---
title: 在使用 SQL 配接器的 SQL Server 中輪詢 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: c31b3cda-c05e-46db-827b-6c47a53d1a3a
caps.latest.revision: 19
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 73bb47bfd631576fe992ef072eee8ff3ff5ba5bf
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "36967127"
---
# <a name="polling-in-sql-server-using-the-sql-adapter"></a><span data-ttu-id="682f1-102">在使用 SQL 配接器的 SQL Server 中輪詢</span><span class="sxs-lookup"><span data-stu-id="682f1-102">Polling in SQL Server using the SQL adapter</span></span>
[!INCLUDE[adaptersql](../../includes/adaptersql-md.md)]<span data-ttu-id="682f1-103"> 可讓配接器用戶端接收的 SQL Server 資料庫中的資料變更訊息。</span><span class="sxs-lookup"><span data-stu-id="682f1-103"> enables adapter clients to receive data-change messages from the SQL Server database.</span></span> <span data-ttu-id="682f1-104">[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]支援接收 「 以輪詢為基礎 」 的訊息執行指定的 SQL 陳述式 （SELECT 陳述式或預存程序），其中配接器擷取或更新資料，並提供給配接器用戶端的結果的固定間隔時間。</span><span class="sxs-lookup"><span data-stu-id="682f1-104">The [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] supports receiving "polling-based" messages wherein the adapter executes a specified SQL statement (SELECT statement or stored procedure), retrieves or updates the data, and provides the result to the adapter client at regular intervals of time.</span></span>  
  
 <span data-ttu-id="682f1-105">[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]公開 （expose) 輪詢執行下列作業：</span><span class="sxs-lookup"><span data-stu-id="682f1-105">The [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] exposes the following operations for polling:</span></span>  
  
- <span data-ttu-id="682f1-106">**輪詢**： 可讓您接收的 SQL Server 資料表或檢視表的定期的資料變更訊息。</span><span class="sxs-lookup"><span data-stu-id="682f1-106">**Polling**: Enables you to receive periodic data-change messages for SQL Server tables or views.</span></span> <span data-ttu-id="682f1-107">訊息會不強型別。</span><span class="sxs-lookup"><span data-stu-id="682f1-107">The messages are not strongly-typed.</span></span>  
  
- <span data-ttu-id="682f1-108">**TypedPolling**： 可讓您接收的 SQL Server 資料庫中的強型別訊息。</span><span class="sxs-lookup"><span data-stu-id="682f1-108">**TypedPolling**: Enables you to receive strongly-typed messages from the SQL Server database.</span></span> <span data-ttu-id="682f1-109">如果您想要將輪詢訊息中的項目對應至任何其他的結構描述，您必須使用這項作業。</span><span class="sxs-lookup"><span data-stu-id="682f1-109">You must use this operation if you intend to map the elements in the polling message to any other schema.</span></span>  
  
- <span data-ttu-id="682f1-110">**XmlPolling**。</span><span class="sxs-lookup"><span data-stu-id="682f1-110">**XmlPolling**.</span></span> <span data-ttu-id="682f1-111">可讓您使用 SELECT 陳述式或預存程序，使用 FOR XML 子句，並傳回資料做為 XML 訊息。</span><span class="sxs-lookup"><span data-stu-id="682f1-111">Enables you to use SELECT statements or stored procedures that use a FOR XML clause and return data as XML messages.</span></span> <span data-ttu-id="682f1-112">這項作業會傳回做為 XML 訊息的輪詢訊息。</span><span class="sxs-lookup"><span data-stu-id="682f1-112">This operation returns the polling message as an XML message.</span></span>  
  
   <span data-ttu-id="682f1-113">如需有關 FOR XML 子句的詳細資訊，請參閱 < [ http://go.microsoft.com/fwlink/?LinkId=131402 ](http://go.microsoft.com/fwlink/?LinkId=131402)。</span><span class="sxs-lookup"><span data-stu-id="682f1-113">For more information about FOR XML clause, see [http://go.microsoft.com/fwlink/?LinkId=131402](http://go.microsoft.com/fwlink/?LinkId=131402).</span></span>  
  
  <span data-ttu-id="682f1-114">如需有關在輪詢[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]，請參閱 <<c2> [ 從 SQL Server 所使用的 BizTalk Server 接收輪詢為基礎的資料變更訊息](../../adapters-and-accelerators/adapter-sql/receive-polling-based-data-changed-messages-from-sql-server-using-biztalk.md)。</span><span class="sxs-lookup"><span data-stu-id="682f1-114">For more information about polling in the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)], see [Receive Polling-based Data-changed Messages from SQL Server by Using BizTalk Server](../../adapters-and-accelerators/adapter-sql/receive-polling-based-data-changed-messages-from-sql-server-using-biztalk.md).</span></span>  
  
## <a name="polling"></a><span data-ttu-id="682f1-115">輪詢</span><span class="sxs-lookup"><span data-stu-id="682f1-115">Polling</span></span>  
 <span data-ttu-id="682f1-116">典型的輪詢作業使用[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]牽涉到下列：</span><span class="sxs-lookup"><span data-stu-id="682f1-116">A typical polling operation using the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] involves the following:</span></span>  
  
1. <span data-ttu-id="682f1-117">配接器用戶端必須指定`Polling`中輸入作業**InboundOperationType**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="682f1-117">The adapter clients must specify `Polling` as the inbound operation in the **InboundOperationType** binding property.</span></span> <span data-ttu-id="682f1-118">這個繫結屬性的預設值是`Polling`。</span><span class="sxs-lookup"><span data-stu-id="682f1-118">The default value for this binding property is `Polling`.</span></span>  
  
2. <span data-ttu-id="682f1-119">配接器用戶端必須指定的 SQL 陳述式**PolledDataAvailableStatement**繫結屬性，可決定是否有資料可供輪詢。</span><span class="sxs-lookup"><span data-stu-id="682f1-119">The adapter clients must specify a SQL statement for the **PolledDataAvailableStatement** binding property that determines whether there is data available for polling.</span></span> <span data-ttu-id="682f1-120">第一個傳回的結果集上執行此陳述式的第一個資料列的第一個資料行包含整數值。</span><span class="sxs-lookup"><span data-stu-id="682f1-120">The first column of the first row of the first result set returned on executing this statement contains an integer value.</span></span> <span data-ttu-id="682f1-121">如果沒有資料可供輪詢，則傳回值是 0 （零）。</span><span class="sxs-lookup"><span data-stu-id="682f1-121">If there is no data available for polling, the return value is 0 (zero).</span></span> <span data-ttu-id="682f1-122">如果沒有可用的資料，則傳回的值會是小於或等於零。</span><span class="sxs-lookup"><span data-stu-id="682f1-122">If there is data available, the return value is greater than zero.</span></span>  
  
3. <span data-ttu-id="682f1-123">配接器用戶端必須指定輪詢間隔**PollingIntervalInSeconds**繫結屬性來定義的間隔時間中的陳述式**PolledDataAvailableStatement**繫結屬性會執行。</span><span class="sxs-lookup"><span data-stu-id="682f1-123">The adapter clients must specify a polling interval for the **PollingIntervalInSeconds** binding property to define the interval at which the statement in the **PolledDataAvailableStatement** binding property is executed.</span></span> <span data-ttu-id="682f1-124">在每個輪詢間隔結束時，輪詢的資料提供陳述式會執行，而且會傳回結果集。</span><span class="sxs-lookup"><span data-stu-id="682f1-124">At the end of every polling interval, the polled data available statement is executed, and the result set is returned.</span></span>  
  
4. <span data-ttu-id="682f1-125">配接器用戶端必須指定輪詢 SQL 陳述式 （SELECT 陳述式或預存程序），如**PollingStatement**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="682f1-125">The adapter clients must specify a polling SQL statement (SELECT statement or stored procedure) for the **PollingStatement** binding property.</span></span> <span data-ttu-id="682f1-126">如果沒有資料可供輪詢 (取決於**PolledDataAvailableStatement**屬性繫結)，配接器執行輪詢陳述式來取得和更新 （如果適用） SQL Server 資料庫中的資料。</span><span class="sxs-lookup"><span data-stu-id="682f1-126">If there is data available for polling (determined by the **PolledDataAvailableStatement** binding property), the adapter executes the polling statement to obtain and update (if applicable) the data in the SQL Server database.</span></span> <span data-ttu-id="682f1-127">當[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]搭配[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]，在同一個交易也會用來提交訊息至[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="682f1-127">When the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] is used with [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)], the same transaction is also used to submit the message to [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
5. <span data-ttu-id="682f1-128">配接器用戶端可以使用**PollWhileDataFound**忽略輪詢間隔，並持續輪詢資料，當有可用的屬性繫結。</span><span class="sxs-lookup"><span data-stu-id="682f1-128">The adapter clients can use the **PollWhileDataFound** binding property to ignore the polling interval, and continuously poll data, as and when available.</span></span>  
  
6. <span data-ttu-id="682f1-129">結果集所傳回的結果執行輪詢陳述式會傳送至配接器用戶端，做為輸入的訊息。</span><span class="sxs-lookup"><span data-stu-id="682f1-129">The result sets that are returned as a result of executing the polling statement are sent to the adapter client as the inbound message.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="682f1-130">XmlPolling 作業牽涉到相同的步驟，以輪詢作業。</span><span class="sxs-lookup"><span data-stu-id="682f1-130">An XmlPolling operation involves the same steps as the Polling operation.</span></span>  
  
## <a name="strongly-typed-polling"></a><span data-ttu-id="682f1-131">強型別輪詢</span><span class="sxs-lookup"><span data-stu-id="682f1-131">Strongly-Typed Polling</span></span>  
 <span data-ttu-id="682f1-132">典型的強型別輪詢作業使用[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]牽涉到下列：</span><span class="sxs-lookup"><span data-stu-id="682f1-132">A typical strongly-typed polling operation using the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] involves the following:</span></span>  
  
1. <span data-ttu-id="682f1-133">配接器用戶端必須指定`TypedPolling`中輸入作業**InboundOperationType**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="682f1-133">The adapter clients must specify `TypedPolling` as the inbound operation in the **InboundOperationType** binding property.</span></span> <span data-ttu-id="682f1-134">這個繫結屬性的預設值是`Polling`。</span><span class="sxs-lookup"><span data-stu-id="682f1-134">The default value for this binding property is `Polling`.</span></span>  
  
2. <span data-ttu-id="682f1-135">配接器用戶端必須指定輸入的識別碼，做為連線 URI 的一部分。</span><span class="sxs-lookup"><span data-stu-id="682f1-135">The adapter clients must specify an inbound ID as part of the connection URI.</span></span> <span data-ttu-id="682f1-136">輸入的識別碼可能是任何字串，並附加至以避免命名空間衝突 TypedPolling 作業的標準命名空間。</span><span class="sxs-lookup"><span data-stu-id="682f1-136">The inbound ID could be any string and is appended to the standard namespace of the TypedPolling operation to prevent namespace collisions.</span></span>  
  
3. <span data-ttu-id="682f1-137">其餘的步驟是相同的步驟 2 – 6 在上一節中所述的輪詢作業中所列。</span><span class="sxs-lookup"><span data-stu-id="682f1-137">The rest of the steps are same as steps 2–6 listed in the Polling operation described in the preceding section.</span></span>  
  
   <span data-ttu-id="682f1-138">如需與輪詢和強型別輪詢的繫結屬性的詳細資訊，請參閱[了解 BizTalk Adapter for SQL Server 配接器繫結屬性](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="682f1-138">For detailed information about the binding properties related to polling and strongly-typed polling, see [Read about BizTalk Adapter for SQL Server adapter  Binding Properties](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="682f1-139">由於執行輪詢陳述式可傳回多個結果集。</span><span class="sxs-lookup"><span data-stu-id="682f1-139">Multiple result sets can be returned as a result of executing the polling statement.</span></span> <span data-ttu-id="682f1-140">如果結果集未包含任何資料列，會不傳送任何訊息給配接器用戶端。</span><span class="sxs-lookup"><span data-stu-id="682f1-140">If the result sets do not contain any rows, no messages are sent to the adapter client.</span></span>  
  
 <span data-ttu-id="682f1-141">下圖提供資訊中的輪詢工作流程[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="682f1-141">The illustration below provides information about the polling workflow in [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)].</span></span> <span data-ttu-id="682f1-142">說明的輪詢工作流程的兩個案例：</span><span class="sxs-lookup"><span data-stu-id="682f1-142">Two scenarios for the polling workflow are illustrated:</span></span>  
  
1. <span data-ttu-id="682f1-143">當 windows 7 **PollWhileDataFound**設為"False"（預設值）。</span><span class="sxs-lookup"><span data-stu-id="682f1-143">When the value of the **PollWhileDataFound** is set to “False” (default setting).</span></span>  
  
2. <span data-ttu-id="682f1-144">當 windows 7 **PollWhileDataFound**設為"True"。</span><span class="sxs-lookup"><span data-stu-id="682f1-144">When the value of the **PollWhileDataFound** is set to “True.”</span></span>  
  
   <span data-ttu-id="682f1-145">![輪詢工作流程&#40;PollWhileDataFound &#61; False&#41;](../../adapters-and-accelerators/adapter-sql/media/15598c14-3a62-4b8d-90bf-84e004a386db.gif "15598c14-3a62-4b8d-90bf-84e004a386db") ![輪詢工作流程&#40;PollWhileDataFound &#61; True&#41; ](../../adapters-and-accelerators/adapter-sql/media/c20535be-ea45-4456-8b62-4d4585cb1d8c.gif "c20535be-ea45-4456-8b62-4d4585cb1d8c")</span><span class="sxs-lookup"><span data-stu-id="682f1-145">![Polling Workflow &#40;PollWhileDataFound &#61; False&#41;](../../adapters-and-accelerators/adapter-sql/media/15598c14-3a62-4b8d-90bf-84e004a386db.gif "15598c14-3a62-4b8d-90bf-84e004a386db") ![Polling Workflow &#40;PollWhileDataFound &#61; True&#41;](../../adapters-and-accelerators/adapter-sql/media/c20535be-ea45-4456-8b62-4d4585cb1d8c.gif "c20535be-ea45-4456-8b62-4d4585cb1d8c")</span></span>  
  
## <a name="differences-between-polling-and-query-notification"></a><span data-ttu-id="682f1-146">輪詢和查詢通知之間的差異</span><span class="sxs-lookup"><span data-stu-id="682f1-146">Differences between Polling and Query Notification</span></span>  
 <span data-ttu-id="682f1-147">輪詢和查詢通知是兩個輸入的作業，而且有關 SQL Server 資料庫中的資料變更通知配接器用戶端，但下表列出兩者之間的一些差異。</span><span class="sxs-lookup"><span data-stu-id="682f1-147">Though polling and query notification are both inbound operations, and inform the adapter clients about the data changes in the SQL Server database, the following table lists some differences between the two.</span></span> <span data-ttu-id="682f1-148">下列差異將協助您決定的作業，視您的需求而定：</span><span class="sxs-lookup"><span data-stu-id="682f1-148">The following differences will help you decide on an operation depending on your requirements:</span></span>  
  
|<span data-ttu-id="682f1-149">輪詢</span><span class="sxs-lookup"><span data-stu-id="682f1-149">Polling</span></span>|<span data-ttu-id="682f1-150">查詢通知</span><span class="sxs-lookup"><span data-stu-id="682f1-150">Query Notification</span></span>|  
|-------------|------------------------|  
|<span data-ttu-id="682f1-151">輪詢配接器所起始。</span><span class="sxs-lookup"><span data-stu-id="682f1-151">Polling is initiated by the adapter.</span></span> <span data-ttu-id="682f1-152">若要驗證是否可供輪詢，資料，並藉由執行輪詢陳述式，如果某些資料已可供輪詢起始輪詢陳述式執行配接器。</span><span class="sxs-lookup"><span data-stu-id="682f1-152">The adapter executes a statement to validate whether data is available for polling, and then initiates polling by executing the polling statement if some data is available for polling.</span></span>|<span data-ttu-id="682f1-153">查詢通知是由 SQL Server 起始。</span><span class="sxs-lookup"><span data-stu-id="682f1-153">Query notification is initiated by SQL Server.</span></span> <span data-ttu-id="682f1-154">只在配接器發出的通知陳述式會指示要起始通知，萬一沒有陳述式的結果集變更的資料庫。</span><span class="sxs-lookup"><span data-stu-id="682f1-154">The notification statement issued by the adapter just instructs the database to initiate notification in case there is a change in the result set of the statement.</span></span>|  
|<span data-ttu-id="682f1-155">您可以使用輪詢陳述式來讀取或更新 SQL Server 資料庫資料表中的資料。</span><span class="sxs-lookup"><span data-stu-id="682f1-155">You can use the polling statement to read or update data in a SQL Server database table.</span></span>|<span data-ttu-id="682f1-156">您可以使用查詢通知的陳述式只讀取 SQL Server 資料庫資料表中的資料。</span><span class="sxs-lookup"><span data-stu-id="682f1-156">You can use the query notification statement to only read data in a SQL Server database table.</span></span>|  
|<span data-ttu-id="682f1-157">輪詢會告知您已變更的實際資料。</span><span class="sxs-lookup"><span data-stu-id="682f1-157">Polling informs you about the actual data that has changed.</span></span>|<span data-ttu-id="682f1-158">查詢通知只會告知的類型變更的資料，例如 Insert、 Update 和 Delete。</span><span class="sxs-lookup"><span data-stu-id="682f1-158">Query notification only informs about the type of change in the data such as Insert, Update, and Delete.</span></span>|  
|<span data-ttu-id="682f1-159">資料變更通知取決於輪詢間隔，以及配接器用戶端會通知有關的資料變更，每個輪詢間隔的結尾。</span><span class="sxs-lookup"><span data-stu-id="682f1-159">The data-change notification depends on the polling interval, and the adapter clients are informed about the data changes at the end of every polling interval.</span></span> <span data-ttu-id="682f1-160">**提示：** 輪詢可讓您更佳的輸送量的資料變更會持續發生，並不想為每項變更並發生時收到通知。</span><span class="sxs-lookup"><span data-stu-id="682f1-160">**Tip:**  Polling can give you better throughput in scenarios where the data changes are happening continuously, and you do not want to be notified of each change as and when it happens.</span></span> <span data-ttu-id="682f1-161">相反地，您可以指定之後，您想要收到的最後一個資料變更通知之後發生的所有變更通知的輪詢間隔。</span><span class="sxs-lookup"><span data-stu-id="682f1-161">Instead, you specify a polling interval after which you want to be notified of all the changes that have happened since the last data-change notification.</span></span>|<span data-ttu-id="682f1-162">資料變更通知是在瞬間完成。</span><span class="sxs-lookup"><span data-stu-id="682f1-162">The data-change notification is instantaneous.</span></span>|  
  
 <span data-ttu-id="682f1-163">如需詳細資訊中的查詢通知的相關[!INCLUDE[adaptersql](../../includes/adaptersql-md.md)]，請參閱 <<c2> [ 使用 BizTalk server 接收 SQL 查詢通知](../../adapters-and-accelerators/adapter-sql/receive-sql-query-notifications-using-biztalk-server.md)。</span><span class="sxs-lookup"><span data-stu-id="682f1-163">For more information about query notification in [!INCLUDE[adaptersql](../../includes/adaptersql-md.md)], see [Receive SQL Query Notifications by Using BizTalk Server](../../adapters-and-accelerators/adapter-sql/receive-sql-query-notifications-using-biztalk-server.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="682f1-164">另請參閱</span><span class="sxs-lookup"><span data-stu-id="682f1-164">See Also</span></span>  
 <span data-ttu-id="682f1-165">[哪些作業可以是執行使用配接器？](https://msdn.microsoft.com/library/cc185435(v=bts.10).aspx)</span><span class="sxs-lookup"><span data-stu-id="682f1-165">[What Operations Can be Performed Using the Adapter?](https://msdn.microsoft.com/library/cc185435(v=bts.10).aspx)</span></span>