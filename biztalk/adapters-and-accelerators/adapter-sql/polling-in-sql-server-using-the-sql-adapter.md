---
title: "在 SQL Server 中使用 SQL 配接器輪詢 |Microsoft 文件"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: c31b3cda-c05e-46db-827b-6c47a53d1a3a
caps.latest.revision: "19"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 7d01bc3d004da60b98e0132aa3c8e04442a45426
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
---
# <a name="polling-in-sql-server-using-the-sql-adapter"></a><span data-ttu-id="5788d-102">在 SQL Server 中使用 SQL 配接器輪詢</span><span class="sxs-lookup"><span data-stu-id="5788d-102">Polling in SQL Server using the SQL adapter</span></span>
[!INCLUDE[adaptersql](../../includes/adaptersql-md.md)]<span data-ttu-id="5788d-103">可讓配接器用戶端接收 SQL Server 資料庫中的資料變更訊息。</span><span class="sxs-lookup"><span data-stu-id="5788d-103"> enables adapter clients to receive data-change messages from the SQL Server database.</span></span> <span data-ttu-id="5788d-104">[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]支援接收 「 輪詢基礎 」 的訊息執行指定的 SQL 陳述式 （SELECT 陳述式或預存程序），其中配接器會擷取或更新資料，並提供結果的固定間隔配接器用戶端時間。</span><span class="sxs-lookup"><span data-stu-id="5788d-104">The [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] supports receiving "polling-based" messages wherein the adapter executes a specified SQL statement (SELECT statement or stored procedure), retrieves or updates the data, and provides the result to the adapter client at regular intervals of time.</span></span>  
  
 <span data-ttu-id="5788d-105">[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]公開輪詢的下列作業：</span><span class="sxs-lookup"><span data-stu-id="5788d-105">The [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] exposes the following operations for polling:</span></span>  
  
-   <span data-ttu-id="5788d-106">**輪詢**： 可讓您接收的 SQL Server 資料表或檢視表的週期性的資料變更訊息。</span><span class="sxs-lookup"><span data-stu-id="5788d-106">**Polling**: Enables you to receive periodic data-change messages for SQL Server tables or views.</span></span> <span data-ttu-id="5788d-107">訊息是不強型別。</span><span class="sxs-lookup"><span data-stu-id="5788d-107">The messages are not strongly-typed.</span></span>  
  
-   <span data-ttu-id="5788d-108">**TypedPolling**： 可讓您接收來自 SQL Server 資料庫的強型別的訊息。</span><span class="sxs-lookup"><span data-stu-id="5788d-108">**TypedPolling**: Enables you to receive strongly-typed messages from the SQL Server database.</span></span> <span data-ttu-id="5788d-109">如果您想要將輪詢訊息中的項目對應至任何其他結構描述，您必須使用這項作業。</span><span class="sxs-lookup"><span data-stu-id="5788d-109">You must use this operation if you intend to map the elements in the polling message to any other schema.</span></span>  
  
-   <span data-ttu-id="5788d-110">**XmlPolling**。</span><span class="sxs-lookup"><span data-stu-id="5788d-110">**XmlPolling**.</span></span> <span data-ttu-id="5788d-111">可讓您使用 SELECT 陳述式或預存程序，使用 FOR XML 子句，並傳回資料當做 XML 訊息。</span><span class="sxs-lookup"><span data-stu-id="5788d-111">Enables you to use SELECT statements or stored procedures that use a FOR XML clause and return data as XML messages.</span></span> <span data-ttu-id="5788d-112">此操作會傳回做為 XML 訊息的輪詢訊息。</span><span class="sxs-lookup"><span data-stu-id="5788d-112">This operation returns the polling message as an XML message.</span></span>  
  
     <span data-ttu-id="5788d-113">如需有關 FOR XML 子句的詳細資訊，請參閱[http://go.microsoft.com/fwlink/?LinkId=131402](http://go.microsoft.com/fwlink/?LinkId=131402)。</span><span class="sxs-lookup"><span data-stu-id="5788d-113">For more information about FOR XML clause, see [http://go.microsoft.com/fwlink/?LinkId=131402](http://go.microsoft.com/fwlink/?LinkId=131402).</span></span>  
  
 <span data-ttu-id="5788d-114">如需有關在輪詢[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]，請參閱[從 SQL Server 所使用的 BizTalk Server 收到輪詢為基礎的資料變更訊息](../../adapters-and-accelerators/adapter-sql/receive-polling-based-data-changed-messages-from-sql-server-using-biztalk.md)。</span><span class="sxs-lookup"><span data-stu-id="5788d-114">For more information about polling in the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)], see [Receive Polling-based Data-changed Messages from SQL Server by Using BizTalk Server](../../adapters-and-accelerators/adapter-sql/receive-polling-based-data-changed-messages-from-sql-server-using-biztalk.md).</span></span>  
  
## <a name="polling"></a><span data-ttu-id="5788d-115">輪詢</span><span class="sxs-lookup"><span data-stu-id="5788d-115">Polling</span></span>  
 <span data-ttu-id="5788d-116">使用一般輪詢作業[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]牽涉到下列：</span><span class="sxs-lookup"><span data-stu-id="5788d-116">A typical polling operation using the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] involves the following:</span></span>  
  
1.  <span data-ttu-id="5788d-117">配接器用戶端必須指定`Polling`為中的輸入作業**InboundOperationType**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="5788d-117">The adapter clients must specify `Polling` as the inbound operation in the **InboundOperationType** binding property.</span></span> <span data-ttu-id="5788d-118">這個繫結屬性的預設值是`Polling`。</span><span class="sxs-lookup"><span data-stu-id="5788d-118">The default value for this binding property is `Polling`.</span></span>  
  
2.  <span data-ttu-id="5788d-119">配接器用戶端必須指定 SQL 陳述式**PolledDataAvailableStatement**繫結屬性，可判斷是否有資料可用來輪詢。</span><span class="sxs-lookup"><span data-stu-id="5788d-119">The adapter clients must specify a SQL statement for the **PolledDataAvailableStatement** binding property that determines whether there is data available for polling.</span></span> <span data-ttu-id="5788d-120">第一個傳回的結果集上執行此陳述式的第一個資料列的第一個資料行包含整數值。</span><span class="sxs-lookup"><span data-stu-id="5788d-120">The first column of the first row of the first result set returned on executing this statement contains an integer value.</span></span> <span data-ttu-id="5788d-121">如果不沒有可用於輪詢的任何資料，傳回值是 0 （零）。</span><span class="sxs-lookup"><span data-stu-id="5788d-121">If there is no data available for polling, the return value is 0 (zero).</span></span> <span data-ttu-id="5788d-122">如果沒有可用的資料，傳回值是小於或等於零。</span><span class="sxs-lookup"><span data-stu-id="5788d-122">If there is data available, the return value is greater than zero.</span></span>  
  
3.  <span data-ttu-id="5788d-123">配接器用戶端必須指定輪詢間隔**PollingIntervalInSeconds**內容繫結至定義的間隔中的陳述式**PolledDataAvailableStatement**繫結執行屬性。</span><span class="sxs-lookup"><span data-stu-id="5788d-123">The adapter clients must specify a polling interval for the **PollingIntervalInSeconds** binding property to define the interval at which the statement in the **PolledDataAvailableStatement** binding property is executed.</span></span> <span data-ttu-id="5788d-124">在每個輪詢間隔結束時，輪詢的資料可用陳述式會執行，而且會傳回結果集。</span><span class="sxs-lookup"><span data-stu-id="5788d-124">At the end of every polling interval, the polled data available statement is executed, and the result set is returned.</span></span>  
  
4.  <span data-ttu-id="5788d-125">配接器用戶端必須指定輪詢 SQL 陳述式 （SELECT 陳述式或預存程序） **PollingStatement**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="5788d-125">The adapter clients must specify a polling SQL statement (SELECT statement or stored procedure) for the **PollingStatement** binding property.</span></span> <span data-ttu-id="5788d-126">如果沒有資料可用於輪詢 (取決於**PolledDataAvailableStatement**繫結屬性)，配接器執行輪詢陳述式可以取得和更新 （如果適用） 的 SQL Server 資料庫中的資料。</span><span class="sxs-lookup"><span data-stu-id="5788d-126">If there is data available for polling (determined by the **PolledDataAvailableStatement** binding property), the adapter executes the polling statement to obtain and update (if applicable) the data in the SQL Server database.</span></span> <span data-ttu-id="5788d-127">當[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]搭配[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]，相同的交易也會用來提交訊息至[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="5788d-127">When the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] is used with [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)], the same transaction is also used to submit the message to [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
5.  <span data-ttu-id="5788d-128">配接器用戶端可以使用**PollWhileDataFound**內容繫結至忽略的輪詢間隔，並持續輪詢資料，以及可用時。</span><span class="sxs-lookup"><span data-stu-id="5788d-128">The adapter clients can use the **PollWhileDataFound** binding property to ignore the polling interval, and continuously poll data, as and when available.</span></span>  
  
6.  <span data-ttu-id="5788d-129">由於執行輪詢陳述式會傳回結果集做為輸入的訊息傳送至配接器用戶端。</span><span class="sxs-lookup"><span data-stu-id="5788d-129">The result sets that are returned as a result of executing the polling statement are sent to the adapter client as the inbound message.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="5788d-130">XmlPolling 作業牽涉到相同的步驟，以輪詢作業。</span><span class="sxs-lookup"><span data-stu-id="5788d-130">An XmlPolling operation involves the same steps as the Polling operation.</span></span>  
  
## <a name="strongly-typed-polling"></a><span data-ttu-id="5788d-131">強型別輪詢</span><span class="sxs-lookup"><span data-stu-id="5788d-131">Strongly-Typed Polling</span></span>  
 <span data-ttu-id="5788d-132">使用一般的強型別輪詢作業[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]牽涉到下列：</span><span class="sxs-lookup"><span data-stu-id="5788d-132">A typical strongly-typed polling operation using the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] involves the following:</span></span>  
  
1.  <span data-ttu-id="5788d-133">配接器用戶端必須指定`TypedPolling`為中的輸入作業**InboundOperationType**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="5788d-133">The adapter clients must specify `TypedPolling` as the inbound operation in the **InboundOperationType** binding property.</span></span> <span data-ttu-id="5788d-134">這個繫結屬性的預設值是`Polling`。</span><span class="sxs-lookup"><span data-stu-id="5788d-134">The default value for this binding property is `Polling`.</span></span>  
  
2.  <span data-ttu-id="5788d-135">配接器用戶端必須指定輸入的識別碼做為連線 URI 的一部分。</span><span class="sxs-lookup"><span data-stu-id="5788d-135">The adapter clients must specify an inbound ID as part of the connection URI.</span></span> <span data-ttu-id="5788d-136">輸入的識別碼可能是任何字串，並附加至 TypedPolling 作業來避免命名空間發生衝突的標準的命名空間。</span><span class="sxs-lookup"><span data-stu-id="5788d-136">The inbound ID could be any string and is appended to the standard namespace of the TypedPolling operation to prevent namespace collisions.</span></span>  
  
3.  <span data-ttu-id="5788d-137">其餘的步驟會與步驟 2-6 列在上一節中說明的輪詢作業相同。</span><span class="sxs-lookup"><span data-stu-id="5788d-137">The rest of the steps are same as steps 2–6 listed in the Polling operation described in the preceding section.</span></span>  
  
 <span data-ttu-id="5788d-138">如需相關輪詢和強型別輪詢的繫結屬性的詳細資訊，請參閱[閱讀 BizTalk Adapter for SQL Server 配接器繫結屬性](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="5788d-138">For detailed information about the binding properties related to polling and strongly-typed polling, see [Read about BizTalk Adapter for SQL Server adapter  Binding Properties](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="5788d-139">執行輪詢陳述式的結果可以傳回多個結果集。</span><span class="sxs-lookup"><span data-stu-id="5788d-139">Multiple result sets can be returned as a result of executing the polling statement.</span></span> <span data-ttu-id="5788d-140">如果結果集未包含任何資料列，會不傳送任何訊息給配接器用戶端。</span><span class="sxs-lookup"><span data-stu-id="5788d-140">If the result sets do not contain any rows, no messages are sent to the adapter client.</span></span>  
  
 <span data-ttu-id="5788d-141">下圖提供資訊中的輪詢工作流程[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="5788d-141">The illustration below provides information about the polling workflow in [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)].</span></span> <span data-ttu-id="5788d-142">輪詢工作流程的兩個案例說明：</span><span class="sxs-lookup"><span data-stu-id="5788d-142">Two scenarios for the polling workflow are illustrated:</span></span>  
  
1.  <span data-ttu-id="5788d-143">當值**PollWhileDataFound**設為"False"（預設值）。</span><span class="sxs-lookup"><span data-stu-id="5788d-143">When the value of the **PollWhileDataFound** is set to “False” (default setting).</span></span>  
  
2.  <span data-ttu-id="5788d-144">當值**PollWhileDataFound**設為"True"。</span><span class="sxs-lookup"><span data-stu-id="5788d-144">When the value of the **PollWhileDataFound** is set to “True.”</span></span>  
  
 <span data-ttu-id="5788d-145">![輪詢工作流程 &#40;PollWhileDataFound &#61;False &#41;] (../../adapters-and-accelerators/adapter-sql/media/15598c14-3a62-4b8d-90bf-84e004a386db.gif "15598c14-3a62-4b8d-90bf-84e004a386db") ![輪詢工作流程 &#40;PollWhileDataFound &#61;True &#41;] (../../adapters-and-accelerators/adapter-sql/media/c20535be-ea45-4456-8b62-4d4585cb1d8c.gif "c20535be-ea45-4456-8b62-4d4585cb1d8c")</span><span class="sxs-lookup"><span data-stu-id="5788d-145">![Polling Workflow &#40;PollWhileDataFound &#61; False&#41;](../../adapters-and-accelerators/adapter-sql/media/15598c14-3a62-4b8d-90bf-84e004a386db.gif "15598c14-3a62-4b8d-90bf-84e004a386db") ![Polling Workflow &#40;PollWhileDataFound &#61; True&#41;](../../adapters-and-accelerators/adapter-sql/media/c20535be-ea45-4456-8b62-4d4585cb1d8c.gif "c20535be-ea45-4456-8b62-4d4585cb1d8c")</span></span>  
  
## <a name="differences-between-polling-and-query-notification"></a><span data-ttu-id="5788d-146">查詢通知輪詢之間的差異</span><span class="sxs-lookup"><span data-stu-id="5788d-146">Differences between Polling and Query Notification</span></span>  
 <span data-ttu-id="5788d-147">雖然輪詢和查詢通知是這兩個輸入的作業，而且配接器用戶端通知的 SQL Server 資料庫中的資料變更下, 表列出這兩者之間的一些差異。</span><span class="sxs-lookup"><span data-stu-id="5788d-147">Though polling and query notification are both inbound operations, and inform the adapter clients about the data changes in the SQL Server database, the following table lists some differences between the two.</span></span> <span data-ttu-id="5788d-148">下列差異，可協助您決定在針對作業，視您的需求而定：</span><span class="sxs-lookup"><span data-stu-id="5788d-148">The following differences will help you decide on an operation depending on your requirements:</span></span>  
  
|<span data-ttu-id="5788d-149">輪詢</span><span class="sxs-lookup"><span data-stu-id="5788d-149">Polling</span></span>|<span data-ttu-id="5788d-150">查詢通知</span><span class="sxs-lookup"><span data-stu-id="5788d-150">Query Notification</span></span>|  
|-------------|------------------------|  
|<span data-ttu-id="5788d-151">輪詢配接器所起始。</span><span class="sxs-lookup"><span data-stu-id="5788d-151">Polling is initiated by the adapter.</span></span> <span data-ttu-id="5788d-152">執行陳述式，以驗證是否資料適用於輪詢，並以起始輪詢執行輪詢陳述式，如果某些資料可用於輪詢配接器。</span><span class="sxs-lookup"><span data-stu-id="5788d-152">The adapter executes a statement to validate whether data is available for polling, and then initiates polling by executing the polling statement if some data is available for polling.</span></span>|<span data-ttu-id="5788d-153">查詢通知是由 SQL Server 啟動。</span><span class="sxs-lookup"><span data-stu-id="5788d-153">Query notification is initiated by SQL Server.</span></span> <span data-ttu-id="5788d-154">只在配接器發出的通知陳述式會指示資料庫在陳述式的結果集變更的情況下起始通知。</span><span class="sxs-lookup"><span data-stu-id="5788d-154">The notification statement issued by the adapter just instructs the database to initiate notification in case there is a change in the result set of the statement.</span></span>|  
|<span data-ttu-id="5788d-155">您可以使用輪詢陳述式來讀取或更新 SQL Server 資料庫資料表中的資料。</span><span class="sxs-lookup"><span data-stu-id="5788d-155">You can use the polling statement to read or update data in a SQL Server database table.</span></span>|<span data-ttu-id="5788d-156">您可以使用查詢通知陳述式只讀取 SQL Server 資料庫資料表中的資料。</span><span class="sxs-lookup"><span data-stu-id="5788d-156">You can use the query notification statement to only read data in a SQL Server database table.</span></span>|  
|<span data-ttu-id="5788d-157">輪詢會通知您有關已變更的實際資料。</span><span class="sxs-lookup"><span data-stu-id="5788d-157">Polling informs you about the actual data that has changed.</span></span>|<span data-ttu-id="5788d-158">查詢通知只會告知的類型變更的資料，例如 Insert、 Update 和 Delete。</span><span class="sxs-lookup"><span data-stu-id="5788d-158">Query notification only informs about the type of change in the data such as Insert, Update, and Delete.</span></span>|  
|<span data-ttu-id="5788d-159">輪詢間隔，取決於資料變更通知，配接器用戶端就會接到通知有關的資料變更每個輪詢間隔的結尾。</span><span class="sxs-lookup"><span data-stu-id="5788d-159">The data-change notification depends on the polling interval, and the adapter clients are informed about the data changes at the end of every polling interval.</span></span> <span data-ttu-id="5788d-160">**提示：**輪詢可讓您更佳的輸送量持續發生資料變更並不想為每項變更，並發生時加以通知。</span><span class="sxs-lookup"><span data-stu-id="5788d-160">**Tip:**  Polling can give you better throughput in scenarios where the data changes are happening continuously, and you do not want to be notified of each change as and when it happens.</span></span> <span data-ttu-id="5788d-161">相反地，您可以指定的輪詢之後, 您想要發生的問題後的最後一個資料變更通知的所有變更的通知。</span><span class="sxs-lookup"><span data-stu-id="5788d-161">Instead, you specify a polling interval after which you want to be notified of all the changes that have happened since the last data-change notification.</span></span>|<span data-ttu-id="5788d-162">資料變更通知是在瞬間完成。</span><span class="sxs-lookup"><span data-stu-id="5788d-162">The data-change notification is instantaneous.</span></span>|  
  
 <span data-ttu-id="5788d-163">如需有關在查詢通知[!INCLUDE[adaptersql](../../includes/adaptersql-md.md)]，請參閱[使用 BizTalk server 接收 SQL 查詢通知](../../adapters-and-accelerators/adapter-sql/receive-sql-query-notifications-using-biztalk-server.md)。</span><span class="sxs-lookup"><span data-stu-id="5788d-163">For more information about query notification in [!INCLUDE[adaptersql](../../includes/adaptersql-md.md)], see [Receive SQL Query Notifications by Using BizTalk Server](../../adapters-and-accelerators/adapter-sql/receive-sql-query-notifications-using-biztalk-server.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5788d-164">另請參閱</span><span class="sxs-lookup"><span data-stu-id="5788d-164">See Also</span></span>  
 <span data-ttu-id="5788d-165">[哪些作業可以是執行使用配接器？](https://msdn.microsoft.com/library/cc185435(v=bts.10).aspx)</span><span class="sxs-lookup"><span data-stu-id="5788d-165">[What Operations Can be Performed Using the Adapter?](https://msdn.microsoft.com/library/cc185435(v=bts.10).aspx)</span></span>