---
title: Insert、 Update、 Delete 與選取資料表和檢視表，SQL 配接器的作業 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: d0cc39d5-16f2-454a-8e1d-c031592439ae
caps.latest.revision: 16
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: f57aa7252fc838473f87418953e081a33a42ae12
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "36993623"
---
# <a name="insert-update-delete-and-select-operations-on-tables-and-views-with-the-sql-adapter"></a>Insert、 Update、 Delete 與資料表和 SQL 配接器的檢視表的選取作業
[!INCLUDE[adaptersql](../../includes/adaptersql-md.md)]呈現一組標準的每個資料表和檢視 SQL Server 資料庫中的作業。 藉由使用這些作業，您可以執行簡單的 INSERT、 UPDATE、 SELECT、 和 DELETE 陳述式目標資料表或檢視表的 WHERE 子句所限定。 這些作業也稱為資料操作語言 (DML) 作業。  

 下表顯示 DML 作業，[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]支援：  


| 作業 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               描述                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|-----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|  Insert   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      執行插入作業的目標資料表或檢視。<br /><br /> -插入作業會取得記錄的陣列作為輸入。 每一筆記錄是強型別，目標資料表，並會對應至插入資料列的資料表中。<br />-您可以在提供的值的身分識別資料行中插入值**AllowIdentityInsert**繫結屬性設定為 TRUE。 如需詳細資訊**AllowIdentityInsert**繫結屬性，請參閱[了解 BizTalk Adapter for SQL Server 配接器繫結屬性](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md)。<br />-插入作業的傳回值是 Long 資料類型的陣列。 如果有的話，這個陣列就會儲存插入的資料列的識別值。 如果資料表沒有識別資料行，傳回的值會是 NULL。<br /><br /> 插入作業的訊息中的某些值會視為由下列方式[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]:<br /><br /> -指定計算資料行和時間戳記資料行的值會被忽略。<br />-如果識別欄位的節點為 null，則會忽略它。<br /><br /> 如需插入作業的訊息中其他值：<br /><br /> -如果資料行指定值，該值會在 INSERT 陳述式。<br />-如果特定的資料行的節點為 null，NULL 會在 INSERT 陳述式。 **注意：** 有特定的記錄，可以使用 INSERT 陳述式中沒有值 （也就是未指定值的任何資料行或所有資料行值已忽略），執行下列 SQL 陳述式的配接器： `insert into <table_name> default values`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|  Select   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               執行 SELECT 陳述式的目標資料表或檢視記錄 （資料行） 的陣列，並指定 WHERE 子句的查詢字串為基礎。<br /><br /> -如需 SELECT 陳述式中的資料行的清單，就必須指定 a 的值。 若要在資料表或檢視表中擷取所有資料行有\*必須在 SELECT 陳述式中指定。 如果要擷取特定資料行，就必須以逗號分隔，並指定相同的順序定義資料表或檢視表中的資料行名稱。<br />-WHERE 子句必須包含在 SELECT 陳述式。 不過，如果您不想在 WHERE 子句中指定的值，您可以刪除`Query`項目，或保持空白。<br />-選取的作業也可讓您執行更新作業。 UPDATE 陳述式放在此情況下， `Query` SELECT 陳述式的項目。<br /><br /> 選取作業的傳回值是強型別結果集，其中包含指定的資料行和資料列從目標資料表或檢視表。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|  Update   | 執行更新作業的目標資料表或檢視。<br /><br /> -更新作業會取得記錄組的陣列作為輸入。 每個記錄組是集合的兩筆記錄，而且每一筆記錄為強型別至目標資料表。<br /><br /> -第一筆記錄對應到需要更新的新值，也就是它會對應到 UPDATE 陳述式的 SET 子句。 <br />-第二筆記錄對應到資料列的舊值，也就是它會對應到 UPDATE 陳述式的 WHERE 子句。 **注意：** 如果特定的記錄組，沒有任何可用的 SET 子句中的值，該記錄組執行任何更新陳述式。 <br />-您可以更新中提供的值的身分識別資料行的值**AllowIdentityInsert**繫結屬性設定為 TRUE。 如需詳細資訊**AllowIdentityInsert**繫結屬性，請參閱[了解 BizTalk Adapter for SQL Server 配接器繫結屬性](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md)。 <br />-更新作業的傳回值是 Int32 資料型別，並代表更新之資料列數目。<br /> 更新作業訊息中的某些值會視為由下列方式[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]:<br /><br /> -指定計算資料行和訊息的 SET 子句中的時間戳記資料行的值會被忽略。<br />-如果使用者定義型別 (UDT) 不是已排序的 UDT 資料行指定值的位元組在 WHERE 子句會忽略。<br />-如果識別欄位的節點是在訊息的 SET 子句中為 null，則會忽略它。<br />-如果 null 訊息的 WHERE 子句中的身分識別或時間戳記資料行的節點，則會忽略它。<br />-如果影像、 XML、 Text 或 Ntext 資料行的節點不是在訊息的 WHERE 子句中為 null，因為無法比較這些值將會忽略它們所指定的值。<br /><br /> 如需更新作業訊息中其他值：<br /><br /> -如果 UPDATE 陳述式的 SET 子句中的資料行指定值，該值會在陳述式的 SET 子句 (`set <column_name> = <value>`)。<br />-如果特定的資料行的節點為 null 的 SET 子句中，UPDATE 陳述式中使用 NULL (`set <column_name> = null`)。<br />-如果指定的值是資料行在 UPDATE 陳述式的 WHERE 子句，陳述式的 WHERE 子句中使用的值 (`where <column_name> = <value>`)。<br />-如果特定的資料行的節點為 null 的 UPDATE 陳述式的 WHERE 子句中，UPDATE 陳述式中使用 NULL (`where <column_name> is null`)。 |
|  DELETE   |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        執行刪除作業的目標資料表或目標資料表的篩選條件字串，指定 WHERE 子句的資料錄 （資料行名稱清單） 的強型別陣列為基礎的檢視。<br /><br /> 刪除作業的傳回值是 Int32 資料型別，並代表刪除資料列數目。<br /><br /> 刪除作業的訊息中的某些值會視為由下列方式[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]:<br /><br /> -如果影像、 XML、 Text 或 Ntext 資料行的節點不是在訊息的 WHERE 子句中為 null，因為無法比較這些值將會忽略它們所指定的值。<br />-如果的身分識別或時間戳記資料行的節點為 null，則會忽略它。<br />-如果 UDT 不是已排序的 UDT 資料行指定值的位元組在 WHERE 子句會忽略。<br /><br /> 如需刪除作業的訊息中其他值：<br /><br /> -如果資料行指定值，該值會在 DELETE 陳述式的 WHERE 子句 (`where <column_name> = <value>`)。<br />-如果特定的資料行的節點為 null，DELETE 陳述式中使用 NULL (`where <column_name> is null`)。 **注意：** 如果特定的記錄沒有值可用於 DELETE 陳述式 （也就是未指定值的任何資料行或存在所有資料行值已被忽略），配接器不會執行任何的 DELETE 陳述式。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |

 如需詳細資訊：  

- 執行這些作業使用[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]，請參閱 < [Insert、 update、 delete 或 select 作業使用 SQL 配接器的 BizTalk Server](../../adapters-and-accelerators/adapter-sql/insert-update-delete-or-select-using-the-sql-adapter-in-biztalk-server.md)。  

- 訊息結構和執行 DML 作業的 SOAP 動作，請參閱[Insert、 Update、 Delete 與資料表和檢視表的選取作業的訊息結構描述](../../adapters-and-accelerators/adapter-sql/message-schemas-for-insert-update-delete-and-select-on-tables-and-views.md)。  

## <a name="see-also"></a>另請參閱  
 [連接到 SAP 系統使用配接器](../../adapters-and-accelerators/adapter-sap/connect-to-an-sap-system-using-the-adapter.md)