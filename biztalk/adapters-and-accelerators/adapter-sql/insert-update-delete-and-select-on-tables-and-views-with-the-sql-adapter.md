---
title: Insert、 Update、 Delete 和選取資料表和檢視表與 SQL 配接器的作業 |Microsoft 文件
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: d0cc39d5-16f2-454a-8e1d-c031592439ae
caps.latest.revision: 16
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: cae4dfff287414c4f9b1081face9a33bbf9da545
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
ms.locfileid: "22225382"
---
# <a name="insert-update-delete-and-select-operations-on-tables-and-views-with-the-sql-adapter"></a><span data-ttu-id="fd9fc-102">Insert、 Update、 Delete 和選取資料表和檢視表與 SQL 配接器的作業</span><span class="sxs-lookup"><span data-stu-id="fd9fc-102">Insert, Update, Delete, and Select Operations on Tables and Views with the SQL adapter</span></span>
<span data-ttu-id="fd9fc-103">[!INCLUDE[adaptersql](../../includes/adaptersql-md.md)]呈現一組標準的作業，針對每個資料表和檢視 SQL Server 資料庫中的。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-103">The [!INCLUDE[adaptersql](../../includes/adaptersql-md.md)]surfaces a set of standard operations on each table and view in the SQL Server database.</span></span> <span data-ttu-id="fd9fc-104">藉由使用這些作業，您可以執行簡單的 INSERT、 UPDATE、 SELECT 和 DELETE 陳述式的目標資料表或檢視的 WHERE 子句所限定。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-104">By using these operations, you can execute simple INSERT, UPDATE, SELECT, and DELETE statements qualified by a WHERE clause on the target table or view.</span></span> <span data-ttu-id="fd9fc-105">這些作業也稱為資料操作語言 (DML) 作業。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-105">These operations are also called data manipulation language (DML) operations.</span></span>  
  
 <span data-ttu-id="fd9fc-106">下表顯示對 DML 作業的[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]支援：</span><span class="sxs-lookup"><span data-stu-id="fd9fc-106">The following table shows the DML operations that the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] supports:</span></span>  
  
|<span data-ttu-id="fd9fc-107">作業</span><span class="sxs-lookup"><span data-stu-id="fd9fc-107">Operation</span></span>|<span data-ttu-id="fd9fc-108">Description</span><span class="sxs-lookup"><span data-stu-id="fd9fc-108">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="fd9fc-109">Insert</span><span class="sxs-lookup"><span data-stu-id="fd9fc-109">Insert</span></span>|<span data-ttu-id="fd9fc-110">執行插入作業的目標資料表或檢視。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-110">Performs an Insert operation on the target table or view.</span></span><br /><br /> <span data-ttu-id="fd9fc-111">-插入作業會取得記錄的陣列作為輸入。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-111">-   The Insert operation takes an array of records as input.</span></span> <span data-ttu-id="fd9fc-112">每一筆記錄強類型的目標資料表和資料列插入資料表中的對應。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-112">Each record is strongly typed to the target table, and maps to the row being inserted in the table.</span></span><br /><span data-ttu-id="fd9fc-113">-您可以在提供的值的識別資料行中插入值**AllowIdentityInsert**繫結屬性設定為 TRUE。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-113">-   You can insert values in identity columns provided the value of the **AllowIdentityInsert** binding property is set to TRUE.</span></span> <span data-ttu-id="fd9fc-114">如需有關**AllowIdentityInsert**繫結屬性，請參閱[閱讀 BizTalk Adapter for SQL Server 配接器繫結屬性](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-114">For more information about the **AllowIdentityInsert** binding property, see [Read about the BizTalk Adapter for SQL Server adapter binding properties](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span></span><br /><span data-ttu-id="fd9fc-115">的插入作業傳回值是 Long 資料類型的陣列。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-115">-   The return value of the Insert operation is an array of Long data type.</span></span> <span data-ttu-id="fd9fc-116">如果有的話，這個陣列會儲存插入的資料列的識別值。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-116">This array stores the identity values of the inserted rows, if any.</span></span> <span data-ttu-id="fd9fc-117">如果資料表沒有識別資料行，傳回值會是 NULL。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-117">If there is no identity column in a table, the return value is NULL.</span></span><br /><br /> <span data-ttu-id="fd9fc-118">依下列方式處理的插入作業的訊息中的某些值的[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="fd9fc-118">Some values in the Insert operation message are treated in the following manner by the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]:</span></span><br /><br /> <span data-ttu-id="fd9fc-119">-指定的計算資料行和時間戳記資料行值都會被忽略。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-119">-   Values specified for computed columns and timestamp columns are ignored.</span></span><br /><span data-ttu-id="fd9fc-120">-如果識別欄位的節點是 null，則會忽略它。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-120">-   If the node for an identity column is null, it is ignored.</span></span><br /><br /> <span data-ttu-id="fd9fc-121">如需插入作業的訊息中其他值：</span><span class="sxs-lookup"><span data-stu-id="fd9fc-121">For all other values in the Insert operation message:</span></span><br /><br /> <span data-ttu-id="fd9fc-122">-如果資料行指定值，該值會用於 INSERT 陳述式。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-122">-   If a value is specified for a column, that value is used in the INSERT statement.</span></span><br /><span data-ttu-id="fd9fc-123">-如果特定的資料行的節點是 null，NULL 會用於 INSERT 陳述式。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-123">-   If the node for a particular column is null, NULL is used in the INSERT statement.</span></span> <span data-ttu-id="fd9fc-124">**注意：** 有特定的記錄，可以使用 INSERT 陳述式中的任何值 （也就是未指定值的任何資料行或所有資料行值已忽略），配接器執行下列 SQL 陳述式：`insert into <table_name> default values`</span><span class="sxs-lookup"><span data-stu-id="fd9fc-124">**Note:**  If for a particular record, there are no values that can be used in the INSERT statement (that is, either no values were specified for any column or all the column values were ignored), the adapter executes the following SQL statement: `insert into <table_name> default values`</span></span>|  
|<span data-ttu-id="fd9fc-125">Select</span><span class="sxs-lookup"><span data-stu-id="fd9fc-125">Select</span></span>|<span data-ttu-id="fd9fc-126">執行 SELECT 陳述式的目標資料表或檢視的記錄 （資料行） 的陣列和查詢字串，指定 WHERE 子句為基礎。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-126">Performs a SELECT statement on the target table or view based on an array of records (columns) and a query string that specifies a WHERE clause.</span></span><br /><br /> <span data-ttu-id="fd9fc-127">-如需 SELECT 陳述式中的資料行的清單，就必須指定 a 的值。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-127">-   A value must be specified for the list of the columns in the SELECT statement.</span></span> <span data-ttu-id="fd9fc-128">如果要擷取資料表或檢視表中的所有資料行有 \* 必須指定 SELECT 陳述式中。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-128">If all columns have to be retrieved in a table or view, \* must be specified in the SELECT statement.</span></span> <span data-ttu-id="fd9fc-129">如果必須擷取特定資料行，必須逗號分隔並在其中指定相同的順序定義這些資料表或檢視表的資料行名稱。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-129">If specific columns have to be retrieved, the column names must be separated by comma, and specified in the same order as they are defined in the table or view.</span></span><br /><span data-ttu-id="fd9fc-130">-在 WHERE 子句必須包含在 SELECT 陳述式。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-130">-   The WHERE clause must be included in the SELECT statement.</span></span> <span data-ttu-id="fd9fc-131">不過，如果您不想在 WHERE 子句中指定的值，您可以刪除`Query`項目，或保持空白。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-131">However, if you do not want to specify a value in the WHERE clause, you can either delete the `Query` element or leave it empty.</span></span><br /><span data-ttu-id="fd9fc-132">-選取的作業也可讓您執行更新作業。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-132">-   The Select operation also allows you to perform an Update operation.</span></span> <span data-ttu-id="fd9fc-133">在此情況下，UPDATE 陳述式放置於`Query`SELECT 陳述式的項目。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-133">In this case, the UPDATE statement is placed inside the `Query` element of the SELECT statement.</span></span><br /><br /> <span data-ttu-id="fd9fc-134">選取作業的傳回值是強型別結果集，其中包含指定的資料行和資料列從目標資料表或檢視表。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-134">The return value of the Select operation is a strongly-typed result set that contains the specified columns and rows from the target table or view.</span></span>|  
|<span data-ttu-id="fd9fc-135">Update</span><span class="sxs-lookup"><span data-stu-id="fd9fc-135">Update</span></span>|<span data-ttu-id="fd9fc-136">執行更新作業的目標資料表或檢視。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-136">Performs an Update operation on the target table or view.</span></span><br /><br /> <span data-ttu-id="fd9fc-137">-更新作業會做為輸入的記錄組的陣列。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-137">- The Update operation takes an array of record pairs as input.</span></span> <span data-ttu-id="fd9fc-138">每一筆記錄對記錄的集合，兩個，而每一筆記錄強型別到目標資料表。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-138">Each record pair is a collection of two records, and each record is strongly-typed to the target table.</span></span><br /><br /> <span data-ttu-id="fd9fc-139">-第一筆記錄對應到需要更新的新值，也就是說，它會對應到 UPDATE 陳述式的 SET 子句。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-139">- The first record corresponds to new values that need to be updated, that is, it corresponds to the SET clause of the UPDATE statement.</span></span> <br /><span data-ttu-id="fd9fc-140">-第二筆記錄對應到資料列的舊值，亦即，它會對應到 UPDATE 陳述式的 WHERE 子句。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-140">- The second record corresponds to the old values of the rows, that is, it corresponds to the WHERE clause of the UPDATE statement.</span></span> <span data-ttu-id="fd9fc-141">**注意：** 配對的記錄特定的記錄組中，沒有任何可用的 SET 子句中的值，如果執行任何 UPDATE 陳述式。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-141">**Note:**      If, for a particular record pair, there are no values that can be used in the SET clause, no UPDATE statement is executed for that record pair.</span></span> <br /><span data-ttu-id="fd9fc-142">-您可以更新所提供的值的識別資料行中值**AllowIdentityInsert**繫結屬性設定為 TRUE。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-142">- You can update values in identity columns provided the value of the **AllowIdentityInsert** binding property is set to TRUE.</span></span> <span data-ttu-id="fd9fc-143">如需有關**AllowIdentityInsert**繫結屬性，請參閱[閱讀 BizTalk Adapter for SQL Server 配接器繫結屬性](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-143">For more information about the **AllowIdentityInsert** binding property, see [Read about the BizTalk Adapter for SQL Server adapter binding properties](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span></span> <br /><span data-ttu-id="fd9fc-144">的更新作業傳回值的 Int32 資料型別，並代表更新的資料列的數目。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-144">- The return value of the Update operation is of Int32 data type, and denotes the number of rows updated.</span></span><br /> <span data-ttu-id="fd9fc-145">依下列方式處理更新作業訊息中的某些值的[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="fd9fc-145">Some values in the Update operation message are treated in the following manner by the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]:</span></span><br /><br /> <span data-ttu-id="fd9fc-146">-指定的計算資料行和訊息的 SET 子句中的時間戳記資料行值都會被忽略。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-146">-   Values specified for computed columns and timestamp columns in the SET clause of the message are ignored.</span></span><br /><span data-ttu-id="fd9fc-147">-如果使用者定義型別 (UDT) 不是已排序的 UDT 資料行指定值的位元組在 where 子句會忽略。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-147">-   If a User Defined Type (UDT) is not byte ordered, the value specified for the UDT column in the WHERE clause is ignored.</span></span><br /><span data-ttu-id="fd9fc-148">-如果識別欄位的節點為 null 之訊息的 SET 子句中，則會忽略它。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-148">-   If the node for an identity column is null in the SET clause of the message, it is ignored.</span></span><br /><span data-ttu-id="fd9fc-149">-如果的身分識別或時間戳記資料行的節點為 null 的 WHERE 子句中的訊息，則會忽略它。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-149">-   If the node for an identity or timestamp column is null in the WHERE clause of the message, it is ignored.</span></span><br /><span data-ttu-id="fd9fc-150">-如果影像、 XML、 Text 或 Ntext 資料行的節點不是 null 的 WHERE 子句中的訊息，因為無法比較這些值將會忽略為其指定的值。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-150">-   If the node for an image, XML, Text or Ntext column is not null in the WHERE clause of the message, the values specified for them are ignored because these values cannot be compared.</span></span><br /><br /> <span data-ttu-id="fd9fc-151">如需更新作業訊息中其他值：</span><span class="sxs-lookup"><span data-stu-id="fd9fc-151">For all other values in the Update operation message:</span></span><br /><br /> <span data-ttu-id="fd9fc-152">-如果 UPDATE 陳述式的 SET 子句中的資料行指定值，陳述式的 SET 子句中，會使用值 (`set <column_name> = <value>`)。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-152">-   If a value is specified for a column in the SET clause of the UPDATE statement, the value is used in the SET clause of the statement (`set <column_name> = <value>`).</span></span><br /><span data-ttu-id="fd9fc-153">-如果特定的資料行的節點為 null 的 SET 子句中，UPDATE 陳述式中使用 NULL (`set <column_name> = null`)。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-153">-   If the node for a particular column is null in the SET clause, NULL is used in the UPDATE statement (`set <column_name> = null`).</span></span><br /><span data-ttu-id="fd9fc-154">-如果指定的值是資料行在 UPDATE 陳述式的 WHERE 子句，陳述式的 WHERE 子句中使用的值 (`where <column_name> = <value>`)。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-154">-   If a value is specified for a column in the WHERE clause of the UPDATE statement, the value is used in the WHERE clause of the statement (`where <column_name> = <value>`).</span></span><br /><span data-ttu-id="fd9fc-155">-如果特定的資料行的節點為 null 的 UPDATE 陳述式的 WHERE 子句中，UPDATE 陳述式中使用 NULL (`where <column_name> is null`)。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-155">-   If the node for a particular column is null in the WHERE clause of the UPDATE statement, NULL is used in the UPDATE statement (`where <column_name> is null`).</span></span>|  
|<span data-ttu-id="fd9fc-156">DELETE</span><span class="sxs-lookup"><span data-stu-id="fd9fc-156">Delete</span></span>|<span data-ttu-id="fd9fc-157">執行 Delete 作業的目標資料表或檢視的記錄 （資料行名稱清單） 之目標資料表指定 WHERE 子句的篩選字串的強型別陣列為基礎。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-157">Performs a Delete operation on the target table or view based on a strongly-typed array of records (list of column names) of the target table and a filter string that specifies a WHERE clause.</span></span><br /><br /> <span data-ttu-id="fd9fc-158">刪除作業的傳回值的 Int32 資料型別，並代表刪除資料列的數目。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-158">The return value of the Delete operation is of Int32 data type, and denotes the number of rows deleted.</span></span><br /><br /> <span data-ttu-id="fd9fc-159">刪除作業的訊息中某些值會視為以下列方式由[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="fd9fc-159">Some values in the Delete operation message are treated in the following manner by the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]:</span></span><br /><br /> <span data-ttu-id="fd9fc-160">-如果影像、 XML、 Text 或 Ntext 資料行的節點不是 null 的 WHERE 子句中的訊息，因為無法比較這些值將會忽略為其指定的值。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-160">-   If the node for an image, XML, Text or Ntext column is not null in the WHERE clause of the message, the values specified for them are ignored because these values cannot be compared.</span></span><br /><span data-ttu-id="fd9fc-161">-如果的身分識別或時間戳記資料行的節點是 null，則會忽略它。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-161">-   If the node for an identity or timestamp column is null, it is ignored.</span></span><br /><span data-ttu-id="fd9fc-162">-如果 UDT 不是已排序的 UDT 資料行指定值的位元組在 where 子句會忽略。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-162">-   If a UDT is not byte ordered, the value specified for the UDT column in the WHERE clause is ignored.</span></span><br /><br /> <span data-ttu-id="fd9fc-163">如需刪除作業的訊息中其他值：</span><span class="sxs-lookup"><span data-stu-id="fd9fc-163">For all other values in the Delete operation message:</span></span><br /><br /> <span data-ttu-id="fd9fc-164">-在 DELETE 陳述式的 WHERE 子句如果資料行指定值，會使用值 (`where <column_name> = <value>`)。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-164">-   If a value is specified for a column, the value is used in the WHERE clause of the DELETE statement (`where <column_name> = <value>`).</span></span><br /><span data-ttu-id="fd9fc-165">-如果特定的資料行的節點是 null，DELETE 陳述式中使用 NULL (`where <column_name> is null`)。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-165">-   If the node for a particular column is null, NULL is used in the DELETE statement (`where <column_name> is null`).</span></span> <span data-ttu-id="fd9fc-166">**注意：** 如果特定的記錄，沒有值可用於 DELETE 陳述式 （也就是未指定值的任何資料行或存在所有資料行值已被忽略），配接器不會執行任何的 DELETE 陳述式。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-166">**Note:**  If, for a particular record, there are no values that can be used in the DELETE statement (that is, either no values were specified for any column or if all the column values present were ignored), the adapter does not execute any DELETE statement.</span></span>|  
  
 <span data-ttu-id="fd9fc-167">如需詳細資訊：</span><span class="sxs-lookup"><span data-stu-id="fd9fc-167">For more information about:</span></span>  
  
-   <span data-ttu-id="fd9fc-168">執行這些作業使用[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]，請參閱[Insert、 update、 delete 或 select 作業使用 BizTalk Server 與 SQL 配接器](../../adapters-and-accelerators/adapter-sql/insert-update-delete-or-select-using-the-sql-adapter-in-biztalk-server.md)。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-168">Performing these operations using [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)], see [Insert, update, delete, or select operations using BizTalk Server with the SQL adapter](../../adapters-and-accelerators/adapter-sql/insert-update-delete-or-select-using-the-sql-adapter-in-biztalk-server.md).</span></span>  
  
-   <span data-ttu-id="fd9fc-169">訊息結構和執行 DML 作業的 SOAP 動作，請參閱[Insert、 Update、 Delete 和資料表和檢視表的選取作業的訊息結構描述](../../adapters-and-accelerators/adapter-sql/message-schemas-for-insert-update-delete-and-select-on-tables-and-views.md)。</span><span class="sxs-lookup"><span data-stu-id="fd9fc-169">Message structures and SOAP action for performing DML operations, see [Message Schemas for Insert, Update, Delete, and Select Operations on Tables and Views](../../adapters-and-accelerators/adapter-sql/message-schemas-for-insert-update-delete-and-select-on-tables-and-views.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="fd9fc-170">另請參閱</span><span class="sxs-lookup"><span data-stu-id="fd9fc-170">See Also</span></span>  
 [<span data-ttu-id="fd9fc-171">連接至 SAP 系統使用配接器</span><span class="sxs-lookup"><span data-stu-id="fd9fc-171">Connect to an SAP system using the adapter</span></span>](../../adapters-and-accelerators/adapter-sap/connect-to-an-sap-system-using-the-adapter.md)