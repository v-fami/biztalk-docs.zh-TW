---
title: 使用 BizTalk Server 從 SQL Server 接收強型別輪詢為基礎的資料變更訊息 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: e6e6ba7e-9e13-4e28-b57d-d24569277bbc
caps.latest.revision: 21
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 5454a20e087a643acb6f2b0bc9735eae6d29b996
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "36976255"
---
# <a name="receive-strongly-typed-polling-based-data-changed-messages-from-sql-server-using-biztalk-server"></a><span data-ttu-id="a16ad-102">使用 BizTalk Server 從 SQL Server 接收強型別輪詢為基礎的資料變更訊息</span><span class="sxs-lookup"><span data-stu-id="a16ad-102">Receive strongly-typed polling-based data-changed messages from SQL Server using BizTalk Server</span></span>
<span data-ttu-id="a16ad-103">您可以設定[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]來接收 SQL Server 中的強型別輪詢訊息。</span><span class="sxs-lookup"><span data-stu-id="a16ad-103">You can configure the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] to receive strongly-typed polling messages from SQL Server.</span></span> <span data-ttu-id="a16ad-104">您可以指定要輪詢的資料庫執行的配接器的輪詢陳述式。</span><span class="sxs-lookup"><span data-stu-id="a16ad-104">You can specify a polling statement that the adapter executes to poll the database.</span></span> <span data-ttu-id="a16ad-105">輪詢陳述式可以是 SELECT 陳述式或預存程序會傳回結果集。</span><span class="sxs-lookup"><span data-stu-id="a16ad-105">The polling statement can be a SELECT statement or a stored procedure that returns a result set.</span></span>  
  
 <span data-ttu-id="a16ad-106">您必須使用強型別輪詢，在案例中您要將輪詢訊息中的項目對應至任何其他的結構描述。</span><span class="sxs-lookup"><span data-stu-id="a16ad-106">You must use strongly-typed polling in a scenario where you want to map the elements in the polling message to any other schema.</span></span> <span data-ttu-id="a16ad-107">SQL Server 上的另一個作業，可能是您想要對應至結構的描述。</span><span class="sxs-lookup"><span data-stu-id="a16ad-107">The schema you want to map to could be for another operation on SQL Server.</span></span> <span data-ttu-id="a16ad-108">例如，您可以將輪詢訊息中的特定項目對應至另一個資料表上的 [插入] 作業的結構描述。</span><span class="sxs-lookup"><span data-stu-id="a16ad-108">For example, you could map certain elements in the polling message to the schema for an Insert operation on another table.</span></span> <span data-ttu-id="a16ad-109">因此，輪詢訊息中的值會做為參數的 Insert 作業。</span><span class="sxs-lookup"><span data-stu-id="a16ad-109">So, the values in the polling message serve as parameters for the Insert operation.</span></span> <span data-ttu-id="a16ad-110">在簡單的案例中，您可以將強型別輪詢訊息的結構描述對應至結構描述檔案，只會儲存資訊。</span><span class="sxs-lookup"><span data-stu-id="a16ad-110">In a simpler scenario, you could map the schema for strongly-typed polling message to a schema file that just stores information.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="a16ad-111">如果您想要在單一的 BizTalk 應用程式中有一個以上的輪詢作業，您必須指定**InboundID**一部分的連線 URI，使其成為唯一的連接屬性。</span><span class="sxs-lookup"><span data-stu-id="a16ad-111">If you want to have more than one polling operation in a single BizTalk application, you must specify an **InboundID** connection property as part of the connection URI to make it unique.</span></span> <span data-ttu-id="a16ad-112">使用唯一連線 URI，您可以建立多個接收輪詢相同的資料庫或甚至是相同的資料表在資料庫中的連接埠。</span><span class="sxs-lookup"><span data-stu-id="a16ad-112">With a unique connection URI, you can create multiple receive ports that poll the same database, or even the same table in a database.</span></span> <span data-ttu-id="a16ad-113">如需詳細資訊，請參閱 <<c0> [ 接收輪詢訊息跨多個接收埠從使用 Biztalk Server 的 SQL](../../adapters-and-accelerators/adapter-sql/receive-polling-messages-across-multiple-receive-ports-from-sql-using-biztalk.md)。</span><span class="sxs-lookup"><span data-stu-id="a16ad-113">For more information, see [Receive Polling Messages Across Multiple Receive Ports from SQL using Biztalk Server](../../adapters-and-accelerators/adapter-sql/receive-polling-messages-across-multiple-receive-ports-from-sql-using-biztalk.md).</span></span>  
  
 <span data-ttu-id="a16ad-114">如需配接器如何支援強型別輪詢的詳細資訊，請參閱[輪詢支援](https://msdn.microsoft.com/library/dd788416.aspx)。</span><span class="sxs-lookup"><span data-stu-id="a16ad-114">For more information about how the adapter supports strongly-typed polling, see [Support for Polling](https://msdn.microsoft.com/library/dd788416.aspx).</span></span> <span data-ttu-id="a16ad-115">如需有關強型別輪詢的訊息結構描述的詳細資訊，請參閱[輪詢和 TypedPolling 作業的訊息結構描述](../../adapters-and-accelerators/adapter-sql/message-schemas-for-the-polling-and-typedpolling-operations.md)。</span><span class="sxs-lookup"><span data-stu-id="a16ad-115">For more information about the message schema for strongly-typed polling, see [Message Schemas for the Polling and TypedPolling Operations](../../adapters-and-accelerators/adapter-sql/message-schemas-for-the-polling-and-typedpolling-operations.md).</span></span>  
  
## <a name="how-this-topic-demonstrates-strongly-typed-polling"></a><span data-ttu-id="a16ad-116">本主題將強型別輪詢的示範</span><span class="sxs-lookup"><span data-stu-id="a16ad-116">How this Topic Demonstrates Strongly-typed Polling</span></span>  
 <span data-ttu-id="a16ad-117">本主題示範如何使用強型別輪詢的輪詢訊息對應到另一個結構描述。</span><span class="sxs-lookup"><span data-stu-id="a16ad-117">This topic demonstrates how to use strongly-typed polling to map the polling message to another schema.</span></span> <span data-ttu-id="a16ad-118">本主題說明如何建立 BizTalk 專案，並產生結構描述**TypedPolling**作業。</span><span class="sxs-lookup"><span data-stu-id="a16ad-118">This topic shows how to create a BizTalk project and generate schema for **TypedPolling** operation.</span></span> <span data-ttu-id="a16ad-119">產生結構描述之前**TypedPolling**作業中，您必須執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="a16ad-119">Before generating schema for **TypedPolling** operation, you must do the following:</span></span>  
  
- <span data-ttu-id="a16ad-120">您必須指定**InboundID**連線 URI 的一部分。</span><span class="sxs-lookup"><span data-stu-id="a16ad-120">You must specify an **InboundID** as part of the connection URI.</span></span>  
  
- <span data-ttu-id="a16ad-121">您必須指定輪詢陳述式**PollingStatement**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="a16ad-121">You must specify a polling statement for the **PollingStatement** binding property.</span></span>  
  
  <span data-ttu-id="a16ad-122">輪詢陳述式的一部分，執行下列作業：</span><span class="sxs-lookup"><span data-stu-id="a16ad-122">As part of the polling statement, perform the following operations:</span></span>  
  
- <span data-ttu-id="a16ad-123">從 [員工] 資料表中選取所有資料列。</span><span class="sxs-lookup"><span data-stu-id="a16ad-123">Select all the rows from the Employee table.</span></span>  
  
- <span data-ttu-id="a16ad-124">執行預存程序 (MOVE_EMP_DATA) 將從 Employee 資料表的所有記錄都移至 EmployeeHistory 資料表。</span><span class="sxs-lookup"><span data-stu-id="a16ad-124">Execute a stored procedure (MOVE_EMP_DATA) to move all the records from the Employee table to an EmployeeHistory table.</span></span>  
  
- <span data-ttu-id="a16ad-125">執行預存程序 (ADD_EMP_DETAILS)，將新記錄新增至 [員工] 資料表。</span><span class="sxs-lookup"><span data-stu-id="a16ad-125">Execute a stored procedure (ADD_EMP_DETAILS) to add a new record to the Employee table.</span></span> <span data-ttu-id="a16ad-126">此程序會接受員工名稱、 指定和薪資做為參數。</span><span class="sxs-lookup"><span data-stu-id="a16ad-126">This procedure takes the employee name, designation, and salary as parameters.</span></span>  
  
  <span data-ttu-id="a16ad-127">若要執行這些作業，您必須指定下列**PollingStatement**繫結屬性：</span><span class="sxs-lookup"><span data-stu-id="a16ad-127">To perform these operations, you must specify the following for the **PollingStatement** binding property:</span></span>  
  
```  
SELECT * FROM Employee;EXEC MOVE_EMP_DATA;EXEC ADD_EMP_DETAILS John, Tester, 100000   
```  
  
 <span data-ttu-id="a16ad-128">因為您產生結構描述**TypedPolling**操作時，結構描述為強型別，包含將輪詢訊息中包含的所有項目。</span><span class="sxs-lookup"><span data-stu-id="a16ad-128">Because you generate schema for the **TypedPolling** operation, the schema is strongly-typed and contains all the elements that will be included in the polling message.</span></span>  
  
 <span data-ttu-id="a16ad-129">相同的 BizTalk 專案的一部分，您可以新增另一個結構描述檔案，例如 EmployeeDetails.xsd。</span><span class="sxs-lookup"><span data-stu-id="a16ad-129">As part of the same BizTalk project, you add another schema file, for example EmployeeDetails.xsd.</span></span> <span data-ttu-id="a16ad-130">EmployeeDetails.xsd 的結構描述如下所示：</span><span class="sxs-lookup"><span data-stu-id="a16ad-130">The schema for EmployeeDetails.xsd resembles the following:</span></span>  
  
```  
<?xml version="1.0" encoding="utf-16" ?>   
<xs:schema xmlns:b="http://schemas.microsoft.com/BizTalk/2003" xmlns="http://Typed_Polling.EmployeeDetails" elementFormDefault="qualified" targetNamespace="http://Typed_Polling.EmployeeDetails" xmlns:xs="http://www.w3.org/2001/XMLSchema">  
  <xs:element name="EmployeeDetails">  
    <xs:complexType>  
      <xs:sequence>  
        <xs:element name="Employee_Info" type="xs:string" />   
        <xs:element name="Employee_Profile" type="xs:string" />   
        <xs:element name="Employee_Performance" type="xs:string" />   
      </xs:sequence>  
    </xs:complexType>  
  </xs:element>  
</xs:schema>  
```  
  
 <span data-ttu-id="a16ad-131">您也會加入至專案，以對應 EmployeeDetails.xsd 結構描述中的項目從 [員工] 資料表 （收到的輪詢訊息） 之項目的的 BizTalk 對應工具。</span><span class="sxs-lookup"><span data-stu-id="a16ad-131">You also add a BizTalk Mapper to the project to map the elements from the Employee table (received as polling message) to the elements in the EmployeeDetails.xsd schema.</span></span> <span data-ttu-id="a16ad-132">隨著對應的詳細資訊，您可以結合一或多個項目從輪詢訊息，並將它對應 EmployeeDetails 結構描述中的單一項目。</span><span class="sxs-lookup"><span data-stu-id="a16ad-132">As part of the map, you combine one or more elements from the polling message and map it to a single element in the EmployeeDetails schema.</span></span> <span data-ttu-id="a16ad-133">您可以使用來進行這**字串串連**運算質。</span><span class="sxs-lookup"><span data-stu-id="a16ad-133">You can do so by using the **String Concatenate** functoid.</span></span>  
  
 <span data-ttu-id="a16ad-134">最後，屬於 BizTalk 專案中，符合 EmployeeDetails.xsd 結構描述檔案拖放至 FILE 傳送埠。</span><span class="sxs-lookup"><span data-stu-id="a16ad-134">Finally, as part of the BizTalk project, a file conforming to the EmployeeDetails.xsd schema is dropped to a FILE send port.</span></span>  
  
## <a name="configure-typed-polling-with-the-sql-adapter-binding-properties"></a><span data-ttu-id="a16ad-135">設定 SQL 配接器繫結屬性的型別的輪詢</span><span class="sxs-lookup"><span data-stu-id="a16ad-135">Configure Typed Polling with the SQL Adapter Binding Properties</span></span>  
 <span data-ttu-id="a16ad-136">下表摘要說明[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]繫結屬性，您用來設定配接器接收資料變更訊息。</span><span class="sxs-lookup"><span data-stu-id="a16ad-136">The following table summarizes the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] binding properties that you use to configure the adapter to receive data-change messages.</span></span> <span data-ttu-id="a16ad-137">以外**PollingStatement**繫結屬性，所有其他繫結屬性列出這一節則需要設定中的接收埠時[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]管理主控台。</span><span class="sxs-lookup"><span data-stu-id="a16ad-137">Other than the **PollingStatement** binding property, all the other binding properties listed in this section are required while configuring the receive port in the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span> <span data-ttu-id="a16ad-138">您必須指定**PollingStatement**才會產生結構描述繫結屬性**TypedPolling**作業。</span><span class="sxs-lookup"><span data-stu-id="a16ad-138">You must specify the **PollingStatement** binding property before generating schema for the **TypedPolling** operation.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a16ad-139">針對具型別輪詢，您必須指定**PollingStatement**飛過產生結構描述時的屬性。</span><span class="sxs-lookup"><span data-stu-id="a16ad-139">For typed polling, you must specify the **PollingStatement** biding property while generating the schema.</span></span> <span data-ttu-id="a16ad-140">您可以選擇指定的其他繫結屬性以及產生結構描述時，即使它們並非必要。</span><span class="sxs-lookup"><span data-stu-id="a16ad-140">You can choose to specify the other binding properties as well while generating the schema, even though they are not mandatory.</span></span> <span data-ttu-id="a16ad-141">如果您指定的繫結屬性，連接埠繫結檔案，[!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)]產生的中繼資料產生的組件也包含您指定的繫結屬性的值。</span><span class="sxs-lookup"><span data-stu-id="a16ad-141">If you do specify the binding properties, the port binding file that the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)] generates as part of the metadata generation also contains the values you specify for the binding properties.</span></span> <span data-ttu-id="a16ad-142">您可以稍後匯入此繫結檔案中的[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]管理主控台來建立 WCF 自訂或 WCF-SQL 與繫結屬性已設定接收埠。</span><span class="sxs-lookup"><span data-stu-id="a16ad-142">You can later import this binding file in the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] Administration console to create the WCF-custom or WCF-SQL receive port with the binding properties already set.</span></span> <span data-ttu-id="a16ad-143">如需建立使用該繫結檔案的連接埠的詳細資訊，請參閱 <<c0> [ 設定要使用 SQL 配接器使用的連接埠繫結檔案的實體連接埠繫結](../../adapters-and-accelerators/adapter-sql/configure-a-physical-port-binding-using-a-port-binding-file-to-sql-adapter.md)。</span><span class="sxs-lookup"><span data-stu-id="a16ad-143">For more information about creating a port using the binding file, see [Configure a physical port binding using a port binding file to use the SQL adapter](../../adapters-and-accelerators/adapter-sql/configure-a-physical-port-binding-using-a-port-binding-file-to-sql-adapter.md).</span></span>  
  
|         <span data-ttu-id="a16ad-144">繫結屬性</span><span class="sxs-lookup"><span data-stu-id="a16ad-144">Binding Property</span></span>         |                                                                                                                                                                                                                                                                                                   <span data-ttu-id="a16ad-145">描述</span><span class="sxs-lookup"><span data-stu-id="a16ad-145">Description</span></span>                                                                                                                                                                                                                                                                                                    |
|----------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|     <span data-ttu-id="a16ad-146">**InboundOperationType**</span><span class="sxs-lookup"><span data-stu-id="a16ad-146">**InboundOperationType**</span></span>     |                                                                                                                                                                                                  <span data-ttu-id="a16ad-147">指定是否要執行**輪詢**， **TypedPolling**，或**通知**輸入作業。</span><span class="sxs-lookup"><span data-stu-id="a16ad-147">Specifies whether you want to perform **Polling**, **TypedPolling**, or **Notification** inbound operation.</span></span> <span data-ttu-id="a16ad-148">預設值是**輪詢**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-148">Default is **Polling**.</span></span> <span data-ttu-id="a16ad-149">若要接收強型別輪詢訊息，將此設**TypedPolling**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-149">To receive strongly-typed polling messages, set this to **TypedPolling**.</span></span>                                                                                                                                                                                                   |
| <span data-ttu-id="a16ad-150">**PolledDataAvailableStatement**</span><span class="sxs-lookup"><span data-stu-id="a16ad-150">**PolledDataAvailableStatement**</span></span> |                                                                                                                                                 <span data-ttu-id="a16ad-151">指定配接器執行，以判斷是否有任何資料可供輪詢 SQL 陳述式。</span><span class="sxs-lookup"><span data-stu-id="a16ad-151">Specifies the SQL statement that the adapter executes to determine whether any data is available for polling.</span></span> <span data-ttu-id="a16ad-152">SQL 陳述式必須傳回的結果集資料列和資料行所組成。</span><span class="sxs-lookup"><span data-stu-id="a16ad-152">The SQL statement must return a result set consisting of rows and columns.</span></span> <span data-ttu-id="a16ad-153">如果可用的資料列，為指定的 SQL 陳述式僅**PollingStatement**屬性繫結將會執行。</span><span class="sxs-lookup"><span data-stu-id="a16ad-153">Only if a row is available, the SQL statement specified for the **PollingStatement** binding property will be executed.</span></span>                                                                                                                                                 |
|   <span data-ttu-id="a16ad-154">**PollingIntervalInSeconds**</span><span class="sxs-lookup"><span data-stu-id="a16ad-154">**PollingIntervalInSeconds**</span></span>   |                                                                                   <span data-ttu-id="a16ad-155">指定間隔 （秒），此時[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]執行陳述式指定**PolledDataAvailableStatement**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="a16ad-155">Specifies the interval, in seconds, at which the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] executes the statement specified for the **PolledDataAvailableStatement** binding property.</span></span> <span data-ttu-id="a16ad-156">預設值是 30 秒。</span><span class="sxs-lookup"><span data-stu-id="a16ad-156">The default is 30 seconds.</span></span> <span data-ttu-id="a16ad-157">輪詢間隔會決定後續輪詢間隔的時間間隔。</span><span class="sxs-lookup"><span data-stu-id="a16ad-157">The polling interval determines the time interval between successive polls.</span></span> <span data-ttu-id="a16ad-158">如果指定的間隔內執行的陳述式，則配接器會等候剩餘的時間間隔中。</span><span class="sxs-lookup"><span data-stu-id="a16ad-158">If the statement is executed within the specified interval, the adapter waits for the remaining time in the interval.</span></span>                                                                                    |
|       <span data-ttu-id="a16ad-159">**PollingStatement**</span><span class="sxs-lookup"><span data-stu-id="a16ad-159">**PollingStatement**</span></span>       | <span data-ttu-id="a16ad-160">指定輪詢 SQL Server 資料庫資料表的 SQL 陳述式。</span><span class="sxs-lookup"><span data-stu-id="a16ad-160">Specifies the SQL statement to poll the SQL Server database table.</span></span> <span data-ttu-id="a16ad-161">您可以指定簡單的 SELECT 陳述式或輪詢陳述式的預存程序。</span><span class="sxs-lookup"><span data-stu-id="a16ad-161">You can specify a simple SELECT statement or a stored procedure for the polling statement.</span></span> <span data-ttu-id="a16ad-162">預設值是 null。</span><span class="sxs-lookup"><span data-stu-id="a16ad-162">The default is null.</span></span> <span data-ttu-id="a16ad-163">您必須指定的值**PollingStatement**啟用輪詢。</span><span class="sxs-lookup"><span data-stu-id="a16ad-163">You must specify a value for **PollingStatement** to enable polling.</span></span> <span data-ttu-id="a16ad-164">輪詢陳述式在沒有可供輪詢，取決於使用的資料時，才會執行**PolledDataAvailableStatement**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="a16ad-164">The polling statement is executed only if there is data available for polling, which is determined by the **PolledDataAvailableStatement** binding property.</span></span> <span data-ttu-id="a16ad-165">您可以指定任意數目的 SQL 陳述式以分號分隔。</span><span class="sxs-lookup"><span data-stu-id="a16ad-165">You can specify any number of SQL statements separated by a semi-colon.</span></span><br /><br /> <span data-ttu-id="a16ad-166">**重要事項︰** For **TypedPolling**，您必須指定這個繫結屬性才能產生中繼資料。</span><span class="sxs-lookup"><span data-stu-id="a16ad-166">**Important:** For **TypedPolling**, you must specify this binding property before generating metadata.</span></span> |
|      <span data-ttu-id="a16ad-167">**PollWhileDataFound**</span><span class="sxs-lookup"><span data-stu-id="a16ad-167">**PollWhileDataFound**</span></span>      |                                                                                      <span data-ttu-id="a16ad-168">指定是否[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]忽略的輪詢間隔，並持續執行 SQL 陳述式指定**PolledDataAvailableStatement**繫結屬性，如果資料可在所輪詢的資料表。</span><span class="sxs-lookup"><span data-stu-id="a16ad-168">Specifies whether the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] ignores the polling interval and continuously executes the SQL statement specified for the **PolledDataAvailableStatement** binding property, if data is available in the table being polled.</span></span> <span data-ttu-id="a16ad-169">如果沒有資料可在資料表中，配接器會還原為執行 SQL 陳述式，在指定的輪詢間隔。</span><span class="sxs-lookup"><span data-stu-id="a16ad-169">If no data is available in the table, the adapter reverts to execute the SQL statement at the specified polling interval.</span></span> <span data-ttu-id="a16ad-170">預設值是**false**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-170">Default is **false**.</span></span>                                                                                       |
  
 <span data-ttu-id="a16ad-171">如需這些屬性的更完整說明，請參閱[了解 BizTalk Adapter for SQL Server 配接器繫結屬性](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="a16ad-171">For a more complete description of these properties, see [Read about the BizTalk Adapter for SQL Server adapter Binding Properties](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span></span> <span data-ttu-id="a16ad-172">如需完整的說明，如何使用[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]輪詢 SQL Server，可深入閱讀。</span><span class="sxs-lookup"><span data-stu-id="a16ad-172">For a complete description of how to use the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] to poll SQL Server, read further.</span></span>  
  
## <a name="how-to-receive-strongly-typed-data-change-messages-from-the-sql-server-database"></a><span data-ttu-id="a16ad-173">如何接收從 SQL Server 資料庫的強型別資料變更訊息</span><span class="sxs-lookup"><span data-stu-id="a16ad-173">How to Receive Strongly-typed Data-change Messages from the SQL Server Database</span></span>  
 <span data-ttu-id="a16ad-174">執行 SQL Server 資料庫使用運算[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]具有[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]牽涉到程序中所述的工作[開發使用 SQL 配接器的 BizTalk 應用程式的建置組塊](../../adapters-and-accelerators/adapter-sql/building-blocks-to-develop-biztalk-applications-with-the-sql-adapter.md)。</span><span class="sxs-lookup"><span data-stu-id="a16ad-174">Performing an operation on the SQL Server database using [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] with [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] involves the procedural tasks described in [Building blocks to develop BizTalk applications with the SQL adapter](../../adapters-and-accelerators/adapter-sql/building-blocks-to-develop-biztalk-applications-with-the-sql-adapter.md).</span></span> <span data-ttu-id="a16ad-175">若要設定要接收的強型別資料變更訊息的介面卡，這些工作如下：</span><span class="sxs-lookup"><span data-stu-id="a16ad-175">To configure the adapter to receive strongly-typed data-change messages, these tasks are:</span></span>  
  
1. <span data-ttu-id="a16ad-176">建立 BizTalk 專案，然後再產生結構描述**TypedPolling**作業。</span><span class="sxs-lookup"><span data-stu-id="a16ad-176">Create a BizTalk project, and then generate schema for the **TypedPolling** operation.</span></span> <span data-ttu-id="a16ad-177">您必須指定**InboundID**連接屬性和**PollingStatement**時產生結構描述繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="a16ad-177">You must specify the **InboundID** connection property and the **PollingStatement** binding property while generating schema.</span></span> <span data-ttu-id="a16ad-178">例如，連接 URI，連同指定的輸入識別碼，如下所示：</span><span class="sxs-lookup"><span data-stu-id="a16ad-178">For example, a connection URI with the inbound ID specified resembles the following:</span></span>  
  
   ```  
   mssql://mysqlserver//mysqldatabase?InboundID=mydatabaseId  
   ```  
  
2. <span data-ttu-id="a16ad-179">從 SQL Server 資料庫接收訊息的 BizTalk 專案中建立訊息。</span><span class="sxs-lookup"><span data-stu-id="a16ad-179">Create a message in the BizTalk project for receiving messages from the SQL Server database.</span></span>  
  
3. <span data-ttu-id="a16ad-180">建立協調流程接收的 SQL Server 資料庫中的訊息，並將它們儲存到資料夾。</span><span class="sxs-lookup"><span data-stu-id="a16ad-180">Create an orchestration to receive messages from the SQL Server database and to save them to a folder.</span></span>  
  
4. <span data-ttu-id="a16ad-181">新增結構描述，例如 EmployeeDetails.xsd BizTalk 專案中。</span><span class="sxs-lookup"><span data-stu-id="a16ad-181">Add a schema, for example, EmployeeDetails.xsd, in the BizTalk project.</span></span>  
  
5. <span data-ttu-id="a16ad-182">新增對應至 EmployeeDetails.xsd 結構描述的輪詢訊息的結構描述的 BizTalk 對應工具 」。</span><span class="sxs-lookup"><span data-stu-id="a16ad-182">Add a BizTalk Mapper to map the schema for the polling message to EmployeeDetails.xsd schema.</span></span>  
  
6. <span data-ttu-id="a16ad-183">建置和部署 BizTalk 專案。</span><span class="sxs-lookup"><span data-stu-id="a16ad-183">Build and deploy the BizTalk project.</span></span>  
  
7. <span data-ttu-id="a16ad-184">設定的 BizTalk 應用程式藉由建立實體傳送和接收埠。</span><span class="sxs-lookup"><span data-stu-id="a16ad-184">Configure the BizTalk application by creating physical send and receive ports.</span></span>  
  
   > [!IMPORTANT]
   >  <span data-ttu-id="a16ad-185">輸入的輪詢案例一律必須設定單向的 WCF 自訂或 WCF SQL 接收埠。</span><span class="sxs-lookup"><span data-stu-id="a16ad-185">For inbound polling scenarios you must always configure a one-way WCF-Custom or WCF-SQL receive port.</span></span> <span data-ttu-id="a16ad-186">雙向 WCF 自訂] 或 [WCF-SQL 接收埠不支援的輸入作業。</span><span class="sxs-lookup"><span data-stu-id="a16ad-186">Two-way WCF-Custom or WCF-SQL receive ports are not supported for inbound operations.</span></span>  
  
8. <span data-ttu-id="a16ad-187">啟動 BizTalk 應用程式。</span><span class="sxs-lookup"><span data-stu-id="a16ad-187">Start the BizTalk application.</span></span>  
  
   <span data-ttu-id="a16ad-188">本主題提供執行這些工作的指示。</span><span class="sxs-lookup"><span data-stu-id="a16ad-188">This topic provides instructions to perform these tasks.</span></span>  
  
## <a name="sample-based-on-this-topic"></a><span data-ttu-id="a16ad-189">根據本主題的範例</span><span class="sxs-lookup"><span data-stu-id="a16ad-189">Sample Based on This Topic</span></span>  
 <span data-ttu-id="a16ad-190">，TypedPolling，根據本主題提供了範例[!INCLUDE[adapterpacknoversion](../../includes/adapterpacknoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="a16ad-190">A sample, TypedPolling, based on this topic is provided with the [!INCLUDE[adapterpacknoversion](../../includes/adapterpacknoversion-md.md)].</span></span> <span data-ttu-id="a16ad-191">如需詳細資訊，請參閱 < [SQL 配接器的範例](../../adapters-and-accelerators/adapter-sql/samples-for-the-sql-adapter.md)。</span><span class="sxs-lookup"><span data-stu-id="a16ad-191">For more information, see [Samples for the SQL adapter](../../adapters-and-accelerators/adapter-sql/samples-for-the-sql-adapter.md).</span></span>  
  
## <a name="generate-schema"></a><span data-ttu-id="a16ad-192">產生結構描述</span><span class="sxs-lookup"><span data-stu-id="a16ad-192">Generate Schema</span></span>  
 <span data-ttu-id="a16ad-193">您必須產生的結構描述**TypedPolling**作業。</span><span class="sxs-lookup"><span data-stu-id="a16ad-193">You must generate the schema for the **TypedPolling** operation.</span></span> <span data-ttu-id="a16ad-194">請參閱[擷取使用 SQL 配接器的 Visual Studio 中的 SQL Server 作業的中繼資料](../../adapters-and-accelerators/adapter-sql/get-metadata-for-sql-server-operations-in-visual-studio-using-the-sql-adapter.md)如需有關如何產生結構描述。</span><span class="sxs-lookup"><span data-stu-id="a16ad-194">See [Retrieving Metadata for SQL Server Operations in Visual Studio using the SQL adapter](../../adapters-and-accelerators/adapter-sql/get-metadata-for-sql-server-operations-in-visual-studio-using-the-sql-adapter.md) for more information about how to generate the schema.</span></span> <span data-ttu-id="a16ad-195">產生結構描述時，請執行下列工作。</span><span class="sxs-lookup"><span data-stu-id="a16ad-195">Perform the following tasks when generating the schema.</span></span>  
  
1.  <span data-ttu-id="a16ad-196">指定**InboundID**時指定連線 URI 的連接屬性。</span><span class="sxs-lookup"><span data-stu-id="a16ad-196">Specify the **InboundID** connection property while specifying the connection URI.</span></span> <span data-ttu-id="a16ad-197">本主題中，您可以指定**InboundID**作為**員工**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-197">For this topic, you can specify the **InboundID** as **Employee**.</span></span> <span data-ttu-id="a16ad-198">如需連線 URI 的詳細資訊，請參閱[建立 SQL Server 連接 URI](../../adapters-and-accelerators/adapter-sql/create-the-sql-server-connection-uri.md)。</span><span class="sxs-lookup"><span data-stu-id="a16ad-198">For more information about the connection URI, see [Create the SQL Server Connection URI](../../adapters-and-accelerators/adapter-sql/create-the-sql-server-connection-uri.md).</span></span>  
  
2.  <span data-ttu-id="a16ad-199">指定的值**PollingStatement**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="a16ad-199">Specify a value for the **PollingStatement** binding property.</span></span> <span data-ttu-id="a16ad-200">如需有關這個繫結屬性的詳細資訊，請參閱[了解 BizTalk Adapter for SQL Server 配接器繫結屬性](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="a16ad-200">For more information about this binding property, see [Read about the BizTalk Adapter for SQL Server adapter Binding Properties](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span></span>  
  
     <span data-ttu-id="a16ad-201">如需有關如何指定繫結屬性的指示，請參閱 <<c0> [ 設定 SQL 配接器的繫結屬性](../../adapters-and-accelerators/adapter-sql/configure-the-binding-properties-for-the-sql-adapter.md)。</span><span class="sxs-lookup"><span data-stu-id="a16ad-201">For instructions on how to specify binding properties, see [Configure the binding properties for the SQL adapter](../../adapters-and-accelerators/adapter-sql/configure-the-binding-properties-for-the-sql-adapter.md).</span></span>  
  
3.  <span data-ttu-id="a16ad-202">選取合約類型作為**服務 （輸入作業）**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-202">Select the contract type as **Service (Inbound operation)**.</span></span>  
  
4.  <span data-ttu-id="a16ad-203">產生結構描述**TypedPolling**作業。</span><span class="sxs-lookup"><span data-stu-id="a16ad-203">Generate schema for the **TypedPolling** operation.</span></span>  
  
## <a name="define-messages-and-message-types"></a><span data-ttu-id="a16ad-204">定義訊息和訊息類型</span><span class="sxs-lookup"><span data-stu-id="a16ad-204">Define Messages and Message Types</span></span>  
 <span data-ttu-id="a16ad-205">您稍早產生的結構描述會描述協調流程中的訊息所需的 「 類型 」。</span><span class="sxs-lookup"><span data-stu-id="a16ad-205">The schema that you generated earlier describes the "types" required for the messages in the orchestration.</span></span> <span data-ttu-id="a16ad-206">訊息通常是一個變數，要為其類型會定義對應的結構。</span><span class="sxs-lookup"><span data-stu-id="a16ad-206">A message is typically a variable, the type for which is defined by the corresponding schema.</span></span> <span data-ttu-id="a16ad-207">一旦產生結構描述時，您必須訊息從 BizTalk 專案的協調流程檢視以將它的連結。</span><span class="sxs-lookup"><span data-stu-id="a16ad-207">Once the schema is generated, you must link it to the messages from the Orchestration view of the BizTalk project.</span></span>  
  
 <span data-ttu-id="a16ad-208">本主題中，您必須建立一則訊息來接收 SQL Server 資料庫中的訊息。</span><span class="sxs-lookup"><span data-stu-id="a16ad-208">For this topic, you must create one message to receive messages from the SQL Server database.</span></span>  
  
 <span data-ttu-id="a16ad-209">執行下列步驟來建立訊息，並將它們連結至結構描述。</span><span class="sxs-lookup"><span data-stu-id="a16ad-209">Perform the following steps to create messages and link them to schema.</span></span>  
  
#### <a name="create-messages-and-link-to-schema"></a><span data-ttu-id="a16ad-210">建立訊息，並連結至結構描述</span><span class="sxs-lookup"><span data-stu-id="a16ad-210">Create messages and link to schema</span></span>  
  
1.  <span data-ttu-id="a16ad-211">BizTalk 專案中新增協調流程。</span><span class="sxs-lookup"><span data-stu-id="a16ad-211">Add an orchestration to the BizTalk project.</span></span> <span data-ttu-id="a16ad-212">從 [方案總管] 中，以滑鼠右鍵按一下 BizTalk 專案名稱，指向**新增**，然後按一下**新項目**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-212">From the Solution Explorer, right-click the BizTalk project name, point to **Add**, and then click **New Item**.</span></span> <span data-ttu-id="a16ad-213">輸入 BizTalk 協調流程的名稱，然後按一下**新增**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-213">Type a name for the BizTalk orchestration and then click **Add**.</span></span>  
  
2.  <span data-ttu-id="a16ad-214">如果它尚未開啟，請開啟 BizTalk 專案中，[協調流程檢視] 視窗。</span><span class="sxs-lookup"><span data-stu-id="a16ad-214">Open the orchestration view window of the BizTalk project, if it is not already open.</span></span> <span data-ttu-id="a16ad-215">按一下 **檢視**，指向**其他 Windows**，然後按一下**協調流程檢視**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-215">Click **View**, point to **Other Windows**, and then click **Orchestration View**.</span></span>  
  
3.  <span data-ttu-id="a16ad-216">在 **協調流程檢視**，以滑鼠右鍵按一下**訊息**，然後按一下**新訊息**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-216">In the **Orchestration View**, right-click **Messages**, and then click **New Message**.</span></span>  
  
4.  <span data-ttu-id="a16ad-217">以滑鼠右鍵按一下新建立的訊息，然後按**屬性 視窗**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-217">Right-click the newly created message, and then select **Properties Window**.</span></span>  
  
5.  <span data-ttu-id="a16ad-218">在 [**屬性**] 窗格**Message_1**，執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="a16ad-218">In the **Properties** pane for **Message_1**, do the following:</span></span>  
  
    |<span data-ttu-id="a16ad-219">使用</span><span class="sxs-lookup"><span data-stu-id="a16ad-219">Use this</span></span>|<span data-ttu-id="a16ad-220">以進行此動作</span><span class="sxs-lookup"><span data-stu-id="a16ad-220">To do this</span></span>|  
    |--------------|----------------|  
    |<span data-ttu-id="a16ad-221">識別碼</span><span class="sxs-lookup"><span data-stu-id="a16ad-221">Identifier</span></span>|<span data-ttu-id="a16ad-222">型別**PollingMessage**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-222">Type **PollingMessage**.</span></span>|  
    |<span data-ttu-id="a16ad-223">訊息類型</span><span class="sxs-lookup"><span data-stu-id="a16ad-223">Message Type</span></span>|<span data-ttu-id="a16ad-224">從下拉式清單中，依序展開**結構描述**，然後選取*Typed_Polling.TypedPolling_Employee.TypedPolling*，其中*Typed_Polling*是 BizTalk 的名稱專案。</span><span class="sxs-lookup"><span data-stu-id="a16ad-224">From the drop-down list, expand **Schemas**, and select *Typed_Polling.TypedPolling_Employee.TypedPolling*, where *Typed_Polling* is the name of your BizTalk project.</span></span> <span data-ttu-id="a16ad-225">*TypedPolling_Employee*是針對產生的結構描述**TypedPolling**作業。</span><span class="sxs-lookup"><span data-stu-id="a16ad-225">*TypedPolling_Employee* is the schema generated for the **TypedPolling** operation.</span></span>|  
  
## <a name="set-up-the-orchestration"></a><span data-ttu-id="a16ad-226">設定協調流程</span><span class="sxs-lookup"><span data-stu-id="a16ad-226">Set up the Orchestration</span></span>  
 <span data-ttu-id="a16ad-227">您必須建立 BizTalk 協調流程使用[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]接收以輪詢為基礎的資料變更訊息從 SQL Server 資料庫。</span><span class="sxs-lookup"><span data-stu-id="a16ad-227">You must create a BizTalk orchestration to use [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] for receiving polling-based data-change messages from the SQL Server database.</span></span> <span data-ttu-id="a16ad-228">在此協調流程中，配接器接收的輪詢訊息指定的輪詢陳述式。</span><span class="sxs-lookup"><span data-stu-id="a16ad-228">In this orchestration, the adapter receives the polling message for the specified polling statement.</span></span> <span data-ttu-id="a16ad-229">BizTalk 對應工具則會對應至 EmployeeDetails.xsd 結構描述的輪詢訊息結構描述。</span><span class="sxs-lookup"><span data-stu-id="a16ad-229">The BizTalk Mapper then maps the polling message schema to the EmployeeDetails.xsd schema.</span></span> <span data-ttu-id="a16ad-230">對應的訊息然後儲存至檔案位置。</span><span class="sxs-lookup"><span data-stu-id="a16ad-230">The mapped message is then saved to a FILE location.</span></span> <span data-ttu-id="a16ad-231">典型的協調流程用於接收從 SQL Server 資料庫的強型別輪詢訊息會包含：</span><span class="sxs-lookup"><span data-stu-id="a16ad-231">A typical orchestration for receiving strongly-typed polling message from a SQL Server database would contain:</span></span>  
  
- <span data-ttu-id="a16ad-232">接收和傳送圖形，從 SQL Server 接收訊息，並分別將傳送至檔案連接埠。</span><span class="sxs-lookup"><span data-stu-id="a16ad-232">Receive and Send shapes to receive messages from SQL Server and send to a FILE port, respectively.</span></span>  
  
- <span data-ttu-id="a16ad-233">單向接收埠以接收來自 SQL Server 的訊息。</span><span class="sxs-lookup"><span data-stu-id="a16ad-233">A one-way receive port to receive messages from SQL Server.</span></span>  
  
  > [!IMPORTANT]
  >  <span data-ttu-id="a16ad-234">輸入的輪詢案例，您必須一律設定為單向接收埠。</span><span class="sxs-lookup"><span data-stu-id="a16ad-234">For inbound polling scenarios you must always configure a one-way receive port.</span></span> <span data-ttu-id="a16ad-235">雙向接收埠不支援的輸入作業。</span><span class="sxs-lookup"><span data-stu-id="a16ad-235">Two-way receive ports are not supported for inbound operations.</span></span>  
  
- <span data-ttu-id="a16ad-236">單向傳送埠以將輪詢回應從 SQL Server 資料庫傳送到資料夾。</span><span class="sxs-lookup"><span data-stu-id="a16ad-236">A one-way send port to send polling responses from a SQL Server database to a folder.</span></span>  
  
- <span data-ttu-id="a16ad-237">輪詢訊息的結構描述對應到任何其他的結構描述的 BizTalk 對應工具 」。</span><span class="sxs-lookup"><span data-stu-id="a16ad-237">A BizTalk Mapper to map the schema of the polling message to any other schema.</span></span>  
  
  <span data-ttu-id="a16ad-238">範例協調流程如下所示。</span><span class="sxs-lookup"><span data-stu-id="a16ad-238">A sample orchestration resembles the following.</span></span>  
  
  <span data-ttu-id="a16ad-239">![協調流程的強式&#45;型別輪詢](../../adapters-and-accelerators/adapter-sql/media/1db03859-b7f8-470c-9158-2be4da0b45ae.gif "1db03859-b7f8-470c-9158-2be4da0b45ae")</span><span class="sxs-lookup"><span data-stu-id="a16ad-239">![Orchestration for strongly&#45;typed polling](../../adapters-and-accelerators/adapter-sql/media/1db03859-b7f8-470c-9158-2be4da0b45ae.gif "1db03859-b7f8-470c-9158-2be4da0b45ae")</span></span>  
  
### <a name="add-message-shapes"></a><span data-ttu-id="a16ad-240">新增訊息圖形</span><span class="sxs-lookup"><span data-stu-id="a16ad-240">Add Message Shapes</span></span>  
 <span data-ttu-id="a16ad-241">請確定您針對每個訊息 圖形中指定下列屬性。</span><span class="sxs-lookup"><span data-stu-id="a16ad-241">Make sure you specify the following properties for each of the message shapes.</span></span> <span data-ttu-id="a16ad-242">剛剛提到的協調流程中所示，圖形資料行中所列的名稱會是訊息 圖形的名稱。</span><span class="sxs-lookup"><span data-stu-id="a16ad-242">The names listed in the Shape column are the names of the message shapes as displayed in the just-mentioned orchestration.</span></span>  
  
|<span data-ttu-id="a16ad-243">形狀圖</span><span class="sxs-lookup"><span data-stu-id="a16ad-243">Shape</span></span>|<span data-ttu-id="a16ad-244">圖形類型</span><span class="sxs-lookup"><span data-stu-id="a16ad-244">Shape Type</span></span>|<span data-ttu-id="a16ad-245">屬性</span><span class="sxs-lookup"><span data-stu-id="a16ad-245">Properties</span></span>|  
|-----------|----------------|----------------|  
|<span data-ttu-id="a16ad-246">ReceiveMessage</span><span class="sxs-lookup"><span data-stu-id="a16ad-246">ReceiveMessage</span></span>|<span data-ttu-id="a16ad-247">Receive</span><span class="sxs-lookup"><span data-stu-id="a16ad-247">Receive</span></span>|<span data-ttu-id="a16ad-248">-設定**名稱**到*ReceiveMessage*</span><span class="sxs-lookup"><span data-stu-id="a16ad-248">- Set **Name** to *ReceiveMessage*</span></span><br /><br /> <span data-ttu-id="a16ad-249">-設定**啟用**到 *，則為 True*</span><span class="sxs-lookup"><span data-stu-id="a16ad-249">- Set **Activate** to *True*</span></span>|  
|<span data-ttu-id="a16ad-250">SaveMessage</span><span class="sxs-lookup"><span data-stu-id="a16ad-250">SaveMessage</span></span>|<span data-ttu-id="a16ad-251">Send</span><span class="sxs-lookup"><span data-stu-id="a16ad-251">Send</span></span>|<span data-ttu-id="a16ad-252">輪詢間隔後，執行配接器再次**PolledDataAvailableStatement**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-252">- Set **Name** to *SaveMessage*</span></span>|  
  
### <a name="add-ports"></a><span data-ttu-id="a16ad-253">新增連接埠</span><span class="sxs-lookup"><span data-stu-id="a16ad-253">Add Ports</span></span>  
 <span data-ttu-id="a16ad-254">請確定您針對每個邏輯連接埠中指定下列屬性。</span><span class="sxs-lookup"><span data-stu-id="a16ad-254">Make sure you specify the following properties for each of the logical ports.</span></span> <span data-ttu-id="a16ad-255">協調流程中所示，連接埠資料行中所列的名稱會是連接埠的名稱。</span><span class="sxs-lookup"><span data-stu-id="a16ad-255">The names listed in the Port column are the names of the ports as displayed in the orchestration.</span></span>  
  
|<span data-ttu-id="a16ad-256">通訊埠</span><span class="sxs-lookup"><span data-stu-id="a16ad-256">Port</span></span>|<span data-ttu-id="a16ad-257">屬性</span><span class="sxs-lookup"><span data-stu-id="a16ad-257">Properties</span></span>|  
|----------|----------------|  
|<span data-ttu-id="a16ad-258">SQLReceivePort</span><span class="sxs-lookup"><span data-stu-id="a16ad-258">SQLReceivePort</span></span>|<span data-ttu-id="a16ad-259">-設定**識別碼**到*SQLReceivePort*</span><span class="sxs-lookup"><span data-stu-id="a16ad-259">- Set **Identifier** to *SQLReceivePort*</span></span><br /><br /> <span data-ttu-id="a16ad-260">-設定**型別**到*SQLReceivePortType*</span><span class="sxs-lookup"><span data-stu-id="a16ad-260">- Set **Type** to *SQLReceivePortType*</span></span><br /><br /> <span data-ttu-id="a16ad-261">-設定**通訊模式**到*單向*</span><span class="sxs-lookup"><span data-stu-id="a16ad-261">- Set **Communication Pattern** to *One-Way*</span></span><br /><br /> <span data-ttu-id="a16ad-262">-設定**通訊方向**到*接收*</span><span class="sxs-lookup"><span data-stu-id="a16ad-262">- Set **Communication Direction** to *Receive*</span></span>|  
|<span data-ttu-id="a16ad-263">SaveMessagePort</span><span class="sxs-lookup"><span data-stu-id="a16ad-263">SaveMessagePort</span></span>|<span data-ttu-id="a16ad-264">-設定**識別碼**到*SaveMessagePort*</span><span class="sxs-lookup"><span data-stu-id="a16ad-264">- Set **Identifier** to *SaveMessagePort*</span></span><br /><br /> <span data-ttu-id="a16ad-265">-設定**型別**到*SaveMessagePortType*</span><span class="sxs-lookup"><span data-stu-id="a16ad-265">- Set **Type** to *SaveMessagePortType*</span></span><br /><br /> <span data-ttu-id="a16ad-266">-設定**通訊模式**到*單向*</span><span class="sxs-lookup"><span data-stu-id="a16ad-266">- Set **Communication Pattern** to *One-Way*</span></span><br /><br /> <span data-ttu-id="a16ad-267">-設定**通訊方向**到*傳送*</span><span class="sxs-lookup"><span data-stu-id="a16ad-267">- Set **Communication Direction** to *Send*</span></span>|  
  
### <a name="enter-messages-for-action-shapes-and-connect-to-ports"></a><span data-ttu-id="a16ad-268">輸入動作圖形訊息並連接到連接埠</span><span class="sxs-lookup"><span data-stu-id="a16ad-268">Enter Messages for Action Shapes and Connect to Ports</span></span>  
 <span data-ttu-id="a16ad-269">下表指定的屬性和屬性來指定動作圖形的訊息，以及連結至連接埠的訊息，您應該設定的值。</span><span class="sxs-lookup"><span data-stu-id="a16ad-269">The following table specifies the properties and their values that you should set to specify messages for action shapes and to link the messages to the ports.</span></span> <span data-ttu-id="a16ad-270">先前所述的協調流程中所示，圖形資料行中所列的名稱會是訊息 圖形的名稱。</span><span class="sxs-lookup"><span data-stu-id="a16ad-270">The names listed in the Shape column are the names of the message shapes as displayed in the orchestration mentioned earlier.</span></span>  
  
|<span data-ttu-id="a16ad-271">形狀圖</span><span class="sxs-lookup"><span data-stu-id="a16ad-271">Shape</span></span>|<span data-ttu-id="a16ad-272">屬性</span><span class="sxs-lookup"><span data-stu-id="a16ad-272">Properties</span></span>|  
|-----------|----------------|  
|<span data-ttu-id="a16ad-273">ReceiveMessage</span><span class="sxs-lookup"><span data-stu-id="a16ad-273">ReceiveMessage</span></span>|<span data-ttu-id="a16ad-274">設定**訊息**到*PollingMessage*</span><span class="sxs-lookup"><span data-stu-id="a16ad-274">Set **Message** to *PollingMessage*</span></span><br /><br /> <span data-ttu-id="a16ad-275">設定**作業**到*SQLReceivePort.TypedPolling.Request*</span><span class="sxs-lookup"><span data-stu-id="a16ad-275">Set **Operation** to *SQLReceivePort.TypedPolling.Request*</span></span>|  
|<span data-ttu-id="a16ad-276">SaveMessage</span><span class="sxs-lookup"><span data-stu-id="a16ad-276">SaveMessage</span></span>|<span data-ttu-id="a16ad-277">設定**訊息**到*PollingMessage*</span><span class="sxs-lookup"><span data-stu-id="a16ad-277">Set **Message** to *PollingMessage*</span></span><br /><br /> <span data-ttu-id="a16ad-278">設定**作業**到*SaveMessagePort.TypedPolling.Request*</span><span class="sxs-lookup"><span data-stu-id="a16ad-278">Set **Operation** to *SaveMessagePort.TypedPolling.Request*</span></span>|  
  
 <span data-ttu-id="a16ad-279">您已指定這些屬性之後，會連接的訊息 圖形和連接埠。</span><span class="sxs-lookup"><span data-stu-id="a16ad-279">After you have specified these properties, the message shapes and ports are connected.</span></span>  
  
### <a name="add-a-biztalk-mapper"></a><span data-ttu-id="a16ad-280">新增 BizTalk 對應工具</span><span class="sxs-lookup"><span data-stu-id="a16ad-280">Add a BizTalk Mapper</span></span>  
 <span data-ttu-id="a16ad-281">您必須將 BizTalk 對應工具加入至輪詢訊息結構描述對應至 EmployeeDetails.xsd 結構描述的協調流程。</span><span class="sxs-lookup"><span data-stu-id="a16ad-281">You must add a BizTalk Mapper to the orchestration to map the polling message schema to the EmployeeDetails.xsd schema.</span></span> <span data-ttu-id="a16ad-282">在 [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]管理主控台中，您將使用此對應工具將輪詢訊息的結構描述對應至 EmployeeDetails.xsd 結構描述。</span><span class="sxs-lookup"><span data-stu-id="a16ad-282">In the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] Administration console, you will use this Mapper to map the schema for the polling message to the EmployeeDetails.xsd schema.</span></span>  
  

1. <span data-ttu-id="a16ad-283">將 BizTalk 對應工具加入至 BizTalk 專案中。</span><span class="sxs-lookup"><span data-stu-id="a16ad-283">Add a BizTalk Mapper to the BizTalk project.</span></span> <span data-ttu-id="a16ad-284">以滑鼠右鍵按一下 BizTalk 專案，指向**新增**，然後按一下**新項目**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-284">Right-click the BizTalk project, point to **Add**, and click **New Item**.</span></span>  
  
    <span data-ttu-id="a16ad-285">在 **加入新項目**對話方塊中，從左窗格中，選取**對應檔**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-285">In the **Add New Item** dialog box, from the left pane, select **Map Files**.</span></span> <span data-ttu-id="a16ad-286">從右窗格中，選取**地圖**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-286">From the right pane, select **Map**.</span></span> <span data-ttu-id="a16ad-287">指定對應名稱，例如`MapSchema.btm`。</span><span class="sxs-lookup"><span data-stu-id="a16ad-287">Specify a name for the map, such as `MapSchema.btm`.</span></span> <span data-ttu-id="a16ad-288">按一下 **[加入]**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-288">Click **Add**.</span></span>  
  
2. <span data-ttu-id="a16ad-289">從來源結構描述 窗格中，按一下**開啟來源結構描述**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-289">From the Source Schema pane, click **Open Source Schema**.</span></span>  
  
3. <span data-ttu-id="a16ad-290">在  **BizTalk 型別選擇器**對話方塊方塊中，展開 專案名稱，展開**結構描述**，，然後選取 輪詢訊息的結構描述。</span><span class="sxs-lookup"><span data-stu-id="a16ad-290">In the **BizTalk Type Picker** dialog box, expand the project name, expand **Schemas**, and select the schema for the polling message.</span></span> <span data-ttu-id="a16ad-291">本主題中，選取 [Typed_Polling.TypedPolling_Employee]。</span><span class="sxs-lookup"><span data-stu-id="a16ad-291">For this topic, select Typed_Polling.TypedPolling_Employee.</span></span> <span data-ttu-id="a16ad-292">按一下 [確定] 。</span><span class="sxs-lookup"><span data-stu-id="a16ad-292">Click **OK**.</span></span>  
  
4. <span data-ttu-id="a16ad-293">在 **來源結構描述的根節點** 對話方塊中，選取 TypedPolling 然後按一下 **確定**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-293">In the **Root Node for Source Schema** dialog box, select TypedPolling and click **OK**.</span></span>  
  
5. <span data-ttu-id="a16ad-294">從目的結構描述 窗格中，按一下**開啟目的結構描述**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-294">From the Destination Schema pane, click **Open Destination Schema**.</span></span>  
  
6. <span data-ttu-id="a16ad-295">在  **BizTalk 型別選擇器**對話方塊方塊中，展開 專案名稱，依序展開**結構描述**，和選取的結構描述的 EmployeeDetails。</span><span class="sxs-lookup"><span data-stu-id="a16ad-295">In the **BizTalk Type Picker** dialog box, expand the project name, expand **Schemas**, and select the schema for EmployeeDetails.</span></span> <span data-ttu-id="a16ad-296">本主題中，選取 [Typed_Polling.EmployeeDetails]。</span><span class="sxs-lookup"><span data-stu-id="a16ad-296">For this topic, select Typed_Polling.EmployeeDetails.</span></span> <span data-ttu-id="a16ad-297">按一下 [確定] 。</span><span class="sxs-lookup"><span data-stu-id="a16ad-297">Click **OK**.</span></span>  
  
7. <span data-ttu-id="a16ad-298">在輪詢訊息的來源結構描述中，展開 TypedPollingResultSet0 節點和後續的節點，以查看會輪詢訊息中傳回的項目。</span><span class="sxs-lookup"><span data-stu-id="a16ad-298">In the source schema of polling message, expand the TypedPollingResultSet0 node and the subsequent nodes to see the elements that are returned in the polling message.</span></span> <span data-ttu-id="a16ad-299">在目的結構描述中，展開 EmployeeDetails 節點以查看結構描述中的不同項目。</span><span class="sxs-lookup"><span data-stu-id="a16ad-299">In the destination schema, expand the EmployeeDetails node to see the different elements in the schema.</span></span> <span data-ttu-id="a16ad-300">本主題中，您必須將對應的結構描述的方式，：</span><span class="sxs-lookup"><span data-stu-id="a16ad-300">For this topic, you must map the schemas in such a way that:</span></span>  
  
   - <span data-ttu-id="a16ad-301">**Employee_ID**並**名稱**來源中結構描述必須對應至**Employee_Info**目的結構描述中。</span><span class="sxs-lookup"><span data-stu-id="a16ad-301">**Employee_ID** and **Name** in the source schema must map to **Employee_Info** in the destination schema.</span></span>  
  
   - <span data-ttu-id="a16ad-302">**指定**並**Job_Description**來源中結構描述必須對應至**Employee_Profile**目的結構描述中。</span><span class="sxs-lookup"><span data-stu-id="a16ad-302">**Designation** and **Job_Description** in the source schema must map to **Employee_Profile** in the destination schema.</span></span>  
  
   - <span data-ttu-id="a16ad-303">**評等**並**薪資**來源中結構描述必須對應至**Employee_Performance**目的結構描述中。</span><span class="sxs-lookup"><span data-stu-id="a16ad-303">**Rating** and **Salary** in the source schema must map to **Employee_Performance** in the destination schema.</span></span>  
  
     <span data-ttu-id="a16ad-304">若要合併來源結構描述中的多個節點，並將它們對應至目的結構描述中的單一節點，您必須使用**字串串連運算質**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-304">To combine more than one node in source schema and map them to a single node in the destination schema, you must use the **String Concatenate functoid**.</span></span> <span data-ttu-id="a16ad-305">詳細資料[!INCLUDE[ui-guidance-developers-reference](../../includes/ui-guidance-developers-reference.md)]。</span><span class="sxs-lookup"><span data-stu-id="a16ad-305">Details [!INCLUDE[ui-guidance-developers-reference](../../includes/ui-guidance-developers-reference.md)].</span></span>
  
8. <span data-ttu-id="a16ad-306">若要使用 「 字串串連 」 運算質：</span><span class="sxs-lookup"><span data-stu-id="a16ad-306">To use the String Concatenate functoid:</span></span>  
  
   1.  <span data-ttu-id="a16ad-307">從**工具箱**，拖曳**字串串連**運算質放在對應工具格線。</span><span class="sxs-lookup"><span data-stu-id="a16ad-307">From the **Toolbox**, drag the **String Concatenate** functoid and drop it on the Mapper grid.</span></span>  
  
   2.  <span data-ttu-id="a16ad-308">連接**Employee_ID**並**名稱**運算質將來源結構描述中的項目。</span><span class="sxs-lookup"><span data-stu-id="a16ad-308">Connect the **Employee_ID** and **Name** elements in the source schema to the functoid.</span></span>  
  
   3.  <span data-ttu-id="a16ad-309">連接到運算質**Employee_Info**目的結構描述中的項目。</span><span class="sxs-lookup"><span data-stu-id="a16ad-309">Connect the functoid to the **Employee_Info** element in the destination schema.</span></span>  
  
   4.  <span data-ttu-id="a16ad-310">重複上述步驟，針對您想要對應的所有項目。</span><span class="sxs-lookup"><span data-stu-id="a16ad-310">Repeat these steps for all the elements that you want to map.</span></span> <span data-ttu-id="a16ad-311">已完成的對應會如下所示：</span><span class="sxs-lookup"><span data-stu-id="a16ad-311">A finished map will resemble the following:</span></span>  
  
        <span data-ttu-id="a16ad-312">![將強型別輪詢結構描述對應](../../adapters-and-accelerators/adapter-sql/media/0a4a2608-3b84-4bac-9a16-512cf42c7525.gif "0a4a2608-3b84-4bac-9a16-512cf42c7525")</span><span class="sxs-lookup"><span data-stu-id="a16ad-312">![Map the strongly-typed polling schema](../../adapters-and-accelerators/adapter-sql/media/0a4a2608-3b84-4bac-9a16-512cf42c7525.gif "0a4a2608-3b84-4bac-9a16-512cf42c7525")</span></span>  
  
   5.  <span data-ttu-id="a16ad-313">儲存對應。</span><span class="sxs-lookup"><span data-stu-id="a16ad-313">Save the map.</span></span>  
  
   <span data-ttu-id="a16ad-314">在您建立 「 對應工具 」 之後，協調流程已完成。</span><span class="sxs-lookup"><span data-stu-id="a16ad-314">The orchestration is complete after you create the Mapper.</span></span> <span data-ttu-id="a16ad-315">您現在必須建置 BizTalk 方案，並將其部署至[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="a16ad-315">You must now build the BizTalk solution and deploy it to a [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="a16ad-316">如需詳細資訊，請參閱 <<c0> [ 建置和執行協調流程](../../core/building-and-running-orchestrations.md)。</span><span class="sxs-lookup"><span data-stu-id="a16ad-316">For more information, see [Building and Running Orchestrations](../../core/building-and-running-orchestrations.md).</span></span>
  
## <a name="configure-the-biztalk-application"></a><span data-ttu-id="a16ad-317">設定 BizTalk 應用程式</span><span class="sxs-lookup"><span data-stu-id="a16ad-317">Configure the BizTalk Application</span></span>  
 <span data-ttu-id="a16ad-318">您已部署的 BizTalk 專案之後，您稍早建立的協調流程會列在下**協調流程**在 BizTalk Server 管理主控台 窗格。</span><span class="sxs-lookup"><span data-stu-id="a16ad-318">After you have deployed the BizTalk project, the orchestration you created earlier is listed under the **Orchestrations** pane in the BizTalk Server Administration console.</span></span> <span data-ttu-id="a16ad-319">您必須使用 BizTalk Server 管理主控台來設定應用程式。</span><span class="sxs-lookup"><span data-stu-id="a16ad-319">You must use the BizTalk Server Administration console to configure the application.</span></span> <span data-ttu-id="a16ad-320">如需逐步解說，請參閱 <<c0> [ 逐步解說： 部署基本 BizTalk 應用程式](Walkthrough:%20Deploying%20a%20Basic%20BizTalk%20Application.md)。</span><span class="sxs-lookup"><span data-stu-id="a16ad-320">For a walkthrough, see [Walkthrough: Deploying a Basic BizTalk Application](Walkthrough:%20Deploying%20a%20Basic%20BizTalk%20Application.md).</span></span>
  
 <span data-ttu-id="a16ad-321">設定應用程式包含：</span><span class="sxs-lookup"><span data-stu-id="a16ad-321">Configuring an application involves:</span></span>  
  
- <span data-ttu-id="a16ad-322">選取應用程式主機。</span><span class="sxs-lookup"><span data-stu-id="a16ad-322">Selecting a host for the application.</span></span>  
  
- <span data-ttu-id="a16ad-323">對應您在您在 BizTalk Server 管理主控台中的實體連接埠的協調流程中建立的連接埠。</span><span class="sxs-lookup"><span data-stu-id="a16ad-323">Mapping the ports that you created in your orchestration to physical ports in the BizTalk Server Administration console.</span></span> <span data-ttu-id="a16ad-324">此協調流程中，您必須：</span><span class="sxs-lookup"><span data-stu-id="a16ad-324">For this orchestration you must:</span></span>  
  
  - <span data-ttu-id="a16ad-325">不過，因為現在具有狀態為 0，則需要不有任何記錄，所以配接器會取得空的回應，如下列所示。</span><span class="sxs-lookup"><span data-stu-id="a16ad-325">Define a physical WCF-Custom or WCF-SQL one-way receive port.</span></span> <span data-ttu-id="a16ad-326">此連接埠會輪詢 SQL Server 資料庫，以您指定連接埠輪詢陳述式。</span><span class="sxs-lookup"><span data-stu-id="a16ad-326">This port polls the SQL Server database with the polling statement you specify for the port.</span></span> <span data-ttu-id="a16ad-327">如需有關如何建立連接埠的資訊，請參閱 <<c0> [ 手動設定 SQL 配接器的實體連接埠繫結](../../adapters-and-accelerators/adapter-sql/manually-configure-a-physical-port-binding-to-the-sql-adapter.md)。</span><span class="sxs-lookup"><span data-stu-id="a16ad-327">For information about how to create ports, see [Manually configure a physical port binding to the SQL adapter](../../adapters-and-accelerators/adapter-sql/manually-configure-a-physical-port-binding-to-the-sql-adapter.md).</span></span> <span data-ttu-id="a16ad-328">請確定指定接收埠的下列繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="a16ad-328">Make sure you specify the following binding properties for the receive port.</span></span>  
  
    > [!IMPORTANT]
    >  <span data-ttu-id="a16ad-329">請確定您指定**InboundID**連線 URI 的一部分。</span><span class="sxs-lookup"><span data-stu-id="a16ad-329">Make sure you specify the **InboundID** as part of the connection URI.</span></span> <span data-ttu-id="a16ad-330">輸入的識別碼必須是您指定在產生結構描述時相同。</span><span class="sxs-lookup"><span data-stu-id="a16ad-330">The inbound ID must be the same you specified while generating the schema.</span></span>  
    > 
    > [!IMPORTANT]
    >  <span data-ttu-id="a16ad-331">您不需要執行此步驟中，如果您指定在設計階段的繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="a16ad-331">You do not need to perform this step if you specified the binding properties at design-time.</span></span> <span data-ttu-id="a16ad-332">在此情況下，您可以建立 wcf-custom 或 WCF SQL 接收埠中，設定必要的繫結屬性，藉由匯入所建立的繫結檔[!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="a16ad-332">In such a case, you can create a WCF-custom or WCF-SQL receive port, with the required binding properties set, by importing the binding file created by the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span></span> <span data-ttu-id="a16ad-333">如需詳細資訊，請參閱[設定要使用 SQL 配接器使用的連接埠繫結檔案的實體連接埠繫結](../../adapters-and-accelerators/adapter-sql/configure-a-physical-port-binding-using-a-port-binding-file-to-sql-adapter.md)。</span><span class="sxs-lookup"><span data-stu-id="a16ad-333">For more information see [Configure a physical port binding using a port binding file to use the SQL adapter](../../adapters-and-accelerators/adapter-sql/configure-a-physical-port-binding-using-a-port-binding-file-to-sql-adapter.md).</span></span>  
  
    |<span data-ttu-id="a16ad-334">繫結屬性</span><span class="sxs-lookup"><span data-stu-id="a16ad-334">Binding Property</span></span>|<span data-ttu-id="a16ad-335">ReplTest1</span><span class="sxs-lookup"><span data-stu-id="a16ad-335">Value</span></span>|  
    |----------------------|-----------|  
    |<span data-ttu-id="a16ad-336">**InboundOperationType**</span><span class="sxs-lookup"><span data-stu-id="a16ad-336">**InboundOperationType**</span></span>|<span data-ttu-id="a16ad-337">請確定您將此設**TypedPolling**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-337">Make sure you set this to **TypedPolling**.</span></span>|  
    |<span data-ttu-id="a16ad-338">**PolledDataAvailableStatement**</span><span class="sxs-lookup"><span data-stu-id="a16ad-338">**PolledDataAvailableStatement**</span></span>|<span data-ttu-id="a16ad-339">請確定您指定時產生的結構描述，也就是指定相同的 SQL 陳述式：</span><span class="sxs-lookup"><span data-stu-id="a16ad-339">Make sure you specify the same SQL statement you specified while generating the schema, which is:</span></span><br /><br /> `SELECT COUNT(*) FROM Employee`|  
    |<span data-ttu-id="a16ad-340">**PollingStatement**</span><span class="sxs-lookup"><span data-stu-id="a16ad-340">**PollingStatement**</span></span>|<span data-ttu-id="a16ad-341">請確定您提供相同的輪詢陳述式時產生的結構描述，也就是您指定：</span><span class="sxs-lookup"><span data-stu-id="a16ad-341">Make sure you provide the same polling statement you specified while generating the schema, which is:</span></span><br /><br /> `SELECT * FROM Employee;EXEC MOVE_EMP_DATA;EXEC ADD_EMP_DETAILS John, Tester, 100000`|  
  
     <span data-ttu-id="a16ad-342">如需不同的繫結屬性的詳細資訊，請參閱[了解 BizTalk Adapter for SQL Server 配接器繫結屬性](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="a16ad-342">For more information about the different binding properties, see [Read about the BizTalk Adapter for SQL Server adapter Binding Properties](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="a16ad-343">我們建議您執行使用的輸入的操作時設定的交易隔離等級和交易等待時間[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="a16ad-343">We recommend configuring the transaction isolation level and the transaction timeout while performing inbound operations using the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)].</span></span> <span data-ttu-id="a16ad-344">您可以執行加上服務行為設定 Wcf-custom 或 WCF-SQL 時接收埠。</span><span class="sxs-lookup"><span data-stu-id="a16ad-344">You can do so by adding the service behavior while configuring the WCF-Custom or WCF-SQL receive port.</span></span> <span data-ttu-id="a16ad-345">如需有關如何新增服務行為的指示，請參閱[設定交易隔離等級和交易等待時間，使用 SQL](../../adapters-and-accelerators/adapter-sql/configure-transaction-isolation-level-and-transaction-timeout-with-sql.md)。</span><span class="sxs-lookup"><span data-stu-id="a16ad-345">For instruction on how to add the service behavior, see [Configure Transaction Isolation Level and Transaction Timeout with SQL](../../adapters-and-accelerators/adapter-sql/configure-transaction-isolation-level-and-transaction-timeout-with-sql.md).</span></span>  
  
  - <span data-ttu-id="a16ad-346">定義配接器將會卸除訊息的 FILE 傳送埠。</span><span class="sxs-lookup"><span data-stu-id="a16ad-346">Define a FILE send port where the adapter will drop the message.</span></span> <span data-ttu-id="a16ad-347">此傳送埠也會使用協調流程，將輪詢訊息對應至訊息符合 EmployeeDetails.xsd 結構描述中建立的對應。</span><span class="sxs-lookup"><span data-stu-id="a16ad-347">This send port will also use the map you created in the orchestration to map the polling message to a message conforming to the EmployeeDetails.xsd schema.</span></span> <span data-ttu-id="a16ad-348">執行下列步驟，以設定 FILE 傳送埠，以使用對應。</span><span class="sxs-lookup"><span data-stu-id="a16ad-348">Perform the following steps to configure the FILE send port to use the map.</span></span>  
  
    1.  <span data-ttu-id="a16ad-349">建立 FILE 傳送埠。</span><span class="sxs-lookup"><span data-stu-id="a16ad-349">Create a FILE send port.</span></span>  
  
    2.  <span data-ttu-id="a16ad-350">從傳送埠的 [屬性] 對話方塊的左窗格中，按一下**輸出對應**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-350">From the left pane of the send port properties dialog box, click **Outbound Maps**.</span></span> <span data-ttu-id="a16ad-351">從右窗格中，按一下 下的欄位**地圖**資料行，然後從下拉式清單中選取**MapSchema**。</span><span class="sxs-lookup"><span data-stu-id="a16ad-351">From the right pane, click the field under the **Map** column, and from the drop-down select **MapSchema**.</span></span> <span data-ttu-id="a16ad-352">按一下 [確定] 。</span><span class="sxs-lookup"><span data-stu-id="a16ad-352">Click **OK**.</span></span>  
  
         <span data-ttu-id="a16ad-353">![FILE 傳送埠上設定輸出對應](../../adapters-and-accelerators/adapter-sql/media/831c9aee-fd97-466f-9270-3b04dbccd9fe.gif "831c9aee-fd97-466f-9270-3b04dbccd9fe")</span><span class="sxs-lookup"><span data-stu-id="a16ad-353">![Configure outbound map on the FILE send port](../../adapters-and-accelerators/adapter-sql/media/831c9aee-fd97-466f-9270-3b04dbccd9fe.gif "831c9aee-fd97-466f-9270-3b04dbccd9fe")</span></span>  
  
## <a name="start-the-application"></a><span data-ttu-id="a16ad-354">啟動應用程式</span><span class="sxs-lookup"><span data-stu-id="a16ad-354">Start the Application</span></span>  
 <span data-ttu-id="a16ad-355">您必須啟動 SQL Server 資料庫中接收訊息的 BizTalk 應用程式。</span><span class="sxs-lookup"><span data-stu-id="a16ad-355">You must start the BizTalk application for receiving messages from the SQL Server database.</span></span> <span data-ttu-id="a16ad-356">如需有關啟動 BizTalk 應用程式的指示，請參閱[如何啟動協調流程](../../core/how-to-start-an-orchestration.md)。</span><span class="sxs-lookup"><span data-stu-id="a16ad-356">For instructions on starting a BizTalk application, see [How to Start an Orchestration](../../core/how-to-start-an-orchestration.md).</span></span>
  
 <span data-ttu-id="a16ad-357">在這個階段，請確定：</span><span class="sxs-lookup"><span data-stu-id="a16ad-357">At this stage, make sure:</span></span>  
  
-   <span data-ttu-id="a16ad-358">Wcf-custom 或 WCF-SQL 單向接收連接埠，就會使用指定的陳述式的 SQL Server 資料庫來輪詢**PollingStatement**繫結屬性，正在執行。</span><span class="sxs-lookup"><span data-stu-id="a16ad-358">The WCF-Custom or WCF-SQL one-way receive port, which polls the SQL Server database using the statements specified for the **PollingStatement** binding property, is running.</span></span>  
  
-   <span data-ttu-id="a16ad-359">FILE 傳送埠，這會對應至 EmployeeDetails 結構描述的輪詢訊息，正在執行。</span><span class="sxs-lookup"><span data-stu-id="a16ad-359">The FILE send port, which will map the polling message to the EmployeeDetails schema, is running.</span></span>  
  
-   <span data-ttu-id="a16ad-360">BizTalk 協調流程的作業正在執行。</span><span class="sxs-lookup"><span data-stu-id="a16ad-360">The BizTalk orchestration for the operation is running.</span></span>  
  
## <a name="execute-the-operation"></a><span data-ttu-id="a16ad-361">執行作業</span><span class="sxs-lookup"><span data-stu-id="a16ad-361">Execute the Operation</span></span>  
 <span data-ttu-id="a16ad-362">執行應用程式之後，下列的一組動作進行，相同的順序：</span><span class="sxs-lookup"><span data-stu-id="a16ad-362">After you run the application, the following set of actions take place, in the same sequence:</span></span>  
  
- <span data-ttu-id="a16ad-363">執行配接器**PolledDataAvailableStatement** employee 資料表，並判斷資料表是否有記錄進行輪詢。</span><span class="sxs-lookup"><span data-stu-id="a16ad-363">The adapter executes the **PolledDataAvailableStatement** on the Employee table and determines that the table has records for polling.</span></span>  
  
- <span data-ttu-id="a16ad-364">配接器執行輪詢陳述式。</span><span class="sxs-lookup"><span data-stu-id="a16ad-364">The adapter executes the polling statement.</span></span> <span data-ttu-id="a16ad-365">輪詢陳述式是由 SELECT 陳述式和預存程序所組成，因為配接器會執行所有陳述式一個接著一個。</span><span class="sxs-lookup"><span data-stu-id="a16ad-365">Because the polling statement consists of a SELECT statement and stored procedures, the adapter will execute all the statements one after the other.</span></span>  
  
  - <span data-ttu-id="a16ad-366">配接器會先執行 SELECT 陳述式會傳回 Employee 資料表中的所有記錄。</span><span class="sxs-lookup"><span data-stu-id="a16ad-366">The adapter first executes the SELECT statement that returns all the records in the Employee table.</span></span>  
  
  - <span data-ttu-id="a16ad-367">然後執行 MOVE_EMP_DATA 預存程序從 Employee 資料表的所有資料移動至 EmployeeHistory 資料表配接器。</span><span class="sxs-lookup"><span data-stu-id="a16ad-367">The adapter then executes the MOVE_EMP_DATA stored procedure that moves all data from the Employee table to the EmployeeHistory table.</span></span> <span data-ttu-id="a16ad-368">這個預存程序不會傳回任何值。</span><span class="sxs-lookup"><span data-stu-id="a16ad-368">This stored procedure does not return any value.</span></span>  
  
  - <span data-ttu-id="a16ad-369">配接器接著就執行 ADD_EMP_DETAILS 預存程序，將 [員工] 資料表中的一筆記錄。</span><span class="sxs-lookup"><span data-stu-id="a16ad-369">The adapter then executes the ADD_EMP_DETAILS stored procedure that adds one record to the Employee table.</span></span> <span data-ttu-id="a16ad-370">這個預存程序傳回的員工識別碼插入之資料錄。</span><span class="sxs-lookup"><span data-stu-id="a16ad-370">This stored procedure returns the Employee ID for the inserted record.</span></span>  
  
    <span data-ttu-id="a16ad-371">執行輪詢陳述式，並接收訊息之後，輪詢訊息取得傳送至 FILE 傳送埠。</span><span class="sxs-lookup"><span data-stu-id="a16ad-371">After the polling statement is executed and the message is received, the polling message gets send to the FILE send port.</span></span> <span data-ttu-id="a16ad-372">這裡，輸出對應 (**MapSchema**) 設定的傳送埠地圖 EmployeeDetails 結構描述的輪詢訊息，並會捨棄訊息至檔案位置。</span><span class="sxs-lookup"><span data-stu-id="a16ad-372">Here, the outbound map (**MapSchema**)configured on the send port maps the polling message to the EmployeeDetails schema and drops the message to a file location.</span></span> <span data-ttu-id="a16ad-373">訊息如下所示：</span><span class="sxs-lookup"><span data-stu-id="a16ad-373">The message resembles the following:</span></span>  
  
  ```  
  <?xml version="1.0" encoding="utf-8" ?>   
  <EmployeeDetails xmlns="http://Typed_Polling.EmployeeDetails">  
    <Employee_Info>10751John</Employee_Info>   
    <Employee_Profile>TesterManagesTesting</Employee_Profile>   
    <Employee_Performance>100000</EmployeePerformance>  
  </EmployeeDetails>  
  ```  
  
   <span data-ttu-id="a16ad-374">在上述的回應中，您可以注意到 Employee_Info 項目包含員工識別碼 (10751) 和員工的姓名 （名字） 的組合。</span><span class="sxs-lookup"><span data-stu-id="a16ad-374">In the preceding response, you can notice that the Employee_Info element contains a combination of employee ID (10751) and employee name (John).</span></span> <span data-ttu-id="a16ad-375">其他項目也會包含對應的協調流程所建立的對應工具中的組合。</span><span class="sxs-lookup"><span data-stu-id="a16ad-375">The other elements also contain combinations as mapped in the Mapper you created as part of the orchestration.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a16ad-376">[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]將繼續輪詢，直到您明確停用接收埠從[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]管理主控台。</span><span class="sxs-lookup"><span data-stu-id="a16ad-376">The [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] will continue to poll until you explicitly disable the receive port from the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span>  
  
## <a name="best-practices"></a><span data-ttu-id="a16ad-377">最佳作法</span><span class="sxs-lookup"><span data-stu-id="a16ad-377">Best Practices</span></span>  
 <span data-ttu-id="a16ad-378">您部署和設定 BizTalk 專案之後，您可以匯出至 XML 檔案，稱為繫結檔案的組態設定。</span><span class="sxs-lookup"><span data-stu-id="a16ad-378">After you have deployed and configured the BizTalk project, you can export configuration settings to an XML file called the binding file.</span></span> <span data-ttu-id="a16ad-379">一旦您產生繫結檔案時，您可以匯入的組態設定檔案，，讓您不需要建立傳送埠和接收相同的協調流程的連接埠。</span><span class="sxs-lookup"><span data-stu-id="a16ad-379">Once you generate a binding file, you can import the configuration settings from the file, so that you do not need to create the send ports and receive ports for the same orchestration.</span></span> <span data-ttu-id="a16ad-380">如需有關繫結檔案的詳細資訊，請參閱 <<c0> [ 重複使用配接器繫結](../../adapters-and-accelerators/adapter-sql/reuse-sql-adapter-bindings.md)。</span><span class="sxs-lookup"><span data-stu-id="a16ad-380">For more information about binding files, see [Reuse adapter bindings](../../adapters-and-accelerators/adapter-sql/reuse-sql-adapter-bindings.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="a16ad-381">另請參閱</span><span class="sxs-lookup"><span data-stu-id="a16ad-381">See Also</span></span>  
 [<span data-ttu-id="a16ad-382">使用 SQL 配接器與 BizTalk Server 輪詢 SQL Server</span><span class="sxs-lookup"><span data-stu-id="a16ad-382">Poll SQL Server by Using the SQL Adapter with BizTalk Server</span></span>](../../adapters-and-accelerators/adapter-sql/poll-sql-server-using-the-sql-adapter-with-biztalk-server.md)