---
title: 接收使用 FOR XML 子句中使用 BizTalk Server 的 SQL SELECT 陳述式的輪詢訊息 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 65c629c1-9ef7-4aa1-8ec1-f94a3cb41cb0
caps.latest.revision: 13
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 967279b93be393d38d220d487e383beb73d91b4a
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "37014127"
---
# <a name="receive-polling-messages-using-select-statements-with-for-xml-clause-from-sql-using-biztalk-server"></a><span data-ttu-id="5b4cf-102">接收輪詢訊息使用 FOR XML 子句中使用 BizTalk Server 的 SQL SELECT 陳述式</span><span class="sxs-lookup"><span data-stu-id="5b4cf-102">Receive polling messages using SELECT statements with FOR XML Clause from SQL using BizTalk Server</span></span>
<span data-ttu-id="5b4cf-103">您可以設定[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]使用 SELECT 陳述式或包含 FOR XML 子句的預存程序接收 SQL Server 資料表或檢視表的定期的資料變更訊息。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-103">You can configure the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] to receive periodic data-change messages for SQL Server tables or views by using SELECT statements or stored procedures that include a FOR XML clause.</span></span> <span data-ttu-id="5b4cf-104">您可以指定這些陳述式，以輪詢資料庫執行的配接器的輪詢陳述式。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-104">You can specify these statements as polling statement that the adapter executes to poll the database.</span></span> <span data-ttu-id="5b4cf-105">輪詢陳述式可以是 SELECT 陳述式或預存程序會傳回結果集。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-105">The polling statement can be a SELECT statement or a stored procedure that returns a result set.</span></span>  
  
 <span data-ttu-id="5b4cf-106">如需有關配接器如何支援輪詢的詳細資訊，請參閱[輪詢支援](https://msdn.microsoft.com/library/dd788416.aspx)。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-106">For more information on how the adapter supports polling, see [Support for Polling](https://msdn.microsoft.com/library/dd788416.aspx).</span></span> <span data-ttu-id="5b4cf-107">輪詢作業的 SOAP 訊息結構的相關資訊，請參閱[輪詢和 TypedPolling 作業的訊息結構描述](../../adapters-and-accelerators/adapter-sql/message-schemas-for-the-polling-and-typedpolling-operations.md)。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-107">For information about the structure of the SOAP message for polling operations, see [Message Schemas for the Polling and TypedPolling Operations](../../adapters-and-accelerators/adapter-sql/message-schemas-for-the-polling-and-typedpolling-operations.md).</span></span> <span data-ttu-id="5b4cf-108">SQL [FOR XML 子句](https://docs.microsoft.com/sql/relational-databases/xml/for-xml-sql-server)提供更多詳細資料。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-108">The SQL [FOR XML clause](https://docs.microsoft.com/sql/relational-databases/xml/for-xml-sql-server) provides more details.</span></span>
  
> [!NOTE]
>  <span data-ttu-id="5b4cf-109">本主題示範如何使用**XmlPolling**輸入作業來接收輪詢訊息。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-109">This topic demonstrates how to use the **XmlPolling** inbound operation to receive polling messages.</span></span> <span data-ttu-id="5b4cf-110">**XmlPolling**作業可用於輪詢 SQL Server 資料庫使用 SELECT 陳述式或包含 FOR XML 子句的預存程序。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-110">The **XmlPolling** operation is used to poll a SQL Server database using SELECT statements or stored procedures that include a FOR XML clause.</span></span> <span data-ttu-id="5b4cf-111">訊息**XmlPolling**作業包含在 SQL Server Management Studio 中執行 SELECT 陳述式或預存程序收到的 xml 訊息。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-111">The message for the **XmlPolling** operation includes the xml message received by executing the SELECT statement or the stored procedure in SQL Server Management Studio.</span></span>  
> 
>  <span data-ttu-id="5b4cf-112">您也可以使用配接器接收不同類型的輪詢訊息。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-112">You can also use the adapter to receive different types of polling messages.</span></span>  
> 
> - <span data-ttu-id="5b4cf-113">如果您想要取得弱型別輪詢訊息時，您必須使用輪詢作業。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-113">If you want to get a weakly-typed polling message, you must use the Polling Operation.</span></span> <span data-ttu-id="5b4cf-114">如需詳細資訊，請參閱 <<c0> [ 從 SQL Server 所使用的 BizTalk Server 接收輪詢為基礎的資料變更訊息](../../adapters-and-accelerators/adapter-sql/receive-polling-based-data-changed-messages-from-sql-server-using-biztalk.md)。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-114">For more information, see [Receive Polling-based Data-changed Messages from SQL Server by Using BizTalk Server](../../adapters-and-accelerators/adapter-sql/receive-polling-based-data-changed-messages-from-sql-server-using-biztalk.md).</span></span>  
>   -   <span data-ttu-id="5b4cf-115">如果您想要取得強型別輪詢訊息時，您必須使用**TypedPolling**作業。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-115">If you want to get strongly-typed polling message, you must use the **TypedPolling** operation.</span></span> <span data-ttu-id="5b4cf-116">您也必須使用**TypedPolling**單一的 BizTalk 應用程式中有多個輪詢作業的作業。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-116">You must also use the **TypedPolling** operation to have multiple polling operations in a single BizTalk application.</span></span> <span data-ttu-id="5b4cf-117">如需有關如何執行**TypedPolling**作業，請參閱[接收強型別輪詢為基礎的資料變更訊息使用 BizTalk Server 從 SQL Server](../../adapters-and-accelerators/adapter-sql/receive-strongly-typed-polling-based-data-changed-messages-from-sql-in-biztalk.md)。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-117">For instructions on how to perform **TypedPolling** operation, see [Receive Strongly-typed Polling-based Data-changed Messages from SQL Server using BizTalk Server](../../adapters-and-accelerators/adapter-sql/receive-strongly-typed-polling-based-data-changed-messages-from-sql-in-biztalk.md).</span></span>  
> 
> [!IMPORTANT]
>  <span data-ttu-id="5b4cf-118">如果您想要在單一的 BizTalk 應用程式中有一個以上的輪詢作業，您必須指定**InboundID**一部分的連線 URI，使其成為唯一的連接屬性。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-118">If you want to have more than one polling operation in a single BizTalk application, you must specify an **InboundID** connection property as part of the connection URI to make it unique.</span></span> <span data-ttu-id="5b4cf-119">使用唯一連線 URI，您可以建立多個接收輪詢相同的資料庫或甚至是相同的資料表在資料庫中的連接埠。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-119">With a unique connection URI, you can create multiple receive ports that poll the same database, or even the same table in a database.</span></span> <span data-ttu-id="5b4cf-120">如需詳細資訊，請參閱 <<c0> [ 接收輪詢訊息跨多個接收埠從使用 BizTalk Server 的 SQL](../../adapters-and-accelerators/adapter-sql/receive-polling-messages-across-multiple-receive-ports-from-sql-using-biztalk.md)。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-120">For more information, see [Receive Polling Messages Across Multiple Receive Ports from SQL using BizTalk Server](../../adapters-and-accelerators/adapter-sql/receive-polling-messages-across-multiple-receive-ports-from-sql-using-biztalk.md).</span></span>  
  
## <a name="how-this-topic-demonstrates-polling"></a><span data-ttu-id="5b4cf-121">本主題將輪詢的示範</span><span class="sxs-lookup"><span data-stu-id="5b4cf-121">How This Topic Demonstrates Polling</span></span>  
 <span data-ttu-id="5b4cf-122">本主題中，以示範如何[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]支援接收資料變更訊息，我們使用 FOR XML 子句使用 SELECT 陳述式來輪詢 SQL Server 資料庫。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-122">In this topic, to demonstrate how the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] supports receiving data change messages, we use a SELECT statement with the FOR XML clause to poll the SQL Server database.</span></span> <span data-ttu-id="5b4cf-123">當您叫用 SQL Server Management Studio 中的這類的陳述式時，輸出會是 xml 訊息的格式。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-123">When you invoke such a statement in SQL Server Management Studio, the output is in the form of an xml message.</span></span> <span data-ttu-id="5b4cf-124">若要使用這類陳述式來輪詢 SQL Server 資料庫，您必須回應 xml 訊息結構描述。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-124">To use such statements to poll a SQL Server database, you must have the schema of the response xml message.</span></span> <span data-ttu-id="5b4cf-125">[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]需要此結構描述，來執行 FOR XML 子句的 SELECT 陳述式之後接收輪詢訊息。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-125">The [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] requires this schema to receive a polling message after executing a SELECT statement with the FOR XML clause.</span></span> <span data-ttu-id="5b4cf-126">因此，若要使用 FOR XML 子句的 SELECT 陳述式來輪詢 SQL Server 資料庫，您必須執行下列一組工作。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-126">So, to use a SELECT statement with FOR XML clause to poll the SQL Server database, you must perform the following set of tasks.</span></span>  
  
1.  <span data-ttu-id="5b4cf-127">產生含有 FOR XML 子句的 SELECT 陳述式的 XML 回應訊息的結構描述。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-127">Generate the schema for the XML response message for the SELECT statement with FOR XML clause.</span></span>  
  
2.  <span data-ttu-id="5b4cf-128">建立 BizTalk 專案，並將產生的結構描述加入至專案。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-128">Create a BizTalk project and add the generated schema to the project.</span></span>  
  
3.  <span data-ttu-id="5b4cf-129">建立接收 SQL Server 資料庫中的 XML 回應訊息的 BizTalk 專案中的訊息。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-129">Create a message in the BizTalk project for receiving XML response messages from the SQL Server database.</span></span>  
  
4.  <span data-ttu-id="5b4cf-130">建立協調流程接收的 SQL Server 資料庫中的訊息，並將它們儲存到資料夾。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-130">Create an orchestration to receive messages from the SQL Server database and to save them to a folder.</span></span>  
  
5.  <span data-ttu-id="5b4cf-131">建置和部署 BizTalk 專案。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-131">Build and deploy the BizTalk project.</span></span>  
  
6.  <span data-ttu-id="5b4cf-132">設定的 BizTalk 應用程式藉由建立實體傳送和接收埠。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-132">Configure the BizTalk application by creating physical send and receive ports.</span></span>  
  
    > [!IMPORTANT]
    >  <span data-ttu-id="5b4cf-133">輸入的輪詢案例一律必須設定單向的 WCF 自訂或 WCF SQL 接收埠。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-133">For inbound polling scenarios you must always configure a one-way WCF-Custom or WCF-SQL receive port.</span></span> <span data-ttu-id="5b4cf-134">雙向 WCF 自訂] 或 [WCF-SQL 接收埠不支援的輸入作業。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-134">Two-way WCF-Custom or WCF-SQL receive ports are not supported for inbound operations.</span></span>  
  
7.  <span data-ttu-id="5b4cf-135">啟動 BizTalk 應用程式。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-135">Start the BizTalk application.</span></span>  
  
##  <a name="BKMK_RespSchema"></a> <span data-ttu-id="5b4cf-136">產生回應訊息的結構描述的 SELECT 陳述式</span><span class="sxs-lookup"><span data-stu-id="5b4cf-136">Generating Schema for the Response Message for SELECT Statement</span></span>  
 <span data-ttu-id="5b4cf-137">您可以產生 SELECT 陳述式的回應訊息的結構描述包括`xmlschema`子句搭配`for xml`子句。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-137">You can generate the schema for the response message for the SELECT statement by including the `xmlschema` clause with the `for xml` clause.</span></span> <span data-ttu-id="5b4cf-138">在本主題中，我們可以使用 SELECT 陳述式擷取特定的員工識別碼的員工詳細資料</span><span class="sxs-lookup"><span data-stu-id="5b4cf-138">In this topic, we use a SELECT statement to retrieve employee details for a given employee ID.</span></span> <span data-ttu-id="5b4cf-139">若要擷取之結構描述執行 SELECT 陳述式，SELECT 陳述式必須以下列方式撰寫：</span><span class="sxs-lookup"><span data-stu-id="5b4cf-139">To retrieve the schema by executing a SELECT statement, the SELECT statement must be written in the following manner:</span></span>  
  
```  
SELECT Employee_ID ,Name ,Designation FROM Employee for xml auto, xmlschema  
```  
  
 <span data-ttu-id="5b4cf-140">執行這個 SELECT 陳述式來取得回應訊息的結構描述。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-140">Execute this SELECT statement to get the schema for the response message.</span></span> <span data-ttu-id="5b4cf-141">儲存結構描述。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-141">Save the schema.</span></span> <span data-ttu-id="5b4cf-142">您現在必須建立 BizTalk 專案中的[!INCLUDE[btsVStudioNoVersion](../../includes/btsvstudionoversion-md.md)]並將此結構描述新增至專案。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-142">You must now create a BizTalk project in [!INCLUDE[btsVStudioNoVersion](../../includes/btsvstudionoversion-md.md)] and add this schema to the project.</span></span> <span data-ttu-id="5b4cf-143">此範例中，針對中，您可以命名為此結構描述**PollingResponse.xsd**。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-143">For this example, you can name this schema as **PollingResponse.xsd**.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="5b4cf-144">請確定您移除`xmlschema`子句之後，您已執行 SELECT 陳述式來產生結構描述。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-144">Make sure you remove the `xmlschema` clause after you have executed the SELECT statement to generate the schema.</span></span> <span data-ttu-id="5b4cf-145">如果您無法這樣做，請在最後執行的 SELECT 陳述式透過 BizTalk XmlPolling 作業的一部分時，您將回應訊息中，重新產生結構描述。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-145">If you fail to do this, when you finally execute the SELECT statement through BizTalk as part of the XmlPolling operation, you will again generate the schema in the response message.</span></span> <span data-ttu-id="5b4cf-146">因此，若要取得回應訊息為 xml，您必須先移除`xmlschema`子句。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-146">So, to get the response message as xml you must remove the `xmlschema` clause.</span></span>  
  
#### <a name="to-add-the-schema-to-a-biztalk-project"></a><span data-ttu-id="5b4cf-147">若要將結構描述加入 BizTalk 專案</span><span class="sxs-lookup"><span data-stu-id="5b4cf-147">To add the schema to a BizTalk project</span></span>  
  
1. <span data-ttu-id="5b4cf-148">建立 BizTalk 專案中的[!INCLUDE[btsVStudioNoVersion](../../includes/btsvstudionoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-148">Create a BizTalk project in [!INCLUDE[btsVStudioNoVersion](../../includes/btsvstudionoversion-md.md)].</span></span>  
  
2. <span data-ttu-id="5b4cf-149">新增您的 BizTalk 專案的預存程序所產生的回應結構描述。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-149">Add the response schema you generated for the stored procedure to the BizTalk project.</span></span> <span data-ttu-id="5b4cf-150">以滑鼠右鍵按一下 [方案總管] 中的 BizTalk 專案，指向**新增**，然後按一下**現有項目**。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-150">Right-click the BizTalk project in the Solution Explorer, point to **Add**, and then click **Existing Item**.</span></span> <span data-ttu-id="5b4cf-151">在 [加入現有項目] 對話方塊中，瀏覽至您儲存的結構描述和按一下的位置**新增**。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-151">In the Add Existing Item dialog box, navigate to the location where you saved the schema and click **Add**.</span></span>  
  
3. <span data-ttu-id="5b4cf-152">開啟中的結構描述[!INCLUDE[btsVStudioNoVersion](../../includes/btsvstudionoversion-md.md)]並進行下列變更。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-152">Open the schema in [!INCLUDE[btsVStudioNoVersion](../../includes/btsvstudionoversion-md.md)] and make the following changes.</span></span>  
  
   1.  <span data-ttu-id="5b4cf-153">將節點加入至結構描述，並移動現有的根節點，此新加入的節點之下。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-153">Add a node to the schema and move the existing root node under this newly added node.</span></span> <span data-ttu-id="5b4cf-154">為根節點名稱。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-154">Give a name to the root node.</span></span> <span data-ttu-id="5b4cf-155">本主題中，重新命名的根節點**根**。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-155">For this topic, rename the root node to **Root**.</span></span>  
  
   2.  <span data-ttu-id="5b4cf-156">SELECT 陳述式所產生的回應結構描述參考 sqltypes.xsd。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-156">The response schema generated for the SELECT statement references a sqltypes.xsd.</span></span> <span data-ttu-id="5b4cf-157">您可以取得的 sqltypes.xsd 結構描述[ http://go.microsoft.com/fwlink/p/?LinkId=131087 ](http://go.microsoft.com/fwlink/p/?LinkId=131087)。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-157">You can get the sqltypes.xsd schema from [http://go.microsoft.com/fwlink/p/?LinkId=131087](http://go.microsoft.com/fwlink/p/?LinkId=131087).</span></span> <span data-ttu-id="5b4cf-158">Sqltypes.xsd 結構描述加入 BizTalk 專案中。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-158">Add the sqltypes.xsd schema to the BizTalk project.</span></span>  
  
   3.  <span data-ttu-id="5b4cf-159">在 SELECT 陳述式所產生的結構描述，將值變更`import schemaLocation`如下。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-159">In the schema generated for the SELECT statement, change the value of `import schemaLocation` to the following.</span></span>  
  
       ```  
       import schemaLocation=”sqltypes.xsd”  
       ```  
  
        <span data-ttu-id="5b4cf-160">因為您已經將 sqltypes.xsd 結構描述加入 BizTalk 專案，您可以這麼做。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-160">You do this because you have already added the sqltypes.xsd schema to your BizTalk project.</span></span>  
  
   4.  <span data-ttu-id="5b4cf-161">提供結構描述目標命名空間。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-161">Provide a target namespace for the schema.</span></span> <span data-ttu-id="5b4cf-162">按一下  **\<結構描述\>** 節點，並在 屬性 窗格中，指定的命名空間中**目標命名空間**屬性。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-162">Click the **\<Schema\>** node, and in the properties pane, specify a namespace in the **Target Namespace** property.</span></span> <span data-ttu-id="5b4cf-163">本主題中提供的命名空間`http://ForXmlPolling/namespace`。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-163">For this topic, give the namespace as `http://ForXmlPolling/namespace`.</span></span>  
  
## <a name="defining-messages-and-message-types"></a><span data-ttu-id="5b4cf-164">定義訊息和訊息類型</span><span class="sxs-lookup"><span data-stu-id="5b4cf-164">Defining Messages and Message Types</span></span>  
 <span data-ttu-id="5b4cf-165">您稍早產生的結構描述會描述協調流程中的訊息所需的 「 類型 」。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-165">The schema that you generated earlier describes the "types" required for the messages in the orchestration.</span></span> <span data-ttu-id="5b4cf-166">訊息通常是一個變數，要為其類型會定義對應的結構。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-166">A message is typically a variable, the type for which is defined by the corresponding schema.</span></span> <span data-ttu-id="5b4cf-167">一旦產生結構描述時，您必須訊息從 BizTalk 專案的協調流程檢視以將它的連結。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-167">Once the schema is generated, you must link it to the messages from the Orchestration view of the BizTalk project.</span></span>  
  
 <span data-ttu-id="5b4cf-168">本主題中，您必須建立一則訊息來接收 SQL Server 資料庫中的訊息。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-168">For this topic, you must create one message to receive messages from the SQL Server database.</span></span>  
  
 <span data-ttu-id="5b4cf-169">執行下列步驟來建立訊息，並將它們連結至結構描述。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-169">Perform the following steps to create messages and link them to schema.</span></span>  
  
#### <a name="to-create-messages-and-link-to-schema"></a><span data-ttu-id="5b4cf-170">若要建立訊息，並連結至結構描述</span><span class="sxs-lookup"><span data-stu-id="5b4cf-170">To create messages and link to schema</span></span>  
  
1.  <span data-ttu-id="5b4cf-171">BizTalk 專案中新增協調流程。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-171">Add an orchestration to the BizTalk project.</span></span> <span data-ttu-id="5b4cf-172">從 [方案總管] 中，以滑鼠右鍵按一下 BizTalk 專案名稱，指向**新增**，然後按一下**新項目**。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-172">From the Solution Explorer, right-click the BizTalk project name, point to **Add**, and then click **New Item**.</span></span> <span data-ttu-id="5b4cf-173">輸入 BizTalk 協調流程的名稱，然後按一下**新增**。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-173">Type a name for the BizTalk orchestration and then click **Add**.</span></span>  
  
2.  <span data-ttu-id="5b4cf-174">如果它尚未開啟，請開啟 BizTalk 專案中，[協調流程檢視] 視窗。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-174">Open the orchestration view window of the BizTalk project, if it is not already open.</span></span> <span data-ttu-id="5b4cf-175">按一下 **檢視**，指向**其他 Windows**，然後按一下**協調流程檢視**。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-175">Click **View**, point to **Other Windows**, and then click **Orchestration View**.</span></span>  
  
3.  <span data-ttu-id="5b4cf-176">在 **協調流程檢視**，以滑鼠右鍵按一下**訊息**，然後按一下**新訊息**。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-176">In the **Orchestration View**, right-click **Messages**, and then click **New Message**.</span></span>  
  
4.  <span data-ttu-id="5b4cf-177">以滑鼠右鍵按一下新建立的訊息，然後按**屬性 視窗**。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-177">Right-click the newly created message, and then select **Properties Window**.</span></span>  
  
5.  <span data-ttu-id="5b4cf-178">在 [**屬性**] 窗格**Message_1**，執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="5b4cf-178">In the **Properties** pane for **Message_1**, do the following:</span></span>  
  
    |<span data-ttu-id="5b4cf-179">使用</span><span class="sxs-lookup"><span data-stu-id="5b4cf-179">Use this</span></span>|<span data-ttu-id="5b4cf-180">以進行此動作</span><span class="sxs-lookup"><span data-stu-id="5b4cf-180">To do this</span></span>|  
    |--------------|----------------|  
    |<span data-ttu-id="5b4cf-181">識別碼</span><span class="sxs-lookup"><span data-stu-id="5b4cf-181">Identifier</span></span>|<span data-ttu-id="5b4cf-182">型別**PollingMessage**。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-182">Type **PollingMessage**.</span></span>|  
    |<span data-ttu-id="5b4cf-183">訊息類型</span><span class="sxs-lookup"><span data-stu-id="5b4cf-183">Message Type</span></span>|<span data-ttu-id="5b4cf-184">從下拉式清單中，依序展開**結構描述**，然後選取*ForXMLPolling.PollingResponse*，其中*ForXMLPolling*是 BizTalk 專案的名稱。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-184">From the drop-down list, expand **Schemas**, and select *ForXMLPolling.PollingResponse*, where *ForXMLPolling* is the name of your BizTalk project.</span></span> <span data-ttu-id="5b4cf-185">*PollingResponse*底下所述，執行 SELECT 陳述式所產生的回應結構描述的名稱[來接收輪詢訊息使用 FOR XML 子句中使用 BizTalk Server 的 SQL SELECT 陳述式](../../adapters-and-accelerators/adapter-sql/receive-polling-messages-using-select-with-for-xml-clause-with-the-sql-adapter.md)。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-185">*PollingResponse* is the name of the response schema generated by executing the SELECT statement as described under [Receive polling messages using SELECT statements with FOR XML Clause from SQL using BizTalk Server](../../adapters-and-accelerators/adapter-sql/receive-polling-messages-using-select-with-for-xml-clause-with-the-sql-adapter.md).</span></span>|  
  
## <a name="setting-up-the-orchestration"></a><span data-ttu-id="5b4cf-186">設定協調流程</span><span class="sxs-lookup"><span data-stu-id="5b4cf-186">Setting up the Orchestration</span></span>  
 <span data-ttu-id="5b4cf-187">您必須建立 BizTalk 協調流程使用[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]接收以輪詢為基礎的資料變更訊息從 SQL Server 資料庫。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-187">You must create a BizTalk orchestration to use [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] for receiving polling-based data-change messages from the SQL Server database.</span></span> <span data-ttu-id="5b4cf-188">在此協調流程中，配接器接收的 select 陳述式指定的回應**PollingStatement**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-188">In this orchestration, the adapter receives the response of the select statement specified for the **PollingStatement** binding property.</span></span> <span data-ttu-id="5b4cf-189">SELECT 陳述式的回應會儲存至檔案位置。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-189">The response for the SELECT statement is saved to a FILE location.</span></span> <span data-ttu-id="5b4cf-190">用於輪詢 SQL Server 資料庫的一般協調流程會包含：</span><span class="sxs-lookup"><span data-stu-id="5b4cf-190">A typical orchestration for polling a SQL Server database would contain:</span></span>  
  
- <span data-ttu-id="5b4cf-191">接收和傳送圖形，從 SQL Server 接收訊息，並分別將傳送至檔案連接埠。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-191">Receive and Send shapes to receive messages from SQL Server and send to a FILE port, respectively.</span></span>  
  
- <span data-ttu-id="5b4cf-192">單向接收埠以接收來自 SQL Server 的訊息。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-192">A one-way receive port to receive messages from SQL Server.</span></span>  
  
  > [!IMPORTANT]
  >  <span data-ttu-id="5b4cf-193">輸入的輪詢案例，您必須一律設定為單向接收埠。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-193">For inbound polling scenarios you must always configure a one-way receive port.</span></span> <span data-ttu-id="5b4cf-194">雙向接收埠不支援的輸入作業。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-194">Two-way receive ports are not supported for inbound operations.</span></span>  
  
- <span data-ttu-id="5b4cf-195">單向傳送埠以將輪詢回應從 SQL Server 資料庫傳送到資料夾。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-195">A one-way send port to send polling responses from a SQL Server database to a folder.</span></span>  
  
  <span data-ttu-id="5b4cf-196">範例協調流程如下所示。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-196">A sample orchestration resembles the following.</span></span>  
  
  <span data-ttu-id="5b4cf-197">![用於輪詢 SQL Server 資料庫的協調流程](../../adapters-and-accelerators/adapter-sql/media/5cf65d53-d70d-444d-82f7-2561efcd9ee4.gif "5cf65d53-d70d-444d-82f7-2561efcd9ee4")</span><span class="sxs-lookup"><span data-stu-id="5b4cf-197">![Orchestration for polling a SQL Server database](../../adapters-and-accelerators/adapter-sql/media/5cf65d53-d70d-444d-82f7-2561efcd9ee4.gif "5cf65d53-d70d-444d-82f7-2561efcd9ee4")</span></span>  
  
### <a name="adding-message-shapes"></a><span data-ttu-id="5b4cf-198">新增訊息圖形</span><span class="sxs-lookup"><span data-stu-id="5b4cf-198">Adding Message Shapes</span></span>  
 <span data-ttu-id="5b4cf-199">請確定您針對每個訊息 圖形中指定下列屬性。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-199">Make sure you specify the following properties for each of the message shapes.</span></span> <span data-ttu-id="5b4cf-200">剛剛提到的協調流程中所示，圖形資料行中所列的名稱會是訊息 圖形的名稱。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-200">The names listed in the Shape column are the names of the message shapes as displayed in the just-mentioned orchestration.</span></span>  
  
|<span data-ttu-id="5b4cf-201">形狀圖</span><span class="sxs-lookup"><span data-stu-id="5b4cf-201">Shape</span></span>|<span data-ttu-id="5b4cf-202">圖形類型</span><span class="sxs-lookup"><span data-stu-id="5b4cf-202">Shape Type</span></span>|<span data-ttu-id="5b4cf-203">屬性</span><span class="sxs-lookup"><span data-stu-id="5b4cf-203">Properties</span></span>|  
|-----------|----------------|----------------|  
|<span data-ttu-id="5b4cf-204">ReceiveMessage</span><span class="sxs-lookup"><span data-stu-id="5b4cf-204">ReceiveMessage</span></span>|<span data-ttu-id="5b4cf-205">Receive</span><span class="sxs-lookup"><span data-stu-id="5b4cf-205">Receive</span></span>|<span data-ttu-id="5b4cf-206">-設定**名稱**到*ReceiveMessage*</span><span class="sxs-lookup"><span data-stu-id="5b4cf-206">- Set **Name** to *ReceiveMessage*</span></span><br /><br /> <span data-ttu-id="5b4cf-207">-設定**啟用**到 *，則為 True*</span><span class="sxs-lookup"><span data-stu-id="5b4cf-207">- Set **Activate** to *True*</span></span>|  
|<span data-ttu-id="5b4cf-208">SaveMessage</span><span class="sxs-lookup"><span data-stu-id="5b4cf-208">SaveMessage</span></span>|<span data-ttu-id="5b4cf-209">Send</span><span class="sxs-lookup"><span data-stu-id="5b4cf-209">Send</span></span>|<span data-ttu-id="5b4cf-210">輪詢間隔後，執行配接器再次**PolledDataAvailableStatement**。\*</span><span class="sxs-lookup"><span data-stu-id="5b4cf-210">- Set **Name** to *SaveMessage*</span></span>|  
  
### <a name="adding-ports"></a><span data-ttu-id="5b4cf-211">新增連接埠</span><span class="sxs-lookup"><span data-stu-id="5b4cf-211">Adding Ports</span></span>  
 <span data-ttu-id="5b4cf-212">請確定您針對每個邏輯連接埠中指定下列屬性。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-212">Make sure you specify the following properties for each of the logical ports.</span></span> <span data-ttu-id="5b4cf-213">協調流程中所示，連接埠資料行中所列的名稱會是連接埠的名稱。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-213">The names listed in the Port column are the names of the ports as displayed in the orchestration.</span></span>  
  
|<span data-ttu-id="5b4cf-214">通訊埠</span><span class="sxs-lookup"><span data-stu-id="5b4cf-214">Port</span></span>|<span data-ttu-id="5b4cf-215">屬性</span><span class="sxs-lookup"><span data-stu-id="5b4cf-215">Properties</span></span>|  
|----------|----------------|  
|<span data-ttu-id="5b4cf-216">SQLReceivePort</span><span class="sxs-lookup"><span data-stu-id="5b4cf-216">SQLReceivePort</span></span>|<span data-ttu-id="5b4cf-217">-設定**識別碼**到*SQLReceivePort*</span><span class="sxs-lookup"><span data-stu-id="5b4cf-217">- Set **Identifier** to *SQLReceivePort*</span></span><br /><br /> <span data-ttu-id="5b4cf-218">-設定**型別**到*SQLReceivePortType*</span><span class="sxs-lookup"><span data-stu-id="5b4cf-218">- Set **Type** to *SQLReceivePortType*</span></span><br /><br /> <span data-ttu-id="5b4cf-219">-設定**通訊模式**到*單向*</span><span class="sxs-lookup"><span data-stu-id="5b4cf-219">- Set **Communication Pattern** to *One-Way*</span></span><br /><br /> <span data-ttu-id="5b4cf-220">-設定**通訊方向**到*接收*</span><span class="sxs-lookup"><span data-stu-id="5b4cf-220">- Set **Communication Direction** to *Receive*</span></span>|  
|<span data-ttu-id="5b4cf-221">SaveMessagePort</span><span class="sxs-lookup"><span data-stu-id="5b4cf-221">SaveMessagePort</span></span>|<span data-ttu-id="5b4cf-222">-設定**識別碼**到*SaveMessagePort*</span><span class="sxs-lookup"><span data-stu-id="5b4cf-222">- Set **Identifier** to *SaveMessagePort*</span></span><br /><br /> <span data-ttu-id="5b4cf-223">-設定**型別**到*SaveMessagePortType*</span><span class="sxs-lookup"><span data-stu-id="5b4cf-223">- Set **Type** to *SaveMessagePortType*</span></span><br /><br /> <span data-ttu-id="5b4cf-224">-設定**通訊模式**到*單向*</span><span class="sxs-lookup"><span data-stu-id="5b4cf-224">- Set **Communication Pattern** to *One-Way*</span></span><br /><br /> <span data-ttu-id="5b4cf-225">-設定**通訊方向**到*傳送*</span><span class="sxs-lookup"><span data-stu-id="5b4cf-225">- Set **Communication Direction** to *Send*</span></span>|  
  
### <a name="specify-messages-for-action-shapes-and-connect-to-ports"></a><span data-ttu-id="5b4cf-226">為動作圖形指定訊息，並連接到連接埠</span><span class="sxs-lookup"><span data-stu-id="5b4cf-226">Specify Messages for Action Shapes and Connect to Ports</span></span>  
 <span data-ttu-id="5b4cf-227">下表指定的屬性和屬性來指定動作圖形的訊息，以及連結至連接埠的訊息，您應該設定的值。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-227">The following table specifies the properties and their values that you should set to specify messages for action shapes and to link the messages to the ports.</span></span> <span data-ttu-id="5b4cf-228">先前所述的協調流程中所示，圖形資料行中所列的名稱會是訊息 圖形的名稱。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-228">The names listed in the Shape column are the names of the message shapes as displayed in the orchestration mentioned earlier.</span></span>  
  
|<span data-ttu-id="5b4cf-229">形狀圖</span><span class="sxs-lookup"><span data-stu-id="5b4cf-229">Shape</span></span>|<span data-ttu-id="5b4cf-230">屬性</span><span class="sxs-lookup"><span data-stu-id="5b4cf-230">Properties</span></span>|  
|-----------|----------------|  
|<span data-ttu-id="5b4cf-231">ReceiveMessage</span><span class="sxs-lookup"><span data-stu-id="5b4cf-231">ReceiveMessage</span></span>|<span data-ttu-id="5b4cf-232">若要插入多筆記錄，您可以執行 more_activity_data.sql 指令碼提供範例。\*</span><span class="sxs-lookup"><span data-stu-id="5b4cf-232">- Set **Message** to *Receive*</span></span><br /><br /> <span data-ttu-id="5b4cf-233">-設定**作業**到*SQLReceivePort.XmlPolling.Request*</span><span class="sxs-lookup"><span data-stu-id="5b4cf-233">- Set **Operation** to *SQLReceivePort.XmlPolling.Request*</span></span>|  
|<span data-ttu-id="5b4cf-234">SaveMessage</span><span class="sxs-lookup"><span data-stu-id="5b4cf-234">SaveMessage</span></span>|<span data-ttu-id="5b4cf-235">若要插入多筆記錄，您可以執行 more_activity_data.sql 指令碼提供範例。\*</span><span class="sxs-lookup"><span data-stu-id="5b4cf-235">- Set **Message** to *Receive*</span></span><br /><br /> <span data-ttu-id="5b4cf-236">-設定**作業**到*SaveMessagePort.XmlPolling.Request*</span><span class="sxs-lookup"><span data-stu-id="5b4cf-236">- Set **Operation** to *SaveMessagePort.XmlPolling.Request*</span></span>|  
  
 <span data-ttu-id="5b4cf-237">您指定這些屬性之後，連線的訊息 圖形和連接埠和協調流程已完成。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-237">After you have specified these properties, the message shapes and ports are connected and your orchestration is complete.</span></span>  
  
 <span data-ttu-id="5b4cf-238">您現在必須建置 BizTalk 方案，並將其部署至[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-238">You must now build the BizTalk solution and deploy it to a [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="5b4cf-239">如需詳細資訊，請參閱 <<c0> [ 建置和執行協調流程](../../core/building-and-running-orchestrations.md)。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-239">For more information, see [Building and Running Orchestrations](../../core/building-and-running-orchestrations.md).</span></span>
  
## <a name="configuring-the-biztalk-application"></a><span data-ttu-id="5b4cf-240">設定 BizTalk 應用程式</span><span class="sxs-lookup"><span data-stu-id="5b4cf-240">Configuring the BizTalk Application</span></span>  
 <span data-ttu-id="5b4cf-241">您已部署的 BizTalk 專案之後，您稍早建立的協調流程會列在下**協調流程**在 BizTalk Server 管理主控台 窗格。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-241">After you have deployed the BizTalk project, the orchestration you created earlier is listed under the **Orchestrations** pane in the BizTalk Server Administration console.</span></span> <span data-ttu-id="5b4cf-242">您必須使用[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]管理主控台來設定應用程式。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-242">You must use the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] Administration console to configure the application.</span></span> <span data-ttu-id="5b4cf-243">如需逐步解說，請參閱 <<c0> [ 逐步解說： 部署基本 BizTalk 應用程式](Walkthrough:%20Deploying%20a%20Basic%20BizTalk%20Application.md)。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-243">For a walkthrough, see [Walkthrough: Deploying a Basic BizTalk Application](Walkthrough:%20Deploying%20a%20Basic%20BizTalk%20Application.md).</span></span>
  
 <span data-ttu-id="5b4cf-244">設定應用程式包含：</span><span class="sxs-lookup"><span data-stu-id="5b4cf-244">Configuring an application involves:</span></span>  
  
- <span data-ttu-id="5b4cf-245">選取應用程式主機。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-245">Selecting a host for the application.</span></span>  
  
- <span data-ttu-id="5b4cf-246">對應您在您在 BizTalk Server 管理主控台中的實體連接埠的協調流程中建立的連接埠。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-246">Mapping the ports that you created in your orchestration to physical ports in the BizTalk Server Administration console.</span></span> <span data-ttu-id="5b4cf-247">此協調流程中，您必須：</span><span class="sxs-lookup"><span data-stu-id="5b4cf-247">For this orchestration you must:</span></span>  
  
  - <span data-ttu-id="5b4cf-248">硬碟和對應的檔案連接埠，其中的 BizTalk 協調流程會從卸除訊息的 SQL Server 資料庫上定義的位置。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-248">Define a location on the hard disk and a corresponding file port where the BizTalk orchestration will drop the messages from the SQL Server database.</span></span> <span data-ttu-id="5b4cf-249">這些訊息會以您指定接收埠的輪詢陳述式的回應。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-249">These messages will be in response to the polling statement that you specify for the receive port.</span></span>  
  
  - <span data-ttu-id="5b4cf-250">不過，因為現在具有狀態為 0，則需要不有任何記錄，所以配接器會取得空的回應，如下列所示。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-250">Define a physical WCF-Custom or WCF-SQL one-way receive port.</span></span> <span data-ttu-id="5b4cf-251">此連接埠會輪詢 SQL Server 資料庫，以您指定連接埠輪詢陳述式。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-251">This port polls the SQL Server database with the polling statement you specify for the port.</span></span> <span data-ttu-id="5b4cf-252">如需有關如何建立連接埠的資訊，請參閱 <<c0> [ 手動設定 SQL 配接器的實體連接埠繫結](../../adapters-and-accelerators/adapter-sql/manually-configure-a-physical-port-binding-to-the-sql-adapter.md)。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-252">For information about how to create ports, see [Manually configure a physical port binding to the SQL adapter](../../adapters-and-accelerators/adapter-sql/manually-configure-a-physical-port-binding-to-the-sql-adapter.md).</span></span> <span data-ttu-id="5b4cf-253">請確定指定接收埠的下列繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-253">Make sure you specify the following binding properties for the receive port.</span></span>  
  
    > [!IMPORTANT]
    >  <span data-ttu-id="5b4cf-254">您不需要執行此步驟中，如果您指定在設計階段的繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-254">You do not need to perform this step if you specified the binding properties at design-time.</span></span> <span data-ttu-id="5b4cf-255">在此情況下，您可以建立 wcf-custom 或 WCF SQL 接收埠中，設定必要的繫結屬性，藉由匯入所建立的繫結檔[!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-255">In such a case, you can create a WCF-custom or WCF-SQL receive port, with the required binding properties set, by importing the binding file created by the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span></span> <span data-ttu-id="5b4cf-256">如需詳細資訊，請參閱[設定要使用 SQL 配接器使用的連接埠繫結檔案的實體連接埠繫結](../../adapters-and-accelerators/adapter-sql/configure-a-physical-port-binding-using-a-port-binding-file-to-sql-adapter.md)。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-256">For more information see [Configure a physical port binding using a port binding file to use the SQL adapter](../../adapters-and-accelerators/adapter-sql/configure-a-physical-port-binding-using-a-port-binding-file-to-sql-adapter.md).</span></span>  
  
    |<span data-ttu-id="5b4cf-257">繫結屬性</span><span class="sxs-lookup"><span data-stu-id="5b4cf-257">Binding Property</span></span>|<span data-ttu-id="5b4cf-258">ReplTest1</span><span class="sxs-lookup"><span data-stu-id="5b4cf-258">Value</span></span>|  
    |----------------------|-----------|  
    |<span data-ttu-id="5b4cf-259">**InboundOperationType**</span><span class="sxs-lookup"><span data-stu-id="5b4cf-259">**InboundOperationType**</span></span>|<span data-ttu-id="5b4cf-260">請確定您將此設**XmlPolling**。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-260">Make sure you set this to **XmlPolling**.</span></span>|  
    |<span data-ttu-id="5b4cf-261">**PolledDataAvailableStatement**</span><span class="sxs-lookup"><span data-stu-id="5b4cf-261">**PolledDataAvailableStatement**</span></span>|<span data-ttu-id="5b4cf-262">請確定您指定的 SQL 陳述式。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-262">Make sure you specify a SQL statement.</span></span> <span data-ttu-id="5b4cf-263">本主題中，請指定：</span><span class="sxs-lookup"><span data-stu-id="5b4cf-263">For this topic, specify:</span></span><br /><br /> `SELECT COUNT(*) FROM Employee`|  
    |<span data-ttu-id="5b4cf-264">**PollingStatement**</span><span class="sxs-lookup"><span data-stu-id="5b4cf-264">**PollingStatement**</span></span>|<span data-ttu-id="5b4cf-265">請確定您提供相同的陳述式，不含`xmlschema`子句中，您指定在產生結構描述中所述[來接收輪詢訊息使用 FOR XML 子句從使用 BizTalk Server的SQLSELECT陳述式](../../adapters-and-accelerators/adapter-sql/receive-polling-messages-using-select-with-for-xml-clause-with-the-sql-adapter.md).</span><span class="sxs-lookup"><span data-stu-id="5b4cf-265">Make sure you provide the same statement, without the `xmlschema` clause, that you specified while generating the schema as described in [Receive polling messages using SELECT statements with FOR XML Clause from SQL using BizTalk Server](../../adapters-and-accelerators/adapter-sql/receive-polling-messages-using-select-with-for-xml-clause-with-the-sql-adapter.md).</span></span><br /><br /> `SELECT Employee_ID ,Name ,Designation FROM Employee for xml auto`<br /><br /> <span data-ttu-id="5b4cf-266">**注意︰** 請注意，SELECT 陳述式不包含`xmlschema`子句。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-266">**Note:** Note that the SELECT statement does not contain the `xmlschema` clause.</span></span>|  
    |<span data-ttu-id="5b4cf-267">**XmlStoredProcedureRootNodeName**</span><span class="sxs-lookup"><span data-stu-id="5b4cf-267">**XmlStoredProcedureRootNodeName**</span></span>|<span data-ttu-id="5b4cf-268">指定的根節點底下所述，您新增至您產生了 SELECT 陳述式中，回應結構描述名稱[產生 SELECT 陳述式的回應訊息的結構描述](#BKMK_RespSchema)。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-268">Specify the name of the root node that you added to the response schema you generated for the SELECT statement, as described under [Generating Schema for the Response Message for SELECT Statement](#BKMK_RespSchema).</span></span> <span data-ttu-id="5b4cf-269">本主題中，將此設為**根**。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-269">For this topic, set this to **Root**.</span></span>|  
    |<span data-ttu-id="5b4cf-270">**XmlStoredProcedureRootNodeNamespace**</span><span class="sxs-lookup"><span data-stu-id="5b4cf-270">**XmlStoredProcedureRootNodeNamespace**</span></span>|<span data-ttu-id="5b4cf-271">指定 SELECT 陳述式中，您產生的回應結構描述的目標命名空間，如底下所述[產生 SELECT 陳述式的回應訊息的結構描述](#BKMK_RespSchema)。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-271">Specify the target namespace for the response schema you generated for the SELECT statement, as described under [Generating Schema for the Response Message for SELECT Statement](#BKMK_RespSchema).</span></span> <span data-ttu-id="5b4cf-272">本主題中，將此設為`http://ForXmlPolling/namespace`。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-272">For this topic, set this to `http://ForXmlPolling/namespace`.</span></span>|  
  
     <span data-ttu-id="5b4cf-273">如需不同的繫結屬性的詳細資訊，請參閱[了解 BizTalk Adapter for SQL Server 配接器繫結屬性](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-273">For more information about the different binding properties, see [Read about the BizTalk Adapter for SQL Server adapter Binding Properties](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="5b4cf-274">我們建議您執行使用的輸入的操作時設定的交易隔離等級和交易等待時間[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-274">We recommend configuring the transaction isolation level and the transaction timeout while performing inbound operations using the [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)].</span></span> <span data-ttu-id="5b4cf-275">您可以執行加上服務行為設定 Wcf-custom 或 WCF-SQL 時接收埠。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-275">You can do so by adding the service behavior while configuring the WCF-Custom or WCF-SQL receive port.</span></span> <span data-ttu-id="5b4cf-276">如需有關如何新增服務行為的指示，請參閱[設定交易隔離等級和交易等待時間，使用 SQL](../../adapters-and-accelerators/adapter-sql/configure-transaction-isolation-level-and-transaction-timeout-with-sql.md)。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-276">For instruction on how to add the service behavior, see [Configure Transaction Isolation Level and Transaction Timeout with SQL](../../adapters-and-accelerators/adapter-sql/configure-transaction-isolation-level-and-transaction-timeout-with-sql.md).</span></span>  
  
## <a name="starting-the-application"></a><span data-ttu-id="5b4cf-277">啟動應用程式</span><span class="sxs-lookup"><span data-stu-id="5b4cf-277">Starting the Application</span></span>  
 <span data-ttu-id="5b4cf-278">您必須啟動 SQL Server 資料庫中接收訊息的 BizTalk 應用程式。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-278">You must start the BizTalk application for receiving messages from the SQL Server database.</span></span> <span data-ttu-id="5b4cf-279">如需有關啟動 BizTalk 應用程式的指示，請參閱[如何啟動協調流程](../../core/how-to-start-an-orchestration.md)。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-279">For instructions on starting a BizTalk application, see [How to Start an Orchestration](../../core/how-to-start-an-orchestration.md).</span></span>
  
 <span data-ttu-id="5b4cf-280">在這個階段，請確定：</span><span class="sxs-lookup"><span data-stu-id="5b4cf-280">At this stage, make sure:</span></span>  
  
-   <span data-ttu-id="5b4cf-281">Wcf-custom 或 WCF-SQL 單向接收連接埠，就會使用指定的陳述式的 SQL Server 資料庫來輪詢**PollingStatement**繫結屬性，正在執行。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-281">The WCF-Custom or WCF-SQL one-way receive port, which polls the SQL Server database using the statements specified for the **PollingStatement** binding property, is running.</span></span>  
  
-   <span data-ttu-id="5b4cf-282">FILE 傳送埠，會從 SQL Server 中接收的訊息，正在執行。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-282">The FILE send port, which receives messages from SQL Server, is running.</span></span>  
  
-   <span data-ttu-id="5b4cf-283">BizTalk 協調流程的作業正在執行。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-283">The BizTalk orchestration for the operation is running.</span></span>  
  
## <a name="executing-the-operation"></a><span data-ttu-id="5b4cf-284">執行作業</span><span class="sxs-lookup"><span data-stu-id="5b4cf-284">Executing the Operation</span></span>  
 <span data-ttu-id="5b4cf-285">執行應用程式之後，下列的一組動作進行，相同的順序：</span><span class="sxs-lookup"><span data-stu-id="5b4cf-285">After you run the application, the following set of actions take place, in the same sequence:</span></span>  
  
-   <span data-ttu-id="5b4cf-286">執行配接器**PolledDataAvailableStatement** employee 資料表，並判斷資料表是否有記錄進行輪詢。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-286">The adapter executes the **PolledDataAvailableStatement** on the Employee table and determines that the table has records for polling.</span></span>  
  
-   <span data-ttu-id="5b4cf-287">配接器執行輪詢陳述式，並從 SQL Server 資料庫中接收輪詢訊息。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-287">The adapter executes the polling statement and receives a polling message from the SQL Server database.</span></span> <span data-ttu-id="5b4cf-288">輪詢陳述式包含 FOR XML 子句的 SELECT 陳述式，因為配接器接收輪詢訊息如下所示：</span><span class="sxs-lookup"><span data-stu-id="5b4cf-288">Because the polling statement consists of a SELECT statement with a FOR XML clause, the polling message received by the adapter resembles the following:</span></span>  
  
    ```  
    <?xml version="1.0" encoding="utf-8" ?>   
    <Root xmlns="http://ForXmlPolling/namespace">  
      <Employee Employee_ID="10765" Name="John" Designation="Tester" xmlns="" />   
      <Employee Employee_ID="10766" Name="Sam" Designation="Manager" xmlns="" />   
      .....  
      .....  
    </Root>  
    ```  
  
     <span data-ttu-id="5b4cf-289">請注意執行 SELECT 陳述式所產生時，在相同的結構描述中接收輪詢訊息**xmlschema**子句。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-289">Notice that the polling message is received in the same schema as generated by executing the SELECT statement with the **xmlschema** clause.</span></span> <span data-ttu-id="5b4cf-290">也請注意，根節點和命名空間是您指定的值為相同**XmlStoredProcedureRootNodeName**並**XmlStoredProcedureRootNodeNamespace**分別繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-290">Also note that the root node and the namespace is the same you specified as values for **XmlStoredProcedureRootNodeName** and **XmlStoredProcedureRootNodeNamespace** binding properties respectively.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="5b4cf-291">[!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)]將繼續輪詢，直到您明確停用接收埠從[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]管理主控台。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-291">The [!INCLUDE[adaptersqlshort](../../includes/adaptersqlshort-md.md)] will continue to poll until you explicitly disable the receive port from the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span>  
  
## <a name="best-practices"></a><span data-ttu-id="5b4cf-292">最佳作法</span><span class="sxs-lookup"><span data-stu-id="5b4cf-292">Best Practices</span></span>  
 <span data-ttu-id="5b4cf-293">您部署和設定 BizTalk 專案之後，您可以匯出至 XML 檔案，稱為繫結檔案的組態設定。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-293">After you have deployed and configured the BizTalk project, you can export configuration settings to an XML file called the binding file.</span></span> <span data-ttu-id="5b4cf-294">一旦您產生繫結檔案時，您可以匯入的組態設定檔案，，讓您不需要建立傳送埠和接收相同的協調流程的連接埠。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-294">Once you generate a binding file, you can import the configuration settings from the file, so that you do not need to create the send ports and receive ports for the same orchestration.</span></span> <span data-ttu-id="5b4cf-295">如需有關繫結檔案的詳細資訊，請參閱 <<c0> [ 重複使用配接器繫結](../../adapters-and-accelerators/adapter-sql/reuse-sql-adapter-bindings.md)。</span><span class="sxs-lookup"><span data-stu-id="5b4cf-295">For more information about binding files, see [Reuse adapter bindings](../../adapters-and-accelerators/adapter-sql/reuse-sql-adapter-bindings.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="5b4cf-296">另請參閱</span><span class="sxs-lookup"><span data-stu-id="5b4cf-296">See Also</span></span>  
 [<span data-ttu-id="5b4cf-297">使用 SQL 配接器與 BizTalk Server 輪詢 SQL Server</span><span class="sxs-lookup"><span data-stu-id="5b4cf-297">Poll SQL Server by Using the SQL Adapter with BizTalk Server</span></span>](../../adapters-and-accelerators/adapter-sql/poll-sql-server-using-the-sql-adapter-with-biztalk-server.md)