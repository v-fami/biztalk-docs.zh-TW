---
title: 接收查詢通知使用 SQL 配接器 |Microsoft 文件
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 6b2ed0f0-d005-4eec-b1a6-97a0c94678dc
caps.latest.revision: 10
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 37d333a2248c943d1d404aa086565ae4b1662226
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
ms.locfileid: "22224502"
---
# <a name="receive-query-notifications-using-the-sql-adapter"></a><span data-ttu-id="cd799-102">接收查詢通知使用 SQL 配接器</span><span class="sxs-lookup"><span data-stu-id="cd799-102">Receive query notifications using the SQL adapter</span></span>
<span data-ttu-id="cd799-103">配接器用戶端可以接收 SQL Server 資料庫中的資料變更的查詢通知訂閱。</span><span class="sxs-lookup"><span data-stu-id="cd799-103">The adapter clients can subscribe to receive query notifications about the data changes in the SQL Server database.</span></span> <span data-ttu-id="cd799-104">SQL SELECT 陳述式或預存程序指定的資料變更準則，用於觸發的查詢通知，資料表中和 SQL Server 會傳送做為查詢通知，當結果集的 SELECT 陳述式或預存程序變更。</span><span class="sxs-lookup"><span data-stu-id="cd799-104">A SQL SELECT statement or a stored procedure specifies the data-change criteria in a table for triggering of the query notifications, and the SQL Server sends query notifications as and when the result set for the SELECT statement or the stored procedure changes.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="cd799-105">若要支援查詢通知，配接器用戶端和 SQL Server 資料庫必須符合特定需求。</span><span class="sxs-lookup"><span data-stu-id="cd799-105">To support query notifications, the adapter clients and the SQL Server database have to fulfill certain requirements.</span></span> <span data-ttu-id="cd799-106">有關這些需求的詳細資訊，請參閱 「 啟用查詢通知 」，網址[http://go.microsoft.com/fwlink/?LinkID=122323](http://go.microsoft.com/fwlink/?LinkID=122323)。</span><span class="sxs-lookup"><span data-stu-id="cd799-106">For detailed information about these requirements, see “Enabling Query Notifications” at [http://go.microsoft.com/fwlink/?LinkID=122323](http://go.microsoft.com/fwlink/?LinkID=122323).</span></span>  
  
 <span data-ttu-id="cd799-107">一般查詢通知涉及下列作業：</span><span class="sxs-lookup"><span data-stu-id="cd799-107">A typical query notification involves the following:</span></span>  
  
-   <span data-ttu-id="cd799-108">配接器用戶端必須指定`Notification`為中的輸入作業**InboundOperationType**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="cd799-108">The adapter clients must specify `Notification` as the inbound operation in the **InboundOperationType** binding property.</span></span> <span data-ttu-id="cd799-109">這個繫結屬性的預設值是`Polling`。</span><span class="sxs-lookup"><span data-stu-id="cd799-109">The default value for this binding property is `Polling`.</span></span>  
  
-   <span data-ttu-id="cd799-110">配接器用戶端必須指定 SQL 陳述式中的查詢通知註冊**NotificationStatement**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="cd799-110">The adapter clients must specify a SQL statement to register for query notifications in the **NotificationStatement** binding property.</span></span> <span data-ttu-id="cd799-111">配接器用戶端會從 SQL Server 取得通知的結果集為指定的 SQL 陳述式變更為。</span><span class="sxs-lookup"><span data-stu-id="cd799-111">The adapter client gets a notification from SQL Server as soon as the result set for the specified SQL statement changes.</span></span>  
  
    > [!IMPORTANT]
    >  <span data-ttu-id="cd799-112">若要接收通知，通知訂閱的 SQL 陳述式*必須*符合特定準則。</span><span class="sxs-lookup"><span data-stu-id="cd799-112">To receive notifications, the SQL statement for the notification subscription *must* meet certain criteria.</span></span> <span data-ttu-id="cd799-113">可用於查詢通知的 SQL 陳述式的相關資訊，請參閱[http://go.microsoft.com/fwlink/?LinkId=122160](http://go.microsoft.com/fwlink/?LinkId=122160)。</span><span class="sxs-lookup"><span data-stu-id="cd799-113">For information about SQL statements that can be used for query notifications, see [http://go.microsoft.com/fwlink/?LinkId=122160](http://go.microsoft.com/fwlink/?LinkId=122160).</span></span>  
  
-   <span data-ttu-id="cd799-114">配接器用戶端必須指定是否配接器傳送通知給配接器用戶端以啟動接聽程式之後儘速**NotifyOnListenerStart**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="cd799-114">The adapter clients must specify whether the adapter sends a notification to the adapter clients as soon as the listener is started in the **NotifyOnListenerStart** binding property.</span></span>  
  
-   <span data-ttu-id="cd799-115">通知會傳送至配接器用戶端並時的結果集的 SQL 陳述式中指定**NotificationStatement**繫結屬性已變更。</span><span class="sxs-lookup"><span data-stu-id="cd799-115">The notification is sent to the adapter clients as and when the result set of the SQL statement specified in the **NotificationStatement** binding property is changed.</span></span>  
  
 <span data-ttu-id="cd799-116">如需有關這些繫結屬性的詳細資訊，請參閱[閱讀 BizTalk Adapter for SQL Server 配接器繫結屬性](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="cd799-116">For more information about these binding properties, see [Read about the BizTalk Adapter for SQL Server adapter binding properties](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="cd799-117">通知訂閱一律是認可，不論陳述式已執行的交易已認可或回復。</span><span class="sxs-lookup"><span data-stu-id="cd799-117">The notification subscription is always committed, regardless of whether the transaction in which the statement ran was committed or rolled back.</span></span> <span data-ttu-id="cd799-118">因此，通知作業可能會保證針對通知訂閱查詢的結果已變更。</span><span class="sxs-lookup"><span data-stu-id="cd799-118">Therefore, the notification operation might not guarantee that the result of the query subscribed for notification has changed.</span></span> <span data-ttu-id="cd799-119">例如，假設資料插入資料表中的資料列 （通知訂閱） 交易，並立即傳送通知給變更 （插入） 相關的配接器通知。</span><span class="sxs-lookup"><span data-stu-id="cd799-119">For example, suppose data is inserted in a table row (subscribed for notification) in a transaction, and immediately a notification is sent to the adapter informing about the change (insert).</span></span> <span data-ttu-id="cd799-120">由於某些原因，交易回復，並有效地任何資料插入資料表資料列。</span><span class="sxs-lookup"><span data-stu-id="cd799-120">Due to some reason, the transaction rolls back, and effectively no data is inserted into the table row.</span></span> <span data-ttu-id="cd799-121">不過，SQL Server 不會傳送通知給配接器有關交易回復。</span><span class="sxs-lookup"><span data-stu-id="cd799-121">However, the SQL Server does not send a notification to the adapter about the transaction roll back.</span></span> <span data-ttu-id="cd799-122">SQL Server 中的查詢通知的相關資訊，請參閱[http://go.microsoft.com/fwlink/?LinkId=145367](http://go.microsoft.com/fwlink/?LinkId=145367)。</span><span class="sxs-lookup"><span data-stu-id="cd799-122">For information about query notifications in SQL Server, see [http://go.microsoft.com/fwlink/?LinkId=145367](http://go.microsoft.com/fwlink/?LinkId=145367).</span></span>  
  
## <a name="differences-between-query-notification-and-polling"></a><span data-ttu-id="cd799-123">查詢通知和輪詢之間的差異</span><span class="sxs-lookup"><span data-stu-id="cd799-123">Differences between Query Notification and Polling</span></span>  
 <span data-ttu-id="cd799-124">查詢通知輪詢都是這兩個輸入的作業，且 SQL Server 資料庫中的資料變更通知配接器用戶端，但下表列出這兩者之間的一些差異。</span><span class="sxs-lookup"><span data-stu-id="cd799-124">Though query notification and polling are both inbound operations, and inform the adapter clients about the data changes in the SQL Server database, the following table lists some differences between the two.</span></span> <span data-ttu-id="cd799-125">下列差異，可協助您決定在針對作業，視您的需求而定：</span><span class="sxs-lookup"><span data-stu-id="cd799-125">The following differences will help you decide on an operation depending on your requirements:</span></span>  
  
|<span data-ttu-id="cd799-126">查詢通知</span><span class="sxs-lookup"><span data-stu-id="cd799-126">Query Notification</span></span>|<span data-ttu-id="cd799-127">輪詢</span><span class="sxs-lookup"><span data-stu-id="cd799-127">Polling</span></span>|  
|------------------------|-------------|  
|<span data-ttu-id="cd799-128">查詢通知是由 SQL Server 啟動。</span><span class="sxs-lookup"><span data-stu-id="cd799-128">Query notification is initiated by SQL Server.</span></span> <span data-ttu-id="cd799-129">只在配接器發出的通知陳述式會指示資料庫在陳述式的結果集變更的情況下起始通知。</span><span class="sxs-lookup"><span data-stu-id="cd799-129">The notification statement issued by the adapter just instructs the database to initiate notification in case there is a change in the result set of the statement.</span></span>|<span data-ttu-id="cd799-130">輪詢配接器所起始。</span><span class="sxs-lookup"><span data-stu-id="cd799-130">Polling is initiated by the adapter.</span></span> <span data-ttu-id="cd799-131">執行陳述式，以驗證是否資料適用於輪詢，並以起始輪詢執行輪詢陳述式，如果某些資料可用於輪詢配接器。</span><span class="sxs-lookup"><span data-stu-id="cd799-131">The adapter executes a statement to validate whether data is available for polling, and then initiates polling by executing the polling statement if some data is available for polling.</span></span>|  
|<span data-ttu-id="cd799-132">您可以使用查詢通知陳述式只讀取 SQL Server 資料庫資料表中的資料。</span><span class="sxs-lookup"><span data-stu-id="cd799-132">You can use the query notification statement to only read data in a SQL Server database table.</span></span>|<span data-ttu-id="cd799-133">您可以使用輪詢陳述式來讀取或更新 SQL Server 資料庫資料表中的資料。</span><span class="sxs-lookup"><span data-stu-id="cd799-133">You can use the polling statement to read or update data in a SQL Server database table.</span></span>|  
|<span data-ttu-id="cd799-134">查詢通知僅告知的類型變更的資料，例如 Insert、 Update 和 Delete。</span><span class="sxs-lookup"><span data-stu-id="cd799-134">Query notification informs only about the type of change in the data such as Insert, Update, and Delete.</span></span>|<span data-ttu-id="cd799-135">輪詢會通知您有關已變更的實際資料。</span><span class="sxs-lookup"><span data-stu-id="cd799-135">Polling informs you about the actual data that has changed.</span></span>|  
|<span data-ttu-id="cd799-136">資料變更通知是在瞬間完成。</span><span class="sxs-lookup"><span data-stu-id="cd799-136">The data-change notification is instantaneous.</span></span>|<span data-ttu-id="cd799-137">輪詢間隔，取決於資料變更通知，配接器用戶端就會接到通知有關的資料變更每個輪詢間隔的結尾。</span><span class="sxs-lookup"><span data-stu-id="cd799-137">The data-change notification depends on the polling interval, and the adapter clients are informed about the data changes at the end of every polling interval.</span></span> <span data-ttu-id="cd799-138">**提示：** 輪詢可讓您更佳的輸送量持續發生資料變更並不想為每項變更，並發生時加以通知。</span><span class="sxs-lookup"><span data-stu-id="cd799-138">**Tip:**  Polling can give you better throughput in scenarios where the data changes are happening continuously, and you do not want to be notified of each change as and when it happens.</span></span> <span data-ttu-id="cd799-139">相反地，您可以指定您要在其後發生是因為最後一個變更通知的所有變更的通知輪詢間隔。</span><span class="sxs-lookup"><span data-stu-id="cd799-139">Instead, you specify a polling interval after which you want to be notified of all the changes that have happened since the last change notification.</span></span>|  
  
 <span data-ttu-id="cd799-140">如需有關在查詢通知[!INCLUDE[adaptersql](../../includes/adaptersql-md.md)]，請參閱[使用 BizTalk server 接收 SQL 查詢通知](../../adapters-and-accelerators/adapter-sql/receive-sql-query-notifications-using-biztalk-server.md)。</span><span class="sxs-lookup"><span data-stu-id="cd799-140">For more information about query notification in [!INCLUDE[adaptersql](../../includes/adaptersql-md.md)], see [Receive SQL Query Notifications by Using BizTalk Server](../../adapters-and-accelerators/adapter-sql/receive-sql-query-notifications-using-biztalk-server.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="cd799-141">另請參閱</span><span class="sxs-lookup"><span data-stu-id="cd799-141">See Also</span></span>  
 <span data-ttu-id="cd799-142">[哪些作業可以是執行使用配接器？](https://msdn.microsoft.com/library/cc185435(v=bts.10).aspx)</span><span class="sxs-lookup"><span data-stu-id="cd799-142">[What Operations Can be Performed Using the Adapter?](https://msdn.microsoft.com/library/cc185435(v=bts.10).aspx)</span></span>