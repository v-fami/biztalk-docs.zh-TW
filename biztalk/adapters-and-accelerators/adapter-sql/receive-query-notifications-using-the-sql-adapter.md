---
title: 接收查詢通知使用 SQL 配接器 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 6b2ed0f0-d005-4eec-b1a6-97a0c94678dc
caps.latest.revision: 10
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 786bbf556acb3a30e652a7ecb29723f40566cb06
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "36999743"
---
# <a name="receive-query-notifications-using-the-sql-adapter"></a><span data-ttu-id="7b514-102">接收查詢通知使用 SQL 配接器</span><span class="sxs-lookup"><span data-stu-id="7b514-102">Receive query notifications using the SQL adapter</span></span>
<span data-ttu-id="7b514-103">配接器用戶端可以訂閱以接收 SQL Server 資料庫中的資料變更的查詢通知。</span><span class="sxs-lookup"><span data-stu-id="7b514-103">The adapter clients can subscribe to receive query notifications about the data changes in the SQL Server database.</span></span> <span data-ttu-id="7b514-104">SQL SELECT 陳述式或預存程序指定的資料變更準則的查詢通知中，觸發表格中和 SQL Server 會傳送做為查詢通知，當結果集的 SELECT 陳述式或預存程序變更。</span><span class="sxs-lookup"><span data-stu-id="7b514-104">A SQL SELECT statement or a stored procedure specifies the data-change criteria in a table for triggering of the query notifications, and the SQL Server sends query notifications as and when the result set for the SELECT statement or the stored procedure changes.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="7b514-105">若要支援查詢通知，配接器用戶端和 SQL Server 資料庫必須符合特定需求。</span><span class="sxs-lookup"><span data-stu-id="7b514-105">To support query notifications, the adapter clients and the SQL Server database have to fulfill certain requirements.</span></span> <span data-ttu-id="7b514-106">有關這些需求的詳細資訊，請參閱 < 啟用查詢通知 >，網址[ http://go.microsoft.com/fwlink/?LinkID=122323 ](http://go.microsoft.com/fwlink/?LinkID=122323)。</span><span class="sxs-lookup"><span data-stu-id="7b514-106">For detailed information about these requirements, see “Enabling Query Notifications” at [http://go.microsoft.com/fwlink/?LinkID=122323](http://go.microsoft.com/fwlink/?LinkID=122323).</span></span>  
  
 <span data-ttu-id="7b514-107">典型的查詢通知涉及下列工作：</span><span class="sxs-lookup"><span data-stu-id="7b514-107">A typical query notification involves the following:</span></span>  
  
- <span data-ttu-id="7b514-108">配接器用戶端必須指定`Notification`中輸入作業**InboundOperationType**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="7b514-108">The adapter clients must specify `Notification` as the inbound operation in the **InboundOperationType** binding property.</span></span> <span data-ttu-id="7b514-109">這個繫結屬性的預設值是`Polling`。</span><span class="sxs-lookup"><span data-stu-id="7b514-109">The default value for this binding property is `Polling`.</span></span>  
  
- <span data-ttu-id="7b514-110">配接器用戶端必須指定 SQL 陳述式中的查詢通知註冊**NotificationStatement**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="7b514-110">The adapter clients must specify a SQL statement to register for query notifications in the **NotificationStatement** binding property.</span></span> <span data-ttu-id="7b514-111">配接器用戶端從 SQL Server 取得通知，因為結果為指定的 SQL 陳述式變更。</span><span class="sxs-lookup"><span data-stu-id="7b514-111">The adapter client gets a notification from SQL Server as soon as the result set for the specified SQL statement changes.</span></span>  
  
  > [!IMPORTANT]
  >  <span data-ttu-id="7b514-112">若要接收通知，通知訂用帳戶的 SQL 陳述式*必須*符合特定準則。</span><span class="sxs-lookup"><span data-stu-id="7b514-112">To receive notifications, the SQL statement for the notification subscription *must* meet certain criteria.</span></span> <span data-ttu-id="7b514-113">如需可用於查詢通知的 SQL 陳述式的資訊，請參閱[ http://go.microsoft.com/fwlink/?LinkId=122160 ](http://go.microsoft.com/fwlink/?LinkId=122160)。</span><span class="sxs-lookup"><span data-stu-id="7b514-113">For information about SQL statements that can be used for query notifications, see [http://go.microsoft.com/fwlink/?LinkId=122160](http://go.microsoft.com/fwlink/?LinkId=122160).</span></span>  
  
- <span data-ttu-id="7b514-114">配接器用戶端必須指定是否配接器傳送通知給配接器用戶端，以啟動接聽程式**NotifyOnListenerStart**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="7b514-114">The adapter clients must specify whether the adapter sends a notification to the adapter clients as soon as the listener is started in the **NotifyOnListenerStart** binding property.</span></span>  
  
- <span data-ttu-id="7b514-115">通知會傳送至配接器用戶端，做為並結果集的 SQL 陳述式中指定**NotificationStatement**繫結屬性變更。</span><span class="sxs-lookup"><span data-stu-id="7b514-115">The notification is sent to the adapter clients as and when the result set of the SQL statement specified in the **NotificationStatement** binding property is changed.</span></span>  
  
  <span data-ttu-id="7b514-116">如需有關這些繫結屬性的詳細資訊，請參閱 <<c0> [ 了解 BizTalk Adapter for SQL Server 配接器繫結屬性](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="7b514-116">For more information about these binding properties, see [Read about the BizTalk Adapter for SQL Server adapter binding properties](../../adapters-and-accelerators/adapter-sql/read-about-the-biztalk-adapter-for-sql-server-adapter-binding-properties.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7b514-117">通知訂閱總是被認可，不論陳述式已執行的交易已認可或回復。</span><span class="sxs-lookup"><span data-stu-id="7b514-117">The notification subscription is always committed, regardless of whether the transaction in which the statement ran was committed or rolled back.</span></span> <span data-ttu-id="7b514-118">因此，通知作業可能會保證已變更的通知訂閱查詢的結果。</span><span class="sxs-lookup"><span data-stu-id="7b514-118">Therefore, the notification operation might not guarantee that the result of the query subscribed for notification has changed.</span></span> <span data-ttu-id="7b514-119">例如，假設資料插入資料表中的資料列 （通知訂閱） 交易，並立即傳送通知給通知變更 （插入） 相關的配接器。</span><span class="sxs-lookup"><span data-stu-id="7b514-119">For example, suppose data is inserted in a table row (subscribed for notification) in a transaction, and immediately a notification is sent to the adapter informing about the change (insert).</span></span> <span data-ttu-id="7b514-120">由於某些原因，交易會回復，且有效地沒有資料會插入至資料表資料列。</span><span class="sxs-lookup"><span data-stu-id="7b514-120">Due to some reason, the transaction rolls back, and effectively no data is inserted into the table row.</span></span> <span data-ttu-id="7b514-121">不過，SQL Server 不會傳送通知給配接器相關的交易回復。</span><span class="sxs-lookup"><span data-stu-id="7b514-121">However, the SQL Server does not send a notification to the adapter about the transaction roll back.</span></span> <span data-ttu-id="7b514-122">SQL Server 中的查詢通知的相關資訊，請參閱[ http://go.microsoft.com/fwlink/?LinkId=145367 ](http://go.microsoft.com/fwlink/?LinkId=145367)。</span><span class="sxs-lookup"><span data-stu-id="7b514-122">For information about query notifications in SQL Server, see [http://go.microsoft.com/fwlink/?LinkId=145367](http://go.microsoft.com/fwlink/?LinkId=145367).</span></span>  
  
## <a name="differences-between-query-notification-and-polling"></a><span data-ttu-id="7b514-123">查詢通知和輪詢之間的差異</span><span class="sxs-lookup"><span data-stu-id="7b514-123">Differences between Query Notification and Polling</span></span>  
 <span data-ttu-id="7b514-124">查詢通知和輪詢是這兩個輸入的作業，而且有關 SQL Server 資料庫中的資料變更通知配接器用戶端，但下表列出兩者之間的一些差異。</span><span class="sxs-lookup"><span data-stu-id="7b514-124">Though query notification and polling are both inbound operations, and inform the adapter clients about the data changes in the SQL Server database, the following table lists some differences between the two.</span></span> <span data-ttu-id="7b514-125">下列差異將協助您決定的作業，視您的需求而定：</span><span class="sxs-lookup"><span data-stu-id="7b514-125">The following differences will help you decide on an operation depending on your requirements:</span></span>  
  
|<span data-ttu-id="7b514-126">查詢通知</span><span class="sxs-lookup"><span data-stu-id="7b514-126">Query Notification</span></span>|<span data-ttu-id="7b514-127">輪詢</span><span class="sxs-lookup"><span data-stu-id="7b514-127">Polling</span></span>|  
|------------------------|-------------|  
|<span data-ttu-id="7b514-128">查詢通知是由 SQL Server 起始。</span><span class="sxs-lookup"><span data-stu-id="7b514-128">Query notification is initiated by SQL Server.</span></span> <span data-ttu-id="7b514-129">只在配接器發出的通知陳述式會指示要起始通知，萬一沒有陳述式的結果集變更的資料庫。</span><span class="sxs-lookup"><span data-stu-id="7b514-129">The notification statement issued by the adapter just instructs the database to initiate notification in case there is a change in the result set of the statement.</span></span>|<span data-ttu-id="7b514-130">輪詢配接器所起始。</span><span class="sxs-lookup"><span data-stu-id="7b514-130">Polling is initiated by the adapter.</span></span> <span data-ttu-id="7b514-131">若要驗證是否可供輪詢，資料，並藉由執行輪詢陳述式，如果某些資料已可供輪詢起始輪詢陳述式執行配接器。</span><span class="sxs-lookup"><span data-stu-id="7b514-131">The adapter executes a statement to validate whether data is available for polling, and then initiates polling by executing the polling statement if some data is available for polling.</span></span>|  
|<span data-ttu-id="7b514-132">您可以使用查詢通知的陳述式只讀取 SQL Server 資料庫資料表中的資料。</span><span class="sxs-lookup"><span data-stu-id="7b514-132">You can use the query notification statement to only read data in a SQL Server database table.</span></span>|<span data-ttu-id="7b514-133">您可以使用輪詢陳述式來讀取或更新 SQL Server 資料庫資料表中的資料。</span><span class="sxs-lookup"><span data-stu-id="7b514-133">You can use the polling statement to read or update data in a SQL Server database table.</span></span>|  
|<span data-ttu-id="7b514-134">查詢通知只會通知的類型變更的資料，例如 Insert、 Update 和 Delete。</span><span class="sxs-lookup"><span data-stu-id="7b514-134">Query notification informs only about the type of change in the data such as Insert, Update, and Delete.</span></span>|<span data-ttu-id="7b514-135">輪詢會告知您已變更的實際資料。</span><span class="sxs-lookup"><span data-stu-id="7b514-135">Polling informs you about the actual data that has changed.</span></span>|  
|<span data-ttu-id="7b514-136">資料變更通知是在瞬間完成。</span><span class="sxs-lookup"><span data-stu-id="7b514-136">The data-change notification is instantaneous.</span></span>|<span data-ttu-id="7b514-137">資料變更通知取決於輪詢間隔，以及配接器用戶端會通知有關的資料變更，每個輪詢間隔的結尾。</span><span class="sxs-lookup"><span data-stu-id="7b514-137">The data-change notification depends on the polling interval, and the adapter clients are informed about the data changes at the end of every polling interval.</span></span> <span data-ttu-id="7b514-138">**提示：** 輪詢可讓您更佳的輸送量的資料變更會持續發生，並不想為每項變更並發生時收到通知。</span><span class="sxs-lookup"><span data-stu-id="7b514-138">**Tip:**  Polling can give you better throughput in scenarios where the data changes are happening continuously, and you do not want to be notified of each change as and when it happens.</span></span> <span data-ttu-id="7b514-139">相反地，您可以指定之後，您想要的上次變更通知，因為發生錯誤的所有變更的通知的輪詢間隔。</span><span class="sxs-lookup"><span data-stu-id="7b514-139">Instead, you specify a polling interval after which you want to be notified of all the changes that have happened since the last change notification.</span></span>|  
  
 <span data-ttu-id="7b514-140">如需詳細資訊中的查詢通知的相關[!INCLUDE[adaptersql](../../includes/adaptersql-md.md)]，請參閱 <<c2> [ 使用 BizTalk server 接收 SQL 查詢通知](../../adapters-and-accelerators/adapter-sql/receive-sql-query-notifications-using-biztalk-server.md)。</span><span class="sxs-lookup"><span data-stu-id="7b514-140">For more information about query notification in [!INCLUDE[adaptersql](../../includes/adaptersql-md.md)], see [Receive SQL Query Notifications by Using BizTalk Server](../../adapters-and-accelerators/adapter-sql/receive-sql-query-notifications-using-biztalk-server.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7b514-141">另請參閱</span><span class="sxs-lookup"><span data-stu-id="7b514-141">See Also</span></span>  
 <span data-ttu-id="7b514-142">[哪些作業可以是執行使用配接器？](https://msdn.microsoft.com/library/cc185435(v=bts.10).aspx)</span><span class="sxs-lookup"><span data-stu-id="7b514-142">[What Operations Can be Performed Using the Adapter?](https://msdn.microsoft.com/library/cc185435(v=bts.10).aspx)</span></span>