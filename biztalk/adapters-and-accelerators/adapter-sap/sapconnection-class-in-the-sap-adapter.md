---
title: SAP 配接器在 SAPConnection 類別 |Microsoft 文件
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- SAPConnection, supported methods, classes, and constructors
ms.assetid: a700602d-8135-4f67-a38b-770357d4e28b
caps.latest.revision: 6
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: cb5a1778fac8577efb3c3c21a10b16f47a026397
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/28/2017
---
# <a name="sapconnection-class-in-the-sap-adapter"></a><span data-ttu-id="3b667-102">SAP 配接器在 SAPConnection 類別</span><span class="sxs-lookup"><span data-stu-id="3b667-102">SAPConnection class in the SAP adapter</span></span>
<span data-ttu-id="3b667-103">下節列出方法和屬性的**SAPConnection**類別。</span><span class="sxs-lookup"><span data-stu-id="3b667-103">The following section lists the methods and properties for the **SAPConnection** class.</span></span> <span data-ttu-id="3b667-104">這代表 ADO.NET 連接到 SAP 應用程式伺服器。</span><span class="sxs-lookup"><span data-stu-id="3b667-104">This represents an ADO.NET connection to the SAP application server.</span></span>  
  
 <span data-ttu-id="3b667-105">這衍生自**System.Data.Common.DbConnection**。</span><span class="sxs-lookup"><span data-stu-id="3b667-105">This is derived from **System.Data.Common.DbConnection**.</span></span>  
  
## <a name="supported-properties"></a><span data-ttu-id="3b667-106">支援的屬性</span><span class="sxs-lookup"><span data-stu-id="3b667-106">Supported Properties</span></span>  
  
|<span data-ttu-id="3b667-107">名稱</span><span class="sxs-lookup"><span data-stu-id="3b667-107">Name</span></span>|<span data-ttu-id="3b667-108">Get/Set</span><span class="sxs-lookup"><span data-stu-id="3b667-108">Get/Set</span></span>|<span data-ttu-id="3b667-109">Description</span><span class="sxs-lookup"><span data-stu-id="3b667-109">Description</span></span>|  
|----------|--------------|-----------------|  
|<span data-ttu-id="3b667-110">**連接字串**</span><span class="sxs-lookup"><span data-stu-id="3b667-110">**ConnectionString**</span></span>|<span data-ttu-id="3b667-111">取得和設定</span><span class="sxs-lookup"><span data-stu-id="3b667-111">Get and Set</span></span>|<span data-ttu-id="3b667-112">請參閱[閱讀 SAP 連接字串的資料提供者類型](../../adapters-and-accelerators/adapter-sap/read-about-data-provider-types-for-the-sap-connection-string.md)。</span><span class="sxs-lookup"><span data-stu-id="3b667-112">See [Read about Data Provider types for the SAP Connection String](../../adapters-and-accelerators/adapter-sap/read-about-data-provider-types-for-the-sap-connection-string.md).</span></span>|  
|<span data-ttu-id="3b667-113">**ConnectionTimeout**</span><span class="sxs-lookup"><span data-stu-id="3b667-113">**ConnectionTimeout**</span></span>|<span data-ttu-id="3b667-114">Get</span><span class="sxs-lookup"><span data-stu-id="3b667-114">Get</span></span>|<span data-ttu-id="3b667-115">不支援。</span><span class="sxs-lookup"><span data-stu-id="3b667-115">Not supported.</span></span> <span data-ttu-id="3b667-116">傳回 0。</span><span class="sxs-lookup"><span data-stu-id="3b667-116">Returns 0.</span></span>|  
|<span data-ttu-id="3b667-117">**資料庫**</span><span class="sxs-lookup"><span data-stu-id="3b667-117">**Database**</span></span>|<span data-ttu-id="3b667-118">Get</span><span class="sxs-lookup"><span data-stu-id="3b667-118">Get</span></span>|<span data-ttu-id="3b667-119">SAP 系統的識別碼。</span><span class="sxs-lookup"><span data-stu-id="3b667-119">SAP System ID.</span></span>|  
|<span data-ttu-id="3b667-120">**DataSource**</span><span class="sxs-lookup"><span data-stu-id="3b667-120">**DataSource**</span></span>|<span data-ttu-id="3b667-121">Get</span><span class="sxs-lookup"><span data-stu-id="3b667-121">Get</span></span>|<span data-ttu-id="3b667-122">這會傳回 SAP 應用程式伺服器主機的名稱。</span><span class="sxs-lookup"><span data-stu-id="3b667-122">This returns the name of the SAP application server host.</span></span>|  
|<span data-ttu-id="3b667-123">**ServerVersion**</span><span class="sxs-lookup"><span data-stu-id="3b667-123">**ServerVersion**</span></span>|<span data-ttu-id="3b667-124">Get</span><span class="sxs-lookup"><span data-stu-id="3b667-124">Get</span></span>|<span data-ttu-id="3b667-125">這會顯示 SAP 執行個體而非 SAP 伺服器版本的版次的號碼。</span><span class="sxs-lookup"><span data-stu-id="3b667-125">This shows the release number for the SAP instance and not the SAP Server version.</span></span> <span data-ttu-id="3b667-126">例如，如果 ADO.NET 用戶端與執行個體的版次號碼 620 連接到 SAP 伺服器版本 4.6，這個屬性會顯示 620。</span><span class="sxs-lookup"><span data-stu-id="3b667-126">For example, if the ADO.NET client is connecting to SAP Server version 4.6 with the instance release number 620, this property will display 620.</span></span>|  
|<span data-ttu-id="3b667-127">**State**</span><span class="sxs-lookup"><span data-stu-id="3b667-127">**State**</span></span>|<span data-ttu-id="3b667-128">Get</span><span class="sxs-lookup"><span data-stu-id="3b667-128">Get</span></span>|<span data-ttu-id="3b667-129">連線狀態。</span><span class="sxs-lookup"><span data-stu-id="3b667-129">Connection state.</span></span> <span data-ttu-id="3b667-130">支援的狀態為：</span><span class="sxs-lookup"><span data-stu-id="3b667-130">The supported states are:</span></span><br /><br /> <span data-ttu-id="3b667-131">-[System.Data.ConnectionState]</span><span class="sxs-lookup"><span data-stu-id="3b667-131">- [System.Data.ConnectionState]</span></span><br /><br /> <span data-ttu-id="3b667-132">關閉</span><span class="sxs-lookup"><span data-stu-id="3b667-132">- Closed</span></span><br /><br /> <span data-ttu-id="3b667-133">-開啟</span><span class="sxs-lookup"><span data-stu-id="3b667-133">- Open</span></span><br /><br /> <span data-ttu-id="3b667-134">連線</span><span class="sxs-lookup"><span data-stu-id="3b667-134">- Connecting</span></span>|  
  
## <a name="supported-methods"></a><span data-ttu-id="3b667-135">支援的方法</span><span class="sxs-lookup"><span data-stu-id="3b667-135">Supported Methods</span></span>  
  
|<span data-ttu-id="3b667-136">名稱</span><span class="sxs-lookup"><span data-stu-id="3b667-136">Name</span></span>|<span data-ttu-id="3b667-137">Description</span><span class="sxs-lookup"><span data-stu-id="3b667-137">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="3b667-138">**ChangeDatabase(string)**</span><span class="sxs-lookup"><span data-stu-id="3b667-138">**ChangeDatabase(string)**</span></span>|<span data-ttu-id="3b667-139">不支援。</span><span class="sxs-lookup"><span data-stu-id="3b667-139">Not supported.</span></span>|  
|<span data-ttu-id="3b667-140">**Close （)**</span><span class="sxs-lookup"><span data-stu-id="3b667-140">**Close()**</span></span>|<span data-ttu-id="3b667-141">關閉 SAP 系統的連接。</span><span class="sxs-lookup"><span data-stu-id="3b667-141">Closes the connection to the SAP system.</span></span>|  
|<span data-ttu-id="3b667-142">**CreateCommand()**</span><span class="sxs-lookup"><span data-stu-id="3b667-142">**CreateCommand()**</span></span>|<span data-ttu-id="3b667-143">傳回新的 SAPCommand 這個連接相關聯。</span><span class="sxs-lookup"><span data-stu-id="3b667-143">Returns a new SAPCommand associated with this connection.</span></span>|  
|<span data-ttu-id="3b667-144">**Getschema （)**</span><span class="sxs-lookup"><span data-stu-id="3b667-144">**GetSchema()**</span></span>|<span data-ttu-id="3b667-145">取得探索到的 SAP 資料表清單。</span><span class="sxs-lookup"><span data-stu-id="3b667-145">Gets the list of discovered SAP tables.</span></span> <span data-ttu-id="3b667-146">所有探索到的資料表都是在 XML 檔案 SAPDiscoveredObjects.xml。</span><span class="sxs-lookup"><span data-stu-id="3b667-146">All discovered tables are available in an XML file SAPDiscoveredObjects.xml.</span></span> <span data-ttu-id="3b667-147">檔案是位於\<安裝磁碟機\>: \Program Files\Common Files\Microsoft Shared\Adapters\SAP。</span><span class="sxs-lookup"><span data-stu-id="3b667-147">The file is located at \<installation drive\>:\Program Files\Common Files\Microsoft Shared\Adapters\SAP.</span></span>|  
|<span data-ttu-id="3b667-148">**GetSchema(string)**</span><span class="sxs-lookup"><span data-stu-id="3b667-148">**GetSchema(string)**</span></span>|<span data-ttu-id="3b667-149">取得結構描述集合名稱為基礎。</span><span class="sxs-lookup"><span data-stu-id="3b667-149">Gets schema based on collection name.</span></span> <span data-ttu-id="3b667-150">支援集合名稱"Tables"。</span><span class="sxs-lookup"><span data-stu-id="3b667-150">Supports the collection name “Tables”.</span></span>|  
  
|<span data-ttu-id="3b667-151">名稱</span><span class="sxs-lookup"><span data-stu-id="3b667-151">Name</span></span>|<span data-ttu-id="3b667-152">Description</span><span class="sxs-lookup"><span data-stu-id="3b667-152">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="3b667-153">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="3b667-153">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="3b667-154">取得結構描述為基礎的集合名稱和限制。</span><span class="sxs-lookup"><span data-stu-id="3b667-154">Gets schema based on the collection name and restrictions.</span></span> <span data-ttu-id="3b667-155">下表表示的集合名稱和支援的限制：</span><span class="sxs-lookup"><span data-stu-id="3b667-155">The table below represents the collection names and restrictions supported:</span></span>|  
  
|<span data-ttu-id="3b667-156">名稱</span><span class="sxs-lookup"><span data-stu-id="3b667-156">Name</span></span>|<span data-ttu-id="3b667-157">集合名稱</span><span class="sxs-lookup"><span data-stu-id="3b667-157">Collection Name</span></span>|<span data-ttu-id="3b667-158">限制</span><span class="sxs-lookup"><span data-stu-id="3b667-158">Restrictions</span></span>|<span data-ttu-id="3b667-159">Description</span><span class="sxs-lookup"><span data-stu-id="3b667-159">Description</span></span>|  
|----------|---------------------|------------------|-----------------|  
|<span data-ttu-id="3b667-160">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="3b667-160">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="3b667-161">資料表</span><span class="sxs-lookup"><span data-stu-id="3b667-161">Tables</span></span>|-|<span data-ttu-id="3b667-162">探索到的 SAP 資料表清單</span><span class="sxs-lookup"><span data-stu-id="3b667-162">List of discovered SAP Tables</span></span>|  
|<span data-ttu-id="3b667-163">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="3b667-163">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="3b667-164">程序</span><span class="sxs-lookup"><span data-stu-id="3b667-164">Procedures</span></span>|-|<span data-ttu-id="3b667-165">探索到 Rfc 的清單</span><span class="sxs-lookup"><span data-stu-id="3b667-165">List of discovered RFCs</span></span>|  
|<span data-ttu-id="3b667-166">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="3b667-166">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="3b667-167">SearchRFCs</span><span class="sxs-lookup"><span data-stu-id="3b667-167">SearchRFCs</span></span>|<span data-ttu-id="3b667-168">arr [0]: 搜尋 expr</span><span class="sxs-lookup"><span data-stu-id="3b667-168">arr[0]: Search expr</span></span>|<span data-ttu-id="3b667-169">相符 Rfc 的清單</span><span class="sxs-lookup"><span data-stu-id="3b667-169">List of matching RFCs</span></span>|  
|<span data-ttu-id="3b667-170">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="3b667-170">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="3b667-171">ImportParameters</span><span class="sxs-lookup"><span data-stu-id="3b667-171">ImportParameters</span></span>|<span data-ttu-id="3b667-172">arr [1]: RFC 名稱</span><span class="sxs-lookup"><span data-stu-id="3b667-172">arr[1]: RFC name</span></span>|<span data-ttu-id="3b667-173">匯入 RFC 的參數</span><span class="sxs-lookup"><span data-stu-id="3b667-173">Import parameters of RFC</span></span>|  
|<span data-ttu-id="3b667-174">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="3b667-174">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="3b667-175">ImportParameterColumn</span><span class="sxs-lookup"><span data-stu-id="3b667-175">ImportParameterColumn</span></span>|<span data-ttu-id="3b667-176">arr [1]: RFC 名稱</span><span class="sxs-lookup"><span data-stu-id="3b667-176">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="3b667-177">arr [2]: name</span><span class="sxs-lookup"><span data-stu-id="3b667-177">arr[2]: Param name</span></span>|<span data-ttu-id="3b667-178">匯入參數結構描述</span><span class="sxs-lookup"><span data-stu-id="3b667-178">Import parameter schema</span></span>|  
|<span data-ttu-id="3b667-179">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="3b667-179">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="3b667-180">ExportParameters</span><span class="sxs-lookup"><span data-stu-id="3b667-180">ExportParameters</span></span>|<span data-ttu-id="3b667-181">arr [1]: RFC 名稱</span><span class="sxs-lookup"><span data-stu-id="3b667-181">arr[1]: RFC name</span></span>|<span data-ttu-id="3b667-182">匯出 RFC 的參數</span><span class="sxs-lookup"><span data-stu-id="3b667-182">Export parameters of RFC</span></span>|  
|<span data-ttu-id="3b667-183">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="3b667-183">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="3b667-184">ExportParameterColumn</span><span class="sxs-lookup"><span data-stu-id="3b667-184">ExportParameterColumn</span></span>|<span data-ttu-id="3b667-185">arr [1]: RFC 名稱</span><span class="sxs-lookup"><span data-stu-id="3b667-185">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="3b667-186">arr [2]: name</span><span class="sxs-lookup"><span data-stu-id="3b667-186">arr[2]: Param name</span></span>|<span data-ttu-id="3b667-187">匯出參數結構描述</span><span class="sxs-lookup"><span data-stu-id="3b667-187">Export parameter schema</span></span>|  
|<span data-ttu-id="3b667-188">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="3b667-188">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="3b667-189">TableParameters</span><span class="sxs-lookup"><span data-stu-id="3b667-189">TableParameters</span></span>|<span data-ttu-id="3b667-190">arr [1]: RFC 名稱</span><span class="sxs-lookup"><span data-stu-id="3b667-190">arr[1]: RFC name</span></span>|<span data-ttu-id="3b667-191">資料表參數的 RFC</span><span class="sxs-lookup"><span data-stu-id="3b667-191">Table parameters of RFC</span></span>|  
|<span data-ttu-id="3b667-192">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="3b667-192">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="3b667-193">TableParameterColumn</span><span class="sxs-lookup"><span data-stu-id="3b667-193">TableParameterColumn</span></span>|<span data-ttu-id="3b667-194">arr [1]: RFC 名稱</span><span class="sxs-lookup"><span data-stu-id="3b667-194">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="3b667-195">arr [2]: name</span><span class="sxs-lookup"><span data-stu-id="3b667-195">arr[2]: Param name</span></span>|<span data-ttu-id="3b667-196">資料表參數結構描述</span><span class="sxs-lookup"><span data-stu-id="3b667-196">Table parameter schema</span></span>|  
|<span data-ttu-id="3b667-197">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="3b667-197">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="3b667-198">ChangingParameters</span><span class="sxs-lookup"><span data-stu-id="3b667-198">ChangingParameters</span></span>|<span data-ttu-id="3b667-199">arr [1]: RFC 名稱</span><span class="sxs-lookup"><span data-stu-id="3b667-199">arr[1]: RFC name</span></span>|<span data-ttu-id="3b667-200">變更參數的 RFC</span><span class="sxs-lookup"><span data-stu-id="3b667-200">Changing parameters of RFC</span></span>|  
|<span data-ttu-id="3b667-201">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="3b667-201">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="3b667-202">ChangingParameterColumn</span><span class="sxs-lookup"><span data-stu-id="3b667-202">ChangingParameterColumn</span></span>|<span data-ttu-id="3b667-203">arr [1]: RFC 名稱</span><span class="sxs-lookup"><span data-stu-id="3b667-203">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="3b667-204">arr [2]: name</span><span class="sxs-lookup"><span data-stu-id="3b667-204">arr[2]: Param name</span></span>|<span data-ttu-id="3b667-205">變更參數結構描述</span><span class="sxs-lookup"><span data-stu-id="3b667-205">Changing parameter schema</span></span>|  
|<span data-ttu-id="3b667-206">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="3b667-206">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="3b667-207">資料行</span><span class="sxs-lookup"><span data-stu-id="3b667-207">columns</span></span>|<span data-ttu-id="3b667-208">arr [1]: 資料表名稱</span><span class="sxs-lookup"><span data-stu-id="3b667-208">arr[1]: Table name</span></span>|<span data-ttu-id="3b667-209">SAP 資料表資料行的結構描述</span><span class="sxs-lookup"><span data-stu-id="3b667-209">SAP Table column schema</span></span>|  
  
|<span data-ttu-id="3b667-210">名稱</span><span class="sxs-lookup"><span data-stu-id="3b667-210">Name</span></span>|<span data-ttu-id="3b667-211">Description</span><span class="sxs-lookup"><span data-stu-id="3b667-211">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="3b667-212">**Open （)**</span><span class="sxs-lookup"><span data-stu-id="3b667-212">**Open()**</span></span>|<span data-ttu-id="3b667-213">開啟 SAP 連接，根據連接字串。</span><span class="sxs-lookup"><span data-stu-id="3b667-213">Opens an SAP connection based on the connection string.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="3b667-214">除了資料表、 程序和 SearchRFCs 集合項目，其他所有集合項目的您必須都指定 arr [0] 的空值。</span><span class="sxs-lookup"><span data-stu-id="3b667-214">Except for Table, Procedure, and SearchRFCs collection entries, for all other collection entries you must specify a dummy value for arr[0].</span></span>  
  
## <a name="supported-constructors"></a><span data-ttu-id="3b667-215">支援的建構函式</span><span class="sxs-lookup"><span data-stu-id="3b667-215">Supported Constructors</span></span>  
  
|<span data-ttu-id="3b667-216">名稱</span><span class="sxs-lookup"><span data-stu-id="3b667-216">Name</span></span>|<span data-ttu-id="3b667-217">Description</span><span class="sxs-lookup"><span data-stu-id="3b667-217">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="3b667-218">**SAPConnection()**</span><span class="sxs-lookup"><span data-stu-id="3b667-218">**SAPConnection()**</span></span>|<span data-ttu-id="3b667-219">建立 SAPConnection 物件執行個體。</span><span class="sxs-lookup"><span data-stu-id="3b667-219">Creates an SAPConnection object instance.</span></span>|  
|<span data-ttu-id="3b667-220">**SAPConnection(string)**</span><span class="sxs-lookup"><span data-stu-id="3b667-220">**SAPConnection(string)**</span></span>|<span data-ttu-id="3b667-221">接受 SAP 的連線字串。</span><span class="sxs-lookup"><span data-stu-id="3b667-221">Accepts an SAP connection string.</span></span> <span data-ttu-id="3b667-222">如果連接字串無效，會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="3b667-222">Throws an exception if the connection string is invalid.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="3b667-223">請參閱</span><span class="sxs-lookup"><span data-stu-id="3b667-223">See Also</span></span>  
 [<span data-ttu-id="3b667-224">SAP 配接器以延伸的 ADO.NET 介面</span><span class="sxs-lookup"><span data-stu-id="3b667-224">Extend ADO.NET Interfaces with the SAP adapter</span></span>](../../adapters-and-accelerators/adapter-sap/extend-ado-net-interfaces-with-the-sap-adapter.md)