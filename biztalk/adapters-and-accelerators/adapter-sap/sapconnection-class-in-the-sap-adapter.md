---
title: "SAP 配接器在 SAPConnection 類別 |Microsoft 文件"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords: SAPConnection, supported methods, classes, and constructors
ms.assetid: a700602d-8135-4f67-a38b-770357d4e28b
caps.latest.revision: "6"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: b27bb8f88686fe1726aed16113ce227347151996
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
---
# <a name="sapconnection-class-in-the-sap-adapter"></a><span data-ttu-id="2732f-102">SAP 配接器在 SAPConnection 類別</span><span class="sxs-lookup"><span data-stu-id="2732f-102">SAPConnection class in the SAP adapter</span></span>
<span data-ttu-id="2732f-103">下節列出方法和屬性的**SAPConnection**類別。</span><span class="sxs-lookup"><span data-stu-id="2732f-103">The following section lists the methods and properties for the **SAPConnection** class.</span></span> <span data-ttu-id="2732f-104">這代表 ADO.NET 連接到 SAP 應用程式伺服器。</span><span class="sxs-lookup"><span data-stu-id="2732f-104">This represents an ADO.NET connection to the SAP application server.</span></span>  
  
 <span data-ttu-id="2732f-105">這衍生自**System.Data.Common.DbConnection**。</span><span class="sxs-lookup"><span data-stu-id="2732f-105">This is derived from **System.Data.Common.DbConnection**.</span></span>  
  
## <a name="supported-properties"></a><span data-ttu-id="2732f-106">支援的屬性</span><span class="sxs-lookup"><span data-stu-id="2732f-106">Supported Properties</span></span>  
  
|<span data-ttu-id="2732f-107">名稱</span><span class="sxs-lookup"><span data-stu-id="2732f-107">Name</span></span>|<span data-ttu-id="2732f-108">Get/Set</span><span class="sxs-lookup"><span data-stu-id="2732f-108">Get/Set</span></span>|<span data-ttu-id="2732f-109">Description</span><span class="sxs-lookup"><span data-stu-id="2732f-109">Description</span></span>|  
|----------|--------------|-----------------|  
|<span data-ttu-id="2732f-110">**連接字串**</span><span class="sxs-lookup"><span data-stu-id="2732f-110">**ConnectionString**</span></span>|<span data-ttu-id="2732f-111">取得和設定</span><span class="sxs-lookup"><span data-stu-id="2732f-111">Get and Set</span></span>|<span data-ttu-id="2732f-112">請參閱[閱讀 SAP 連接字串的資料提供者類型](../../adapters-and-accelerators/adapter-sap/read-about-data-provider-types-for-the-sap-connection-string.md)。</span><span class="sxs-lookup"><span data-stu-id="2732f-112">See [Read about Data Provider types for the SAP Connection String](../../adapters-and-accelerators/adapter-sap/read-about-data-provider-types-for-the-sap-connection-string.md).</span></span>|  
|<span data-ttu-id="2732f-113">**ConnectionTimeout**</span><span class="sxs-lookup"><span data-stu-id="2732f-113">**ConnectionTimeout**</span></span>|<span data-ttu-id="2732f-114">Get</span><span class="sxs-lookup"><span data-stu-id="2732f-114">Get</span></span>|<span data-ttu-id="2732f-115">不支援。</span><span class="sxs-lookup"><span data-stu-id="2732f-115">Not supported.</span></span> <span data-ttu-id="2732f-116">傳回 0。</span><span class="sxs-lookup"><span data-stu-id="2732f-116">Returns 0.</span></span>|  
|<span data-ttu-id="2732f-117">**資料庫**</span><span class="sxs-lookup"><span data-stu-id="2732f-117">**Database**</span></span>|<span data-ttu-id="2732f-118">Get</span><span class="sxs-lookup"><span data-stu-id="2732f-118">Get</span></span>|<span data-ttu-id="2732f-119">SAP 系統的識別碼。</span><span class="sxs-lookup"><span data-stu-id="2732f-119">SAP System ID.</span></span>|  
|<span data-ttu-id="2732f-120">**DataSource**</span><span class="sxs-lookup"><span data-stu-id="2732f-120">**DataSource**</span></span>|<span data-ttu-id="2732f-121">Get</span><span class="sxs-lookup"><span data-stu-id="2732f-121">Get</span></span>|<span data-ttu-id="2732f-122">這會傳回 SAP 應用程式伺服器主機的名稱。</span><span class="sxs-lookup"><span data-stu-id="2732f-122">This returns the name of the SAP application server host.</span></span>|  
|<span data-ttu-id="2732f-123">**ServerVersion**</span><span class="sxs-lookup"><span data-stu-id="2732f-123">**ServerVersion**</span></span>|<span data-ttu-id="2732f-124">Get</span><span class="sxs-lookup"><span data-stu-id="2732f-124">Get</span></span>|<span data-ttu-id="2732f-125">這會顯示 SAP 執行個體而非 SAP 伺服器版本的版次的號碼。</span><span class="sxs-lookup"><span data-stu-id="2732f-125">This shows the release number for the SAP instance and not the SAP Server version.</span></span> <span data-ttu-id="2732f-126">例如，如果 ADO.NET 用戶端與執行個體的版次號碼 620 連接到 SAP 伺服器版本 4.6，這個屬性會顯示 620。</span><span class="sxs-lookup"><span data-stu-id="2732f-126">For example, if the ADO.NET client is connecting to SAP Server version 4.6 with the instance release number 620, this property will display 620.</span></span>|  
|<span data-ttu-id="2732f-127">**State**</span><span class="sxs-lookup"><span data-stu-id="2732f-127">**State**</span></span>|<span data-ttu-id="2732f-128">Get</span><span class="sxs-lookup"><span data-stu-id="2732f-128">Get</span></span>|<span data-ttu-id="2732f-129">連線狀態。</span><span class="sxs-lookup"><span data-stu-id="2732f-129">Connection state.</span></span> <span data-ttu-id="2732f-130">支援的狀態為：</span><span class="sxs-lookup"><span data-stu-id="2732f-130">The supported states are:</span></span><br /><br /> <span data-ttu-id="2732f-131">-[System.Data.ConnectionState]</span><span class="sxs-lookup"><span data-stu-id="2732f-131">- [System.Data.ConnectionState]</span></span><br /><br /> <span data-ttu-id="2732f-132">關閉</span><span class="sxs-lookup"><span data-stu-id="2732f-132">- Closed</span></span><br /><br /> <span data-ttu-id="2732f-133">-開啟</span><span class="sxs-lookup"><span data-stu-id="2732f-133">- Open</span></span><br /><br /> <span data-ttu-id="2732f-134">連線</span><span class="sxs-lookup"><span data-stu-id="2732f-134">- Connecting</span></span>|  
  
## <a name="supported-methods"></a><span data-ttu-id="2732f-135">支援的方法</span><span class="sxs-lookup"><span data-stu-id="2732f-135">Supported Methods</span></span>  
  
|<span data-ttu-id="2732f-136">名稱</span><span class="sxs-lookup"><span data-stu-id="2732f-136">Name</span></span>|<span data-ttu-id="2732f-137">Description</span><span class="sxs-lookup"><span data-stu-id="2732f-137">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="2732f-138">**ChangeDatabase(string)**</span><span class="sxs-lookup"><span data-stu-id="2732f-138">**ChangeDatabase(string)**</span></span>|<span data-ttu-id="2732f-139">不支援。</span><span class="sxs-lookup"><span data-stu-id="2732f-139">Not supported.</span></span>|  
|<span data-ttu-id="2732f-140">**Close （)**</span><span class="sxs-lookup"><span data-stu-id="2732f-140">**Close()**</span></span>|<span data-ttu-id="2732f-141">關閉 SAP 系統的連接。</span><span class="sxs-lookup"><span data-stu-id="2732f-141">Closes the connection to the SAP system.</span></span>|  
|<span data-ttu-id="2732f-142">**CreateCommand()**</span><span class="sxs-lookup"><span data-stu-id="2732f-142">**CreateCommand()**</span></span>|<span data-ttu-id="2732f-143">傳回新的 SAPCommand 這個連接相關聯。</span><span class="sxs-lookup"><span data-stu-id="2732f-143">Returns a new SAPCommand associated with this connection.</span></span>|  
|<span data-ttu-id="2732f-144">**Getschema （)**</span><span class="sxs-lookup"><span data-stu-id="2732f-144">**GetSchema()**</span></span>|<span data-ttu-id="2732f-145">取得探索到的 SAP 資料表清單。</span><span class="sxs-lookup"><span data-stu-id="2732f-145">Gets the list of discovered SAP tables.</span></span> <span data-ttu-id="2732f-146">所有探索到的資料表都是在 XML 檔案 SAPDiscoveredObjects.xml。</span><span class="sxs-lookup"><span data-stu-id="2732f-146">All discovered tables are available in an XML file SAPDiscoveredObjects.xml.</span></span> <span data-ttu-id="2732f-147">檔案是位於\<安裝磁碟機 >: \Program Files\Common Files\Microsoft Shared\Adapters\SAP。</span><span class="sxs-lookup"><span data-stu-id="2732f-147">The file is located at \<installation drive>:\Program Files\Common Files\Microsoft Shared\Adapters\SAP.</span></span>|  
|<span data-ttu-id="2732f-148">**GetSchema(string)**</span><span class="sxs-lookup"><span data-stu-id="2732f-148">**GetSchema(string)**</span></span>|<span data-ttu-id="2732f-149">取得結構描述集合名稱為基礎。</span><span class="sxs-lookup"><span data-stu-id="2732f-149">Gets schema based on collection name.</span></span> <span data-ttu-id="2732f-150">支援集合名稱"Tables"。</span><span class="sxs-lookup"><span data-stu-id="2732f-150">Supports the collection name “Tables”.</span></span>|  
  
|<span data-ttu-id="2732f-151">名稱</span><span class="sxs-lookup"><span data-stu-id="2732f-151">Name</span></span>|<span data-ttu-id="2732f-152">Description</span><span class="sxs-lookup"><span data-stu-id="2732f-152">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="2732f-153">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="2732f-153">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="2732f-154">取得結構描述為基礎的集合名稱和限制。</span><span class="sxs-lookup"><span data-stu-id="2732f-154">Gets schema based on the collection name and restrictions.</span></span> <span data-ttu-id="2732f-155">下表表示的集合名稱和支援的限制：</span><span class="sxs-lookup"><span data-stu-id="2732f-155">The table below represents the collection names and restrictions supported:</span></span>|  
  
|<span data-ttu-id="2732f-156">名稱</span><span class="sxs-lookup"><span data-stu-id="2732f-156">Name</span></span>|<span data-ttu-id="2732f-157">集合名稱</span><span class="sxs-lookup"><span data-stu-id="2732f-157">Collection Name</span></span>|<span data-ttu-id="2732f-158">限制</span><span class="sxs-lookup"><span data-stu-id="2732f-158">Restrictions</span></span>|<span data-ttu-id="2732f-159">Description</span><span class="sxs-lookup"><span data-stu-id="2732f-159">Description</span></span>|  
|----------|---------------------|------------------|-----------------|  
|<span data-ttu-id="2732f-160">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="2732f-160">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="2732f-161">資料表</span><span class="sxs-lookup"><span data-stu-id="2732f-161">Tables</span></span>|-|<span data-ttu-id="2732f-162">探索到的 SAP 資料表清單</span><span class="sxs-lookup"><span data-stu-id="2732f-162">List of discovered SAP Tables</span></span>|  
|<span data-ttu-id="2732f-163">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="2732f-163">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="2732f-164">程序</span><span class="sxs-lookup"><span data-stu-id="2732f-164">Procedures</span></span>|-|<span data-ttu-id="2732f-165">探索到 Rfc 的清單</span><span class="sxs-lookup"><span data-stu-id="2732f-165">List of discovered RFCs</span></span>|  
|<span data-ttu-id="2732f-166">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="2732f-166">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="2732f-167">SearchRFCs</span><span class="sxs-lookup"><span data-stu-id="2732f-167">SearchRFCs</span></span>|<span data-ttu-id="2732f-168">arr [0]: 搜尋 expr</span><span class="sxs-lookup"><span data-stu-id="2732f-168">arr[0]: Search expr</span></span>|<span data-ttu-id="2732f-169">相符 Rfc 的清單</span><span class="sxs-lookup"><span data-stu-id="2732f-169">List of matching RFCs</span></span>|  
|<span data-ttu-id="2732f-170">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="2732f-170">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="2732f-171">ImportParameters</span><span class="sxs-lookup"><span data-stu-id="2732f-171">ImportParameters</span></span>|<span data-ttu-id="2732f-172">arr [1]: RFC 名稱</span><span class="sxs-lookup"><span data-stu-id="2732f-172">arr[1]: RFC name</span></span>|<span data-ttu-id="2732f-173">匯入 RFC 的參數</span><span class="sxs-lookup"><span data-stu-id="2732f-173">Import parameters of RFC</span></span>|  
|<span data-ttu-id="2732f-174">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="2732f-174">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="2732f-175">ImportParameterColumn</span><span class="sxs-lookup"><span data-stu-id="2732f-175">ImportParameterColumn</span></span>|<span data-ttu-id="2732f-176">arr [1]: RFC 名稱</span><span class="sxs-lookup"><span data-stu-id="2732f-176">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="2732f-177">arr [2]: name</span><span class="sxs-lookup"><span data-stu-id="2732f-177">arr[2]: Param name</span></span>|<span data-ttu-id="2732f-178">匯入參數結構描述</span><span class="sxs-lookup"><span data-stu-id="2732f-178">Import parameter schema</span></span>|  
|<span data-ttu-id="2732f-179">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="2732f-179">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="2732f-180">ExportParameters</span><span class="sxs-lookup"><span data-stu-id="2732f-180">ExportParameters</span></span>|<span data-ttu-id="2732f-181">arr [1]: RFC 名稱</span><span class="sxs-lookup"><span data-stu-id="2732f-181">arr[1]: RFC name</span></span>|<span data-ttu-id="2732f-182">匯出 RFC 的參數</span><span class="sxs-lookup"><span data-stu-id="2732f-182">Export parameters of RFC</span></span>|  
|<span data-ttu-id="2732f-183">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="2732f-183">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="2732f-184">ExportParameterColumn</span><span class="sxs-lookup"><span data-stu-id="2732f-184">ExportParameterColumn</span></span>|<span data-ttu-id="2732f-185">arr [1]: RFC 名稱</span><span class="sxs-lookup"><span data-stu-id="2732f-185">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="2732f-186">arr [2]: name</span><span class="sxs-lookup"><span data-stu-id="2732f-186">arr[2]: Param name</span></span>|<span data-ttu-id="2732f-187">匯出參數結構描述</span><span class="sxs-lookup"><span data-stu-id="2732f-187">Export parameter schema</span></span>|  
|<span data-ttu-id="2732f-188">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="2732f-188">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="2732f-189">TableParameters</span><span class="sxs-lookup"><span data-stu-id="2732f-189">TableParameters</span></span>|<span data-ttu-id="2732f-190">arr [1]: RFC 名稱</span><span class="sxs-lookup"><span data-stu-id="2732f-190">arr[1]: RFC name</span></span>|<span data-ttu-id="2732f-191">資料表參數的 RFC</span><span class="sxs-lookup"><span data-stu-id="2732f-191">Table parameters of RFC</span></span>|  
|<span data-ttu-id="2732f-192">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="2732f-192">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="2732f-193">TableParameterColumn</span><span class="sxs-lookup"><span data-stu-id="2732f-193">TableParameterColumn</span></span>|<span data-ttu-id="2732f-194">arr [1]: RFC 名稱</span><span class="sxs-lookup"><span data-stu-id="2732f-194">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="2732f-195">arr [2]: name</span><span class="sxs-lookup"><span data-stu-id="2732f-195">arr[2]: Param name</span></span>|<span data-ttu-id="2732f-196">資料表參數結構描述</span><span class="sxs-lookup"><span data-stu-id="2732f-196">Table parameter schema</span></span>|  
|<span data-ttu-id="2732f-197">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="2732f-197">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="2732f-198">ChangingParameters</span><span class="sxs-lookup"><span data-stu-id="2732f-198">ChangingParameters</span></span>|<span data-ttu-id="2732f-199">arr [1]: RFC 名稱</span><span class="sxs-lookup"><span data-stu-id="2732f-199">arr[1]: RFC name</span></span>|<span data-ttu-id="2732f-200">變更參數的 RFC</span><span class="sxs-lookup"><span data-stu-id="2732f-200">Changing parameters of RFC</span></span>|  
|<span data-ttu-id="2732f-201">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="2732f-201">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="2732f-202">ChangingParameterColumn</span><span class="sxs-lookup"><span data-stu-id="2732f-202">ChangingParameterColumn</span></span>|<span data-ttu-id="2732f-203">arr [1]: RFC 名稱</span><span class="sxs-lookup"><span data-stu-id="2732f-203">arr[1]: RFC name</span></span><br /><br /> <span data-ttu-id="2732f-204">arr [2]: name</span><span class="sxs-lookup"><span data-stu-id="2732f-204">arr[2]: Param name</span></span>|<span data-ttu-id="2732f-205">變更參數結構描述</span><span class="sxs-lookup"><span data-stu-id="2732f-205">Changing parameter schema</span></span>|  
|<span data-ttu-id="2732f-206">**GetSchema （string，耗費**</span><span class="sxs-lookup"><span data-stu-id="2732f-206">**GetSchema(string, string[])**</span></span>|<span data-ttu-id="2732f-207">資料行</span><span class="sxs-lookup"><span data-stu-id="2732f-207">columns</span></span>|<span data-ttu-id="2732f-208">arr [1]: 資料表名稱</span><span class="sxs-lookup"><span data-stu-id="2732f-208">arr[1]: Table name</span></span>|<span data-ttu-id="2732f-209">SAP 資料表資料行的結構描述</span><span class="sxs-lookup"><span data-stu-id="2732f-209">SAP Table column schema</span></span>|  
  
|<span data-ttu-id="2732f-210">名稱</span><span class="sxs-lookup"><span data-stu-id="2732f-210">Name</span></span>|<span data-ttu-id="2732f-211">Description</span><span class="sxs-lookup"><span data-stu-id="2732f-211">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="2732f-212">**Open （)**</span><span class="sxs-lookup"><span data-stu-id="2732f-212">**Open()**</span></span>|<span data-ttu-id="2732f-213">開啟 SAP 連接，根據連接字串。</span><span class="sxs-lookup"><span data-stu-id="2732f-213">Opens an SAP connection based on the connection string.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="2732f-214">除了資料表、 程序和 SearchRFCs 集合項目，其他所有集合項目的您必須都指定 arr [0] 的空值。</span><span class="sxs-lookup"><span data-stu-id="2732f-214">Except for Table, Procedure, and SearchRFCs collection entries, for all other collection entries you must specify a dummy value for arr[0].</span></span>  
  
## <a name="supported-constructors"></a><span data-ttu-id="2732f-215">支援的建構函式</span><span class="sxs-lookup"><span data-stu-id="2732f-215">Supported Constructors</span></span>  
  
|<span data-ttu-id="2732f-216">名稱</span><span class="sxs-lookup"><span data-stu-id="2732f-216">Name</span></span>|<span data-ttu-id="2732f-217">Description</span><span class="sxs-lookup"><span data-stu-id="2732f-217">Description</span></span>|  
|----------|-----------------|  
|<span data-ttu-id="2732f-218">**SAPConnection()**</span><span class="sxs-lookup"><span data-stu-id="2732f-218">**SAPConnection()**</span></span>|<span data-ttu-id="2732f-219">建立 SAPConnection 物件執行個體。</span><span class="sxs-lookup"><span data-stu-id="2732f-219">Creates an SAPConnection object instance.</span></span>|  
|<span data-ttu-id="2732f-220">**SAPConnection(string)**</span><span class="sxs-lookup"><span data-stu-id="2732f-220">**SAPConnection(string)**</span></span>|<span data-ttu-id="2732f-221">接受 SAP 的連線字串。</span><span class="sxs-lookup"><span data-stu-id="2732f-221">Accepts an SAP connection string.</span></span> <span data-ttu-id="2732f-222">如果連接字串無效，會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="2732f-222">Throws an exception if the connection string is invalid.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="2732f-223">另請參閱</span><span class="sxs-lookup"><span data-stu-id="2732f-223">See Also</span></span>  
 [<span data-ttu-id="2732f-224">SAP 配接器以延伸的 ADO.NET 介面</span><span class="sxs-lookup"><span data-stu-id="2732f-224">Extend ADO.NET Interfaces with the SAP adapter</span></span>](../../adapters-and-accelerators/adapter-sap/extend-ado-net-interfaces-with-the-sap-adapter.md)