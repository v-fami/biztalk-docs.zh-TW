---
title: FRR 處理 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- FRR, processing
- FRR, components
- FRR, process flow
ms.assetid: 8b064d18-5ee7-44fd-95d1-9a0d66f1ad1a
caps.latest.revision: 3
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 30c343d214a97895e90bae2bc3a041180c0cc8e3
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "36987007"
---
# <a name="frr-processing"></a><span data-ttu-id="b7eba-102">FRR 處理</span><span class="sxs-lookup"><span data-stu-id="b7eba-102">FRR Processing</span></span>
<span data-ttu-id="b7eba-103">[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] FIN 回應對帳 (FRR) 功能與原始訊息相互關聯 FIN 訊息從 SWIFT Alliance 存取 (SAA) [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] SAA 訊息回應。</span><span class="sxs-lookup"><span data-stu-id="b7eba-103">The [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] FIN Response Reconciliation (FRR) feature correlates FIN messages from the SWIFT Alliance Access (SAA) with the original message from [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] that the SAA message responds to.</span></span> <span data-ttu-id="b7eba-104">每當[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]傳送原始訊息時，FRR 快取任何 SWIFT 和繫結的訊息副本不處理失敗。</span><span class="sxs-lookup"><span data-stu-id="b7eba-104">Whenever [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] sends an original message, FRR caches a copy of any message that is bound for SWIFT and that has not failed processing.</span></span> <span data-ttu-id="b7eba-105">然後它會監視 SAA 至所傳回的回應訊息的 MessageBox [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]，並挑選對應至快取的訊息複本的任何通知/NAK 訊息。</span><span class="sxs-lookup"><span data-stu-id="b7eba-105">It then monitors the MessageBox for response messages returned by SAA to [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)], and picks up any ACK/NAK messages that corresponds to the cached message copy.</span></span>  

 <span data-ttu-id="b7eba-106">FRR 會藉由比較相互關聯識別碼屬性來建立外寄訊息和內送訊息之間的相互關聯。</span><span class="sxs-lookup"><span data-stu-id="b7eba-106">FRR establishes a correlation between an outgoing message and an incoming message by comparing correlation ID properties.</span></span> <span data-ttu-id="b7eba-107">FRR 設定根據回應的本質，原始訊息的複本的升級的屬性，然後將原始訊息路由傳送至 MessageBox 做進一步處理。</span><span class="sxs-lookup"><span data-stu-id="b7eba-107">FRR sets promoted properties of the copy of the original message according to the nature of the response, and then routes the original message to the MessageBox for further processing.</span></span>  

## <a name="frr-components"></a><span data-ttu-id="b7eba-108">FRR 元件</span><span class="sxs-lookup"><span data-stu-id="b7eba-108">FRR Components</span></span>  
 <span data-ttu-id="b7eba-109">FRR 包括進行中的程序 （協調流程） 來監視傳出和傳入訊息，並為每個傳出或傳入的訊息，將它用來進行比較的識別屬性升級。</span><span class="sxs-lookup"><span data-stu-id="b7eba-109">FRR includes an ongoing process (orchestration) that monitors outgoing and incoming messages, and for each outgoing or incoming message, promotes the identification properties that it will use for comparison.</span></span> <span data-ttu-id="b7eba-110">一系列[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]FRR 協調流程中，將訊息內的 FRR 元件之間路由搭配運作的元件[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]，和之間[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]和 SAA。</span><span class="sxs-lookup"><span data-stu-id="b7eba-110">A series of [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] components work together with the FRR orchestration, routing messages between the FRR components within [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)], and between [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] and SAA.</span></span> <span data-ttu-id="b7eba-111">以下列出這些元件：</span><span class="sxs-lookup"><span data-stu-id="b7eba-111">These components are listed below:</span></span>  

- <span data-ttu-id="b7eba-112">FRR 接收來自後端應用程式接收原始訊息的位置。</span><span class="sxs-lookup"><span data-stu-id="b7eba-112">An FRR receive location that receives the original message from the back-end application.</span></span>  

- <span data-ttu-id="b7eba-113">FRR 協調流程會監視傳出和傳入訊息，並建立它們之間的相互關聯。</span><span class="sxs-lookup"><span data-stu-id="b7eba-113">The FRR orchestration that monitors outgoing and incoming messages, and establishes the correlation between them.</span></span>  

- <span data-ttu-id="b7eba-114">FRR 傳送埠傳送原始訊息[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]SAA 到。</span><span class="sxs-lookup"><span data-stu-id="b7eba-114">An FRR send port that sends the original message from [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] to SAA.</span></span>  

- <span data-ttu-id="b7eba-115">BizTalk Adapter for MQSeries 可之間的資料傳輸[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]和 SAA （這會使用 MQSeries 佇列）。</span><span class="sxs-lookup"><span data-stu-id="b7eba-115">The BizTalk Adapter for MQSeries that enables data transmission between [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] and SAA (which uses MQSeries queues).</span></span>  

- <span data-ttu-id="b7eba-116">FRR 接收位置，接收來自 SAA FIN 回應訊息。</span><span class="sxs-lookup"><span data-stu-id="b7eba-116">An FRR receive location that receives FIN response messages from SAA.</span></span>  

- <span data-ttu-id="b7eba-117">FRR 傳送埠，其中每個傳送相互關聯的訊息，從特定類型的一組[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]至後端應用程式的自訂處理。</span><span class="sxs-lookup"><span data-stu-id="b7eba-117">A set of FRR send ports, each of which sends correlated messages of a specific type from [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] to a back-end application for custom processing.</span></span>  

  <span data-ttu-id="b7eba-118">上述的元件，您可以新增後端的自訂處理常式，以處理升級的屬性，其中已設定 FRR 原始訊息。</span><span class="sxs-lookup"><span data-stu-id="b7eba-118">To the above components, you can add a back-end custom handler that processes the original message the promoted properties of which have been set by FRR.</span></span>  

## <a name="frr-process-flow"></a><span data-ttu-id="b7eba-119">FRR 處理流程</span><span class="sxs-lookup"><span data-stu-id="b7eba-119">FRR Process Flow</span></span>  
 [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]<span data-ttu-id="b7eba-120"> 在下列程序中執行重新調整：</span><span class="sxs-lookup"><span data-stu-id="b7eba-120"> performs the reconciliation in the following process:</span></span>  

1. <span data-ttu-id="b7eba-121">後端應用程式傳送原始訊息的目標[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="b7eba-121">The back-end application routes the original message to [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)].</span></span>  

2. <span data-ttu-id="b7eba-122">FRR 接收位置接收訊息、 處理在相關聯的接收管線中，並將其路由傳送到 BizTalk MessageBox。</span><span class="sxs-lookup"><span data-stu-id="b7eba-122">An FRR receive location receives the message, processes it in the associated receive pipeline, and routes it to the BizTalk MessageBox.</span></span>  

   > [!NOTE]
   >  <span data-ttu-id="b7eba-123">您可以搭配使用 FRR [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] Message Repair 和 New Submission 的功能，或分別。</span><span class="sxs-lookup"><span data-stu-id="b7eba-123">You can use FRR in conjunction with the [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] Message Repair and New Submission feature, or separately.</span></span> <span data-ttu-id="b7eba-124">如果您已安裝訊息修復和新送出，您可以設定在步驟 2 之後的訊息修復系統。</span><span class="sxs-lookup"><span data-stu-id="b7eba-124">If you have installed Message Repair and New Submission, you can configure the system for message repair after step 2.</span></span> <span data-ttu-id="b7eba-125">訊息修復協調流程修復/驗證/核准會將訊息路由至 BizTalk MessageBox 進行後續的 FRR 處理。</span><span class="sxs-lookup"><span data-stu-id="b7eba-125">The message-repair orchestration routes the repaired/verified/approved message back to the BizTalk MessageBox for subsequent FRR processing.</span></span>  

3. <span data-ttu-id="b7eba-126">如果所繫結的 SWIFT MessageBox 中的訊息，而且已通過驗證，[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]啟動 FRR 協調流程執行個體。</span><span class="sxs-lookup"><span data-stu-id="b7eba-126">If the message in the MessageBox is bound for SWIFT and has passed validation, [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] activates an instance of the FRR orchestration.</span></span> <span data-ttu-id="b7eba-127">協調流程會保留外寄訊息的複本。</span><span class="sxs-lookup"><span data-stu-id="b7eba-127">The orchestration keeps a copy of the outgoing message.</span></span> <span data-ttu-id="b7eba-128">它然後等候回應 SAA，因此它會比對任何內送回應外寄訊息處於啟動狀態。</span><span class="sxs-lookup"><span data-stu-id="b7eba-128">It then waits in an activated state for a response from SAA, so it can match the outgoing message to any incoming response.</span></span> <span data-ttu-id="b7eba-129">協調流程的這個執行個體只會處理該特定的外寄訊息和任何相互關聯的回應，該訊息。</span><span class="sxs-lookup"><span data-stu-id="b7eba-129">This instance of the orchestration only processes that specific outgoing message and any correlated responses to that message.</span></span> <span data-ttu-id="b7eba-130">任何其他訊息，即使是相同的型別，是由另一個協調流程執行個體處理。</span><span class="sxs-lookup"><span data-stu-id="b7eba-130">Any other message, even of the same type, is processed by another instance of the orchestration.</span></span>  

4. <span data-ttu-id="b7eba-131">在相同時間[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]啟動 FRR 協調流程執行個體，[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]會將訊息路由至傳送埠將訊息傳送至 SAA。</span><span class="sxs-lookup"><span data-stu-id="b7eba-131">At the same time that [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] activates the FRR orchestration instance, [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)] routes the message to the send port that sends messages to SAA.</span></span> <span data-ttu-id="b7eba-132">傳送管線會升級訊息識別屬性和處理 MQSeries 所需的屬性。</span><span class="sxs-lookup"><span data-stu-id="b7eba-132">The send pipeline promotes a message-identification property and properties required for processing by MQSeries.</span></span> <span data-ttu-id="b7eba-133">然後，將傳送訊息至 BizTalk Adapter for MQSeries。</span><span class="sxs-lookup"><span data-stu-id="b7eba-133">It then sends the message to the BizTalk Adapter for MQSeries.</span></span>  

5. <span data-ttu-id="b7eba-134">BizTalk Adapter for MQSeries 傳輸 SAA 在適當的 MQSeries 佇列的訊息。</span><span class="sxs-lookup"><span data-stu-id="b7eba-134">The BizTalk Adapter for MQSeries transports the message to the appropriate MQSeries queue at SAA.</span></span>  

6. <span data-ttu-id="b7eba-135">SAA 會產生路由直接傳回立即回應[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="b7eba-135">SAA generates an immediate response for routing directly back to [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)].</span></span> <span data-ttu-id="b7eba-136">SAA 然後會將訊息傳送至 SWIFT 網路。</span><span class="sxs-lookup"><span data-stu-id="b7eba-136">SAA then routes the message to the SWIFT Network.</span></span> <span data-ttu-id="b7eba-137">SWIFT 網路會產生其他回應，它會傳送回路由至 SAA [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="b7eba-137">The SWIFT Network generates other responses, which it sends to SAA for routing back to [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)].</span></span> <span data-ttu-id="b7eba-138">SAA 設定 FIN 回應訊息的相互關聯語彙基元屬性的原始訊息的訊息識別碼值。</span><span class="sxs-lookup"><span data-stu-id="b7eba-138">SAA sets the correlation token property for the FIN response message to the message-identification value of the original message.</span></span>  

7. <span data-ttu-id="b7eba-139">透過 BizTalk Adapter for MQSeries FIN 回應傳送給 SAA 傳輸[!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="b7eba-139">SAA transports the FIN response through the BizTalk Adapter for MQSeries back to [!INCLUDE[btaA4SWIFT2.3abbrevnonumber](../../includes/btaa4swift2-3abbrevnonumber-md.md)].</span></span>  

8. <span data-ttu-id="b7eba-140">FRR 接收位置接收回應，然後將路由傳送訊息的 FRR 接收管線處理回應的相互關聯 token。</span><span class="sxs-lookup"><span data-stu-id="b7eba-140">The FRR receive location receives the response and routes the message through the FRR receive pipeline that processes the response's correlation token.</span></span> <span data-ttu-id="b7eba-141">然後，就會將回應 BizTalk MessageBox 中。</span><span class="sxs-lookup"><span data-stu-id="b7eba-141">It then places the response in the BizTalk MessageBox.</span></span>  

9. <span data-ttu-id="b7eba-142">FRR 協調流程執行個體從具有等於原始訊息複本的訊息 ID 屬性的相互關聯權杖在 MessageBox 中挑選出任何訊息。</span><span class="sxs-lookup"><span data-stu-id="b7eba-142">The FRR orchestration instance picks up any message from the MessageBox that has a correlation token equal to the message ID property of the copy of the original message.</span></span>  

10. <span data-ttu-id="b7eba-143">如果此回應指出原始訊息已成功處理由 SAA/SWIFT，FRR 協調流程執行個體設定 A4SWIFT_Failed 升級屬性的原始訊息的複本設為 False，並設定 BTS。作業屬性設為適當的值。</span><span class="sxs-lookup"><span data-stu-id="b7eba-143">If the response indicates that the original message was successfully processed by SAA/SWIFT, the FRR orchestration instance sets the A4SWIFT_Failed promoted property of the copy of the original message to False, and sets the BTS.Operation property to the appropriate value.</span></span>  

11. <span data-ttu-id="b7eba-144">如果原始訊息已無法順利處理 SAA/SWIFT，FRR 協調流程執行個體設定 BTS。作業屬性，以適當的值，並再將修復的訊息指定 A4SWIFT_Failed 設為 True，並將升級的 A4SWIFT_FRRFailedReason 屬性設定為失敗的原因。</span><span class="sxs-lookup"><span data-stu-id="b7eba-144">If the original message was not successfully processed by SAA/SWIFT, the FRR orchestration instance sets the BTS.Operation property to the appropriate value, and then designates the message for repair by setting A4SWIFT_Failed to True and setting the A4SWIFT_FRRFailedReason promoted property to the reason for the failure.</span></span>  

12. <span data-ttu-id="b7eba-145">FRR 協調流程執行個體的回應訊息中，就會捨棄，然後將原始訊息的副本 （使用升級的屬性，指出回應） 路由傳送至 MessageBox。</span><span class="sxs-lookup"><span data-stu-id="b7eba-145">The FRR orchestration instance discards the response message(s), and then routes the copy of the original message (with promoted properties indicating the response) to the MessageBox.</span></span>  

13. <span data-ttu-id="b7eba-146">其中一個的 FRR 傳送埠設定來回應路由到一或多個自訂處理常式拾取的升級屬性的原始訊息的副本。</span><span class="sxs-lookup"><span data-stu-id="b7eba-146">One of the FRR send ports set up to route the responses to one or more custom handlers picks up the copy of the original message with the promoted properties.</span></span>  

14. <span data-ttu-id="b7eba-147">自訂處理常式或處理常式訂閱、 擷取，並處理所需的後端應用程式的原始訊息的副本。</span><span class="sxs-lookup"><span data-stu-id="b7eba-147">The custom handler or handlers subscribes to, retrieves, and processes the copy of the original message as required for the back-end application.</span></span>
