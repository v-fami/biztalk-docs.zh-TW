---
title: 輪詢使用預存程序、 函數或封裝的程序和函式的 Oracle 資料庫 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 6c34843a-d02b-4941-baf6-6bc80b5821ad
caps.latest.revision: 12
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: e63bf6b30de29c18a9424306140804a4cf73c16d
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "37010887"
---
# <a name="poll-oracle-database-using-stored-procedures-functions-or-packaged-procedures-and-functions"></a><span data-ttu-id="d47e0-102">使用預存程序、 函數或封裝的程序和函式的輪詢 Oracle 資料庫</span><span class="sxs-lookup"><span data-stu-id="d47e0-102">Poll Oracle Database Using Stored Procedures, Functions, or Packaged Procedures and Functions</span></span>
<span data-ttu-id="d47e0-103">您可以設定[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]藉由使用預存程序、 函數或封裝的程序和函式會定期輪詢 Oracle 資料庫接收定期的資料變更訊息。</span><span class="sxs-lookup"><span data-stu-id="d47e0-103">You can configure the [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] to receive periodic data-change messages by using stored procedures, functions, or packaged procedures and functions to periodically poll the Oracle database.</span></span> <span data-ttu-id="d47e0-104">您可以指定預存程序、 函數或封裝的程序，並做為輪詢 Oracle 資料庫定期執行配接器的輪詢陳述式。</span><span class="sxs-lookup"><span data-stu-id="d47e0-104">You can specify a stored procedure, function, or packaged procedure and function as a polling statement that the adapter executes periodically to poll the Oracle database.</span></span>  

 <span data-ttu-id="d47e0-105">若要啟用此功能，您必須指定特定繫結屬性上[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="d47e0-105">To enable this, you must specify certain binding properties on the [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)].</span></span> <span data-ttu-id="d47e0-106">您也可以藉由設定修改 POLLINGSTMT 作業的目標命名空間**PollingId**中的連線 URI 屬性。</span><span class="sxs-lookup"><span data-stu-id="d47e0-106">You can also modify the target namespace for the POLLINGSTMT operation by setting the **PollingId** property in the connection URI.</span></span> <span data-ttu-id="d47e0-107">如需詳細資訊，請參閱 <<c0> [ 支援在 Oracle 資料庫接收輪詢為基礎的資料變更訊息](../../adapters-and-accelerators/adapter-oracle-database/support-for-receiving-polling-based-data-changed-messages-in-oracle-database.md)並[在 Oracle 資料庫配接器接收以輪詢為基礎的資料變更訊息](../../adapters-and-accelerators/adapter-oracle-database/receive-polling-based-data-changed-messages-in-oracle-database-adapter.md)。</span><span class="sxs-lookup"><span data-stu-id="d47e0-107">For more information, see [Support for Receiving Polling-based Data-changed Messages in Oracle Database](../../adapters-and-accelerators/adapter-oracle-database/support-for-receiving-polling-based-data-changed-messages-in-oracle-database.md) and [Receive polling-based data-changed messages in Oracle Database adapter](../../adapters-and-accelerators/adapter-oracle-database/receive-polling-based-data-changed-messages-in-oracle-database-adapter.md).</span></span> <span data-ttu-id="d47e0-108">輪詢作業的 SOAP 訊息結構的相關資訊，請參閱[輪詢作業的訊息結構描述](../../adapters-and-accelerators/adapter-oracle-database/message-schemas-for-the-polling-operations2.md)。</span><span class="sxs-lookup"><span data-stu-id="d47e0-108">For information about the structure of the SOAP message for polling operations, see [Message Schemas for the Polling Operations](../../adapters-and-accelerators/adapter-oracle-database/message-schemas-for-the-polling-operations2.md).</span></span>  

## <a name="configuring-a-polling-operation-with-oracle-database-adapter-binding-properties"></a><span data-ttu-id="d47e0-109">使用繫結屬性建立的 Oracle 資料庫配接器設定的輪詢作業</span><span class="sxs-lookup"><span data-stu-id="d47e0-109">Configuring a Polling Operation with Oracle Database Adapter Binding Properties</span></span>  
 <span data-ttu-id="d47e0-110">[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]輪詢查詢和任何後續輪詢 PL/SQL 程式碼區塊在交易內執行。</span><span class="sxs-lookup"><span data-stu-id="d47e0-110">The [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] executes the polling query and any post-poll PL/SQL code block inside a transaction.</span></span> <span data-ttu-id="d47e0-111">下表摘要說明[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]繫結屬性，您用來設定配接器接收資料變更訊息。</span><span class="sxs-lookup"><span data-stu-id="d47e0-111">The following table summarizes the [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] binding properties that you use to configure the adapter to receive data change messages.</span></span> <span data-ttu-id="d47e0-112">您必須指定這些繫結設定 Wcf-custom 或 Wcf-oracledb 時接收屬性中的連接埠[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]管理主控台。</span><span class="sxs-lookup"><span data-stu-id="d47e0-112">You must specify these binding properties while configuring the WCF-Custom or WCF-OracleDB receive port in the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span>  


|         <span data-ttu-id="d47e0-113">繫結屬性</span><span class="sxs-lookup"><span data-stu-id="d47e0-113">Binding Property</span></span>         |                                                                                                                                                                                                                                                                                                                <span data-ttu-id="d47e0-114">描述</span><span class="sxs-lookup"><span data-stu-id="d47e0-114">Description</span></span>                                                                                                                                                                                                                                                                                                                |
|----------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|     <span data-ttu-id="d47e0-115">**InboundOperationType**</span><span class="sxs-lookup"><span data-stu-id="d47e0-115">**InboundOperationType**</span></span>     |                                                                                                                                                                                                                                                               <span data-ttu-id="d47e0-116">指定是否要執行通知的輪詢輸入作業。</span><span class="sxs-lookup"><span data-stu-id="d47e0-116">Specifies whether you want to perform the Polling or Notification inbound operation.</span></span> <span data-ttu-id="d47e0-117">預設值是**輪詢**。</span><span class="sxs-lookup"><span data-stu-id="d47e0-117">Default is **Polling**.</span></span>                                                                                                                                                                                                                                                                |
| <span data-ttu-id="d47e0-118">**PolledDataAvailableStatement**</span><span class="sxs-lookup"><span data-stu-id="d47e0-118">**PolledDataAvailableStatement**</span></span> |                                                                                                                                                                                              <span data-ttu-id="d47e0-119">指定配接器執行，以判斷是否有任何資料可供輪詢 SQL 陳述式。</span><span class="sxs-lookup"><span data-stu-id="d47e0-119">Specifies the SQL statement that the adapter executes to determine whether any data is available for polling.</span></span> <span data-ttu-id="d47e0-120">只有當可用的記錄時，預存程序指定**PollingStatement**屬性繫結將會執行。</span><span class="sxs-lookup"><span data-stu-id="d47e0-120">Only if a record is available, the stored procedure you specified for the **PollingStatement** binding property will be executed.</span></span>                                                                                                                                                                                              |
|       <span data-ttu-id="d47e0-121">**PollingInterval**</span><span class="sxs-lookup"><span data-stu-id="d47e0-121">**PollingInterval**</span></span>        |              <span data-ttu-id="d47e0-122">指定間隔 （秒），此時[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]執行陳述式指定**PolledDataAvailableStatement**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="d47e0-122">Specifies the interval, in seconds, at which the [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] executes the statement specified for the **PolledDataAvailableStatement** binding property.</span></span> <span data-ttu-id="d47e0-123">預設值為 500 的秒數。</span><span class="sxs-lookup"><span data-stu-id="d47e0-123">The default is 500 seconds.</span></span> <span data-ttu-id="d47e0-124">輪詢間隔會決定後續輪詢間隔的時間間隔。</span><span class="sxs-lookup"><span data-stu-id="d47e0-124">The polling interval determines the time interval between successive polls.</span></span> <span data-ttu-id="d47e0-125">如果指定的間隔內執行的陳述式，則配接器會睡剩餘的時間間隔中。</span><span class="sxs-lookup"><span data-stu-id="d47e0-125">If the statement is executed within the specified interval, the adapter sleeps for the remaining time in the interval.</span></span> <span data-ttu-id="d47e0-126">預設值是`SELECT 1 FROM DUAL`，這表示配接器，必須繼續輪詢，無論資料表輪詢是否有資料。</span><span class="sxs-lookup"><span data-stu-id="d47e0-126">The default is `SELECT 1 FROM DUAL`, which implies that the adapter must continue polling irrespective of whether the table being polled has data or not.</span></span>              |
|       <span data-ttu-id="d47e0-127">**PollingStatement**</span><span class="sxs-lookup"><span data-stu-id="d47e0-127">**PollingStatement**</span></span>       | <span data-ttu-id="d47e0-128">指定輪詢陳述式。</span><span class="sxs-lookup"><span data-stu-id="d47e0-128">Specifies the polling statement.</span></span> <span data-ttu-id="d47e0-129">若要使用預存程序、 函數或封裝的程序或函式進行輪詢，您必須指定個別作業的整個要求訊息這個繫結屬性中。</span><span class="sxs-lookup"><span data-stu-id="d47e0-129">To poll using a stored procedure, function, or packaged procedure or function, you must specify the entire request message for the respective operation in this binding property.</span></span> <span data-ttu-id="d47e0-130">要求訊息必須相同，您傳送給配接器，叫用的個別作業，做為輸出的作業。</span><span class="sxs-lookup"><span data-stu-id="d47e0-130">The request message must be the same that you send to the adapter for invoking the respective operations as an outbound operation.</span></span> <span data-ttu-id="d47e0-131">預設值是 null。</span><span class="sxs-lookup"><span data-stu-id="d47e0-131">The default is null.</span></span><br /><br /> <span data-ttu-id="d47e0-132">您必須指定的值**PollingStatement**繫結屬性，來啟用輪詢。</span><span class="sxs-lookup"><span data-stu-id="d47e0-132">You must specify a value for **PollingStatement** binding property to enable polling.</span></span> <span data-ttu-id="d47e0-133">輪詢陳述式在沒有可供輪詢，取決於使用的資料時，才會執行**PolledDataAvailableStatement**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="d47e0-133">The polling statement is executed only if there is data available for polling, which is determined by the **PolledDataAvailableStatement** binding property.</span></span> |
|        <span data-ttu-id="d47e0-134">**PollingAction**</span><span class="sxs-lookup"><span data-stu-id="d47e0-134">**PollingAction**</span></span>         |                                                                                                                                                                                        <span data-ttu-id="d47e0-135">指定輪詢作業的動作。</span><span class="sxs-lookup"><span data-stu-id="d47e0-135">Specifies the action for the polling operation.</span></span> <span data-ttu-id="d47e0-136">您可以判斷特定的作業，從您為作業使用產生的中繼資料的輪詢動作[!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="d47e0-136">You can determine the polling action for a specific operation from the metadata you generate for the operation using the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span></span>                                                                                                                                                                                        |
|      <span data-ttu-id="d47e0-137">**PostPollStatement**</span><span class="sxs-lookup"><span data-stu-id="d47e0-137">**PostPollStatement**</span></span>       |                                                                                                                                                                                                                                                   <span data-ttu-id="d47e0-138">指定執行所指定的陳述式之後的陳述式區塊**PollingStatement**屬性繫結會執行。</span><span class="sxs-lookup"><span data-stu-id="d47e0-138">Specifies a statement block that is executed after the statement specified by the **PollingStatement** binding property is executed.</span></span>                                                                                                                                                                                                                                                    |
|      <span data-ttu-id="d47e0-139">**PollWhileDataFound**</span><span class="sxs-lookup"><span data-stu-id="d47e0-139">**PollWhileDataFound**</span></span>      |                                                                                                                               <span data-ttu-id="d47e0-140">指定是否[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]會忽略的輪詢間隔，並持續執行輪詢陳述式，如果資料可在所輪詢的資料表。</span><span class="sxs-lookup"><span data-stu-id="d47e0-140">Specifies whether the [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] ignores the polling interval and continuously executes the polling statement, if data is available in the table being polled.</span></span> <span data-ttu-id="d47e0-141">如果沒有資料可在資料表中，配接器會還原為執行指定的輪詢間隔輪詢陳述式。</span><span class="sxs-lookup"><span data-stu-id="d47e0-141">If no data is available in the table, the adapter reverts to execute the polling statement at the specified polling interval.</span></span> <span data-ttu-id="d47e0-142">預設值為 false。</span><span class="sxs-lookup"><span data-stu-id="d47e0-142">Default is false.</span></span>                                                                                                                               |

 <span data-ttu-id="d47e0-143">如需這些屬性的更完整說明，請參閱[了解 Oracle 資料庫配接器繫結屬性](../../adapters-and-accelerators/adapter-oracle-database/read-about-the-oracle-database-adapter-binding-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="d47e0-143">For a more complete description of these properties, see [Read about the Oracle Database adapter binding properties](../../adapters-and-accelerators/adapter-oracle-database/read-about-the-oracle-database-adapter-binding-properties.md).</span></span> <span data-ttu-id="d47e0-144">如需完整的說明，如何使用[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]輪詢 Oracle 資料庫，可深入閱讀。</span><span class="sxs-lookup"><span data-stu-id="d47e0-144">For a complete description of how to use the [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] to poll the Oracle database, read further.</span></span>  

## <a name="how-this-topic-demonstrates-polling"></a><span data-ttu-id="d47e0-145">本主題將輪詢的示範</span><span class="sxs-lookup"><span data-stu-id="d47e0-145">How This Topic Demonstrates Polling</span></span>  
 <span data-ttu-id="d47e0-146">本主題示範如何使用預存程序之 Oracle 資料庫可以進行輪詢。</span><span class="sxs-lookup"><span data-stu-id="d47e0-146">This topic demonstrates how you can poll the Oracle database using a stored procedure.</span></span> <span data-ttu-id="d47e0-147">建立 BizTalk 專案，並產生您想要使用輪詢 Oracle 資料庫的預存程序的結構描述。</span><span class="sxs-lookup"><span data-stu-id="d47e0-147">Create a BizTalk project and generate schema for the stored procedure you want to use to poll the Oracle database.</span></span> <span data-ttu-id="d47e0-148">本主題中，我們會使用 GET_ACTIVITYS 預存程序來輪詢 ACCOUNTACTIVITY 資料表。</span><span class="sxs-lookup"><span data-stu-id="d47e0-148">In this topic, we use the GET_ACTIVITYS stored procedure to poll the ACCOUNTACTIVITY table.</span></span> <span data-ttu-id="d47e0-149">這個預存程序可與 ACCOUNT_PKG 封裝 SCOTT 結構描述中。</span><span class="sxs-lookup"><span data-stu-id="d47e0-149">This stored procedure is available with the ACCOUNT_PKG package in the SCOTT schema.</span></span> <span data-ttu-id="d47e0-150">您可以執行 SQL 指令碼隨附的範例，在資料庫中建立這些物件。</span><span class="sxs-lookup"><span data-stu-id="d47e0-150">You can run the SQL scripts provided with the samples to create these objects in the database.</span></span>  

> [!NOTE]
>  <span data-ttu-id="d47e0-151">中這個 ACCOUNTACTIVITY 資料表，其中資料庫資料表建立執行提供的指令碼範例的主題輪詢的協調流程。</span><span class="sxs-lookup"><span data-stu-id="d47e0-151">The orchestration in this topic polls the ACCOUNTACTIVITY table, which is a database table created by running the scripts provided with the samples.</span></span> <span data-ttu-id="d47e0-152">若要輪詢的任何其他表格本主題中所述，您必須執行類似的程序。</span><span class="sxs-lookup"><span data-stu-id="d47e0-152">You must perform similar procedures as described in this topic to poll any other table.</span></span>  

 <span data-ttu-id="d47e0-153">為了示範輪詢作業，我們執行下列作業：</span><span class="sxs-lookup"><span data-stu-id="d47e0-153">To demonstrate a polling operation, we do the following:</span></span>  

-   <span data-ttu-id="d47e0-154">指定的 SELECT 陳述式**PolledDataAvailableStatement**繫結屬性，以判斷其中資料表輪詢 (ACCOUNTACTIVITY) 有任何資料。</span><span class="sxs-lookup"><span data-stu-id="d47e0-154">Specify a SELECT statement for the **PolledDataAvailableStatement** binding property to determine where the table being polled (ACCOUNTACTIVITY) has any data.</span></span> <span data-ttu-id="d47e0-155">在此範例中，您可以設定為這個繫結屬性：</span><span class="sxs-lookup"><span data-stu-id="d47e0-155">In this example, you can set this binding property as:</span></span>  

    ```  
    SELECT COUNT (*) FROM ACCOUNTACTIVITY  
    ```  

     <span data-ttu-id="d47e0-156">這可確保當配接器 ACCOUNTACTIVITY 資料表有一些記錄時，才會執行輪詢陳述式。</span><span class="sxs-lookup"><span data-stu-id="d47e0-156">This ensures that the adapter executes the polling statement only when the ACCOUNTACTIVITY table has some records.</span></span>  

-   <span data-ttu-id="d47e0-157">執行預存程序 GET_ACTIVITYS，藉由提供的要求訊息的一部分**PollingStatement**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="d47e0-157">Execute a stored procedure, GET_ACTIVITYS, by providing the request message as part of the **PollingStatement** binding property.</span></span> <span data-ttu-id="d47e0-158">這個預存程序會擷取 ACCOUNTACTIVITY 資料表中的所有資料列，然後就會從配接器的回應訊息。</span><span class="sxs-lookup"><span data-stu-id="d47e0-158">This stored procedure will retrieve all the rows in the ACCOUNTACTIVITY table and you will get a response message from the adapter.</span></span>  

-   <span data-ttu-id="d47e0-159">執行一部分的 PL/SQL 區塊**PostPollStatement**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="d47e0-159">EXECUTE a PL/SQL block as part of the **PostPollStatement** binding property.</span></span> <span data-ttu-id="d47e0-160">此陳述式會從 ACCOUNTACTIVITY 資料表移動所有資料到資料庫中的另一個資料表。</span><span class="sxs-lookup"><span data-stu-id="d47e0-160">This statement will move all data from ACCOUNTACTIVITY table to another table in the database.</span></span> <span data-ttu-id="d47e0-161">一旦發生這種情況，在下次**PollingStatement**會執行，它不會擷取任何資料，並因此 GET_ACTIVITYS 預存程序會傳回空白的回應訊息。</span><span class="sxs-lookup"><span data-stu-id="d47e0-161">Once this happens, the next time **PollingStatement** will be executed, it will not fetch any data and hence the GET_ACTIVITYS stored procedure will return an empty response message.</span></span>  

-   <span data-ttu-id="d47e0-162">更多資料新增至 ACCOUNTACTIVITY 資料表，直到您將繼續收到空的回應訊息。</span><span class="sxs-lookup"><span data-stu-id="d47e0-162">Until more data is added to the ACCOUNTACTIVITY table, you will continue to get empty response messages.</span></span> <span data-ttu-id="d47e0-163">因此，您必須重新擴展 ACCOUNTACTIVITY 資料表與新的記錄。</span><span class="sxs-lookup"><span data-stu-id="d47e0-163">So, you must repopulate the ACCOUNTACTIVITY table with new records.</span></span> <span data-ttu-id="d47e0-164">您可以執行 more_activity_data.sql 指令碼提供範例來這麼做。</span><span class="sxs-lookup"><span data-stu-id="d47e0-164">You can do so by running the more_activity_data.sql script provided with the samples.</span></span> <span data-ttu-id="d47e0-165">執行此指令碼之後下, 一個輪詢作業會擷取新記錄插入至資料表。</span><span class="sxs-lookup"><span data-stu-id="d47e0-165">After you run this script, the next polling operation will fetch the new records inserted into the table.</span></span>  

## <a name="how-to-receive-data-change-messages-from-oracle"></a><span data-ttu-id="d47e0-166">如何獲得 Oracle 的資料變更訊息</span><span class="sxs-lookup"><span data-stu-id="d47e0-166">How to Receive Data-change Messages from Oracle</span></span>  
 <span data-ttu-id="d47e0-167">使用 Oracle database 上執行運算[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]具有[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]涉及下列程序性工作中所述[開發與 Oracle 資料庫的 BizTalk 應用程式的建置組塊](../../adapters-and-accelerators/adapter-oracle-database/building-blocks-to-develop-biztalk-applications-with-oracle-database.md)。</span><span class="sxs-lookup"><span data-stu-id="d47e0-167">Performing an operation on Oracle database using [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] with [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] involves the following procedural tasks described in [Building Blocks to develop BizTalk Applications with Oracle Database](../../adapters-and-accelerators/adapter-oracle-database/building-blocks-to-develop-biztalk-applications-with-oracle-database.md).</span></span> <span data-ttu-id="d47e0-168">若要設定輪詢使用預存程序的 Oracle 資料庫配接器：</span><span class="sxs-lookup"><span data-stu-id="d47e0-168">To configure the adapter to poll Oracle database using a stored procedure:</span></span>  

1. <span data-ttu-id="d47e0-169">建立 BizTalk 專案，並產生您想要用於輪詢預存程序的結構描述。</span><span class="sxs-lookup"><span data-stu-id="d47e0-169">Create a BizTalk project, and generate schema for the stored procedure you want to use for polling.</span></span>  

2. <span data-ttu-id="d47e0-170">從 Oracle 資料庫接收訊息的 BizTalk 專案中建立訊息。</span><span class="sxs-lookup"><span data-stu-id="d47e0-170">Create a message in the BizTalk project for receiving messages from Oracle database.</span></span>  

3. <span data-ttu-id="d47e0-171">建立協調流程，以從 Oracle 資料庫接收訊息，並將它們儲存到資料夾。</span><span class="sxs-lookup"><span data-stu-id="d47e0-171">Create an orchestration to receive messages from Oracle database and save them to a folder.</span></span>  

4. <span data-ttu-id="d47e0-172">建置和部署 BizTalk 專案。</span><span class="sxs-lookup"><span data-stu-id="d47e0-172">Build and deploy the BizTalk project.</span></span>  

5. <span data-ttu-id="d47e0-173">設定的 BizTalk 應用程式藉由建立實體傳送和接收埠。</span><span class="sxs-lookup"><span data-stu-id="d47e0-173">Configure the BizTalk application by creating physical send and receive ports.</span></span>  

   > [!IMPORTANT]
   >  <span data-ttu-id="d47e0-174">輸入的輪詢案例，您必須一律設定為單向接收埠。</span><span class="sxs-lookup"><span data-stu-id="d47e0-174">For inbound polling scenarios you must always configure a one-way receive port.</span></span> <span data-ttu-id="d47e0-175">雙向接收埠不支援的輸入作業。</span><span class="sxs-lookup"><span data-stu-id="d47e0-175">Two-way receive ports are not supported for inbound operations.</span></span>  

6. <span data-ttu-id="d47e0-176">啟動 BizTalk 應用程式。</span><span class="sxs-lookup"><span data-stu-id="d47e0-176">Start the BizTalk application.</span></span>  

   <span data-ttu-id="d47e0-177">本主題提供執行這些工作的指示。</span><span class="sxs-lookup"><span data-stu-id="d47e0-177">This topic provides instructions to perform these tasks.</span></span>  

## <a name="generating-schema"></a><span data-ttu-id="d47e0-178">產生結構描述</span><span class="sxs-lookup"><span data-stu-id="d47e0-178">Generating Schema</span></span>  
 <span data-ttu-id="d47e0-179">您必須產生 GET_ACTIVITYS 作業的結構描述。</span><span class="sxs-lookup"><span data-stu-id="d47e0-179">You must generate the schema for the GET_ACTIVITYS operation.</span></span> <span data-ttu-id="d47e0-180">執行下列工作時產生結構描述使用[!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="d47e0-180">Perform the following tasks while generating the schema using the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span></span>  

- <span data-ttu-id="d47e0-181">選取合約類型作為**服務 （輸入作業）**。</span><span class="sxs-lookup"><span data-stu-id="d47e0-181">Select the contract type as **Service (Inbound operation)**.</span></span>  

- <span data-ttu-id="d47e0-182">產生結構描述**GET_ACTIVITYS**程序。</span><span class="sxs-lookup"><span data-stu-id="d47e0-182">Generate schema for the **GET_ACTIVITYS** procedure.</span></span>  

  <span data-ttu-id="d47e0-183">如需如何產生結構描述的詳細資訊，請參閱[瀏覽、 搜尋及取得 Oracle 資料庫作業的中繼資料](../../adapters-and-accelerators/adapter-oracle-database/browse-search-and-get-metadata-for-oracle-database-operations.md)。</span><span class="sxs-lookup"><span data-stu-id="d47e0-183">For more information about how to generate schema, see [Browse, search, and get metadata for Oracle Database operations](../../adapters-and-accelerators/adapter-oracle-database/browse-search-and-get-metadata-for-oracle-database-operations.md).</span></span>  

## <a name="defining-messages-and-message-types"></a><span data-ttu-id="d47e0-184">定義訊息和訊息類型</span><span class="sxs-lookup"><span data-stu-id="d47e0-184">Defining Messages and Message Types</span></span>  
 <span data-ttu-id="d47e0-185">您稍早產生的結構描述會描述協調流程中的訊息所需的 「 類型 」。</span><span class="sxs-lookup"><span data-stu-id="d47e0-185">The schema that you generated earlier describes the "types" required for the messages in the orchestration.</span></span> <span data-ttu-id="d47e0-186">訊息通常是一個變數，要為其類型會定義對應的結構。</span><span class="sxs-lookup"><span data-stu-id="d47e0-186">A message is typically a variable, the type for which is defined by the corresponding schema.</span></span> <span data-ttu-id="d47e0-187">一旦產生結構描述時，您必須訊息從 BizTalk 專案的協調流程檢視以將它的連結。</span><span class="sxs-lookup"><span data-stu-id="d47e0-187">Once the schema is generated, you must link it to the messages from the Orchestration view of the BizTalk project.</span></span>  

 <span data-ttu-id="d47e0-188">本主題中，您必須建立一個從 Oracle 接收訊息的訊息。</span><span class="sxs-lookup"><span data-stu-id="d47e0-188">For this topic, you must create one message to receive messages from Oracle.</span></span>  

 <span data-ttu-id="d47e0-189">執行下列步驟來建立訊息，並將它們連結至結構描述。</span><span class="sxs-lookup"><span data-stu-id="d47e0-189">Perform the following steps to create messages and link them to schema.</span></span>  

#### <a name="to-create-messages-and-link-to-schema"></a><span data-ttu-id="d47e0-190">若要建立訊息，並連結至結構描述</span><span class="sxs-lookup"><span data-stu-id="d47e0-190">To create messages and link to schema</span></span>  

1. <span data-ttu-id="d47e0-191">BizTalk 專案中新增協調流程。</span><span class="sxs-lookup"><span data-stu-id="d47e0-191">Add an orchestration to the BizTalk project.</span></span> <span data-ttu-id="d47e0-192">從 [方案總管] 中，以滑鼠右鍵按一下 BizTalk 專案名稱，指向**新增**，然後按一下**新項目**。</span><span class="sxs-lookup"><span data-stu-id="d47e0-192">From the Solution Explorer, right-click the BizTalk project name, point to **Add**, and then click **New Item**.</span></span> <span data-ttu-id="d47e0-193">輸入 BizTalk 協調流程的名稱，然後按一下**新增**。</span><span class="sxs-lookup"><span data-stu-id="d47e0-193">Type a name for the BizTalk orchestration and then click **Add**.</span></span>  

2. <span data-ttu-id="d47e0-194">如果它尚未開啟，請開啟 BizTalk 專案中，[協調流程檢視] 視窗。</span><span class="sxs-lookup"><span data-stu-id="d47e0-194">Open the orchestration view window of the BizTalk project, if it is not already open.</span></span> <span data-ttu-id="d47e0-195">按一下 **檢視**，指向**其他 Windows**，然後按一下**協調流程檢視**。</span><span class="sxs-lookup"><span data-stu-id="d47e0-195">Click **View**, point to **Other Windows**, and then click **Orchestration View**.</span></span>  

3. <span data-ttu-id="d47e0-196">在 **協調流程檢視**，以滑鼠右鍵按一下**訊息**，然後按一下**新訊息**。</span><span class="sxs-lookup"><span data-stu-id="d47e0-196">In the **Orchestration View**, right-click **Messages**, and then click **New Message**.</span></span>  

4. <span data-ttu-id="d47e0-197">以滑鼠右鍵按一下新建立的訊息，然後按**屬性 視窗**。</span><span class="sxs-lookup"><span data-stu-id="d47e0-197">Right-click the newly created message, and then select **Properties Window**.</span></span>  

5. <span data-ttu-id="d47e0-198">在 [**屬性**] 窗格**Message_1**，執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="d47e0-198">In the **Properties** pane for **Message_1**, do the following:</span></span>  

   |<span data-ttu-id="d47e0-199">使用</span><span class="sxs-lookup"><span data-stu-id="d47e0-199">Use this</span></span>|<span data-ttu-id="d47e0-200">以進行此動作</span><span class="sxs-lookup"><span data-stu-id="d47e0-200">To do this</span></span>|  
   |--------------|----------------|  
   |<span data-ttu-id="d47e0-201">識別碼</span><span class="sxs-lookup"><span data-stu-id="d47e0-201">Identifier</span></span>|<span data-ttu-id="d47e0-202">型別**接收**。</span><span class="sxs-lookup"><span data-stu-id="d47e0-202">Type **Receive**.</span></span>|  
   |<span data-ttu-id="d47e0-203">訊息類型</span><span class="sxs-lookup"><span data-stu-id="d47e0-203">Message Type</span></span>|<span data-ttu-id="d47e0-204">從下拉式清單中，依序展開**結構描述**，然後選取*Polling.OracleEBSBindingSchema*，其中*輪詢*是 BizTalk 專案的名稱。</span><span class="sxs-lookup"><span data-stu-id="d47e0-204">From the drop-down list, expand **Schemas**, and select *Polling.OracleEBSBindingSchema*, where *Polling* is the name of your BizTalk project.</span></span> <span data-ttu-id="d47e0-205">*OracleEBSBindingSchema*是針對產生的回應結構描述**GET_ACTIVITYS**預存程序。</span><span class="sxs-lookup"><span data-stu-id="d47e0-205">*OracleEBSBindingSchema* is the response schema generated for the **GET_ACTIVITYS** stored procedure.</span></span><br /><br /> <span data-ttu-id="d47e0-206">**重要事項：** 因為輪詢是單向作業，配接器所產生的結構描述不包含 [回應] 節點中，因此只有一個根節點中沒有結構描述。</span><span class="sxs-lookup"><span data-stu-id="d47e0-206">**Important:** Because polling is a one way operation, the schema generated by the adapter does not contain a response node, and hence there is only one root node in the schema.</span></span> <span data-ttu-id="d47e0-207">如果您使用這類結構描述訊息類型時，您必須識別結構描述所產生的結構描述的檔案名稱。</span><span class="sxs-lookup"><span data-stu-id="d47e0-207">If you use such schemas for a message type, you must identify the schema by the filename of the generated schema.</span></span><br /><br /> <span data-ttu-id="d47e0-208">例如，如果您建立雙向作業的結構描述，結構描述中的節點檔案名稱`OracleEBSBindingSchema`可能看起來像是 「 要求 」 和 「 回應 」。</span><span class="sxs-lookup"><span data-stu-id="d47e0-208">For example, if you create schema for a two-way operation, the nodes in the schema file with a name `OracleEBSBindingSchema` may look like “Request” and “Response”.</span></span> <span data-ttu-id="d47e0-209">如果您想要建立訊息對應至要求結構描述的協調流程中，您可以藉由尋找識別清單中的結構描述`OracleEBSBindingSchema.Request`。</span><span class="sxs-lookup"><span data-stu-id="d47e0-209">If you want to create a message in the orchestration that maps to the request schema, you can identify the schema in the list by looking for `OracleEBSBindingSchema.Request`.</span></span> <span data-ttu-id="d47e0-210">不過，在輪詢作業中，唯一的節點是 「 輪詢 」，因為它並不容易找出您想要對應到，因為未列為單一節點的結構描述的結構描述\<schemafilename\>。\<rootnodename\>。</span><span class="sxs-lookup"><span data-stu-id="d47e0-210">However, in the case of polling operation, because the only node is “Poll”, it is not easy to identify the schema you want to map to because schemas with single nodes are not listed as \<schemafilename\>.\<rootnodename\>.</span></span> <span data-ttu-id="d47e0-211">相反地，這類結構描述會列出依檔案名稱。</span><span class="sxs-lookup"><span data-stu-id="d47e0-211">Instead, such schemas are listed by only the filename.</span></span> <span data-ttu-id="d47e0-212">在此情況下，識別結構描述的唯一方式是依結構描述檔案名稱，例如 OracleEBSBindingSchema。</span><span class="sxs-lookup"><span data-stu-id="d47e0-212">In such a case, the only way to identify the schema is by the schema filename, for example, OracleEBSBindingSchema.</span></span>|  

    <span data-ttu-id="d47e0-213">[!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)] GET_ACTIVITYS 的輸入和輸出作業預存程序會產生結構描述。</span><span class="sxs-lookup"><span data-stu-id="d47e0-213">The [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)] generates schema for both inbound and outbound operations for the GET_ACTIVITYS stored procedure.</span></span> <span data-ttu-id="d47e0-214">您必須輸入作業使用的結構描述：</span><span class="sxs-lookup"><span data-stu-id="d47e0-214">You must use the schema for inbound operation to:</span></span>  

   - <span data-ttu-id="d47e0-215">將協調流程的過程中建立訊息的對應。</span><span class="sxs-lookup"><span data-stu-id="d47e0-215">Map the message created as part of the orchestration.</span></span>  

   - <span data-ttu-id="d47e0-216">若要擷取的動作，您必須指定**PollingAction**執行階段的繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="d47e0-216">To retrieve the action you must specify for the **PollingAction** binding property at run-time.</span></span>  

     <span data-ttu-id="d47e0-217">您必須使用輸出作業的結構描述來取得要求訊息的一部分，您必須指定**PollingStatement**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="d47e0-217">You must use the schema for the outbound operation to get the request message you must specify as part of the **PollingStatement** binding property.</span></span>  

## <a name="setting-up-the-orchestration"></a><span data-ttu-id="d47e0-218">設定協調流程</span><span class="sxs-lookup"><span data-stu-id="d47e0-218">Setting up the Orchestration</span></span>  
 <span data-ttu-id="d47e0-219">您必須建立 BizTalk 協調流程使用[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]從 Oracle 接收以輪詢為基礎的資料變更訊息。</span><span class="sxs-lookup"><span data-stu-id="d47e0-219">You must create a BizTalk orchestration to use [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] for receiving polling-based data-change messages from Oracle.</span></span> <span data-ttu-id="d47e0-220">在此協調流程中，配接器接收的回應中執行預存程序，您必須指定要求訊息的一部分**PollingStatement**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="d47e0-220">In this orchestration, the adapter receives the response by executing the stored procedure for which you specified the request message as part of the **PollingStatement** binding property.</span></span> <span data-ttu-id="d47e0-221">預存程序的回應訊息會儲存至檔案位置。</span><span class="sxs-lookup"><span data-stu-id="d47e0-221">The response message for the stored procedure is saved to a FILE location.</span></span> <span data-ttu-id="d47e0-222">用於輪詢 Oracle 資料庫的一般協調流程會包含：</span><span class="sxs-lookup"><span data-stu-id="d47e0-222">A typical orchestration for polling Oracle database would contain:</span></span>  

- <span data-ttu-id="d47e0-223">接收和傳送圖形，從 Oracle 接收訊息，並分別將傳送至檔案的連接埠。</span><span class="sxs-lookup"><span data-stu-id="d47e0-223">Receive and Send shapes to receive messages from Oracle and send to a FILE port, respectively.</span></span>  

- <span data-ttu-id="d47e0-224">單向接收埠從 Oracle 資料庫接收訊息。</span><span class="sxs-lookup"><span data-stu-id="d47e0-224">A one-way receive port to receive messages from Oracle database.</span></span>  

  > [!IMPORTANT]
  >  <span data-ttu-id="d47e0-225">輸入的輪詢案例，您必須一律設定為單向接收埠。</span><span class="sxs-lookup"><span data-stu-id="d47e0-225">For inbound polling scenarios you must always configure a one-way receive port.</span></span> <span data-ttu-id="d47e0-226">雙向接收埠不支援的輸入作業。</span><span class="sxs-lookup"><span data-stu-id="d47e0-226">Two-way receive ports are not supported for inbound operations.</span></span>  

- <span data-ttu-id="d47e0-227">單向傳送埠以傳送輪詢回應從 Oracle 資料庫。</span><span class="sxs-lookup"><span data-stu-id="d47e0-227">A one-way send port to send polling responses from Oracle database.</span></span>  

  <span data-ttu-id="d47e0-228">範例協調流程如下所示。</span><span class="sxs-lookup"><span data-stu-id="d47e0-228">A sample orchestration resembles the following.</span></span>  

  <span data-ttu-id="d47e0-229">![Oracle 輪詢查詢的協調流程](../../adapters-and-accelerators/adapter-oracle-database/media/6eddfe32-bfd0-4bd9-9e2a-fb4a7d0b53e3.gif "6eddfe32-bfd0-4bd9-9e2a-fb4a7d0b53e3")</span><span class="sxs-lookup"><span data-stu-id="d47e0-229">![Orchestration for a polling query for Oracle](../../adapters-and-accelerators/adapter-oracle-database/media/6eddfe32-bfd0-4bd9-9e2a-fb4a7d0b53e3.gif "6eddfe32-bfd0-4bd9-9e2a-fb4a7d0b53e3")</span></span>  

### <a name="adding-message-shapes"></a><span data-ttu-id="d47e0-230">新增訊息圖形</span><span class="sxs-lookup"><span data-stu-id="d47e0-230">Adding Message Shapes</span></span>  
 <span data-ttu-id="d47e0-231">請確定您針對每個訊息 圖形中指定下列屬性。</span><span class="sxs-lookup"><span data-stu-id="d47e0-231">Make sure you specify the following properties for each of the message shapes.</span></span> <span data-ttu-id="d47e0-232">剛剛提到的協調流程中所示，圖形資料行中所列的名稱會是訊息 圖形的名稱。</span><span class="sxs-lookup"><span data-stu-id="d47e0-232">The names listed in the Shape column are the names of the message shapes as displayed in the just-mentioned orchestration.</span></span>  

|<span data-ttu-id="d47e0-233">形狀圖</span><span class="sxs-lookup"><span data-stu-id="d47e0-233">Shape</span></span>|<span data-ttu-id="d47e0-234">圖形類型</span><span class="sxs-lookup"><span data-stu-id="d47e0-234">Shape Type</span></span>|<span data-ttu-id="d47e0-235">屬性</span><span class="sxs-lookup"><span data-stu-id="d47e0-235">Properties</span></span>|  
|-----------|----------------|----------------|  
|<span data-ttu-id="d47e0-236">ReceiveMessage</span><span class="sxs-lookup"><span data-stu-id="d47e0-236">ReceiveMessage</span></span>|<span data-ttu-id="d47e0-237">Receive</span><span class="sxs-lookup"><span data-stu-id="d47e0-237">Receive</span></span>|<span data-ttu-id="d47e0-238">-設定**名稱**到*ReceiveMessage*</span><span class="sxs-lookup"><span data-stu-id="d47e0-238">- Set **Name** to *ReceiveMessage*</span></span><br /><br /> <span data-ttu-id="d47e0-239">-設定**啟用**到 *，則為 True*</span><span class="sxs-lookup"><span data-stu-id="d47e0-239">- Set **Activate** to *True*</span></span>|  
|<span data-ttu-id="d47e0-240">SaveMessage</span><span class="sxs-lookup"><span data-stu-id="d47e0-240">SaveMessage</span></span>|<span data-ttu-id="d47e0-241">Send</span><span class="sxs-lookup"><span data-stu-id="d47e0-241">Send</span></span>|<span data-ttu-id="d47e0-242">輪詢間隔後，執行配接器再次**PolledDataAvailableStatement**。\*</span><span class="sxs-lookup"><span data-stu-id="d47e0-242">- Set **Name** to *SaveMessage*</span></span>|  

### <a name="adding-ports"></a><span data-ttu-id="d47e0-243">新增連接埠</span><span class="sxs-lookup"><span data-stu-id="d47e0-243">Adding Ports</span></span>  
 <span data-ttu-id="d47e0-244">請確定您針對每個邏輯連接埠中指定下列屬性。</span><span class="sxs-lookup"><span data-stu-id="d47e0-244">Make sure you specify the following properties for each of the logical ports.</span></span> <span data-ttu-id="d47e0-245">協調流程中所示，連接埠資料行中所列的名稱會是連接埠的名稱。</span><span class="sxs-lookup"><span data-stu-id="d47e0-245">The names listed in the Port column are the names of the ports as displayed in the orchestration.</span></span>  

|<span data-ttu-id="d47e0-246">通訊埠</span><span class="sxs-lookup"><span data-stu-id="d47e0-246">Port</span></span>|<span data-ttu-id="d47e0-247">屬性</span><span class="sxs-lookup"><span data-stu-id="d47e0-247">Properties</span></span>|  
|----------|----------------|  
|<span data-ttu-id="d47e0-248">因為 ACCOUNTACTIVITY 資料表沒有記錄現在PolledDataAvailableStatement不會傳回正值，因此配接器不會執行指定的陳述式PollingStatement繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="d47e0-248">OracleReceivePort</span></span>|<span data-ttu-id="d47e0-249">如此一來，配接器用戶端不會取得任何輪詢訊息。\*</span><span class="sxs-lookup"><span data-stu-id="d47e0-249">- Set **Identifier** to *OracleReceivePort*</span></span><br /><br /> <span data-ttu-id="d47e0-250">某些記錄明確插入 ACCOUNTACTIVITY 資料表之前，配接器用戶端不會收到任何其他的輪詢訊息。\*</span><span class="sxs-lookup"><span data-stu-id="d47e0-250">- Set **Type** to *OracleReceivePortType*</span></span><br /><br /> <span data-ttu-id="d47e0-251">-設定**通訊模式**到*單向*</span><span class="sxs-lookup"><span data-stu-id="d47e0-251">- Set **Communication Pattern** to *One-Way*</span></span><br /><br /> <span data-ttu-id="d47e0-252">-設定**通訊方向**到*接收*</span><span class="sxs-lookup"><span data-stu-id="d47e0-252">- Set **Communication Direction** to *Receive*</span></span>|  
|<span data-ttu-id="d47e0-253">SaveMessagePort</span><span class="sxs-lookup"><span data-stu-id="d47e0-253">SaveMessagePort</span></span>|<span data-ttu-id="d47e0-254">-設定**識別碼**到*SaveMessagePort*</span><span class="sxs-lookup"><span data-stu-id="d47e0-254">- Set **Identifier** to *SaveMessagePort*</span></span><br /><br /> <span data-ttu-id="d47e0-255">-設定**型別**到*SaveMessagePortType*</span><span class="sxs-lookup"><span data-stu-id="d47e0-255">- Set **Type** to *SaveMessagePortType*</span></span><br /><br /> <span data-ttu-id="d47e0-256">-設定**通訊模式**到*單向*</span><span class="sxs-lookup"><span data-stu-id="d47e0-256">- Set **Communication Pattern** to *One-Way*</span></span><br /><br /> <span data-ttu-id="d47e0-257">-設定**通訊方向**到*傳送*</span><span class="sxs-lookup"><span data-stu-id="d47e0-257">- Set **Communication Direction** to *Send*</span></span>|  

### <a name="specify-messages-for-action-shapes-and-connect-to-ports"></a><span data-ttu-id="d47e0-258">為動作圖形指定訊息，並連接到連接埠</span><span class="sxs-lookup"><span data-stu-id="d47e0-258">Specify Messages for Action Shapes and Connect to Ports</span></span>  
 <span data-ttu-id="d47e0-259">下表指定的屬性和屬性來指定動作圖形的訊息，以及連結至連接埠的訊息，您應該設定的值。</span><span class="sxs-lookup"><span data-stu-id="d47e0-259">The following table specifies the properties and their values that you should set to specify messages for action shapes and to link the messages to the ports.</span></span> <span data-ttu-id="d47e0-260">先前所述的協調流程中所示，圖形資料行中所列的名稱會是訊息 圖形的名稱。</span><span class="sxs-lookup"><span data-stu-id="d47e0-260">The names listed in the Shape column are the names of the message shapes as displayed in the orchestration mentioned earlier.</span></span>  

|<span data-ttu-id="d47e0-261">形狀圖</span><span class="sxs-lookup"><span data-stu-id="d47e0-261">Shape</span></span>|<span data-ttu-id="d47e0-262">屬性</span><span class="sxs-lookup"><span data-stu-id="d47e0-262">Properties</span></span>|  
|-----------|----------------|  
|<span data-ttu-id="d47e0-263">ReceiveMessage</span><span class="sxs-lookup"><span data-stu-id="d47e0-263">ReceiveMessage</span></span>|<span data-ttu-id="d47e0-264">若要插入多筆記錄，您可以執行 more_activity_data.sql 指令碼提供範例。\*</span><span class="sxs-lookup"><span data-stu-id="d47e0-264">- Set **Message** to *Receive*</span></span><br /><br /> <span data-ttu-id="d47e0-265">在下一次執行此指令碼之後, **PolledDataAvailableStatement**會執行，它會傳回正值。\*</span><span class="sxs-lookup"><span data-stu-id="d47e0-265">- Set **Operation** to *OracleReceivePort.Polling.Request*</span></span>|  
|<span data-ttu-id="d47e0-266">SaveMessage</span><span class="sxs-lookup"><span data-stu-id="d47e0-266">SaveMessage</span></span>|<span data-ttu-id="d47e0-267">若要插入多筆記錄，您可以執行 more_activity_data.sql 指令碼提供範例。\*</span><span class="sxs-lookup"><span data-stu-id="d47e0-267">- Set **Message** to *Receive*</span></span><br /><br /> <span data-ttu-id="d47e0-268">如此一來，配接器執行輪詢陳述式，並再次接收配接器用戶端的輪詢訊息。\*</span><span class="sxs-lookup"><span data-stu-id="d47e0-268">- Set **Operation** to *SaveMessagePort.Polling.Request*</span></span>|  

 <span data-ttu-id="d47e0-269">您指定這些屬性之後，連線的訊息 圖形和連接埠和協調流程已完成。</span><span class="sxs-lookup"><span data-stu-id="d47e0-269">After you have specified these properties, the message shapes and ports are connected and your orchestration is complete.</span></span>  

 <span data-ttu-id="d47e0-270">您現在必須建置 BizTalk 方案，並將其部署至[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="d47e0-270">You must now build the BizTalk solution and deploy it to a [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="d47e0-271">[將繼續輪詢，直到您明確停用接收埠從](../../core/building-and-running-orchestrations.md)管理主控台。</span><span class="sxs-lookup"><span data-stu-id="d47e0-271">For more information, see [Building and Running Orchestrations](../../core/building-and-running-orchestrations.md)).</span></span>  

## <a name="configuring-the-biztalk-application"></a><span data-ttu-id="d47e0-272">設定 BizTalk 應用程式</span><span class="sxs-lookup"><span data-stu-id="d47e0-272">Configuring the BizTalk Application</span></span>  
 <span data-ttu-id="d47e0-273">您已部署的 BizTalk 專案之後，您稍早建立的協調流程會列在下**協調流程**在 BizTalk Server 管理主控台 窗格。</span><span class="sxs-lookup"><span data-stu-id="d47e0-273">After you have deployed the BizTalk project, the orchestration you created earlier is listed under the **Orchestrations** pane in the BizTalk Server Administration console.</span></span> <span data-ttu-id="d47e0-274">您必須使用 BizTalk Server 管理主控台來設定應用程式。</span><span class="sxs-lookup"><span data-stu-id="d47e0-274">You must use the BizTalk Server Administration console to configure the application.</span></span> <span data-ttu-id="d47e0-275">如需逐步解說，請參閱 <<c0> [ 逐步解說： 部署基本 BizTalk 應用程式](Walkthrough:%20Deploying%20a%20Basic%20BizTalk%20Application.md)。</span><span class="sxs-lookup"><span data-stu-id="d47e0-275">For a walkthrough, see [Walkthrough: Deploying a Basic BizTalk Application](Walkthrough:%20Deploying%20a%20Basic%20BizTalk%20Application.md).</span></span>

 <span data-ttu-id="d47e0-276">設定應用程式包含：</span><span class="sxs-lookup"><span data-stu-id="d47e0-276">Configuring an application involves:</span></span>  

- <span data-ttu-id="d47e0-277">選取應用程式主機。</span><span class="sxs-lookup"><span data-stu-id="d47e0-277">Selecting a host for the application.</span></span>  

- <span data-ttu-id="d47e0-278">對應您在您在 BizTalk Server 管理主控台中的實體連接埠的協調流程中建立的連接埠。</span><span class="sxs-lookup"><span data-stu-id="d47e0-278">Mapping the ports that you created in your orchestration to physical ports in the BizTalk Server Administration console.</span></span> <span data-ttu-id="d47e0-279">此協調流程中，您必須：</span><span class="sxs-lookup"><span data-stu-id="d47e0-279">For this orchestration you must:</span></span>  

  - <span data-ttu-id="d47e0-280">一旦產生繫結檔案時，您可以匯入的組態設定從檔案，讓您不需要建立傳送埠和接收相同的協調流程的連接埠。</span><span class="sxs-lookup"><span data-stu-id="d47e0-280">Define a location on the hard disk and a corresponding FILE port where the BizTalk orchestration will drop the messages from Oracle.</span></span> <span data-ttu-id="d47e0-281">這些訊息會以您指定接收埠的輪詢陳述式的回應。</span><span class="sxs-lookup"><span data-stu-id="d47e0-281">These messages will be in response to the polling statement that you specify for the receive port.</span></span>  

  - <span data-ttu-id="d47e0-282">定義實體的 Wcf-custom 或 Wcf-oracledb 單向接收埠。</span><span class="sxs-lookup"><span data-stu-id="d47e0-282">Define a physical WCF-Custom or WCF-OracleDB one-way receive port.</span></span> <span data-ttu-id="d47e0-283">此連接埠會輪詢 Oracle 資料庫。</span><span class="sxs-lookup"><span data-stu-id="d47e0-283">This port polls the Oracle database.</span></span> <span data-ttu-id="d47e0-284">如需如何建立接收埠，請參閱 <<c0> [ 手動設定 Oracle 資料庫配接器的實體連接埠繫結](../../adapters-and-accelerators/adapter-oracle-database/manually-configure-a-physical-port-binding-to-the-oracle-database-adapter.md)。</span><span class="sxs-lookup"><span data-stu-id="d47e0-284">For information about how to create receive ports, see [Manually configure a physical port binding to the Oracle Database Adapter](../../adapters-and-accelerators/adapter-oracle-database/manually-configure-a-physical-port-binding-to-the-oracle-database-adapter.md).</span></span> <span data-ttu-id="d47e0-285">請確定指定接收埠的下列繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="d47e0-285">Make sure you specify the following binding properties for the receive port.</span></span>  


    |         <span data-ttu-id="d47e0-286">繫結屬性</span><span class="sxs-lookup"><span data-stu-id="d47e0-286">Binding Property</span></span>         |                                                                                                                                                                                                                                                                                                                                                       <span data-ttu-id="d47e0-287">ReplTest1</span><span class="sxs-lookup"><span data-stu-id="d47e0-287">Value</span></span>                                                                                                                                                                                                                                                                                                                                                       |
    |----------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    |     <span data-ttu-id="d47e0-288">**InboundOperationType**</span><span class="sxs-lookup"><span data-stu-id="d47e0-288">**InboundOperationType**</span></span>     |                                                                                                                                                                                                                                                                                                                                             <span data-ttu-id="d47e0-289">將此設為**輪詢**。</span><span class="sxs-lookup"><span data-stu-id="d47e0-289">Set this to **Polling**.</span></span>                                                                                                                                                                                                                                                                                                                                              |
    | <span data-ttu-id="d47e0-290">**PolledDataAvailableStatement**</span><span class="sxs-lookup"><span data-stu-id="d47e0-290">**PolledDataAvailableStatement**</span></span> |                                                                                                                                                                                                                                        <span data-ttu-id="d47e0-291">例如，此繫結將屬性設定為：</span><span class="sxs-lookup"><span data-stu-id="d47e0-291">For this example, set this binding property to:</span></span><br /><br /> `SELECT COUNT (*) FROM ACCOUNTACTIVITY`<br /><br /> <span data-ttu-id="d47e0-292">這可確保當配接器 ACCOUNTACTIVITY 資料表有一些記錄時，才會執行輪詢陳述式。</span><span class="sxs-lookup"><span data-stu-id="d47e0-292">This ensures that the adapter executes the polling statement only when the ACCOUNTACTIVITY table has some records.</span></span>                                                                                                                                                                                                                                         |
    |        <span data-ttu-id="d47e0-293">**PollingAction**</span><span class="sxs-lookup"><span data-stu-id="d47e0-293">**PollingAction**</span></span>         |                                                                                                                                                                                                                        <span data-ttu-id="d47e0-294">從產生 GET_ACTIVITYS 程序的輸入訊息的結構描述中擷取輪詢動作。</span><span class="sxs-lookup"><span data-stu-id="d47e0-294">Retrieve the polling action from the schema generated for the inbound message for the GET_ACTIVITYS procedure.</span></span> <span data-ttu-id="d47e0-295">此範例中，此繫結將屬性設定為 **<http://Microsoft.LobServices.OracleDB/2007/03/SCOTT/PollingPackage/> ACCOUNT_PKG/GET_ACTIVITYS**。</span><span class="sxs-lookup"><span data-stu-id="d47e0-295">For this example, set this binding property to **<http://Microsoft.LobServices.OracleDB/2007/03/SCOTT/PollingPackage/> /ACCOUNT_PKG/GET_ACTIVITYS**.</span></span>                                                                                                                                                                                                                        |
    |       <span data-ttu-id="d47e0-296">**PollingStatement**</span><span class="sxs-lookup"><span data-stu-id="d47e0-296">**PollingStatement**</span></span>       | <span data-ttu-id="d47e0-297">為此繫結屬性，指定要叫用 GET_ACTIVITYS 的要求訊息的預存程序。</span><span class="sxs-lookup"><span data-stu-id="d47e0-297">For this binding property, specify the request message to invoke the GET_ACTIVITYS stored procedure.</span></span> <span data-ttu-id="d47e0-298">您可以取得要求訊息結構描述所產生的輸出作業[!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="d47e0-298">You can get the request message from the schema for the outbound operation generated by the [!INCLUDE[consumeadapterservshort](../../includes/consumeadapterservshort-md.md)].</span></span> <span data-ttu-id="d47e0-299">您必須提供整個 XML 訊息做為輸入，這個繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="d47e0-299">You must provide the entire XML message as an input for this binding property.</span></span> <span data-ttu-id="d47e0-300">例如，此繫結將屬性設定為：</span><span class="sxs-lookup"><span data-stu-id="d47e0-300">For this example, set this binding property to:</span></span><br /><br /> `<GET_ACTIVITYS xmlns="http://Microsoft.LobServices.OracleDB/2007/03/SCOTT/Package/ACCOUNT_PKG/GET_ACTIVITY">   <INRECS>OPEN ? FOR SELECT * FROM ACCOUNTACTIVITY</INRECS> </GET_ACTIVITYS>`<br /><br /> <span data-ttu-id="d47e0-301">GET_ACTIVITYS 預存程序會採用輸入的 REF CURSOR，做為參數。</span><span class="sxs-lookup"><span data-stu-id="d47e0-301">The GET_ACTIVITYS stored procedure takes an input REF CURSOR as parameter.</span></span> |
    |      <span data-ttu-id="d47e0-302">**PostPollStatement**</span><span class="sxs-lookup"><span data-stu-id="d47e0-302">**PostPollStatement**</span></span>       |                                                                                                                                                                                                                                                      <span data-ttu-id="d47e0-303">指定後輪詢陳述式，將所有資料從 ACCOUNTACTIVITY 資料表移到另一個資料表。</span><span class="sxs-lookup"><span data-stu-id="d47e0-303">Specify the post-poll statement to move all data from ACCOUNTACTIVITY table to another table.</span></span> <span data-ttu-id="d47e0-304">例如，此繫結將屬性設定為：</span><span class="sxs-lookup"><span data-stu-id="d47e0-304">For this example, set this binding property to:</span></span><br /><br /> `BEGIN ACCOUNT_PKG.PROCESS_ACTIVITY(); END;`                                                                                                                                                                                                                                                       |

     <span data-ttu-id="d47e0-305">如需不同的繫結屬性的詳細資訊，請參閱[了解 Oracle 資料庫配接器繫結屬性](../../adapters-and-accelerators/adapter-oracle-database/read-about-the-oracle-database-adapter-binding-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="d47e0-305">For more information about the different binding properties, see [Read about the Oracle Database adapter binding properties](../../adapters-and-accelerators/adapter-oracle-database/read-about-the-oracle-database-adapter-binding-properties.md).</span></span>  

    > [!NOTE]
    >  <span data-ttu-id="d47e0-306">我們建議您執行使用的輸入的操作時設定的交易隔離等級和交易等待時間[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="d47e0-306">We recommend configuring the transaction isolation level and the transaction timeout while performing inbound operations using the [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)].</span></span> <span data-ttu-id="d47e0-307">您可以藉由設定接收埠時新增的服務行為來這麼做。</span><span class="sxs-lookup"><span data-stu-id="d47e0-307">You can do so by adding the service behavior while configuring the receive port.</span></span> <span data-ttu-id="d47e0-308">如需有關如何新增服務行為的指示，請參閱[設定交易隔離等級和交易等待時間](../../adapters-and-accelerators/adapter-oracle-database/configure-transaction-isolation-level-and-transaction-timeout-with-oracle-db.md)。</span><span class="sxs-lookup"><span data-stu-id="d47e0-308">For instruction on how to add the service behavior, see [Configure transaction isolation level and transaction timeout](../../adapters-and-accelerators/adapter-oracle-database/configure-transaction-isolation-level-and-transaction-timeout-with-oracle-db.md).</span></span>  

## <a name="starting-the-application"></a><span data-ttu-id="d47e0-309">啟動應用程式</span><span class="sxs-lookup"><span data-stu-id="d47e0-309">Starting the Application</span></span>  
 <span data-ttu-id="d47e0-310">您必須啟動 BizTalk 應用程式，用於輪詢 Oracle 資料庫。</span><span class="sxs-lookup"><span data-stu-id="d47e0-310">You must start the BizTalk application for polling Oracle database.</span></span> <span data-ttu-id="d47e0-311">如需有關啟動 BizTalk 應用程式的指示，請參閱[如何啟動協調流程](../../core/how-to-start-an-orchestration.md)。</span><span class="sxs-lookup"><span data-stu-id="d47e0-311">For instructions on starting a BizTalk application, see [How to Start an Orchestration](../../core/how-to-start-an-orchestration.md).</span></span>  

 <span data-ttu-id="d47e0-312">在這個階段，請確定：</span><span class="sxs-lookup"><span data-stu-id="d47e0-312">At this stage, make sure:</span></span>  

-   <span data-ttu-id="d47e0-313">Wcf-custom 或 Wcf-oracledb 單向接收埠，會輪詢 Oracle 使用指定的預存程序**PollingStatement**繫結屬性，正在執行。</span><span class="sxs-lookup"><span data-stu-id="d47e0-313">The WCF-Custom or WCF-OracleDB one-way receive port, which polls Oracle using the stored procedure specified for the **PollingStatement** binding property, is running.</span></span>  

-   <span data-ttu-id="d47e0-314">FILE 傳送埠，會從 Oracle 資料庫接收的訊息，正在執行。</span><span class="sxs-lookup"><span data-stu-id="d47e0-314">The FILE send port, which receives messages from Oracle database, is running.</span></span>  

-   <span data-ttu-id="d47e0-315">BizTalk 協調流程的作業正在執行。</span><span class="sxs-lookup"><span data-stu-id="d47e0-315">The BizTalk orchestration for the operation is running.</span></span>  

## <a name="executing-the-operation"></a><span data-ttu-id="d47e0-316">執行作業</span><span class="sxs-lookup"><span data-stu-id="d47e0-316">Executing the Operation</span></span>  
 <span data-ttu-id="d47e0-317">執行應用程式之後，下列的一組動作進行，相同的順序：</span><span class="sxs-lookup"><span data-stu-id="d47e0-317">After you run the application, the following set of actions take place, in the same sequence:</span></span>  

-   <span data-ttu-id="d47e0-318">執行配接器**PolledDataAvailableStatement**它會傳回正數的值，指出要執行指定的陳述式的介面卡**PollingStatement**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="d47e0-318">The adapter executes the **PolledDataAvailableStatement** which returns a positive value indicating the adapter to execute the statement specified for **PollingStatement** binding property.</span></span>  

-   <span data-ttu-id="d47e0-319">配接器執行 GET_ACTIVITYS 預存程序時指定**PollingStatement** ACCOUNTACTIVITY 資料表中的繫結屬性，並傳回所有資料列。</span><span class="sxs-lookup"><span data-stu-id="d47e0-319">The adapter executes the GET_ACTIVITYS stored procedure specified for the **PollingStatement** binding property and returns all the rows in the ACCOUNTACTIVITY table.</span></span> <span data-ttu-id="d47e0-320">Oracle 資料庫的回應如下所示：</span><span class="sxs-lookup"><span data-stu-id="d47e0-320">The response from Oracle database resembles the following:</span></span>  

    ```  
    <?xml version="1.0" encoding="utf-8" ?>   
    <GET_ACTIVITYS xmlns=" http://Microsoft.LobServices.OracleDB/2007/03/SCOTT/PollingPackage/ACCOUNT_PKG">  
      <OUTRECS>  
        <OUTRECSRecord xmlns=" http://Microsoft.LobServices.OracleDB/2007/03/ReferencedRecordTypes/SCOTT/ACCOUNT_PKG/GET_ACTIVITYS/SCOTT/GET_ACTIVITYS">  
          <TID>1</TID>   
          <ACCOUNT>100001</ACCOUNT>   
          <AMOUNT>500</AMOUNT>   
          <DESCRIPTION />   
          <TRANSDATE>2008-06-21T15:52:19</TRANSDATE>   
          <PROCESSED>n</PROCESSED>   
        </OUTRECSRecord>  
        <OUTRECSRecord xmlns=" http://Microsoft.LobServices.OracleDB/2007/03/ReferencedRecordTypes/SCOTT/ACCOUNT_PKG/GET_ACTIVITYS/SCOTT/GET_ACTIVITYS">  
          ......  
          ......   
        </OUTRECSRecord>  
        ......  
        ......  
      </OUTRECS>  
    </GET_ACTIVITYS>  
    ```  

-   <span data-ttu-id="d47e0-321">配接器執行後輪詢陳述式，會將所有資料從 ACCOUNTACTIVITY 資料表都移到另一個資料表。</span><span class="sxs-lookup"><span data-stu-id="d47e0-321">The adapter executes the post-poll statement, which moves all the data from ACCOUNTACTIVITY table to another table.</span></span>  

-   <span data-ttu-id="d47e0-322">輪詢間隔後，執行配接器再次**PolledDataAvailableStatement**。</span><span class="sxs-lookup"><span data-stu-id="d47e0-322">After the polling interval, the adapter again executes **PolledDataAvailableStatement**.</span></span> <span data-ttu-id="d47e0-323">因為 ACCOUNTACTIVITY 資料表沒有記錄現在**PolledDataAvailableStatement**不會傳回正值，因此配接器不會執行指定的陳述式**PollingStatement**繫結屬性。</span><span class="sxs-lookup"><span data-stu-id="d47e0-323">Because ACCOUNTACTIVITY table has no records now, **PolledDataAvailableStatement** does not return a positive value and hence the adapter does not execute the statement specified for the **PollingStatement** binding property.</span></span> <span data-ttu-id="d47e0-324">如此一來，配接器用戶端不會取得任何輪詢訊息。</span><span class="sxs-lookup"><span data-stu-id="d47e0-324">As a result, adapter client does not get any polling message.</span></span>  

-   <span data-ttu-id="d47e0-325">某些記錄明確插入 ACCOUNTACTIVITY 資料表之前，配接器用戶端不會收到任何其他的輪詢訊息。</span><span class="sxs-lookup"><span data-stu-id="d47e0-325">The adapter client will not get any more polling messages until some records are explicitly inserted into the ACCOUNTACTIVITY table.</span></span> <span data-ttu-id="d47e0-326">若要插入多筆記錄，您可以執行 more_activity_data.sql 指令碼提供範例。</span><span class="sxs-lookup"><span data-stu-id="d47e0-326">To insert more records, you can run the more_activity_data.sql script provided with the samples.</span></span> <span data-ttu-id="d47e0-327">在下一次執行此指令碼之後, **PolledDataAvailableStatement**會執行，它會傳回正值。</span><span class="sxs-lookup"><span data-stu-id="d47e0-327">After you run this script, the next time **PolledDataAvailableStatement** is executed, it returns a positive value.</span></span> <span data-ttu-id="d47e0-328">如此一來，配接器執行輪詢陳述式，並再次接收配接器用戶端的輪詢訊息。</span><span class="sxs-lookup"><span data-stu-id="d47e0-328">As a result, the adapter executes the polling statement and adapter clients again receive a polling message.</span></span>  

> [!NOTE]
>  <span data-ttu-id="d47e0-329">[!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)]將繼續輪詢，直到您明確停用接收埠從[!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)]管理主控台。</span><span class="sxs-lookup"><span data-stu-id="d47e0-329">The [!INCLUDE[adapteroracle_short](../../includes/adapteroracle-short-md.md)] will continue to poll until you explicitly disable the receive port from the [!INCLUDE[btsBizTalkServerNoVersion](../../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span>  

## <a name="best-practices"></a><span data-ttu-id="d47e0-330">最佳作法</span><span class="sxs-lookup"><span data-stu-id="d47e0-330">Best Practices</span></span>  
 <span data-ttu-id="d47e0-331">您部署和設定 BizTalk 專案之後，您可以匯出至 XML 檔案，稱為繫結檔案的組態設定。</span><span class="sxs-lookup"><span data-stu-id="d47e0-331">After you have deployed and configured the BizTalk project, you can export configuration settings to an XML file called the bindings file.</span></span> <span data-ttu-id="d47e0-332">一旦產生繫結檔案時，您可以匯入的組態設定從檔案，讓您不需要建立傳送埠和接收相同的協調流程的連接埠。</span><span class="sxs-lookup"><span data-stu-id="d47e0-332">Once you generate a bindings file, you can import the configuration settings from the file so that you do not need to create the send ports and receive ports for the same orchestration.</span></span> <span data-ttu-id="d47e0-333">如需有關繫結檔案的詳細資訊，請參閱 <<c0> [ 重複使用的 Oracle 資料庫配接器繫結](../../adapters-and-accelerators/adapter-oracle-database/reuse-oracle-database-adapter-bindings.md)。</span><span class="sxs-lookup"><span data-stu-id="d47e0-333">For more information about binding files, see [Reuse Oracle Database Adapter bindings](../../adapters-and-accelerators/adapter-oracle-database/reuse-oracle-database-adapter-bindings.md).</span></span>  

## <a name="see-also"></a><span data-ttu-id="d47e0-334">另請參閱</span><span class="sxs-lookup"><span data-stu-id="d47e0-334">See Also</span></span>  
 [<span data-ttu-id="d47e0-335">使用 BizTalk Server 輪詢 Oracle 資料庫</span><span class="sxs-lookup"><span data-stu-id="d47e0-335">Poll Oracle Database using BizTalk Server</span></span>](../../adapters-and-accelerators/adapter-oracle-database/poll-oracle-database-using-biztalk-server.md)