---
title: 檢查清單： 測量 HYPER-V 上的效能 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: f32c95f4-a4eb-412b-9fa7-140e80b85e5a
caps.latest.revision: 13
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 111ca6bfa37fdfc6af6f484ebc1568cbaca2c8f6
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "37007111"
---
# <a name="checklist-measuring-performance-on-hyper-v"></a><span data-ttu-id="46ef8-102">檢查清單： 測量 HYPER-V 上的效能</span><span class="sxs-lookup"><span data-stu-id="46ef8-102">Checklist: Measuring Performance on Hyper-V</span></span>
<span data-ttu-id="46ef8-103">雖然大部分的原則分析安裝在 HYPER-V 虛擬機器效能上的客體作業系統的效能分析的效能，在實體機器上安裝作業系統的相同，許多集合的方法是不同。</span><span class="sxs-lookup"><span data-stu-id="46ef8-103">While most of the principles of analyzing performance of a guest operating system installed on a Hyper-V virtual machine performance are the same as analyzing the performance of an operating system installed on a physical machine, many of the collection methods are different.</span></span> <span data-ttu-id="46ef8-104">評估您在 HYPER-V 虛擬機器上安裝客體作業系統上執行的 BizTalk Server 解決方案的效能時，應該使用下列各節，快速參考。</span><span class="sxs-lookup"><span data-stu-id="46ef8-104">The sections below should be used as a quick reference when evaluating performance of your BizTalk Server solution running on a guest operating system installed on a Hyper-V virtual machine.</span></span>  

## <a name="measuring-disk-io-performance"></a><span data-ttu-id="46ef8-105">測量磁碟 I/O 效能</span><span class="sxs-lookup"><span data-stu-id="46ef8-105">Measuring Disk I/O Performance</span></span>  
 <span data-ttu-id="46ef8-106">您可以使用下列效能監視器計數器來測量在 HYPER-V 虛擬機器上安裝客體作業系統上的磁碟 I/O 效能：</span><span class="sxs-lookup"><span data-stu-id="46ef8-106">Use the following performance monitor counters to measure disk I/O performance on a guest operating system installed on a Hyper-V virtual machine:</span></span>  


|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 <span data-ttu-id="46ef8-107">步驟</span><span class="sxs-lookup"><span data-stu-id="46ef8-107">Step</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <span data-ttu-id="46ef8-108">參考</span><span class="sxs-lookup"><span data-stu-id="46ef8-108">Reference</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="46ef8-109">**測量 HYPER-V 主機作業系統上的磁碟延遲**-在 HYPER-V 主機的作業系統上的磁碟效能的最佳初始指標使用取得的 「 \Logical 磁碟 (*) \Avg。Disk sec/Read"和"\Logical 磁碟 (\*) \Avg。Disk sec/Write"效能監視器計數器。這些效能監視器計數器來測量讀取和寫入作業的時間來回應作業系統的時間的量。一般的經驗法則，平均回應時間大於 15ms年會被視為不佳。一般的經驗法則，平均回應時間大於 15ms年會被視為不佳。這根據一般的搜尋單一 7200 RPM 磁碟機，而不需要快取的時間。建議的實體磁碟效能監視器計數器與邏輯磁碟使用，因為 Windows 應用程式和服務使用以呈現給作業系統的實體磁碟 (LUN) 可以是其中的磁碟機代號的邏輯磁碟機組成磁碟陣列中的多個實體磁碟機。使用下列規則的經驗法則，測量 HYPER-V 主機作業系統使用 \Logical 磁碟上的磁碟延遲時 (\*) \Avg。磁碟 sec/Read] 或 [\Logical 磁碟 (\*) \Avg。磁碟 sec/Write 效能監視器計數器：<br /> <br />這根據一般的搜尋單一 7200 RPM 磁碟機，而不需要快取的時間。建議的實體磁碟效能監視器計數器與邏輯磁碟使用，因為 Windows 應用程式和服務使用以呈現給作業系統的實體磁碟 (LUN) 可以是其中的磁碟機代號的邏輯磁碟機組成磁碟陣列中的多個實體磁碟機。使用下列規則的經驗法則，測量 HYPER-V 主機作業系統使用 \Logical 磁碟上的磁碟延遲時 (\*) \Avg。磁碟 sec/Read] 或 [\Logical 磁碟 (\*) \Avg。磁碟 sec/Write 效能監視器計數器：<br /> <br /> -1 毫秒到 15ms年 = 狀況良好<br />-15ms年 25 毫秒 = 警告或監視<br />-26ms年以上 = 嚴重，效能會受到負面影響\* \*附註：* \*安裝在非虛擬化環境中的實體磁碟提供更佳的效能比經由 HYPER-V 主機作業系統的磁碟。</span><span class="sxs-lookup"><span data-stu-id="46ef8-109">**Measure disk latency on a Hyper-V host operating system** – The best initial indicator of disk performance on a Hyper-V host operating system is obtained by using the “\Logical Disk(*)\Avg. Disk sec/Read” and “\Logical Disk(\*)\Avg. Disk sec/Write” performance monitor counters. These performance monitor counters measure the amount of time that read and write operations take to respond to the operating system. As a general rule of thumb, average response times greater than 15ms are considered sub-optimal. As a general rule of thumb, average response times greater than 15ms are considered sub-optimal. This is based on the typical seek time of a single 7200 RPM disk drive without cache. The use of logical disk versus physical disk performance monitor counters is recommended because Windows applications and services utilize logical drives represented as drive letters wherein the physical disk (LUN) presented to the operating system can be comprised of multiple physical disk drives in a disk array. Use the following rule of thumb when measuring disk latency on the Hyper-V host operating system using the \Logical Disk(\*)\Avg. Disk sec/Read or \Logical Disk(\*)\Avg. Disk sec/Write performance monitor counters:<br /><br /> This is based on the typical seek time of a single 7200 RPM disk drive without cache. The use of logical disk versus physical disk performance monitor counters is recommended because Windows applications and services utilize logical drives represented as drive letters wherein the physical disk (LUN) presented to the operating system can be comprised of multiple physical disk drives in a disk array. Use the following rule of thumb when measuring disk latency on the Hyper-V host operating system using the \Logical Disk(\*)\Avg. Disk sec/Read or \Logical Disk(\*)\Avg. Disk sec/Write performance monitor counters:<br /><br /> -   1ms to 15ms  = Healthy<br />-   15ms to 25ms = Warning or Monitor<br />-   26ms or greater = Critical, performance will be adversely affected \*\*Note:*\*  Physical disks installed on a non-virtualized environment offer better performance than disks accessed through a Hyper-V host operating system.</span></span> <span data-ttu-id="46ef8-110">如果磁碟效能十分重要的應用程式的整體效能，請考慮裝載在實際的硬體上的磁碟。</span><span class="sxs-lookup"><span data-stu-id="46ef8-110">If disk performance is absolutely critical to the overall performance of your application, consider hosting disks on physical hardware only.</span></span> <span data-ttu-id="46ef8-111">**注意：** 時評估的磁碟 I/O 效能，請確定您要排除的任何磁碟分割進行評估掃描的防毒軟體設定。</span><span class="sxs-lookup"><span data-stu-id="46ef8-111">**Note:**  When evaluating disk I/O performance, ensure that you configure antivirus software to exclude scanning of any disk partitions that are being evaluated.</span></span> <span data-ttu-id="46ef8-112">防毒軟體掃描導入了對造成負面影響效能和扭曲測試結果的額外負荷。</span><span class="sxs-lookup"><span data-stu-id="46ef8-112">Antivirus scanning introduces overhead that can negatively impact performance and skew test results.</span></span> <br /><br /> <span data-ttu-id="46ef8-113">**測量在客體作業系統上的磁碟延遲**– 可以測量回應時間的客體作業系統所使用的磁碟，使用同一個效能監視器計數器來測量回應時間的 HYPER-V 主機作業系統所使用的磁碟系統。</span><span class="sxs-lookup"><span data-stu-id="46ef8-113">**Measure disk latency on guest operating systems** – Response times of the disks used by the guest operating systems can be measured using the same performance monitor counters used to measure response times of the disks used by the Hyper-V host operating system.</span></span> | <span data-ttu-id="46ef8-114">如需有關磁碟效能分析的詳細資訊，請參閱下列資源：</span><span class="sxs-lookup"><span data-stu-id="46ef8-114">For more information about disk performance analysis, see the following resources:</span></span><br /><br /> <span data-ttu-id="46ef8-115">-在 「 執行 SQL Server 2008 in a HYPER-V 環境 – 最佳 Practices and Performance Considerations 「 白皮書 」 在 HYPER-V 中執行 SQL Server 中的效能負荷 」 一節[ http://go.microsoft.com/fwlink/?LinkId=144622 ](http://go.microsoft.com/fwlink/?LinkId=144622)。</span><span class="sxs-lookup"><span data-stu-id="46ef8-115">-   “Performance Overhead of Running SQL Server in Hyper-V” section of “Running SQL Server 2008 in a Hyper-V Environment – Best Practices and Performance Considerations” whitepaper at [http://go.microsoft.com/fwlink/?LinkId=144622](http://go.microsoft.com/fwlink/?LinkId=144622).</span></span><br /><span data-ttu-id="46ef8-116">-條件在繫結磁碟問題[ http://go.microsoft.com/fwlink/?LinkId=120947 ](http://go.microsoft.com/fwlink/?LinkId=120947)。</span><span class="sxs-lookup"><span data-stu-id="46ef8-116">-   Ruling Out Disk-Bound Problems at [http://go.microsoft.com/fwlink/?LinkId=120947](http://go.microsoft.com/fwlink/?LinkId=120947).</span></span><br /><span data-ttu-id="46ef8-117">SQL Server 前置部署 I/O 最佳實務範例[ http://go.microsoft.com/fwlink/?LinkId=120948 ](http://go.microsoft.com/fwlink/?LinkId=120948)。</span><span class="sxs-lookup"><span data-stu-id="46ef8-117">-   SQL Server Predeployment I/O Best Practices at [http://go.microsoft.com/fwlink/?LinkId=120948](http://go.microsoft.com/fwlink/?LinkId=120948).</span></span><br /><span data-ttu-id="46ef8-118">-「 I/O 瓶頸 」 一節的 「 疑難排解效能問題，在 SQL Server 2008 > 白皮書，網址[ http://go.microsoft.com/fwlink/?LinkID=202135 ](http://go.microsoft.com/fwlink/?LinkID=202135)。</span><span class="sxs-lookup"><span data-stu-id="46ef8-118">-   “I/O Bottlenecks” section of the “Troubleshooting Performance Problems in SQL Server 2008” whitepaper available at [http://go.microsoft.com/fwlink/?LinkID=202135](http://go.microsoft.com/fwlink/?LinkID=202135).</span></span><br /><span data-ttu-id="46ef8-119">-如何找出使用 Microsoft Server 效能 Advisor (SPA) 工具，在磁碟效能瓶頸[ http://go.microsoft.com/fwlink/?LinkID=98096 ](http://go.microsoft.com/fwlink/?LinkID=98096)。</span><span class="sxs-lookup"><span data-stu-id="46ef8-119">-   How to Identify a Disk Performance Bottleneck Using the Microsoft Server Performance Advisor (SPA) Tool at [http://go.microsoft.com/fwlink/?LinkID=98096](http://go.microsoft.com/fwlink/?LinkID=98096).</span></span> |

## <a name="measuring-memory-performance"></a><span data-ttu-id="46ef8-120">測量記憶體效能</span><span class="sxs-lookup"><span data-stu-id="46ef8-120">Measuring Memory Performance</span></span>  
 <span data-ttu-id="46ef8-121">您可以使用下列效能監視器計數器來測量可用的記憶體，HYPER-V 虛擬機器上安裝客體作業系統效能的影響：</span><span class="sxs-lookup"><span data-stu-id="46ef8-121">Use the following performance monitor counters to measure the impact of available memory on the performance of a guest operating system installed on a Hyper-V virtual machine:</span></span>  

|<span data-ttu-id="46ef8-122">步驟</span><span class="sxs-lookup"><span data-stu-id="46ef8-122">Step</span></span>|<span data-ttu-id="46ef8-123">參考</span><span class="sxs-lookup"><span data-stu-id="46ef8-123">Reference</span></span>|  
|----------|---------------|  
|<span data-ttu-id="46ef8-124">**測量 HYPER-V 主機作業系統上的可用記憶體**– 用於 HYPER-V 主機作業系統的實體記憶體數量由上監視的 「 \Memory\Available MBytes 「 效能監視器計數器實體電腦。</span><span class="sxs-lookup"><span data-stu-id="46ef8-124">**Measure available memory on the Hyper-V host operating system** – The amount of physical memory available to the Hyper-V host operating system can be determined by monitoring the “\Memory\Available MBytes” performance monitor counter on the physical computer.</span></span> <span data-ttu-id="46ef8-125">此計數器會報告可用主機作業系統可用實體記憶體數量。</span><span class="sxs-lookup"><span data-stu-id="46ef8-125">This counter reports the amount of free physical memory available to the host operating system.</span></span> <span data-ttu-id="46ef8-126">評估可用主機作業系統可用實體記憶體時，請使用下列規則的經驗法則：</span><span class="sxs-lookup"><span data-stu-id="46ef8-126">Use the following rules of thumb when evaluating available physical memory available to the host operating system:</span></span><br /><br /> <ul><li><span data-ttu-id="46ef8-127">**\Memory\Available Mbytes** – Available mbytes 量值的電腦上安裝的實體記憶體百分比的電腦上，執行的處理序可用的實體記憶體數量。</span><span class="sxs-lookup"><span data-stu-id="46ef8-127">**\Memory\Available Mbytes** – Available MBytes measures the amount of physical memory available to processes running on the computer, as a percentage of physical memory installed on the computer.</span></span> <span data-ttu-id="46ef8-128">測量這個效能監視器計數器的值時，就會套用下列準則：</span><span class="sxs-lookup"><span data-stu-id="46ef8-128">The following guidelines apply when measuring the value of this performance monitor counter:</span></span><br /><br /> <ul><li><span data-ttu-id="46ef8-129">可用的記憶體的 50%或更 = 狀況良好</span><span class="sxs-lookup"><span data-stu-id="46ef8-129">50% of free memory available or more = Healthy</span></span></li><li><span data-ttu-id="46ef8-130">25%的可用的記憶體 = 監視</span><span class="sxs-lookup"><span data-stu-id="46ef8-130">25% of free memory available = Monitor</span></span></li><li><span data-ttu-id="46ef8-131">10%的可用的記憶體 = 警告</span><span class="sxs-lookup"><span data-stu-id="46ef8-131">10% of free memory available = Warning</span></span></li><li><span data-ttu-id="46ef8-132">可用的記憶體低於 5%= 嚴重，效能會受到負面影響</span><span class="sxs-lookup"><span data-stu-id="46ef8-132">Less than 5% of free memory available = Critical, performance will be adversely affected</span></span></li></ul></li><li><span data-ttu-id="46ef8-133">**\Memory\Pages/sec** – 這個效能監視器計數器會測量在讀取或寫入磁碟以解決硬體分頁錯誤頁面的速率。</span><span class="sxs-lookup"><span data-stu-id="46ef8-133">**\Memory\Pages/sec** – This performance monitor counter measures the rate at which pages are read from or written to disk to resolve hard page faults.</span></span> <span data-ttu-id="46ef8-134">若要解決硬體分頁錯誤，作業系統必須交換記憶體內容的磁碟，而效能受到負面影響。</span><span class="sxs-lookup"><span data-stu-id="46ef8-134">To resolve hard page faults, the operating system must swap the contents of memory to disk, which negatively impacts performance.</span></span> <span data-ttu-id="46ef8-135">每秒實體可用的記憶體不足的相互關聯的頁面數目可能表示實體記憶體不足。</span><span class="sxs-lookup"><span data-stu-id="46ef8-135">A high number of pages per second in correlation with low available physical memory may indicate a lack of physical memory.</span></span> <span data-ttu-id="46ef8-136">測量這個效能監視器計數器的值時，就會套用下列準則：</span><span class="sxs-lookup"><span data-stu-id="46ef8-136">The following guidelines apply when measuring the value of this performance monitor counter:</span></span><br /><br /> <ul><li><span data-ttu-id="46ef8-137">少於 500 個 = 狀況良好</span><span class="sxs-lookup"><span data-stu-id="46ef8-137">Less than 500 = Healthy</span></span></li><li><span data-ttu-id="46ef8-138">500-1000年 = 監視或警告</span><span class="sxs-lookup"><span data-stu-id="46ef8-138">500 - 1000 = Monitor or Caution</span></span></li><li><span data-ttu-id="46ef8-139">大於 1000年 = 嚴重，效能會受到負面影響</span><span class="sxs-lookup"><span data-stu-id="46ef8-139">Greater than 1000 = Critical, performance will be adversely affected</span></span></li></ul></li></ul><br /> <span data-ttu-id="46ef8-140">**測量在客體作業系統上的可用記憶體**– 客體作業系統可用的記憶體可以測量的相同效能監控計數器來測量 HYPER-V 主機作業系統可用的記憶體。</span><span class="sxs-lookup"><span data-stu-id="46ef8-140">**Measure available memory on the guest operating system** – Memory that is available to the guest operating systems can be measured with the same performance monitor counters used to measure memory available to the Hyper-V host operating system.</span></span>|<span data-ttu-id="46ef8-141">詳細資訊的相關影響可用的實體記憶體的應用程式伺服器效能，請參閱 Exchange Server 2003 說明主題 < 統治出記憶體繫結的問題 >，網址[ http://go.microsoft.com/fwlink/?LinkId=121056 ](http://go.microsoft.com/fwlink/?LinkId=121056)。</span><span class="sxs-lookup"><span data-stu-id="46ef8-141">For more information about the impact of available physical memory on application server performance, see the Exchange Server 2003 Help topic “Ruling Out Memory-Bound Problems” at [http://go.microsoft.com/fwlink/?LinkId=121056](http://go.microsoft.com/fwlink/?LinkId=121056).</span></span>|  

## <a name="measuring-network-performance"></a><span data-ttu-id="46ef8-142">測量網路效能</span><span class="sxs-lookup"><span data-stu-id="46ef8-142">Measuring Network Performance</span></span>  
 <span data-ttu-id="46ef8-143">HYPER-V 可讓客體電腦共用相同的實體網路介面卡。</span><span class="sxs-lookup"><span data-stu-id="46ef8-143">Hyper-V allows guest computers to share the same physical network adapter.</span></span> <span data-ttu-id="46ef8-144">雖然這有助於整併硬體，請小心不要 saturate 實體介面卡。</span><span class="sxs-lookup"><span data-stu-id="46ef8-144">While this helps to consolidate hardware, take care not to saturate the physical adapter.</span></span> <span data-ttu-id="46ef8-145">您可以使用下列方法來確保 HYPER-V 虛擬機器所使用的網路健康狀態：</span><span class="sxs-lookup"><span data-stu-id="46ef8-145">Use the following methods to ensure the health of the network used by the Hyper-V virtual machines:</span></span>  


|                                 <span data-ttu-id="46ef8-146">步驟</span><span class="sxs-lookup"><span data-stu-id="46ef8-146">Step</span></span>                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               <span data-ttu-id="46ef8-147">參考</span><span class="sxs-lookup"><span data-stu-id="46ef8-147">Reference</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|----------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                       <span data-ttu-id="46ef8-148">**測試網路延遲**</span><span class="sxs-lookup"><span data-stu-id="46ef8-148">**Test network latency**</span></span>                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 <span data-ttu-id="46ef8-149">Ping 每個虛擬機器，以確保有適當的網路延遲。</span><span class="sxs-lookup"><span data-stu-id="46ef8-149">Ping each virtual machine to ensure adequate network latency.</span></span> <span data-ttu-id="46ef8-150">在 區域網路，應該會收到小於 1 毫秒回應時間。</span><span class="sxs-lookup"><span data-stu-id="46ef8-150">On local area networks, expect to receive less than 1ms response times.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|                       <span data-ttu-id="46ef8-151">**測試封包遺失**</span><span class="sxs-lookup"><span data-stu-id="46ef8-151">**Test for packet loss**</span></span>                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <span data-ttu-id="46ef8-152">您可以使用 pathping.exe 公用程式來測試虛擬機器之間的封包遺失。</span><span class="sxs-lookup"><span data-stu-id="46ef8-152">Use the pathping.exe utility to test packet loss between virtual machines.</span></span> <span data-ttu-id="46ef8-153">Pathping.exe 測量網路上的封包遺失，並且只適用於所有版本的[!INCLUDE[btsWinNoVersion](../includes/btswinnoversion-md.md)]因為[!INCLUDE[btsWin2kSvr](../includes/btswin2ksvr-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="46ef8-153">Pathping.exe measures packet loss on the network and is available with all versions of [!INCLUDE[btsWinNoVersion](../includes/btswinnoversion-md.md)] since [!INCLUDE[btsWin2kSvr](../includes/btswin2ksvr-md.md)].</span></span> <span data-ttu-id="46ef8-154">Pathping.exe 送出至網路中的每個節點的 100 個 ping 要求的高載，並計算會傳回多少 ping。</span><span class="sxs-lookup"><span data-stu-id="46ef8-154">Pathping.exe sends out a burst of 100 ping requests to each network node and calculates how many pings are returned.</span></span> <span data-ttu-id="46ef8-155">在 區域網路上應該不會遺失從 pathping.exe 公用程式 ping 要求。</span><span class="sxs-lookup"><span data-stu-id="46ef8-155">On local area networks there should be no loss of ping requests from the pathping.exe utility.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                   <span data-ttu-id="46ef8-156">**測試網路檔案傳輸**</span><span class="sxs-lookup"><span data-stu-id="46ef8-156">**Test network file transfers**</span></span>                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <span data-ttu-id="46ef8-157">複製虛擬機器之間 100 MB 的檔案，並測量完成複製所需的時間長度。</span><span class="sxs-lookup"><span data-stu-id="46ef8-157">Copy a 100MB file between virtual machines and measure the length of time required to complete the copy.</span></span> <span data-ttu-id="46ef8-158">在 狀況良好的 100Mbit 100 MB (mb) 的檔案應該複製 (mb) 網路，以 10 到 20 秒為單位。</span><span class="sxs-lookup"><span data-stu-id="46ef8-158">On a healthy 100Mbit (megabit) network, a 100MB (megabyte) file should copy in 10 to 20 seconds.</span></span> <span data-ttu-id="46ef8-159">狀況良好的 1Gbit 網路 100 MB 的檔案應該複製在 3 到 5 秒內。</span><span class="sxs-lookup"><span data-stu-id="46ef8-159">On a healthy 1Gbit network, a 100MB file should copy in about 3 to 5 seconds.</span></span> <span data-ttu-id="46ef8-160">在這些參數範圍外的複製時間較長的網路問題。</span><span class="sxs-lookup"><span data-stu-id="46ef8-160">Copy times outside of these parameters are indicative of a network problem.</span></span> <span data-ttu-id="46ef8-161">當網路介面卡具有 「 自動偵測到 」 時，就會發生不佳的網路傳輸的一個常見原因要充分利用可用的頻寬時，防止網路介面卡的 10MB 半雙工網路。</span><span class="sxs-lookup"><span data-stu-id="46ef8-161">One common cause of poor network transfers occurs when the network adapter has “auto detected” a 10MB half-duplex network which prevents the network adapter from taking full advantage of available bandwidth.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| <span data-ttu-id="46ef8-162">**量值為 HYPER-V 主機作業系統上的網路使用率**</span><span class="sxs-lookup"><span data-stu-id="46ef8-162">**Measure network utilization on the Hyper-V host operating system**</span></span> | <span data-ttu-id="46ef8-163">您可以使用下列效能監視器計數器來測量 HYPER-V 主機作業系統上的網路使用率：</span><span class="sxs-lookup"><span data-stu-id="46ef8-163">Use the following performance monitor counters to measure network utilization on the Hyper-V host operating system:</span></span><br /><br /> <span data-ttu-id="46ef8-164">**\Network 介面 (\*) \Bytes Total/sec** – 網路使用率百分比會計算位元組總數/秒乘以 8，將它轉換成位元，請將結果乘以 100 上，然後除以網路介面卡的目前頻寬。</span><span class="sxs-lookup"><span data-stu-id="46ef8-164">**\Network Interface(\*)\Bytes Total/sec** – The percentage of network utilization is calculated by multiplying Bytes Total/sec by 8 to convert it to bits, multiply the result by 100, then divide by the network adapter’s current bandwidth.</span></span> <span data-ttu-id="46ef8-165">您可以使用下列的臨界值來評估網路頻寬使用率：</span><span class="sxs-lookup"><span data-stu-id="46ef8-165">Use the following thresholds to evaluate network bandwidth utilization:</span></span><br /><br /> <span data-ttu-id="46ef8-166">-低於 40%的耗用的介面 = 狀況良好</span><span class="sxs-lookup"><span data-stu-id="46ef8-166">-   Less than 40% of the interface consumed = Healthy</span></span><br /><span data-ttu-id="46ef8-167">-耗用的介面 41%-64%= 監視或警告</span><span class="sxs-lookup"><span data-stu-id="46ef8-167">-   41%-64% of the interface consumed = Monitor or Caution</span></span><br /><span data-ttu-id="46ef8-168">-耗用的介面 65 100%= 嚴重，效能會受到負面影響</span><span class="sxs-lookup"><span data-stu-id="46ef8-168">-   65-100% of the interface consumed = Critical, performance will be adversely affected</span></span><br /><br /> <span data-ttu-id="46ef8-169">**\Network 介面 (\*) \Output 佇列長度**– 輸出佇列長度量值的網路介面卡上等候的執行緒數目。</span><span class="sxs-lookup"><span data-stu-id="46ef8-169">**\Network Interface(\*)\Output Queue Length** – The output queue length measures the number of threads waiting on the network adapter.</span></span> <span data-ttu-id="46ef8-170">如果有 2 個以上的執行緒等待網路介面卡上，網路可能是瓶頸。</span><span class="sxs-lookup"><span data-stu-id="46ef8-170">If there are more than 2 threads waiting on the network adapter, then the network may be a bottleneck.</span></span> <span data-ttu-id="46ef8-171">常見的原因，這是不佳的網路延遲及/或網路上的高衝突率。</span><span class="sxs-lookup"><span data-stu-id="46ef8-171">Common causes of this are poor network latency and/or high collision rates on the network.</span></span> <span data-ttu-id="46ef8-172">您可以使用下列的臨界值來評估輸出佇列長度：</span><span class="sxs-lookup"><span data-stu-id="46ef8-172">Use the following thresholds to evaluate output queue length:</span></span><br /><br /> <span data-ttu-id="46ef8-173">-0 = 狀況良好</span><span class="sxs-lookup"><span data-stu-id="46ef8-173">-   0 = Healthy</span></span><br /><span data-ttu-id="46ef8-174">-1-2 = 監視或警告</span><span class="sxs-lookup"><span data-stu-id="46ef8-174">-   1-2 = Monitor or Caution</span></span><br /><span data-ttu-id="46ef8-175">-Greater than 2 = 嚴重，效能會受到負面影響。</span><span class="sxs-lookup"><span data-stu-id="46ef8-175">-   Greater than 2 = Critical, performance will be adversely affected.</span></span><br /><br /> <span data-ttu-id="46ef8-176">確定方案中的所有電腦 （實體和虛擬） 的網路介面卡已設定的最大傳輸單位 (MTU) 使用相同的值。</span><span class="sxs-lookup"><span data-stu-id="46ef8-176">Ensure that the network adapters for all computers (physical and virtual) in the solution are configured to use the same value for maximum transmission unit (MTU).</span></span> <span data-ttu-id="46ef8-177">設定 MTU 值的詳細資訊，請參閱 < 附錄 a: TCP/IP 組態參數 >，網址[ http://go.microsoft.com/fwlink/?LinkId=113716 ](http://go.microsoft.com/fwlink/?LinkId=113716)。</span><span class="sxs-lookup"><span data-stu-id="46ef8-177">For more information about configuring the MTU value, see “Appendix A: TCP/IP Configuration Parameters” at [http://go.microsoft.com/fwlink/?LinkId=113716](http://go.microsoft.com/fwlink/?LinkId=113716).</span></span><br /><br /> <span data-ttu-id="46ef8-178">如果以 2 或多個輸出佇列長度，請考慮將一個或多個實體網路介面卡新增至裝載的虛擬機器的實體電腦，並繫結客體作業系統，這些實體網路介面卡所使用的網路介面卡。</span><span class="sxs-lookup"><span data-stu-id="46ef8-178">If an output queue length of 2 or more is measured, consider adding one or more physical network adapters to the physical computer that hosts the virtual machines and bind the network adapters used by the guest operating systems to these physical network adapters.</span></span> |
|    <span data-ttu-id="46ef8-179">**量值在客體作業系統上的網路使用率**</span><span class="sxs-lookup"><span data-stu-id="46ef8-179">**Measure network utilization on the guest operating systems**</span></span>    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       <span data-ttu-id="46ef8-180">如果 HYPER-V 根磁碟分割上的網路介面卡處於忙碌狀態，如先前所述的效能監視器計數器所指出的請考慮使用 「 \Hyper-V 虛擬網路介面卡 (\*) \Bytes/sec"以找出哪些效能監視器計數器虛擬網路介面卡會耗用大部分的網路使用率。</span><span class="sxs-lookup"><span data-stu-id="46ef8-180">If a network adapter on the Hyper-V root partition is busy as indicated by the performance monitor counters mentioned above, then consider using the "\Hyper-V Virtual Network Adapter(\*)\Bytes/sec" performance monitor counter to identify which virtual network adapters are consuming the most network utilization.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |

 <span data-ttu-id="46ef8-181">網路效能分析的詳細資訊，請參閱 < 章 15-測量.NET 應用程式效能 >，網址[ http://go.microsoft.com/fwlink/?LinkId=121073 ](http://go.microsoft.com/fwlink/?LinkId=121073)。</span><span class="sxs-lookup"><span data-stu-id="46ef8-181">For more information about network performance analysis, see “Chapter 15 - Measuring .NET Application Performance” at [http://go.microsoft.com/fwlink/?LinkId=121073](http://go.microsoft.com/fwlink/?LinkId=121073).</span></span>  

## <a name="measuring-processor-performance"></a><span data-ttu-id="46ef8-182">測量處理器效能</span><span class="sxs-lookup"><span data-stu-id="46ef8-182">Measuring Processor Performance</span></span>  
 <span data-ttu-id="46ef8-183">您可以使用下列方法來評估在 HYPER-V 虛擬機器上安裝客體作業系統上的處理器效能：</span><span class="sxs-lookup"><span data-stu-id="46ef8-183">Use the following methods to evaluate processor performance on a guest operating system installed on a Hyper-V virtual machine:</span></span>  

- <span data-ttu-id="46ef8-184">**測量客體作業系統的處理器使用率-** 傳統上，處理器效能可以用來評估 」 \Processor(\*)\\處理器時間百分比 」 效能監視器計數器。</span><span class="sxs-lookup"><span data-stu-id="46ef8-184">**Measure guest operating system processor utilization -** Traditionally, processor performance can be measured using the “\Processor(\*)\\% Processor Time” performance monitor counter.</span></span> <span data-ttu-id="46ef8-185">這不是精確的計數器，但評估為客體作業系統的處理器使用率，因為 HYPER-V 測量並報告此值相對於配置給虛擬機器的處理器數目。</span><span class="sxs-lookup"><span data-stu-id="46ef8-185">This is not an accurate counter for evaluating processor utilization of a guest operating system though because Hyper-V measures and reports this value relative to the number of processors allocated to the virtual machine.</span></span> <span data-ttu-id="46ef8-186">每個客體作業系統 」 的更多的處理器配置給虛擬機器超過實際存在的實體電腦上執行，如果傳回的值"\Processor (\*)\\處理器時間百分比 」 效能監視器計數器很少，即使事實上處理器使用率是瓶頸。</span><span class="sxs-lookup"><span data-stu-id="46ef8-186">If more processors are allocated to running virtual machines than are actually present on the physical computer, the value returned by each guest operating system for the “\Processor(\*)\\% Processor Time” performance monitor counter will be low, even if in fact processor utilization is a bottleneck.</span></span> <span data-ttu-id="46ef8-187">這是因為利用實體處理器循環配置資源方式，虛擬處理器。</span><span class="sxs-lookup"><span data-stu-id="46ef8-187">This occurs because the virtual processors utilize the physical processors in a round-robin fashion.</span></span> <span data-ttu-id="46ef8-188">每個虛擬處理器會試著配置本身的共用的整體系統資源，因此在 4 個實體處理器的系統中，每個虛擬處理器會依預設會嘗試使用 25%的系統資源。</span><span class="sxs-lookup"><span data-stu-id="46ef8-188">Each virtual processor will try and allocate itself a share of overall system resources, so in a 4 physical processor system, each virtual processor will by default try to utilize 25% of the system resources.</span></span> <span data-ttu-id="46ef8-189">8 個虛擬處理器，以便共同建立這表示如果虛擬處理器會嘗試利用 200%的 CPU 容量的伺服器。</span><span class="sxs-lookup"><span data-stu-id="46ef8-189">If 8 virtual processors are created this means that collectively the virtual processors will attempt to utilize 200% of the server CPU capacity.</span></span> <span data-ttu-id="46ef8-190">在此情況下，每個虛擬處理器會回報所測量的低使用率 」 \Processor (\*)\\%Processor Time"（相對於它所需要的層級） 的效能監視器計數器和內容切換過多虛擬處理器會導致每個虛擬機器的效能不佳。</span><span class="sxs-lookup"><span data-stu-id="46ef8-190">In this case, each virtual processor will report a low utilization as measured by the “\Processor(\*)\\% Processor Time” performance monitor counter (relative to the level it expects) and the excessive context switching between the virtual processors will result in poor performance for each virtual machine.</span></span> <span data-ttu-id="46ef8-191">在此案例中，請考慮減少配置給主機作業系統上的 HYPER-V 虛擬機器的虛擬處理器數目。HYPER-V 提供 hypervisor 來監視效能的邏輯與虛擬處理器的效能物件。</span><span class="sxs-lookup"><span data-stu-id="46ef8-191">In this scenario, consider reducing the number of virtual processors allocated to Hyper-V virtual machines on the host operating system.Hyper-V provides hypervisor performance objects to monitor the performance of both logical and virtual processors.</span></span> <span data-ttu-id="46ef8-192">邏輯處理器與直接相互關聯的處理器或實體電腦已安裝的核心數目。</span><span class="sxs-lookup"><span data-stu-id="46ef8-192">A logical processor correlates directly to the number of processors or cores that are installed on the physical computer.</span></span> <span data-ttu-id="46ef8-193">比方說，8 個邏輯處理器會相互關聯的實體電腦上安裝的 2 個四核心處理器。</span><span class="sxs-lookup"><span data-stu-id="46ef8-193">For example, 2 quad core processors installed on the physical computer would correlate to 8 logical processors.</span></span> <span data-ttu-id="46ef8-194">虛擬處理器虛擬機器實際使用的項目，而且會以虛擬處理器根和子資料分割中的所有執行。</span><span class="sxs-lookup"><span data-stu-id="46ef8-194">Virtual processors are what the virtual machines actually use, and all execution in the root and child partitions occurs in virtual processors.</span></span>  

   <span data-ttu-id="46ef8-195">HYPER-V 提供 hypervisor 來監視效能的邏輯與虛擬處理器的效能物件。</span><span class="sxs-lookup"><span data-stu-id="46ef8-195">Hyper-V provides hypervisor performance objects to monitor the performance of both logical and virtual processors.</span></span> <span data-ttu-id="46ef8-196">邏輯處理器與直接相互關聯的處理器或實體電腦已安裝的核心數目。</span><span class="sxs-lookup"><span data-stu-id="46ef8-196">A logical processor correlates directly to the number of processors or cores that are installed on the physical computer.</span></span> <span data-ttu-id="46ef8-197">比方說，8 個邏輯處理器會相互關聯的實體電腦上安裝的 2 個四核心處理器。</span><span class="sxs-lookup"><span data-stu-id="46ef8-197">For example, 2 quad core processors installed on the physical computer would correlate to 8 logical processors.</span></span> <span data-ttu-id="46ef8-198">虛擬處理器虛擬機器實際使用的項目，而且會以虛擬處理器根和子資料分割中的所有執行。</span><span class="sxs-lookup"><span data-stu-id="46ef8-198">Virtual processors are what the virtual machines actually use, and all execution in the root and child partitions occurs in virtual processors.</span></span>  

   <span data-ttu-id="46ef8-199">若要精確地測量客體作業系統的處理器使用量，請使用 「 HYPER-V Hypervisor 邏輯 processor （_total） %total 執行階段 」 HYPER-V 主機作業系統上的效能監視器計數器。</span><span class="sxs-lookup"><span data-stu-id="46ef8-199">To accurately measure the processor utilization of a guest operating system, use the “Hyper-V Hypervisor Logical Processor(_Total)% Total Run Time” performance monitor counter on the Hyper-V host operating system.</span></span> <span data-ttu-id="46ef8-200">使用下列的臨界值，以評估客體作業系統系統處理器使用率使用 「 HYPER-V Hypervisor 邏輯 processor （_total） %total 執行階段 「 效能監視器計數器：</span><span class="sxs-lookup"><span data-stu-id="46ef8-200">Use the following thresholds to evaluate guest operating system processor utilization using the “Hyper-V Hypervisor Logical Processor(_Total)% Total Run Time” performance monitor counter:</span></span>  

  - <span data-ttu-id="46ef8-201">消耗低於 60%= 狀況良好</span><span class="sxs-lookup"><span data-stu-id="46ef8-201">Less than 60% consumed = Healthy</span></span>  

  - <span data-ttu-id="46ef8-202">60%-89%使用 = 監視或警告</span><span class="sxs-lookup"><span data-stu-id="46ef8-202">60% - 89% consumed = Monitor or Caution</span></span>  

  - <span data-ttu-id="46ef8-203">90%-100%使用 = 重大，效能會受到負面影響</span><span class="sxs-lookup"><span data-stu-id="46ef8-203">90% - 100% consumed = Critical, performance will be adversely affected</span></span>  

    <span data-ttu-id="46ef8-204">若要疑難排解 HYPER-V 環境上的客體作業系統的處理器效能，最好儘量主機作業系統所報告的值之間的平衡"\Hyper-V Hypervisor 邏輯 processor （_total)\\%執行總計時間 」 (LPTR) 和 「 \Hyper-V Hypervisor 虛擬 processor （_total)\\%的總執行時間 」 (VPTR)。</span><span class="sxs-lookup"><span data-stu-id="46ef8-204">To troubleshoot processor performance of guest operating systems on a Hyper-V environment, it is best to strive for a balance between the values reported by the host operating system for “\Hyper-V Hypervisor Logical Processor(_Total)\\% Total Run Time” (LPTR) and “\Hyper-V Hypervisor Virtual Processor(_Total)\\% Total Run Time” (VPTR).</span></span> <span data-ttu-id="46ef8-205">如果 LPTR 很高，而且 VPTR 不足再確認不會有更多的處理器配置給虛擬機器，超過實際可用的實體電腦上。</span><span class="sxs-lookup"><span data-stu-id="46ef8-205">If LPTR is high and VPTR is low then verify that there are not more processors allocated to virtual machines than are physically available on the physical computer.</span></span> <span data-ttu-id="46ef8-206">使用 「 \Hyper-V Hypervisor 虛擬 Processor(\*)\\客體執行時間百分比 」 計數器，可用來判斷哪一個虛擬處理器所耗用的 CPU，並取消配置虛擬處理器，從虛擬機器，視需要設定的一對一對應虛擬處理器與邏輯處理器。</span><span class="sxs-lookup"><span data-stu-id="46ef8-206">Use the “\Hyper-V Hypervisor Virtual Processor(\*)\\%Guest Run Time” counters to determine which virtual Processors are consuming CPU and de-allocate virtual processors from virtual machines as appropriate to configure a one to one mapping of virtual processors to logical processors.</span></span> <span data-ttu-id="46ef8-207">如需有關如何設定虛擬處理器與邏輯處理器的一對一對應的詳細資訊，請參閱中的 < 最佳化處理器效能 > 一節[檢查清單： 在 HYPER-V 上的 最佳化效能](~/technical-guides/checklist-optimizing-performance-on-hyper-v.md)。</span><span class="sxs-lookup"><span data-stu-id="46ef8-207">For more information about configuring a one to one mapping of virtual processors to logical processors, see the “Optimizing Processor Performance” section in [Checklist: Optimizing Performance on Hyper-V](~/technical-guides/checklist-optimizing-performance-on-hyper-v.md).</span></span> <span data-ttu-id="46ef8-208">如果 VPTR 很高，而且 LPTR 不足則考慮配置額外的虛擬機器的處理器，如果有可用的邏輯處理器，以及額外的處理器支援客體作業系統。</span><span class="sxs-lookup"><span data-stu-id="46ef8-208">If VPTR is high and LPTR is low then consider allocating additional processors to virtual machines if there are available logical processors and if additional processors are supported by the guest operating system.</span></span> <span data-ttu-id="46ef8-209">萬一其中 VPTR 很高，LPTR 偏低，有可用的邏輯處理器，若要配置，但額外的處理器不支援客體作業系統，請考慮藉由將實體電腦上的其他虛擬機器向外延展和配置給這些虛擬機器可用的處理器。</span><span class="sxs-lookup"><span data-stu-id="46ef8-209">In the case where VPTR is high, LPTR is low, there are available logical processors to allocate, but additional processors are not supported by the guest operating system, consider scaling out by adding additional virtual machines to the physical computer and allocating available processors to these virtual machines.</span></span> <span data-ttu-id="46ef8-210">在其中 VPTR 和 LPTR 是高的情況下，組態會推送的實體電腦的限制，並應該考慮將另一部實體電腦和其他 HYPER-V 虛擬機器加入至環境相應放大。</span><span class="sxs-lookup"><span data-stu-id="46ef8-210">In the case where both VPTR and LPTR are high, the configuration is pushing the limits of the physical computer and should consider scaling out by adding another physical computer and additional Hyper-V virtual machines to the environment.</span></span> <span data-ttu-id="46ef8-211">下列流程圖說明在 HYPER-V 環境中的處理器效能的疑難排解時，應使用的程序。</span><span class="sxs-lookup"><span data-stu-id="46ef8-211">The flowchart below describes the process that should be used when troubleshooting processor performance in a Hyper-V environment.</span></span>  

    <span data-ttu-id="46ef8-212">如果 VPTR 很高，而且 LPTR 偏低，則考慮配置額外的虛擬機器的處理器，如果有可用的邏輯處理器，以及額外的處理器支援客體作業系統。</span><span class="sxs-lookup"><span data-stu-id="46ef8-212">If VPTR is high and LPTR is low, then consider allocating additional processors to virtual machines if there are available logical processors and if additional processors are supported by the guest operating system.</span></span> <span data-ttu-id="46ef8-213">萬一其中 VPTR 很高，LPTR 偏低，有可用的邏輯處理器，若要配置，但額外的處理器不支援客體作業系統，請考慮藉由將實體電腦上的其他虛擬機器向外延展和配置給這些虛擬機器可用的處理器。</span><span class="sxs-lookup"><span data-stu-id="46ef8-213">In the case where VPTR is high, LPTR is low, there are available logical processors to allocate, but additional processors are not supported by the guest operating system, consider scaling out by adding additional virtual machines to the physical computer and allocating available processors to these virtual machines.</span></span> <span data-ttu-id="46ef8-214">在其中 VPTR 和 LPTR 是高的情況下，組態會推送的實體電腦的限制，並應該考慮將另一部實體電腦和其他 HYPER-V 虛擬機器加入至環境相應放大。</span><span class="sxs-lookup"><span data-stu-id="46ef8-214">In the case where both VPTR and LPTR are high, the configuration is pushing the limits of the physical computer and should consider scaling out by adding another physical computer and additional Hyper-V virtual machines to the environment.</span></span> <span data-ttu-id="46ef8-215">下列流程圖說明在 HYPER-V 環境中的處理器效能的疑難排解時，應使用的程序。</span><span class="sxs-lookup"><span data-stu-id="46ef8-215">The flowchart below describes the process that should be used when troubleshooting processor performance in a Hyper-V environment.</span></span>  

    <span data-ttu-id="46ef8-216">![疑難排解 Hyper-v 上的 CPU 效能&#45;V](../technical-guides/media/623fdcd6-e80b-4ba9-bf46-5d9b92b6612b.gif "623fdcd6-e80b-4ba9-bf46-5d9b92b6612b")</span><span class="sxs-lookup"><span data-stu-id="46ef8-216">![Troubleshooting CPU Performance on Hyper&#45;V](../technical-guides/media/623fdcd6-e80b-4ba9-bf46-5d9b92b6612b.gif "623fdcd6-e80b-4ba9-bf46-5d9b92b6612b")</span></span>  
    <span data-ttu-id="46ef8-217">在 HYPER-V 環境中的 CPU 效能疑難排解</span><span class="sxs-lookup"><span data-stu-id="46ef8-217">Troubleshooting CPU performance in a Hyper-V Environment</span></span>  

  > [!NOTE]  
  >  <span data-ttu-id="46ef8-218">**客體作業系統的處理器不需要實體的處理器核心組同質性**– hypervisor 會決定如何實體資源使用。</span><span class="sxs-lookup"><span data-stu-id="46ef8-218">**Guest operating system processors do not have a set affinity to physical processors/cores** – The hypervisor determines how physical resources are used.</span></span> <span data-ttu-id="46ef8-219">在處理器使用率的情況下 hypervisor 會排程的執行緒形式的實體處理器的來賓處理器時間。</span><span class="sxs-lookup"><span data-stu-id="46ef8-219">In the case of processor utilization, the hypervisor schedules the guest processor time to physical processor in the form of threads.</span></span> <span data-ttu-id="46ef8-220">這表示虛擬機器的處理器負載會分散於實體電腦的處理器。</span><span class="sxs-lookup"><span data-stu-id="46ef8-220">This means the processor load of virtual machines will be spread across the processors of the physical computer.</span></span> <span data-ttu-id="46ef8-221">此外，虛擬機器不能超過設定的數個邏輯處理器，例如，如果單一虛擬機器設定為具有 8 個處理器/核心，在實體電腦上執行 2 個邏輯處理器的處理器使用量則虛擬機器不能超過設定的邏輯處理器 （在此情況下 2 個處理器） 數目的處理器容量。</span><span class="sxs-lookup"><span data-stu-id="46ef8-221">Furthermore, virtual machines cannot exceed the processor utilization of the configured number of logical processors, for example if a single virtual machine is configured to run with 2 logical processors on a physical computer with 8 processors/cores, then the virtual machine cannot exceed the processor capacity of the number of configured logical processors (in this case 2 processors).</span></span>  

- <span data-ttu-id="46ef8-222">**測量整體處理器使用率的 HYPER-V 環境中，使用 HYPER-V 效能監視計數器-** 基於測量處理器使用率，主機作業系統邏輯上視為只是另一個客體作業系統.</span><span class="sxs-lookup"><span data-stu-id="46ef8-222">**Measure overall processor utilization of the Hyper-V environment using Hyper-V performance monitor counters -** For purposes of measuring processor utilization, the host operating system is logically viewed as just another guest operating system.</span></span> <span data-ttu-id="46ef8-223">因此，「 \Processor(\*)\\%Processor Time"監視的計數器會測量主控件僅限作業系統的處理器使用量。</span><span class="sxs-lookup"><span data-stu-id="46ef8-223">Therefore, the “\Processor(\*)\\% Processor Time” monitor counter measures the processor utilization of the host operating system only.</span></span> <span data-ttu-id="46ef8-224">若要測量的主機作業系統和所有的客體作業系統的實體處理器總使用率，使用"\Hyper-V Hypervisor 邏輯 processor （_total)\\%total 執行階段 「 效能監視器計數器。</span><span class="sxs-lookup"><span data-stu-id="46ef8-224">To measure total physical processor utilization of the host operating system and all guest operating systems, use the “\Hyper-V Hypervisor Logical Processor(_Total)\\% Total Run Time” performance monitor counter.</span></span> <span data-ttu-id="46ef8-225">此計數器會測量處理器執行這兩個主機作業系統所花費的時間百分比總計，所有客體作業系統。</span><span class="sxs-lookup"><span data-stu-id="46ef8-225">This counter measures the total percentage of time spent by the processor running the both the host operating system and all guest operating systems.</span></span>  

   <span data-ttu-id="46ef8-226">使用下列的臨界值評估的 HYPER-V 環境使用的整體處理器使用率 」 \Hyper-V Hypervisor 邏輯 processor （_total)\\%total 執行階段 「 效能監視器計數器：</span><span class="sxs-lookup"><span data-stu-id="46ef8-226">Use the following thresholds to evaluate overall processor utilization of the Hyper-V environment using the “\Hyper-V Hypervisor Logical Processor(_Total)\\% Total Run Time” performance monitor counter:</span></span>  

  - <span data-ttu-id="46ef8-227">消耗低於 60%= 狀況良好</span><span class="sxs-lookup"><span data-stu-id="46ef8-227">Less than 60% consumed = Healthy</span></span>  

  - <span data-ttu-id="46ef8-228">60%-89%使用 = 監視或警告</span><span class="sxs-lookup"><span data-stu-id="46ef8-228">60% - 89% consumed = Monitor or Caution</span></span>  

  - <span data-ttu-id="46ef8-229">90%-100%使用 = 重大，效能會受到負面影響</span><span class="sxs-lookup"><span data-stu-id="46ef8-229">90% - 100% consumed = Critical, performance will be adversely affected</span></span>  

    <span data-ttu-id="46ef8-230">如需有關處理器使用率，請檢閱下列資源：</span><span class="sxs-lookup"><span data-stu-id="46ef8-230">For more information about processor utilization review the following resources:</span></span>  

  - <span data-ttu-id="46ef8-231">"How To： 識別導致高的使用者模式 CPU 瓶頸的伺服器應用程式在生產環境中的函式 」 在[ http://go.microsoft.com/fwlink/?LinkID=107047 ](http://go.microsoft.com/fwlink/?LinkID=107047)。</span><span class="sxs-lookup"><span data-stu-id="46ef8-231">“How To: Identify Functions causing a High User-mode CPU Bottleneck for Server Applications in a Production Environment” at [http://go.microsoft.com/fwlink/?LinkID=107047](http://go.microsoft.com/fwlink/?LinkID=107047).</span></span>  

  - <span data-ttu-id="46ef8-232">在的"章 15-測量的.NET 應用程式效能 」 [ http://go.microsoft.com/fwlink/?LinkId=121073 ](http://go.microsoft.com/fwlink/?LinkId=121073)。</span><span class="sxs-lookup"><span data-stu-id="46ef8-232">“Chapter 15 - Measuring .NET Application Performance” at [http://go.microsoft.com/fwlink/?LinkId=121073](http://go.microsoft.com/fwlink/?LinkId=121073).</span></span>
