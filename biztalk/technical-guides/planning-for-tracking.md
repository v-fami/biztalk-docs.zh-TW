---
title: 規劃追蹤 |Microsoft 文件
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 8ffc8573-1b4a-47c7-96ab-0471f43facf5
caps.latest.revision: 3
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: c9853fccde9c5fa6e8c223106c8386f19298d0b9
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
ms.locfileid: "22302078"
---
# <a name="planning-for-tracking"></a><span data-ttu-id="e2385-102">規劃追蹤</span><span class="sxs-lookup"><span data-stu-id="e2385-102">Planning for Tracking</span></span>
<span data-ttu-id="e2385-103">追蹤的訊息是部分的訊息執行個體，例如訊息本文、 訊息屬性和中繼資料儲存的資料庫中，通常為封存之用的程序。</span><span class="sxs-lookup"><span data-stu-id="e2385-103">Message tracking is the process by which parts of a message instance, such as the message body, message properties, and metadata are stored in a database, typically for archival purposes.</span></span> <span data-ttu-id="e2385-104">後續可以檢視追蹤的訊息執行個體部分執行查詢，從 [群組中樞] 頁面中[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台。</span><span class="sxs-lookup"><span data-stu-id="e2385-104">Message instance parts that are tracked can subsequently be viewed by running queries from the Group Hub page in the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span> <span data-ttu-id="e2385-105">除了存取封存的資料，您也可以檢視即時資料，可以識別並修正開發中的問題或預備環境的有力工具。</span><span class="sxs-lookup"><span data-stu-id="e2385-105">In addition to accessing archived data, you can also view live data, which can be a helpful tool for identifying and fixing problems in a development or staging environment.</span></span>  
  
 <span data-ttu-id="e2385-106">因為郵件追蹤的程序可以是非常耗用資源，您應該檢閱本主題建立您的計劃之前。</span><span class="sxs-lookup"><span data-stu-id="e2385-106">Since the process of message tracking can be very resource intensive, you should review this topic before creating your plan.</span></span>  
  
 <span data-ttu-id="e2385-107">如需有關追蹤的詳細資訊，請參閱[健全狀況與活動追蹤](http://go.microsoft.com/fwlink/?LinkId=154187)(http://go.microsoft.com/fwlink/?LinkId=154187)。</span><span class="sxs-lookup"><span data-stu-id="e2385-107">For more information about tracking, see [Health and Activity Tracking](http://go.microsoft.com/fwlink/?LinkId=154187) (http://go.microsoft.com/fwlink/?LinkId=154187).</span></span>  
  
## <a name="configuring-and-enabling-the-dta-purge-and-archive-sql-agent-job"></a><span data-ttu-id="e2385-108">設定及啟用 DTA 清除與封存 SQL Agent 作業</span><span class="sxs-lookup"><span data-stu-id="e2385-108">Configuring and Enabling the DTA Purge and Archive SQL Agent Job</span></span>  
 <span data-ttu-id="e2385-109">這項作業會封存和清除舊的資料從 BizTalk 追蹤資料庫，藉此讓它變得太大。</span><span class="sxs-lookup"><span data-stu-id="e2385-109">This job archives and purges old data from the BizTalk Tracking database, thus keeping it from becoming too large.</span></span> <span data-ttu-id="e2385-110">這是不可或缺的狀況良好[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]系統。</span><span class="sxs-lookup"><span data-stu-id="e2385-110">This is essential for a healthy [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] system.</span></span> <span data-ttu-id="e2385-111">在大型追蹤資料庫將會開始追蹤主控件以及任何其他處理序的效能影響該查詢追蹤資料庫。</span><span class="sxs-lookup"><span data-stu-id="e2385-111">A large tracking database will begin to affect the performance of the tracking host and any other processes that query the tracking database.</span></span>  
  
-   <span data-ttu-id="e2385-112">**請確認已正確設定、 啟用以及已成功完成 DTA 清除與封存 SQL 代理程式作業。**</span><span class="sxs-lookup"><span data-stu-id="e2385-112">**Ensure that the DTA Purge and Archive SQL Agent job is properly configured, enabled, and successfully completing.**</span></span> <span data-ttu-id="e2385-113">因為您必須先將它設定為包含可以在其中寫入封存檔案的目錄，預設不會啟用這項作業。</span><span class="sxs-lookup"><span data-stu-id="e2385-113">This job is not enabled by default because you must first configure it to include a directory where the archive files can be written.</span></span>  
  
-   <span data-ttu-id="e2385-114">**請確保工作能夠以最快速度的內送的追蹤資料會產生清除追蹤資料。**</span><span class="sxs-lookup"><span data-stu-id="e2385-114">**Ensure that the job is able to purge the tracking data as fast as the incoming tracking data is generated.**</span></span> <span data-ttu-id="e2385-115">它是可接受的工作負載在尖峰期間，取得，但永遠應該能夠跟上。</span><span class="sxs-lookup"><span data-stu-id="e2385-115">It is acceptable for the job to get behind during peak load times, but it should always be able to catch up.</span></span> <span data-ttu-id="e2385-116">如果清除工作落後，而且絕不會是能夠趕上，BizTalk 追蹤資料庫將會繼續成長，而效能將最終會受到負面影響。</span><span class="sxs-lookup"><span data-stu-id="e2385-116">If the purge job gets behind and is never able to catch up, the BizTalk Tracking database will continue to grow, and performance will eventually be adversely affected.</span></span>  
  
-   <span data-ttu-id="e2385-117">**檢閱軟清除和硬清除參數，以確保您會保留足夠的時間，但不是太長的資料。**</span><span class="sxs-lookup"><span data-stu-id="e2385-117">**Review the soft purge and hard purge parameters to ensure you are keeping data long enough but not too long.**</span></span> <span data-ttu-id="e2385-118">如需這些參數的詳細資訊，請參閱[封存和清除 BizTalk 追蹤資料庫](http://go.microsoft.com/fwlink/?LinkID=153816)(http://go.microsoft.com/fwlink/?LinkID=153816)。</span><span class="sxs-lookup"><span data-stu-id="e2385-118">For more information about these parameters see [Archiving and Purging the BizTalk Tracking Database](http://go.microsoft.com/fwlink/?LinkID=153816) (http://go.microsoft.com/fwlink/?LinkID=153816).</span></span>  
  
-   <span data-ttu-id="e2385-119">**如果您只需要清除舊資料，而不需要將它封存在第一次，然後變更 SQL Agent 作業來呼叫預存程序 」 dtasp_PurgeTrackingDatabase"。**</span><span class="sxs-lookup"><span data-stu-id="e2385-119">**If you only need to purge the old data and do not need to archive it first, then change the SQL Agent job to call the stored procedure “dtasp_PurgeTrackingDatabase”.**</span></span> <span data-ttu-id="e2385-120">這會略過 「 封存 」 步驟，並只清除。</span><span class="sxs-lookup"><span data-stu-id="e2385-120">This skips the archive step, and just does the purge.</span></span> <span data-ttu-id="e2385-121">如需有關這個預存程序和變更的 SQL 代理程式作業來使用它時，請參閱[如何從 BizTalk 追蹤資料庫清除資料](http://go.microsoft.com/fwlink/?LinkID=153817)(http://go.microsoft.com/fwlink/?LinkID=153817)。</span><span class="sxs-lookup"><span data-stu-id="e2385-121">For more information about this stored procedure and changing the SQL Agent job to use it, see [How to Purge Data from the BizTalk Tracking Database](http://go.microsoft.com/fwlink/?LinkID=153817) (http://go.microsoft.com/fwlink/?LinkID=153817).</span></span>  
  
-   <span data-ttu-id="e2385-122">**如果您需要保留 「 BizTalk 追蹤 」 資料庫封存檔案，請確定您已成功還原，並使用它們的位置中有程序。**</span><span class="sxs-lookup"><span data-stu-id="e2385-122">**If you need to keep the BizTalk Tracking database archive files, ensure that you have a process in place to successfully restore and use them.**</span></span>  
  
-   <span data-ttu-id="e2385-123">**如果您有會清除 BizTalk 追蹤資料庫中，而暫時解決的效能問題，而且您想要將 BizTalk 設定為不再收集追蹤資訊，您可能要考慮關閉全域追蹤。**</span><span class="sxs-lookup"><span data-stu-id="e2385-123">**If you are having performance issues that are momentarily addressed by purging the BizTalk tracking database, and you want to configure BizTalk to no longer collect tracking information, you may want to consider turning off global tracking.**</span></span> <span data-ttu-id="e2385-124">如需如何關閉全域追蹤資訊，請參閱主題[如何關閉全域追蹤](http://go.microsoft.com/fwlink/?LinkID=154193)(http://go.microsoft.com/fwlink/?LinkID=154193)。</span><span class="sxs-lookup"><span data-stu-id="e2385-124">For information about how to turn off global tracking, see the topic [How to Turn Off Global Tracking](http://go.microsoft.com/fwlink/?LinkID=154193) (http://go.microsoft.com/fwlink/?LinkID=154193).</span></span>  
  
## <a name="creating-a-dedicated-tracking-host"></a><span data-ttu-id="e2385-125">建立專用的追蹤主控件</span><span class="sxs-lookup"><span data-stu-id="e2385-125">Creating a Dedicated Tracking Host</span></span>  
 <span data-ttu-id="e2385-126">當選擇**允許主控件追蹤**主機在 BizTalk Server 管理主控台中，該主控件執行個體將會執行追蹤資料解碼 Service (TDDS) 將追蹤的資料，從已啟用[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]MessageBoxBizTalk 追蹤資料庫的資料庫。</span><span class="sxs-lookup"><span data-stu-id="e2385-126">When the option to **Allow Host Tracking** is enabled for a host in the BizTalk Server Administration console, instances of that host will run the Tracking Data Decode Service (TDDS) to move tracked data from the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] MessageBox database to the BizTalk Tracking database.</span></span> <span data-ttu-id="e2385-127">因為 TDDS 可能會耗用資源，請考慮建立的 「 專用 」 追蹤主控件**允許主控件追蹤**啟用選項，而且這不會執行任何其他[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]程序 （例如配接器或協調流程）。</span><span class="sxs-lookup"><span data-stu-id="e2385-127">Since TDDS may be resource intensive, consider creating a "dedicated" tracking host for which the **Allow Host Tracking** option is enabled and which does not run any other [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] processes (such as adapters or orchestrations).</span></span> <span data-ttu-id="e2385-128">如果您的 BizTalk 群組包含一個以上的 BizTalk server，也公認的最佳作法是 TDDS 提供高可用性群組中每個伺服器上建立此主控件執行個體。</span><span class="sxs-lookup"><span data-stu-id="e2385-128">If your BizTalk group contains more than one BizTalk server, it is also considered a best practice to create an instance of this host on each server in the group to provide high availability for TDDS.</span></span>  
  
## <a name="testing-to-measure-maximum-sustainable-tracking-throughput"></a><span data-ttu-id="e2385-129">測試量值最大持續性追蹤輸送量</span><span class="sxs-lookup"><span data-stu-id="e2385-129">Testing to Measure Maximum Sustainable Tracking Throughput</span></span>  
 <span data-ttu-id="e2385-130">追蹤的完備訊息是資源極大量的活動，若未妥善管理可以有非常不良的效能影響[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]環境。</span><span class="sxs-lookup"><span data-stu-id="e2385-130">Extensive message tracking is a very resource intensive activity and if not properly managed can have an extremely adverse effect on the performance of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment.</span></span> <span data-ttu-id="e2385-131">因此，您應該衡量的最大持續性追蹤輸送量您[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]環境來確保系統持續性，且會在指定的訊息流程速率無限期地執行。</span><span class="sxs-lookup"><span data-stu-id="e2385-131">Therefore, you should measure maximum sustainable tracking throughput for your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment to ensure that the system is sustainable and will run indefinitely at a given message flow rate.</span></span> <span data-ttu-id="e2385-132">如需有關如何測量最大持續性追蹤輸送量的詳細資訊，請參閱[測量最大持續性追蹤輸送量](http://go.microsoft.com/fwlink/?LinkID=153815)(http://go.microsoft.com/fwlink/?LinkID=153815)。</span><span class="sxs-lookup"><span data-stu-id="e2385-132">For more information about measuring maximum sustainable tracking throughput, see [Measuring Maximum Sustainable Tracking Throughput](http://go.microsoft.com/fwlink/?LinkID=153815) (http://go.microsoft.com/fwlink/?LinkID=153815).</span></span>  
  
##  <a name="BKMK_TrackingBP"></a><span data-ttu-id="e2385-133">追蹤的最佳作法</span><span class="sxs-lookup"><span data-stu-id="e2385-133">Best Practices for Tracking</span></span>  
  
-   <span data-ttu-id="e2385-134">**決定您需要在計劃期間追蹤的資訊**： 您應規劃期間，決定設置追蹤，讓您部署專案之後，您可以設定追蹤選項和限制的追蹤資料量所需的資訊請提供您所需的資訊。</span><span class="sxs-lookup"><span data-stu-id="e2385-134">**Determine the information you need to track during planning** : You should decide during the planning stages which information you need to track, so that after you deploy the project you can set the tracking options and limit the amount of tracked data to give you only the information you need.</span></span>  
  
-   <span data-ttu-id="e2385-135">**不要追蹤所有訊息**： 我們建議您在不都追蹤所有訊息，因為每次觸及訊息時，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]會製作另一個複本。</span><span class="sxs-lookup"><span data-stu-id="e2385-135">**Do not track all messages**: We recommend that you not track all messages, because each time a message is touched, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] makes another copy.</span></span> <span data-ttu-id="e2385-136">您可以改為縮小範圍，藉由追蹤特定連接埠。</span><span class="sxs-lookup"><span data-stu-id="e2385-136">You can instead narrow the scope by tracking only a specific port.</span></span> <span data-ttu-id="e2385-137">這有助於將您的系統效能最大化，並保持資料庫的整齊。</span><span class="sxs-lookup"><span data-stu-id="e2385-137">This helps to maximize the performance of your system and to keep the databases uncluttered.</span></span>  
  
-   <span data-ttu-id="e2385-138">**設定追蹤傳送埠和接收埠而不是在管線**： 如果您設定管線的追蹤選項，您也會設定每個管線所使用的連接埠全域追蹤選項。</span><span class="sxs-lookup"><span data-stu-id="e2385-138">**Set tracking on send ports and receive ports instead of on a pipeline**: If you set tracking options on pipelines, you will also set the tracking options globally for every port that uses the pipeline.</span></span> <span data-ttu-id="e2385-139">這又可能會導致更多正在追蹤資料比您想要這會拖慢系統效能。</span><span class="sxs-lookup"><span data-stu-id="e2385-139">This in turn may result in far more data being tracked than you intend, which will slow system performance.</span></span> <span data-ttu-id="e2385-140">相反地，您可以設定追蹤選項，傳送連接埠和接收埠。</span><span class="sxs-lookup"><span data-stu-id="e2385-140">Instead, you can set tracking options on send ports and receive ports.</span></span>  
  
-   <span data-ttu-id="e2385-141">**請考慮各種因素 BizTalk 追蹤資料庫大小**:</span><span class="sxs-lookup"><span data-stu-id="e2385-141">**Take into account various factors when you size the BizTalk Tracking database**:</span></span>  
  
    -   <span data-ttu-id="e2385-142">當調整 BizTalk 追蹤資料庫的大小，考量到 SQL Server 的因素，例如索引大小應變乘數加入您的計算。</span><span class="sxs-lookup"><span data-stu-id="e2385-142">When sizing the BizTalk Tracking database, account for SQL Server factors, such as index size, by adding a contingency multiplier to your calculations.</span></span>  
  
    -   <span data-ttu-id="e2385-143">在決定 BizTalk 追蹤資料庫中的訊息大小，加入訊息內容的平均大小的訊息大小是否重要訊息大小相較之下。</span><span class="sxs-lookup"><span data-stu-id="e2385-143">When determining the size of messages in the BizTalk Tracking database, add the average size of the message context to the message size if it is significant compared to the message size.</span></span>  
  
    -   <span data-ttu-id="e2385-144">若要限制 BizTalk 追蹤資料庫中的訊息大小，請限制您將升級的屬性數目。</span><span class="sxs-lookup"><span data-stu-id="e2385-144">To limit the size of messages in the BizTalk Tracking database, limit the number of properties that you promote.</span></span> <span data-ttu-id="e2385-145">如果需要進行路由，應該只使用升級屬性，否則請使用辨別的欄位。</span><span class="sxs-lookup"><span data-stu-id="e2385-145">You should only use promoted properties if you need them for routing purposes, otherwise use distinguished fields.</span></span>  
  
    -   <span data-ttu-id="e2385-146">如果協調流程**圖形開始和結束**選項已啟用，請考慮每個圖形中每個協調流程執行個體的啟動和停止事件儲存在 「 BizTalk 追蹤資料庫中。</span><span class="sxs-lookup"><span data-stu-id="e2385-146">If the orchestration **Shape start and end** option is enabled, take into account that a start and stop event for each shape in each orchestration instance is saved in the BizTalk Tracking database.</span></span>