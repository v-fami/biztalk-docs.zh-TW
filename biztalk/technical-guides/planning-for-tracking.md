---
title: 規劃追蹤 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 8ffc8573-1b4a-47c7-96ab-0471f43facf5
caps.latest.revision: 3
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: c0c45c61efee90b68efc927d88dbcf6429fe13e2
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "36973823"
---
# <a name="planning-for-tracking"></a><span data-ttu-id="e59be-102">規劃追蹤</span><span class="sxs-lookup"><span data-stu-id="e59be-102">Planning for Tracking</span></span>
<span data-ttu-id="e59be-103">追蹤的訊息是由其中的部分的訊息執行個體，例如訊息本文、 訊息屬性和中繼資料會儲存在資料庫中，通常為封存之用的程序。</span><span class="sxs-lookup"><span data-stu-id="e59be-103">Message tracking is the process by which parts of a message instance, such as the message body, message properties, and metadata are stored in a database, typically for archival purposes.</span></span> <span data-ttu-id="e59be-104">之後可以檢視追蹤的訊息執行個體組件從 [群組中樞] 頁面中執行查詢[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台。</span><span class="sxs-lookup"><span data-stu-id="e59be-104">Message instance parts that are tracked can subsequently be viewed by running queries from the Group Hub page in the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span> <span data-ttu-id="e59be-105">除了存取封存的資料，您也可以檢視即時資料，它可以是有用的工具，用來識別並修正問題，在開發或預備環境。</span><span class="sxs-lookup"><span data-stu-id="e59be-105">In addition to accessing archived data, you can also view live data, which can be a helpful tool for identifying and fixing problems in a development or staging environment.</span></span>  
  
 <span data-ttu-id="e59be-106">因為訊息追蹤的程序可以是非常耗用資源，您應該檢閱本主題之前先建立您的計劃。</span><span class="sxs-lookup"><span data-stu-id="e59be-106">Since the process of message tracking can be very resource intensive, you should review this topic before creating your plan.</span></span>  
  
 <span data-ttu-id="e59be-107">如需有關追蹤的詳細資訊，請參閱 <<c0> [ 健全狀況與活動追蹤](http://go.microsoft.com/fwlink/?LinkId=154187)(http://go.microsoft.com/fwlink/?LinkId=154187)。</span><span class="sxs-lookup"><span data-stu-id="e59be-107">For more information about tracking, see [Health and Activity Tracking](http://go.microsoft.com/fwlink/?LinkId=154187) (http://go.microsoft.com/fwlink/?LinkId=154187).</span></span>  
  
## <a name="configuring-and-enabling-the-dta-purge-and-archive-sql-agent-job"></a><span data-ttu-id="e59be-108">設定並啟用 DTA 清除與封存 SQL Agent 作業</span><span class="sxs-lookup"><span data-stu-id="e59be-108">Configuring and Enabling the DTA Purge and Archive SQL Agent Job</span></span>  
 <span data-ttu-id="e59be-109">此工作會封存和清除 BizTalk 追蹤資料庫，藉此讓它變得太大的舊資料。</span><span class="sxs-lookup"><span data-stu-id="e59be-109">This job archives and purges old data from the BizTalk Tracking database, thus keeping it from becoming too large.</span></span> <span data-ttu-id="e59be-110">這是不可或缺的狀況良好[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]系統。</span><span class="sxs-lookup"><span data-stu-id="e59be-110">This is essential for a healthy [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] system.</span></span> <span data-ttu-id="e59be-111">大型的追蹤資料庫就會開始影響該查詢追蹤資料庫的追蹤主控件和任何其他處理序的效能。</span><span class="sxs-lookup"><span data-stu-id="e59be-111">A large tracking database will begin to affect the performance of the tracking host and any other processes that query the tracking database.</span></span>  
  
-   <span data-ttu-id="e59be-112">**請確定 DTA 清除與封存 SQL Agent 作業已正確設定、 啟用以及成功完成。**</span><span class="sxs-lookup"><span data-stu-id="e59be-112">**Ensure that the DTA Purge and Archive SQL Agent job is properly configured, enabled, and successfully completing.**</span></span> <span data-ttu-id="e59be-113">因為您必須先設定其包含可以在其中寫入封存檔案的目錄，預設不會啟用這項作業。</span><span class="sxs-lookup"><span data-stu-id="e59be-113">This job is not enabled by default because you must first configure it to include a directory where the archive files can be written.</span></span>  
  
-   <span data-ttu-id="e59be-114">**請確定工作是能夠以最快速度的內送的追蹤資料會產生清除追蹤資料。**</span><span class="sxs-lookup"><span data-stu-id="e59be-114">**Ensure that the job is able to purge the tracking data as fast as the incoming tracking data is generated.**</span></span> <span data-ttu-id="e59be-115">它是可接受的尖峰負載時間時，取得後置作業，但它應該一律能夠趕上。</span><span class="sxs-lookup"><span data-stu-id="e59be-115">It is acceptable for the job to get behind during peak load times, but it should always be able to catch up.</span></span> <span data-ttu-id="e59be-116">如果清除工作落後，而且絕不會是能夠趕上，BizTalk 追蹤資料庫將會繼續成長，以及效能會最後會受到負面影響。</span><span class="sxs-lookup"><span data-stu-id="e59be-116">If the purge job gets behind and is never able to catch up, the BizTalk Tracking database will continue to grow, and performance will eventually be adversely affected.</span></span>  
  
-   <span data-ttu-id="e59be-117">**檢閱軟清除和硬清除參數，以確保您會保留足夠的時間，但不是會太長的資料。**</span><span class="sxs-lookup"><span data-stu-id="e59be-117">**Review the soft purge and hard purge parameters to ensure you are keeping data long enough but not too long.**</span></span> <span data-ttu-id="e59be-118">如需這些參數的詳細資訊，請參閱[封存和清除 BizTalk 追蹤資料庫](http://go.microsoft.com/fwlink/?LinkID=153816)(http://go.microsoft.com/fwlink/?LinkID=153816)。</span><span class="sxs-lookup"><span data-stu-id="e59be-118">For more information about these parameters see [Archiving and Purging the BizTalk Tracking Database](http://go.microsoft.com/fwlink/?LinkID=153816) (http://go.microsoft.com/fwlink/?LinkID=153816).</span></span>  
  
-   <span data-ttu-id="e59be-119">**如果您只需要清除舊資料，也不需要將它封存到第一次，然後變更 SQL 代理程式作業來呼叫預存程序 」 dtasp_PurgeTrackingDatabase"。**</span><span class="sxs-lookup"><span data-stu-id="e59be-119">**If you only need to purge the old data and do not need to archive it first, then change the SQL Agent job to call the stored procedure “dtasp_PurgeTrackingDatabase”.**</span></span> <span data-ttu-id="e59be-120">這會略過 「 封存 」 步驟，並產生只會清除。</span><span class="sxs-lookup"><span data-stu-id="e59be-120">This skips the archive step, and just does the purge.</span></span> <span data-ttu-id="e59be-121">如需有關這個預存程序，並變更 SQL Agent 作業來使用它，請參閱[如何從 BizTalk 追蹤資料庫清除資料](http://go.microsoft.com/fwlink/?LinkID=153817)(http://go.microsoft.com/fwlink/?LinkID=153817)。</span><span class="sxs-lookup"><span data-stu-id="e59be-121">For more information about this stored procedure and changing the SQL Agent job to use it, see [How to Purge Data from the BizTalk Tracking Database](http://go.microsoft.com/fwlink/?LinkID=153817) (http://go.microsoft.com/fwlink/?LinkID=153817).</span></span>  
  
-   <span data-ttu-id="e59be-122">**如果您需要將 BizTalk 追蹤資料庫封存檔案，請確定您已經找備妥已成功還原，並使用它們的處理程序。**</span><span class="sxs-lookup"><span data-stu-id="e59be-122">**If you need to keep the BizTalk Tracking database archive files, ensure that you have a process in place to successfully restore and use them.**</span></span>  
  
-   <span data-ttu-id="e59be-123">**如果您有會藉由清除 BizTalk 追蹤資料庫中，而暫時解決的效能問題，而且您想要設定為不再收集追蹤資訊的 BizTalk，您可能要考慮關閉全域追蹤。**</span><span class="sxs-lookup"><span data-stu-id="e59be-123">**If you are having performance issues that are momentarily addressed by purging the BizTalk tracking database, and you want to configure BizTalk to no longer collect tracking information, you may want to consider turning off global tracking.**</span></span> <span data-ttu-id="e59be-124">如需如何關閉全域追蹤資訊，請參閱主題[如何關閉全域追蹤](http://go.microsoft.com/fwlink/?LinkID=154193)(http://go.microsoft.com/fwlink/?LinkID=154193)。</span><span class="sxs-lookup"><span data-stu-id="e59be-124">For information about how to turn off global tracking, see the topic [How to Turn Off Global Tracking](http://go.microsoft.com/fwlink/?LinkID=154193) (http://go.microsoft.com/fwlink/?LinkID=154193).</span></span>  
  
## <a name="creating-a-dedicated-tracking-host"></a><span data-ttu-id="e59be-125">建立專用的追蹤主控件</span><span class="sxs-lookup"><span data-stu-id="e59be-125">Creating a Dedicated Tracking Host</span></span>  
 <span data-ttu-id="e59be-126">當選擇**允許主控件追蹤**在 BizTalk Server 管理主控台中，該主控件執行個體的主機將執行追蹤資料解碼 Service (TDDS) 將追蹤的資料，從已啟用[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]MessageBoxBizTalk 追蹤資料庫的資料庫。</span><span class="sxs-lookup"><span data-stu-id="e59be-126">When the option to **Allow Host Tracking** is enabled for a host in the BizTalk Server Administration console, instances of that host will run the Tracking Data Decode Service (TDDS) to move tracked data from the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] MessageBox database to the BizTalk Tracking database.</span></span> <span data-ttu-id="e59be-127">因為 TDDS 可能耗用大量資源，請考慮建立 「 專用 」 追蹤主控件為其**允許主控件追蹤**啟用選項，而且這不會執行任何其他[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]程序 （例如配接器或協調流程）。</span><span class="sxs-lookup"><span data-stu-id="e59be-127">Since TDDS may be resource intensive, consider creating a "dedicated" tracking host for which the **Allow Host Tracking** option is enabled and which does not run any other [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] processes (such as adapters or orchestrations).</span></span> <span data-ttu-id="e59be-128">如果您的 BizTalk 群組包含一個以上的 BizTalk server，它也會被視為最佳作法為 TDDS 提供高可用性群組中的每一部伺服器上建立此主控件執行個體。</span><span class="sxs-lookup"><span data-stu-id="e59be-128">If your BizTalk group contains more than one BizTalk server, it is also considered a best practice to create an instance of this host on each server in the group to provide high availability for TDDS.</span></span>  
  
## <a name="testing-to-measure-maximum-sustainable-tracking-throughput"></a><span data-ttu-id="e59be-129">測試以測量最大持續性追蹤輸送量</span><span class="sxs-lookup"><span data-stu-id="e59be-129">Testing to Measure Maximum Sustainable Tracking Throughput</span></span>  
 <span data-ttu-id="e59be-130">追蹤的完備訊息是大量資源的大量活動，若未妥善管理可以有的效能相當不利的影響[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]環境。</span><span class="sxs-lookup"><span data-stu-id="e59be-130">Extensive message tracking is a very resource intensive activity and if not properly managed can have an extremely adverse effect on the performance of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment.</span></span> <span data-ttu-id="e59be-131">因此，您應該測量最大持續性追蹤輸送量您[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]環境，以確保系統持續性，且將會在指定的訊息流程速率無限期地執行。</span><span class="sxs-lookup"><span data-stu-id="e59be-131">Therefore, you should measure maximum sustainable tracking throughput for your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment to ensure that the system is sustainable and will run indefinitely at a given message flow rate.</span></span> <span data-ttu-id="e59be-132">如需有關如何測量最大持續性追蹤輸送量的詳細資訊，請參閱 <<c0> [ 測量最大持續性追蹤輸送量](http://go.microsoft.com/fwlink/?LinkID=153815)(<http://go.microsoft.com/fwlink/?LinkID=153815>)。</span><span class="sxs-lookup"><span data-stu-id="e59be-132">For more information about measuring maximum sustainable tracking throughput, see [Measuring Maximum Sustainable Tracking Throughput](http://go.microsoft.com/fwlink/?LinkID=153815) (<http://go.microsoft.com/fwlink/?LinkID=153815>).</span></span>  
  
##  <a name="BKMK_TrackingBP"></a> <span data-ttu-id="e59be-133">追蹤的最佳作法</span><span class="sxs-lookup"><span data-stu-id="e59be-133">Best Practices for Tracking</span></span>  
  
- <span data-ttu-id="e59be-134">**判斷您要追蹤計劃期間所需的資訊**： 您應該決定的規劃階段需要追蹤，以便您部署專案之後您可以設定追蹤選項，並限制追蹤資料量的資訊請提供您所需的資訊。</span><span class="sxs-lookup"><span data-stu-id="e59be-134">**Determine the information you need to track during planning** : You should decide during the planning stages which information you need to track, so that after you deploy the project you can set the tracking options and limit the amount of tracked data to give you only the information you need.</span></span>  
  
- <span data-ttu-id="e59be-135">**不會追蹤所有訊息**： 我們建議您，您不會都追蹤所有訊息，因為每次觸及訊息時，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]會建立另一個複本。</span><span class="sxs-lookup"><span data-stu-id="e59be-135">**Do not track all messages**: We recommend that you not track all messages, because each time a message is touched, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] makes another copy.</span></span> <span data-ttu-id="e59be-136">您可以改為縮小範圍，藉由追蹤特定連接埠。</span><span class="sxs-lookup"><span data-stu-id="e59be-136">You can instead narrow the scope by tracking only a specific port.</span></span> <span data-ttu-id="e59be-137">這有助於您系統的效能最大化，並保持資料庫的整齊。</span><span class="sxs-lookup"><span data-stu-id="e59be-137">This helps to maximize the performance of your system and to keep the databases uncluttered.</span></span>  
  
- <span data-ttu-id="e59be-138">**設定追蹤傳送埠和接收埠而不是在管線**： 如果您設定在管線的追蹤選項時，您也會設定每個管線所使用的連接埠的全域追蹤選項。</span><span class="sxs-lookup"><span data-stu-id="e59be-138">**Set tracking on send ports and receive ports instead of on a pipeline**: If you set tracking options on pipelines, you will also set the tracking options globally for every port that uses the pipeline.</span></span> <span data-ttu-id="e59be-139">這接著可能會導致更多正在追蹤資料比您想，這將會變慢系統效能。</span><span class="sxs-lookup"><span data-stu-id="e59be-139">This in turn may result in far more data being tracked than you intend, which will slow system performance.</span></span> <span data-ttu-id="e59be-140">相反地，您可以設定追蹤選項，傳送連接埠和接收埠。</span><span class="sxs-lookup"><span data-stu-id="e59be-140">Instead, you can set tracking options on send ports and receive ports.</span></span>  
  
- <span data-ttu-id="e59be-141">**請考慮各種因素，當您調整 BizTalk 追蹤資料庫的大小**:</span><span class="sxs-lookup"><span data-stu-id="e59be-141">**Take into account various factors when you size the BizTalk Tracking database**:</span></span>  
  
  -   <span data-ttu-id="e59be-142">當調整 BizTalk 追蹤資料庫的大小，請藉由將計算的緊急應變乘數考量 SQL Server 的因素，例如索引大小。</span><span class="sxs-lookup"><span data-stu-id="e59be-142">When sizing the BizTalk Tracking database, account for SQL Server factors, such as index size, by adding a contingency multiplier to your calculations.</span></span>  
  
  -   <span data-ttu-id="e59be-143">在決定 BizTalk 追蹤資料庫中的訊息大小，請加入訊息內容的平均大小的訊息大小很重要，如果相較於訊息大小。</span><span class="sxs-lookup"><span data-stu-id="e59be-143">When determining the size of messages in the BizTalk Tracking database, add the average size of the message context to the message size if it is significant compared to the message size.</span></span>  
  
  -   <span data-ttu-id="e59be-144">若要限制 BizTalk 追蹤資料庫中的訊息大小，限制您將升級的屬性數目。</span><span class="sxs-lookup"><span data-stu-id="e59be-144">To limit the size of messages in the BizTalk Tracking database, limit the number of properties that you promote.</span></span> <span data-ttu-id="e59be-145">如果您基於路由目的需要應該只使用升級屬性，否則請使用辨別的欄位。</span><span class="sxs-lookup"><span data-stu-id="e59be-145">You should only use promoted properties if you need them for routing purposes, otherwise use distinguished fields.</span></span>  
  
  -   <span data-ttu-id="e59be-146">如果協調流程**流程化開始與結束**啟用選項，請考慮每個協調流程執行個體中每個圖形的啟動和停止事件儲存在 「 BizTalk 追蹤資料庫中。</span><span class="sxs-lookup"><span data-stu-id="e59be-146">If the orchestration **Shape start and end** option is enabled, take into account that a start and stop event for each shape in each orchestration instance is saved in the BizTalk Tracking database.</span></span>