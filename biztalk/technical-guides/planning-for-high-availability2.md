---
title: "規劃高 Availability2 |Microsoft 文件"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 65271fd5-5294-406f-87f8-3aa394c235a2
caps.latest.revision: "4"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: f9b5ff05391eed424e7b910296cc5aa801f8cab1
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/01/2017
---
# <a name="planning-for-high-availability"></a><span data-ttu-id="7247a-102">高可用性的規劃</span><span class="sxs-lookup"><span data-stu-id="7247a-102">Planning for High Availability</span></span>
<span data-ttu-id="7247a-103">BizTalk Server 的高可用性著重於復原可能中斷 BizTalk Server 部署中的可用性的功能性元件。</span><span class="sxs-lookup"><span data-stu-id="7247a-103">High availability for BizTalk Server focuses on recovering functional components that might disrupt availability in a BizTalk Server deployment.</span></span>  
  
 <span data-ttu-id="7247a-104">為了示範如何在 BizTalk Server 的高可用性，您有會導致失敗和量值的修復的產品的效能。</span><span class="sxs-lookup"><span data-stu-id="7247a-104">To demonstrate high availability in BizTalk Server, you have to cause a failure and measure the product's effectiveness in recovery.</span></span> <span data-ttu-id="7247a-105">高可用性的 BizTalk Server 部署可以讓錯誤和失敗外部應用程式和系統，並可確保所有的服務繼續正常的干擾。</span><span class="sxs-lookup"><span data-stu-id="7247a-105">A highly available BizTalk Server deployment makes errors and failures transparent to external applications and systems, and ensures that all services continue functioning correctly with minimal disruption.</span></span>  
  
 <span data-ttu-id="7247a-106">設計可提供高可用性的 BizTalk Server 部署，牽涉到整合應用程式或商務程序整合案例中實作的每個功能元件的備援性。</span><span class="sxs-lookup"><span data-stu-id="7247a-106">Designing a BizTalk Server deployment that provides high availability involves implementing redundancy for each functional component involved in an application integration or business process integration scenario.</span></span> <span data-ttu-id="7247a-107">BizTalk Server 可簡化這些案例的實作在概念上分隔資料從*主機*所處理的資料。</span><span class="sxs-lookup"><span data-stu-id="7247a-107">BizTalk Server simplifies the implementation of these scenarios by conceptually separating the data from the *hosts* that process the data.</span></span> <span data-ttu-id="7247a-108">A*主機*是 BizTalk 的邏輯容器項目，例如協調流程、 傳送處理常式和接收處理常式。</span><span class="sxs-lookup"><span data-stu-id="7247a-108">A *host* is a logical container of BizTalk items, such as orchestrations, send handlers, and receive handlers.</span></span> <span data-ttu-id="7247a-109">您建立*主控件執行個體*並將它們指派給主機。</span><span class="sxs-lookup"><span data-stu-id="7247a-109">You create *host instances* and assign them to the host.</span></span> <span data-ttu-id="7247a-110">主控件執行個體是特定伺服器上主控件的實體表示法。</span><span class="sxs-lookup"><span data-stu-id="7247a-110">A host instance is the physical representation of a host on a specific server.</span></span> <span data-ttu-id="7247a-111">它是 BizTalk Server 服務程序呼叫 BTSNTSvc.exe 或另一個處理序，例如，在 IIS 處理序。</span><span class="sxs-lookup"><span data-stu-id="7247a-111">It is either the BizTalk Server service process called BTSNTSvc.exe or another process, for example, the IIS process.</span></span> <span data-ttu-id="7247a-112">因此，BizTalk Server 涉及執行多個，提供高可用性*主控件執行個體*和叢集 BizTalk Server 資料庫，如下所示：</span><span class="sxs-lookup"><span data-stu-id="7247a-112">So providing high availability for BizTalk Server involves running multiple *host instances* and clustering the BizTalk Server databases, as follows:</span></span>  
  
-   <span data-ttu-id="7247a-113">**BizTalk 主控件的架構**。</span><span class="sxs-lookup"><span data-stu-id="7247a-113">**Architecture for BizTalk Hosts**.</span></span> <span data-ttu-id="7247a-114">BizTalk Server 可讓您將主控件分開並執行以提供高可用性的索引鍵的函式，例如接收訊息、 處理協調流程和傳送訊息的多個主控件執行個體。</span><span class="sxs-lookup"><span data-stu-id="7247a-114">BizTalk Server lets you separate hosts and run multiple host instances to provide high availability for key functions such as receiving messages, processing orchestrations, and sending messages.</span></span> <span data-ttu-id="7247a-115">這些主機不需要因為 BizTalk Server 會自動分散工作負載，透過主控件執行個體的多部電腦上任何其他叢集或負載平衡機制。</span><span class="sxs-lookup"><span data-stu-id="7247a-115">These hosts do not require any additional clustering or load-balancing mechanism because BizTalk Server automatically distributes workload across multiple computers through host instances.</span></span> <span data-ttu-id="7247a-116">不過，裝載 HTTP 與 SOAP 配接器需要負載平衡機制，例如網路負載平衡 (NLB) 以提供高可用性，並執行 ftp 接收處理常式的主控件、 MSMQ、 POP3、 SQL 和 SAP 需要執行的接收處理常式叢集以提供高可用性機制。</span><span class="sxs-lookup"><span data-stu-id="7247a-116">However, hosts running the receive handlers for the HTTP and SOAP adapters require a load-balancing mechanism such as Network Load Balancing (NLB) to provide high availability, and hosts running the receive handlers for FTP, MSMQ, POP3, SQL, and SAP require a clustering mechanism to provide high availability.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="7247a-117">您必須一律叢集 SAP 接收配接器，以容納兩階段認可案例。</span><span class="sxs-lookup"><span data-stu-id="7247a-117">You must always cluster the SAP receive adapter to accommodate a two-phase commit scenario.</span></span>  
  
-   <span data-ttu-id="7247a-118">**BizTalk Server 資料庫的架構**。</span><span class="sxs-lookup"><span data-stu-id="7247a-118">**Architecture for BizTalk Server databases**.</span></span> <span data-ttu-id="7247a-119">設定為主動/被動伺服器叢集組態的兩個或多個 SQL Server 資料庫電腦通常包含 BizTalk Server 資料庫的高可用性組態。</span><span class="sxs-lookup"><span data-stu-id="7247a-119">High-availability configuration for the BizTalk Server databases typically consists of two or more SQL Server database computers configured in an active/passive server cluster configuration.</span></span> <span data-ttu-id="7247a-120">這些電腦會共用一般磁碟資源 (例如 RAID 1 + 0 SCSI 磁碟陣列或存放區域網路)，並使用 Windows 容錯移轉叢集提供備份備援和容錯功能。</span><span class="sxs-lookup"><span data-stu-id="7247a-120">These computers share a common disk resource (such as a RAID 1+0 SCSI disk array or a storage area network) and use Windows Failover Clustering to provide backup redundancy and fault tolerance.</span></span>  
  
 <span data-ttu-id="7247a-121">主要密碼伺服器的另一個重要的高可用性 BizTalk 功能元件。</span><span class="sxs-lookup"><span data-stu-id="7247a-121">Another BizTalk functional component that is critical for high availability is the master secret server.</span></span> <span data-ttu-id="7247a-122">BizTalk Server 依賴此服務，以取得加密金鑰。</span><span class="sxs-lookup"><span data-stu-id="7247a-122">BizTalk Server relies on this service to obtain the encryption key.</span></span>  
  
 <span data-ttu-id="7247a-123">本節提供如何處理每個類別中的高可用性的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="7247a-123">This section provides information about how to address high availability in each of these categories.</span></span> <span data-ttu-id="7247a-124">因為 BizTalk Server 高可用性解決方案建置在 Windows 和 SQL Server，請確定具備高可用性部署這些產品，然後再設定 BizTalk Server 的主機。</span><span class="sxs-lookup"><span data-stu-id="7247a-124">Because a BizTalk Server high availability solution is built on Windows and SQL Server, make sure that you deploy these products with high availability before configuring hosts for BizTalk Server.</span></span> <span data-ttu-id="7247a-125">以下連結包括為這些基礎產品提供高可用性的資訊：</span><span class="sxs-lookup"><span data-stu-id="7247a-125">The following links include information about providing high availability for these underlying products:</span></span>  
  
-   <span data-ttu-id="7247a-126">**高可用性解決方案 (SQL Server)] (https://docs.microsoft.com/sql/sql-server/failover-clusters/high-availability-solutions-sql-server)**</span><span class="sxs-lookup"><span data-stu-id="7247a-126">**High Availability Solutions (SQL Server)](https://docs.microsoft.com/sql/sql-server/failover-clusters/high-availability-solutions-sql-server)**</span></span>  
  
-   <span data-ttu-id="7247a-127">**[容錯移轉叢集的 Windows Server](https://docs.microsoft.com/windows-server/failover-clustering/failover-clustering-overview)**</span><span class="sxs-lookup"><span data-stu-id="7247a-127">**[Failover Clustering in Windows Server](https://docs.microsoft.com/windows-server/failover-clustering/failover-clustering-overview)**</span></span>
  
## <a name="understanding-the-impact-of-a-component-failure"></a><span data-ttu-id="7247a-128">了解元件故障的影響</span><span class="sxs-lookup"><span data-stu-id="7247a-128">Understanding the Impact of a Component Failure</span></span>  
 <span data-ttu-id="7247a-129">下表列出的元件和 BizTalk Server 環境，以及對 BizTalk Server 環境的影響的相依性，如果元件或相依性失敗。</span><span class="sxs-lookup"><span data-stu-id="7247a-129">The following table lists the components and dependencies of a BizTalk Server environment and the impact on the BizTalk Server environment if the component or dependency fails.</span></span> <span data-ttu-id="7247a-130">決定是否要加入叢集的元件或相依性時，您應該考慮可能失敗的範圍。</span><span class="sxs-lookup"><span data-stu-id="7247a-130">You should consider the scope of a potential failure when deciding whether to cluster a component or dependency.</span></span>  
  
|<span data-ttu-id="7247a-131">元件或相依性</span><span class="sxs-lookup"><span data-stu-id="7247a-131">Component or dependency</span></span>|<span data-ttu-id="7247a-132">失敗的範圍</span><span class="sxs-lookup"><span data-stu-id="7247a-132">Scope of failure</span></span>|  
|-----------------------------|----------------------|  
|<span data-ttu-id="7247a-133">SQL Server</span><span class="sxs-lookup"><span data-stu-id="7247a-133">SQL Server</span></span>|<span data-ttu-id="7247a-134">全系統。</span><span class="sxs-lookup"><span data-stu-id="7247a-134">Systemwide.</span></span> <span data-ttu-id="7247a-135">如果 SQL Server 無法再 BizTalk Server 將無法處理文件。</span><span class="sxs-lookup"><span data-stu-id="7247a-135">If SQL Server fails then BizTalk Server will be unable to process documents.</span></span>|  
|<span data-ttu-id="7247a-136">主要密碼伺服器</span><span class="sxs-lookup"><span data-stu-id="7247a-136">Master secret server</span></span>|<span data-ttu-id="7247a-137">全系統。</span><span class="sxs-lookup"><span data-stu-id="7247a-137">Systemwide.</span></span> <span data-ttu-id="7247a-138">如果主要密碼伺服器失敗然後 BizTalk Server 將無法處理文件。</span><span class="sxs-lookup"><span data-stu-id="7247a-138">If the master secret server fails then BizTalk Server will be unable to process documents.</span></span> <br/><span data-ttu-id="7247a-139">**注意：**如果主要密碼伺服器失敗，BizTalk 群組中的每個 BizTalk server 將會繼續使用快取的記憶體中複本的主要密碼，直到重新啟動 BizTalk server 上的企業 SSO 服務。</span><span class="sxs-lookup"><span data-stu-id="7247a-139">**Note:**  If the master secret server fails, each BizTalk server in the BizTalk group will continue to use a cached in-memory copy of the master secret until the Enterprise SSO service on that BizTalk server is restarted.</span></span> <span data-ttu-id="7247a-140">企業 SSO 服務重新啟動 BizTalk 伺服器上，然後從記憶體釋放主要密碼的快取的副本和 BizTalk server 必須能夠連絡主要密碼伺服器取得主要密碼的另一個複本。</span><span class="sxs-lookup"><span data-stu-id="7247a-140">If the Enterprise SSO service is restarted on the BizTalk servers, then the cached copy of the master secret is released from memory and the BizTalk servers must be able to contact the master secret server to obtain another copy of the master secret.</span></span> <span data-ttu-id="7247a-141">並不需要重新啟動 BizTalk 伺服器上的企業單一登入服務群組中如果主要密碼伺服器失敗，而且您想要繼續處理文件的 BizTalk 伺服器。</span><span class="sxs-lookup"><span data-stu-id="7247a-141">Do not restart the Enterprise SSO service on the BizTalk server(s) in a group if the master secret server fails and you want the BizTalk server to continue processing documents.</span></span>|  
|<span data-ttu-id="7247a-142">MSDTC</span><span class="sxs-lookup"><span data-stu-id="7247a-142">MSDTC</span></span>|<span data-ttu-id="7247a-143">伺服器。</span><span class="sxs-lookup"><span data-stu-id="7247a-143">Server.</span></span> <span data-ttu-id="7247a-144">如果 MSDTC 失敗需要交易支援，伺服器上的任何元件將會失敗。</span><span class="sxs-lookup"><span data-stu-id="7247a-144">If MSDTC fails then any component on the server that requires transaction support will fail.</span></span> <br/><span data-ttu-id="7247a-145">**注意：**如果 SQL server 或主要密碼伺服器上的 MSDTC 失敗 SQL Server 和主要密碼伺服器有相依於 MSDTC 交易支援，因為失敗的範圍將會變成全系統。</span><span class="sxs-lookup"><span data-stu-id="7247a-145">**Note:**  Because SQL Server and the master secret server are dependent on MSDTC for transaction support, the scope of the failure will become system wide if the MSDTC on the SQL server or master secret server fails.</span></span> <span data-ttu-id="7247a-146">在執行階段作業期間與 SQL Server 和主要密碼伺服器進行通訊時，BizTalk Server 需要交易支援。</span><span class="sxs-lookup"><span data-stu-id="7247a-146">BizTalk Server requires transaction support when communicating with SQL Server and the master secret server during run-time operations.</span></span>|  
|<span data-ttu-id="7247a-147">BizTalk 主控件執行個體</span><span class="sxs-lookup"><span data-stu-id="7247a-147">BizTalk Host instance</span></span>|<span data-ttu-id="7247a-148">伺服器。</span><span class="sxs-lookup"><span data-stu-id="7247a-148">Server.</span></span> <span data-ttu-id="7247a-149">在 BizTalk 主控件執行個體中的任何元件將無法參與文件處理，如果主控件執行個體失敗。</span><span class="sxs-lookup"><span data-stu-id="7247a-149">Any components housed in a BizTalk Host instance will be unable to participate in document processing if the host instance fails.</span></span>|  
|<span data-ttu-id="7247a-150">Microsoft Message Queuing (MSMQ)</span><span class="sxs-lookup"><span data-stu-id="7247a-150">Microsoft Message Queuing (MSMQ)</span></span>|<span data-ttu-id="7247a-151">伺服器。</span><span class="sxs-lookup"><span data-stu-id="7247a-151">Server.</span></span> <span data-ttu-id="7247a-152">如果 MSMQ 失敗然後相依於 MSMQ 服務，例如 MSMQ 配接器，任何文件處理就會停止在伺服器上。</span><span class="sxs-lookup"><span data-stu-id="7247a-152">If MSMQ fails then any document processing that is dependent on the MSMQ service, such as the MSMQ adapter, will be halted on the server.</span></span>|  
|<span data-ttu-id="7247a-153">檔案系統</span><span class="sxs-lookup"><span data-stu-id="7247a-153">File system</span></span>|<span data-ttu-id="7247a-154">伺服器。</span><span class="sxs-lookup"><span data-stu-id="7247a-154">Server.</span></span> <span data-ttu-id="7247a-155">如果檔案系統接著任何文件處理失敗，取決於檔案系統中，例如 File 配接器，就會停止在伺服器上。</span><span class="sxs-lookup"><span data-stu-id="7247a-155">If the file system fails then any document processing that is dependent on the file system, such as the File adapter, will be halted on the server.</span></span>|  
  
 <span data-ttu-id="7247a-156">若要能管理高可用性的 BizTalk Server 系統更容易，您必須充分了解 BizTalk 堆疊： Windows Server、 DC （DNS、 DHCP）、 BizTalk Server、 SQL Server、 IIS 伺服器、 檔案伺服器、 MSMQ 伺服器、 外部應用程式。</span><span class="sxs-lookup"><span data-stu-id="7247a-156">To be able to better manage a highly available BizTalk Server system, you must have a good understanding of the BizTalk stack: Windows Server, DC (DNS, DHCP), BizTalk Server, SQL Server, IIS server, File server, MSMQ server, external applications.</span></span> <span data-ttu-id="7247a-157">本節著重於 BizTalk Server 和相依的 SQL Server 電腦的高可用性。</span><span class="sxs-lookup"><span data-stu-id="7247a-157">This section focuses on the high availability of BizTalk Server and the dependent SQL Server computer.</span></span>  
  
## <a name="biztalk-server-high-availability-examples"></a><span data-ttu-id="7247a-158">BizTalk Server 高可用性的範例</span><span class="sxs-lookup"><span data-stu-id="7247a-158">BizTalk Server High-Availability Examples</span></span>  
 <span data-ttu-id="7247a-159">如範例的案例中 Microsoft BizTalk Server 中透過向外擴充的主控件層提供高可用性，請參閱[BizTalk Server 高可用性實例範例](../core/sample-biztalk-server-high-availability-scenarios.md)。</span><span class="sxs-lookup"><span data-stu-id="7247a-159">For sample scenarios in Microsoft BizTalk Server that provide high availability through scaled-out tiers of hosts, see [Sample BizTalk Server High Availability Scenarios](../core/sample-biztalk-server-high-availability-scenarios.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="7247a-160">請參閱</span><span class="sxs-lookup"><span data-stu-id="7247a-160">See Also</span></span>  
 <span data-ttu-id="7247a-161">[BizTalk 主控件的高可用性](../technical-guides/high-availability-for-biztalk-hosts.md) </span><span class="sxs-lookup"><span data-stu-id="7247a-161">[High Availability for BizTalk Hosts](../technical-guides/high-availability-for-biztalk-hosts.md) </span></span>  
 <span data-ttu-id="7247a-162">[資料庫的高可用性](../technical-guides/high-availability-for-databases.md) </span><span class="sxs-lookup"><span data-stu-id="7247a-162">[High Availability for Databases](../technical-guides/high-availability-for-databases.md) </span></span>  
 <span data-ttu-id="7247a-163">[主要密碼伺服器的高可用性](../technical-guides/high-availability-for-the-master-secret-server.md) </span><span class="sxs-lookup"><span data-stu-id="7247a-163">[High Availability for the Master Secret Server](../technical-guides/high-availability-for-the-master-secret-server.md) </span></span>  
 [<span data-ttu-id="7247a-164">檢查清單：利用災害復原功能提高可用性</span><span class="sxs-lookup"><span data-stu-id="7247a-164">Checklist: Increasing Availability with Disaster Recovery</span></span>](../technical-guides/checklist-increasing-availability-with-disaster-recovery.md)