---
title: 規劃高 Availability2 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 65271fd5-5294-406f-87f8-3aa394c235a2
caps.latest.revision: 4
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: ac94e56775badc3aa610505ad1fb441f85e9262e
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "36988503"
---
# <a name="planning-for-high-availability"></a><span data-ttu-id="2814b-102">高可用性的規劃</span><span class="sxs-lookup"><span data-stu-id="2814b-102">Planning for High Availability</span></span>
<span data-ttu-id="2814b-103">BizTalk Server 的高可用性著重於復原可能中斷 BizTalk Server 部署中的可用性的功能性元件。</span><span class="sxs-lookup"><span data-stu-id="2814b-103">High availability for BizTalk Server focuses on recovering functional components that might disrupt availability in a BizTalk Server deployment.</span></span>  
  
 <span data-ttu-id="2814b-104">若要示範 BizTalk Server 中的高可用性，您有會導致失敗，並測量 recovery 中的產品的有效性。</span><span class="sxs-lookup"><span data-stu-id="2814b-104">To demonstrate high availability in BizTalk Server, you have to cause a failure and measure the product's effectiveness in recovery.</span></span> <span data-ttu-id="2814b-105">高可用性的 BizTalk Server 部署可以讓錯誤和失敗外部應用程式和系統，並確保所有服務會都持續最少中斷的情況下正確運作。</span><span class="sxs-lookup"><span data-stu-id="2814b-105">A highly available BizTalk Server deployment makes errors and failures transparent to external applications and systems, and ensures that all services continue functioning correctly with minimal disruption.</span></span>  
  
 <span data-ttu-id="2814b-106">設計 BizTalk Server 部署，提供高可用性，牽涉到在應用程式整合或商務程序整合案例中實作每個功能元件的備援。</span><span class="sxs-lookup"><span data-stu-id="2814b-106">Designing a BizTalk Server deployment that provides high availability involves implementing redundancy for each functional component involved in an application integration or business process integration scenario.</span></span> <span data-ttu-id="2814b-107">BizTalk Server 會簡化這些案例的實作在概念上分隔的資料*主機*所處理的資料。</span><span class="sxs-lookup"><span data-stu-id="2814b-107">BizTalk Server simplifies the implementation of these scenarios by conceptually separating the data from the *hosts* that process the data.</span></span> <span data-ttu-id="2814b-108">A*主機*是 BizTalk 的邏輯容器項目，例如協調流程、 傳送處理常式和接收處理常式。</span><span class="sxs-lookup"><span data-stu-id="2814b-108">A *host* is a logical container of BizTalk items, such as orchestrations, send handlers, and receive handlers.</span></span> <span data-ttu-id="2814b-109">您建立*主控件執行個體*並將它們指派給主機。</span><span class="sxs-lookup"><span data-stu-id="2814b-109">You create *host instances* and assign them to the host.</span></span> <span data-ttu-id="2814b-110">主控件執行個體是特定伺服器上主控件的實體表示法。</span><span class="sxs-lookup"><span data-stu-id="2814b-110">A host instance is the physical representation of a host on a specific server.</span></span> <span data-ttu-id="2814b-111">它是 BizTalk Server 服務程序呼叫 BTSNTSvc.exe 或另一個處理序，比方說，IIS 處理序。</span><span class="sxs-lookup"><span data-stu-id="2814b-111">It is either the BizTalk Server service process called BTSNTSvc.exe or another process, for example, the IIS process.</span></span> <span data-ttu-id="2814b-112">BizTalk Server 中包含執行多個，因此提供高可用性*主控件執行個體*和叢集 BizTalk Server 資料庫，如下所示：</span><span class="sxs-lookup"><span data-stu-id="2814b-112">So providing high availability for BizTalk Server involves running multiple *host instances* and clustering the BizTalk Server databases, as follows:</span></span>  
  
- <span data-ttu-id="2814b-113">**為 BizTalk 主控件的架構**。</span><span class="sxs-lookup"><span data-stu-id="2814b-113">**Architecture for BizTalk Hosts**.</span></span> <span data-ttu-id="2814b-114">BizTalk Server 可讓您分開主機並執行多個主控件執行個體，以提供高可用性的索引鍵的函式，例如接收訊息、 處理協調流程和傳送訊息。</span><span class="sxs-lookup"><span data-stu-id="2814b-114">BizTalk Server lets you separate hosts and run multiple host instances to provide high availability for key functions such as receiving messages, processing orchestrations, and sending messages.</span></span> <span data-ttu-id="2814b-115">這些主機不需要任何其他叢集或負載平衡機制，因為 BizTalk Server 會自動將工作負載分散在多部電腦透過主控件執行個體。</span><span class="sxs-lookup"><span data-stu-id="2814b-115">These hosts do not require any additional clustering or load-balancing mechanism because BizTalk Server automatically distributes workload across multiple computers through host instances.</span></span> <span data-ttu-id="2814b-116">不過，會裝載 HTTP 與 SOAP 配接器需要負載平衡機制，例如網路負載平衡 (NLB) 以提供高可用性，並執行 FTP 接收處理常式的主控件、 MSMQ、 POP3、 SQL 和 SAP 需要執行的接收處理常式叢集提供高可用性機制。</span><span class="sxs-lookup"><span data-stu-id="2814b-116">However, hosts running the receive handlers for the HTTP and SOAP adapters require a load-balancing mechanism such as Network Load Balancing (NLB) to provide high availability, and hosts running the receive handlers for FTP, MSMQ, POP3, SQL, and SAP require a clustering mechanism to provide high availability.</span></span>  
  
  > [!NOTE]  
  >  <span data-ttu-id="2814b-117">您一律必須叢集化 SAP 接收配接器，以容納兩階段交易認可案例。</span><span class="sxs-lookup"><span data-stu-id="2814b-117">You must always cluster the SAP receive adapter to accommodate a two-phase commit scenario.</span></span>  
  
- <span data-ttu-id="2814b-118">**BizTalk Server 資料庫的架構**。</span><span class="sxs-lookup"><span data-stu-id="2814b-118">**Architecture for BizTalk Server databases**.</span></span> <span data-ttu-id="2814b-119">BizTalk Server 資料庫的高可用性組態通常包含設定為主動/被動伺服器叢集組態的兩個或多個 SQL Server 資料庫電腦。</span><span class="sxs-lookup"><span data-stu-id="2814b-119">High-availability configuration for the BizTalk Server databases typically consists of two or more SQL Server database computers configured in an active/passive server cluster configuration.</span></span> <span data-ttu-id="2814b-120">這些電腦會共用一般磁碟資源 (例如 RAID 1 + 0 SCSI 磁碟陣列或存放區域網路) 並使用 Windows 容錯移轉叢集提供備份備援和容錯。</span><span class="sxs-lookup"><span data-stu-id="2814b-120">These computers share a common disk resource (such as a RAID 1+0 SCSI disk array or a storage area network) and use Windows Failover Clustering to provide backup redundancy and fault tolerance.</span></span>  
  
  <span data-ttu-id="2814b-121">另一個 BizTalk 功能元件，是高可用性的關鍵是主要密碼伺服器。</span><span class="sxs-lookup"><span data-stu-id="2814b-121">Another BizTalk functional component that is critical for high availability is the master secret server.</span></span> <span data-ttu-id="2814b-122">BizTalk Server 依賴這項服務取得加密金鑰。</span><span class="sxs-lookup"><span data-stu-id="2814b-122">BizTalk Server relies on this service to obtain the encryption key.</span></span>  
  
  <span data-ttu-id="2814b-123">本節提供如何解決這些類別中的高可用性的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="2814b-123">This section provides information about how to address high availability in each of these categories.</span></span> <span data-ttu-id="2814b-124">因為 BizTalk Server 高可用性解決方案建置在 Windows 和 SQL Server，請確定具有高可用性部署這些產品，然後再設定 BizTalk Server 的主機。</span><span class="sxs-lookup"><span data-stu-id="2814b-124">Because a BizTalk Server high availability solution is built on Windows and SQL Server, make sure that you deploy these products with high availability before configuring hosts for BizTalk Server.</span></span> <span data-ttu-id="2814b-125">以下連結包括為這些基礎產品提供高可用性的資訊：</span><span class="sxs-lookup"><span data-stu-id="2814b-125">The following links include information about providing high availability for these underlying products:</span></span>  
  
- <span data-ttu-id="2814b-126">**高可用性解決方案 (SQL Server)] (https://docs.microsoft.com/sql/sql-server/failover-clusters/high-availability-solutions-sql-server)**</span><span class="sxs-lookup"><span data-stu-id="2814b-126">**High Availability Solutions (SQL Server)](https://docs.microsoft.com/sql/sql-server/failover-clusters/high-availability-solutions-sql-server)**</span></span>  
  
- <span data-ttu-id="2814b-127">**[Windows Server 叢集的容錯移轉](https://docs.microsoft.com/windows-server/failover-clustering/failover-clustering-overview)**</span><span class="sxs-lookup"><span data-stu-id="2814b-127">**[Failover Clustering in Windows Server](https://docs.microsoft.com/windows-server/failover-clustering/failover-clustering-overview)**</span></span>
  
## <a name="understanding-the-impact-of-a-component-failure"></a><span data-ttu-id="2814b-128">了解元件失敗的影響</span><span class="sxs-lookup"><span data-stu-id="2814b-128">Understanding the Impact of a Component Failure</span></span>  
 <span data-ttu-id="2814b-129">下表列出的元件和 BizTalk Server 環境以及對 BizTalk Server 環境的影響的相依性，如果元件或相依性失敗。</span><span class="sxs-lookup"><span data-stu-id="2814b-129">The following table lists the components and dependencies of a BizTalk Server environment and the impact on the BizTalk Server environment if the component or dependency fails.</span></span> <span data-ttu-id="2814b-130">決定是否要加入叢集的元件或相依性時，您應該考慮可能失敗的範圍。</span><span class="sxs-lookup"><span data-stu-id="2814b-130">You should consider the scope of a potential failure when deciding whether to cluster a component or dependency.</span></span>  
  
|<span data-ttu-id="2814b-131">元件或相依性</span><span class="sxs-lookup"><span data-stu-id="2814b-131">Component or dependency</span></span>|<span data-ttu-id="2814b-132">失敗的範圍</span><span class="sxs-lookup"><span data-stu-id="2814b-132">Scope of failure</span></span>|  
|-----------------------------|----------------------|  
|<span data-ttu-id="2814b-133">[SQL Server]</span><span class="sxs-lookup"><span data-stu-id="2814b-133">SQL Server</span></span>|<span data-ttu-id="2814b-134">全系統。</span><span class="sxs-lookup"><span data-stu-id="2814b-134">Systemwide.</span></span> <span data-ttu-id="2814b-135">如果 SQL Server 無法然後 BizTalk Server 將無法處理文件。</span><span class="sxs-lookup"><span data-stu-id="2814b-135">If SQL Server fails then BizTalk Server will be unable to process documents.</span></span>|  
|<span data-ttu-id="2814b-136">主要密碼伺服器</span><span class="sxs-lookup"><span data-stu-id="2814b-136">Master secret server</span></span>|<span data-ttu-id="2814b-137">全系統。</span><span class="sxs-lookup"><span data-stu-id="2814b-137">Systemwide.</span></span> <span data-ttu-id="2814b-138">如果主要密碼伺服器失敗然後 BizTalk Server 將無法處理文件。</span><span class="sxs-lookup"><span data-stu-id="2814b-138">If the master secret server fails then BizTalk Server will be unable to process documents.</span></span> <br/><span data-ttu-id="2814b-139">**注意：** 如果主要密碼伺服器失敗，BizTalk 群組中的每個 BizTalk server 將繼續使用快取於記憶體中複本的主要密碼，直到重新啟動 BizTalk server 上的企業 SSO 服務。</span><span class="sxs-lookup"><span data-stu-id="2814b-139">**Note:**  If the master secret server fails, each BizTalk server in the BizTalk group will continue to use a cached in-memory copy of the master secret until the Enterprise SSO service on that BizTalk server is restarted.</span></span> <span data-ttu-id="2814b-140">在 BizTalk 伺服器上重新啟動 「 企業單一登入 」 服務時，然後從記憶體釋放主要祕密的快取的副本，並 BizTalk server 必須能夠連絡以取得主要祕密的另一份主要密碼伺服器。</span><span class="sxs-lookup"><span data-stu-id="2814b-140">If the Enterprise SSO service is restarted on the BizTalk servers, then the cached copy of the master secret is released from memory and the BizTalk servers must be able to contact the master secret server to obtain another copy of the master secret.</span></span> <span data-ttu-id="2814b-141">不重新啟動的企業單一登入服務的 BizTalk server 群組中如果主要密碼伺服器失敗，而且您想要繼續處理文件的 BizTalk server。</span><span class="sxs-lookup"><span data-stu-id="2814b-141">Do not restart the Enterprise SSO service on the BizTalk server(s) in a group if the master secret server fails and you want the BizTalk server to continue processing documents.</span></span>|  
|<span data-ttu-id="2814b-142">MSDTC</span><span class="sxs-lookup"><span data-stu-id="2814b-142">MSDTC</span></span>|<span data-ttu-id="2814b-143">伺服器。</span><span class="sxs-lookup"><span data-stu-id="2814b-143">Server.</span></span> <span data-ttu-id="2814b-144">如果 MSDTC 失敗需要交易支援的伺服器上的任何元件將會失敗。</span><span class="sxs-lookup"><span data-stu-id="2814b-144">If MSDTC fails then any component on the server that requires transaction support will fail.</span></span> <br/><span data-ttu-id="2814b-145">**注意：** SQL 伺服器和主要密碼伺服器是在 MSDTC 交易支援相依項目，因為失敗的範圍會變成全系統的 SQL 伺服器或主要密碼伺服器上的 MSDTC 時。</span><span class="sxs-lookup"><span data-stu-id="2814b-145">**Note:**  Because SQL Server and the master secret server are dependent on MSDTC for transaction support, the scope of the failure will become system wide if the MSDTC on the SQL server or master secret server fails.</span></span> <span data-ttu-id="2814b-146">在執行階段作業期間，SQL Server 與主要密碼伺服器進行通訊時，BizTalk Server 需要交易支援。</span><span class="sxs-lookup"><span data-stu-id="2814b-146">BizTalk Server requires transaction support when communicating with SQL Server and the master secret server during run-time operations.</span></span>|  
|<span data-ttu-id="2814b-147">BizTalk 主控件執行個體</span><span class="sxs-lookup"><span data-stu-id="2814b-147">BizTalk Host instance</span></span>|<span data-ttu-id="2814b-148">伺服器。</span><span class="sxs-lookup"><span data-stu-id="2814b-148">Server.</span></span> <span data-ttu-id="2814b-149">裝載 BizTalk 主控件執行個體中的任何元件將無法參與文件處理，如果主控件執行個體失敗。</span><span class="sxs-lookup"><span data-stu-id="2814b-149">Any components housed in a BizTalk Host instance will be unable to participate in document processing if the host instance fails.</span></span>|  
|<span data-ttu-id="2814b-150">Microsoft Message Queuing (MSMQ)</span><span class="sxs-lookup"><span data-stu-id="2814b-150">Microsoft Message Queuing (MSMQ)</span></span>|<span data-ttu-id="2814b-151">伺服器。</span><span class="sxs-lookup"><span data-stu-id="2814b-151">Server.</span></span> <span data-ttu-id="2814b-152">如果 MSMQ 失敗然後任何相依於 MSMQ 服務，例如 MSMQ 配接器的文件處理就會停止在伺服器上。</span><span class="sxs-lookup"><span data-stu-id="2814b-152">If MSMQ fails then any document processing that is dependent on the MSMQ service, such as the MSMQ adapter, will be halted on the server.</span></span>|  
|<span data-ttu-id="2814b-153">檔案系統</span><span class="sxs-lookup"><span data-stu-id="2814b-153">File system</span></span>|<span data-ttu-id="2814b-154">伺服器。</span><span class="sxs-lookup"><span data-stu-id="2814b-154">Server.</span></span> <span data-ttu-id="2814b-155">如果檔案系統失敗則取決於檔案系統，例如 File 配接器，任何文件處理就會停止在伺服器上。</span><span class="sxs-lookup"><span data-stu-id="2814b-155">If the file system fails then any document processing that is dependent on the file system, such as the File adapter, will be halted on the server.</span></span>|  
  
 <span data-ttu-id="2814b-156">若要能夠更有效地管理高可用性的 BizTalk Server 系統，您必須充分了解 BizTalk 堆疊： Windows Server，DC （DNS、 DHCP）、 BizTalk Server、 SQL Server、 IIS 伺服器、 檔案伺服器、 MSMQ 伺服器、 外部應用程式。</span><span class="sxs-lookup"><span data-stu-id="2814b-156">To be able to better manage a highly available BizTalk Server system, you must have a good understanding of the BizTalk stack: Windows Server, DC (DNS, DHCP), BizTalk Server, SQL Server, IIS server, File server, MSMQ server, external applications.</span></span> <span data-ttu-id="2814b-157">本節著重於 BizTalk Server 和相依的 SQL Server 電腦的高可用性。</span><span class="sxs-lookup"><span data-stu-id="2814b-157">This section focuses on the high availability of BizTalk Server and the dependent SQL Server computer.</span></span>  
  
## <a name="biztalk-server-high-availability-examples"></a><span data-ttu-id="2814b-158">BizTalk Server 高可用性的範例</span><span class="sxs-lookup"><span data-stu-id="2814b-158">BizTalk Server High-Availability Examples</span></span>  
 <span data-ttu-id="2814b-159">如需範例案例在 Microsoft BizTalk Server 可透過向外擴充的主機層的高可用性，請參閱[BizTalk Server 高可用性實例範例](../core/sample-biztalk-server-high-availability-scenarios.md)。</span><span class="sxs-lookup"><span data-stu-id="2814b-159">For sample scenarios in Microsoft BizTalk Server that provide high availability through scaled-out tiers of hosts, see [Sample BizTalk Server High Availability Scenarios](../core/sample-biztalk-server-high-availability-scenarios.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="2814b-160">另請參閱</span><span class="sxs-lookup"><span data-stu-id="2814b-160">See Also</span></span>  
 <span data-ttu-id="2814b-161">[BizTalk 主控件的的高可用性](../technical-guides/high-availability-for-biztalk-hosts.md) </span><span class="sxs-lookup"><span data-stu-id="2814b-161">[High Availability for BizTalk Hosts](../technical-guides/high-availability-for-biztalk-hosts.md) </span></span>  
 <span data-ttu-id="2814b-162">[資料庫的高可用性](../technical-guides/high-availability-for-databases.md) </span><span class="sxs-lookup"><span data-stu-id="2814b-162">[High Availability for Databases](../technical-guides/high-availability-for-databases.md) </span></span>  
 <span data-ttu-id="2814b-163">[主要密碼伺服器的高可用性](../technical-guides/high-availability-for-the-master-secret-server.md) </span><span class="sxs-lookup"><span data-stu-id="2814b-163">[High Availability for the Master Secret Server](../technical-guides/high-availability-for-the-master-secret-server.md) </span></span>  
 [<span data-ttu-id="2814b-164">檢查清單：利用災害復原功能提高可用性</span><span class="sxs-lookup"><span data-stu-id="2814b-164">Checklist: Increasing Availability with Disaster Recovery</span></span>](../technical-guides/checklist-increasing-availability-with-disaster-recovery.md)