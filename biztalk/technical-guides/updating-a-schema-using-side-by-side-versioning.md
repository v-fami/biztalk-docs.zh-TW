---
title: 更新結構描述使用並存的版本設定 |Microsoft 文件
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: a7360ec5-b5e9-40c7-9a7c-965fcc95ddb0
caps.latest.revision: 2
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: d3d63b93f665e80f88e2d9e81b2337e7b198b3df
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
ms.locfileid: "22302238"
---
# <a name="updating-a-schema-using-side-by-side-versioning"></a><span data-ttu-id="e518f-102">更新結構描述中使用的並存版本控制</span><span class="sxs-lookup"><span data-stu-id="e518f-102">Updating a Schema Using Side-by-Side Versioning</span></span>
<span data-ttu-id="e518f-103">您可以執行的並存版本控制結構描述。</span><span class="sxs-lookup"><span data-stu-id="e518f-103">You can perform side-by-side versioning with schemas.</span></span> <span data-ttu-id="e518f-104">您可以藉由加入新的結構描述版本的組件，但保留現有的結構描述 （和其版本） 升級結構描述的版本保持不變。</span><span class="sxs-lookup"><span data-stu-id="e518f-104">You do so by adding a new version of the schema to an assembly, upgrading the version of the schema, while leaving the existing schema (and its version) unchanged.</span></span>  
  
 <span data-ttu-id="e518f-105">如果要增加結構描述版本，您必須更新結構描述以取得任何管線執行個體並使用它的管線元件的參考。</span><span class="sxs-lookup"><span data-stu-id="e518f-105">If you increment a schema version, you must update the reference to the schema for any pipeline instances and pipeline components that use it.</span></span> <span data-ttu-id="e518f-106">您也必須更新參考結構描述 （或建立新的對應） 的對應，以及任何依賴該結構描述的協調流程。</span><span class="sxs-lookup"><span data-stu-id="e518f-106">You must also update the maps that reference the schema (or create new maps) as well as any orchestrations that rely on the schema.</span></span>  
  
 <span data-ttu-id="e518f-107">如果您解除部署結構描述，舊版的結構描述中，如果有的話，會變成作用中。</span><span class="sxs-lookup"><span data-stu-id="e518f-107">If you undeploy a schema, the previous version of the schema, if available, will become active.</span></span>  
  
## <a name="schema-resolution-in-pipelines"></a><span data-ttu-id="e518f-108">在管線中的結構描述解析</span><span class="sxs-lookup"><span data-stu-id="e518f-108">Schema Resolution in Pipelines</span></span>  
 <span data-ttu-id="e518f-109">如果您將 BizTalk 群組中包含具有相同的訊息類型做為現有的結構描述的新結構描述的組件加入至應用程式，在管線中發生結構描述解析時將使用具有最新的版本號碼的結構描述。</span><span class="sxs-lookup"><span data-stu-id="e518f-109">If you add to an application an assembly that includes a new schema with the same message type as an existing schema in the BizTalk group, the schema with the latest version number will be used when schema resolution occurs in pipelines.</span></span> <span data-ttu-id="e518f-110">如果一種訊息類型參考一個以上的.NET 型別，模稜兩可能導致管線執行失敗。</span><span class="sxs-lookup"><span data-stu-id="e518f-110">If one message type refers to more than one .NET type, this ambiguity may cause pipeline execution failure.</span></span> <span data-ttu-id="e518f-111">這是因為結構描述查閱會使用訊息類型、目標命名空間以及執行個體的根名稱。</span><span class="sxs-lookup"><span data-stu-id="e518f-111">This is because schema lookup uses message type, the target namespace, and root name of the instance.</span></span> <span data-ttu-id="e518f-112">這種失敗可能會發生在任何使用結構描述具有相同的訊息類型做為新的結構描述的應用程式管線。</span><span class="sxs-lookup"><span data-stu-id="e518f-112">This type of failure can occur for pipelines in any application that uses a schema with the same message type as the new schema.</span></span> <span data-ttu-id="e518f-113">如需結構描述解析的詳細資訊，請參閱[管線元件中的結構描述解析](http://go.microsoft.com/fwlink/?LinkID=154207)(http://go.microsoft.com/fwlink/?LinkID=154207) 中[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]幫助。</span><span class="sxs-lookup"><span data-stu-id="e518f-113">For more information about schema resolution, see [Schema Resolution in Pipeline Components](http://go.microsoft.com/fwlink/?LinkID=154207) (http://go.microsoft.com/fwlink/?LinkID=154207) in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Help.</span></span>  
  
 <span data-ttu-id="e518f-114">XML 解譯器的結構描述解析行為可能會需要額外變更之後新增新版與舊版並存的結構描述。</span><span class="sxs-lookup"><span data-stu-id="e518f-114">The schema resolution behavior for the XML Disassembler may require additional changes after adding a new version of a schema side by side with an older version.</span></span> <span data-ttu-id="e518f-115">在某些情況下，您可能想要在管線設計師 」 中的管線解譯器屬性結構描述的特定版本的硬式編碼參考。</span><span class="sxs-lookup"><span data-stu-id="e518f-115">In certain cases, you may want to hard-code references in the pipeline disassembler properties in the Pipeline Designer to specific versions of the schemas.</span></span> <span data-ttu-id="e518f-116">這可讓您避免動態解析行為，在其中 XML 解譯器會決定使用訊息類型以動態方式載入的結構描述探索在執行階段從訊息 XML 內容。</span><span class="sxs-lookup"><span data-stu-id="e518f-116">This enables you to avoid the dynamic resolution behavior, in which the XML Disassembler determines which schema to load by using the message type dynamically discovered at runtime from the message XML content.</span></span>  
  
## <a name="updating-a-schema-in-an-orchestration"></a><span data-ttu-id="e518f-117">更新協調流程中的結構描述</span><span class="sxs-lookup"><span data-stu-id="e518f-117">Updating a Schema in an Orchestration</span></span>  
 <span data-ttu-id="e518f-118">當您變更與多個傳送相關聯的結構描述，並接收圖形的協調流程中時，您可以更輕鬆地變更進行每次傳送相關聯之訊息的訊息類型屬性設定，或接收 圖形至多部分訊息類型，而非結構描述。</span><span class="sxs-lookup"><span data-stu-id="e518f-118">When you change the schema associated with multiple send and receive shapes in an orchestration, you can make changes much easier by setting the Message Type property for the message associated with each send or receive shape to Multi-part Message Type, rather than Schema.</span></span> <span data-ttu-id="e518f-119">然後，您可以設定每個圖形是相同的結構描述相關聯的訊息部分的型別屬性。</span><span class="sxs-lookup"><span data-stu-id="e518f-119">You can then set the Type property for the message part associated with each shapes to be the same schema.</span></span> <span data-ttu-id="e518f-120">如此一來，您可以透過隨後變更結構描述的變更類型屬性的每個訊息部分，而不必變更每個圖形的訊息類型。</span><span class="sxs-lookup"><span data-stu-id="e518f-120">By so doing, you can subsequently change the schema by changing the Type property for each message part, rather than having to change the Message Type for each shape.</span></span> <span data-ttu-id="e518f-121">如需這個程序方便變更的詳細資訊，請參閱[8 秘訣和訣竅更好的 BizTalk 程式設計](http://go.microsoft.com/fwlink/?LinkId=101594)白皮書 (http://go.microsoft.com/fwlink/?LinkId=101594)。</span><span class="sxs-lookup"><span data-stu-id="e518f-121">For more information about making changes easier by this process, see the [8 Tips and Tricks for Better BizTalk Programming](http://go.microsoft.com/fwlink/?LinkId=101594) white paper (http://go.microsoft.com/fwlink/?LinkId=101594).</span></span>  
  
## <a name="versioning-schemas"></a><span data-ttu-id="e518f-122">管理結構描述版本</span><span class="sxs-lookup"><span data-stu-id="e518f-122">Versioning Schemas</span></span>  
 <span data-ttu-id="e518f-123">BizTalk Server 會從最新版本包含它的組件的結構描述。</span><span class="sxs-lookup"><span data-stu-id="e518f-123">BizTalk Server takes a schema from the most recent version of the assembly containing it.</span></span> <span data-ttu-id="e518f-124">這表示，如果您建立新的結構描述版本，新的版本會完全取代所有舊版的結構描述。</span><span class="sxs-lookup"><span data-stu-id="e518f-124">This means that if you create a new version of a schema, the new version completely replaces all previous versions of the schema.</span></span> <span data-ttu-id="e518f-125">這在交易期間很短時是可行的。</span><span class="sxs-lookup"><span data-stu-id="e518f-125">This works well when transactions are short-lived.</span></span> <span data-ttu-id="e518f-126">不過，在商務程序管理解決方案中的交易期間較長： 訂單可能需要一年才能完成。</span><span class="sxs-lookup"><span data-stu-id="e518f-126">However, transactions in the Business Process Management solution are long-lived: an order may take up to a year to complete.</span></span>  
  
 <span data-ttu-id="e518f-127">為了同時使用某個結構描述的多個版本，解決方案中的每個結構描述會在其命名空間中包含版本號碼。</span><span class="sxs-lookup"><span data-stu-id="e518f-127">To allow for the possibility of using multiple versions of a schema being in use, each schema in the solution includes a version number in its namespace.</span></span> <span data-ttu-id="e518f-128">BizTalk 管線會判斷目標命名空間為基礎的訊息加上結構描述中定義的根節點名稱的訊息類型。</span><span class="sxs-lookup"><span data-stu-id="e518f-128">BizTalk pipelines determine the message type of a message based on the target namespace plus the root node name defined in the schema.</span></span> <span data-ttu-id="e518f-129">例如，Order 結構描述的命名空間如下所示：</span><span class="sxs-lookup"><span data-stu-id="e518f-129">For example, the namespace for the Order schema is as follows:</span></span>  
  
```  
http://Microsoft.Samples.BizTalk.SouthridgeVideo.Schemas.Order.v1  
```  
  
 <span data-ttu-id="e518f-130">命名空間的結構描述和包含的版本號碼會識別唯一的結構描述的命名空間，因為新的結構描述將會從較舊的版本不同。</span><span class="sxs-lookup"><span data-stu-id="e518f-130">Because the namespace identifies the schema, and inclusion of the version number makes the namespace unique to the schema, the new schema will be distinct from the older version.</span></span> <span data-ttu-id="e518f-131">因此，可以不取代舊的結構描述，即可使用新的結構描述。</span><span class="sxs-lookup"><span data-stu-id="e518f-131">Thus, a new schema can be used without supplanting the old schema.</span></span>  
  
 <span data-ttu-id="e518f-132">變更結構描述版本會影響您的方案，有許多組件，所以這必須事先規劃。</span><span class="sxs-lookup"><span data-stu-id="e518f-132">Changing the schema version can affect many parts of your solution, so this should be planned in advance.</span></span> <span data-ttu-id="e518f-133">如需效果的結構描述版本變更，請參閱[管線元件中的結構描述解析](http://go.microsoft.com/fwlink/?LinkID=154207)(http://go.microsoft.com/fwlink/?LinkID=154207) 中[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]幫助。</span><span class="sxs-lookup"><span data-stu-id="e518f-133">For more information about the effect of schema version changes, see [Schema Resolution in Pipeline Components](http://go.microsoft.com/fwlink/?LinkID=154207) (http://go.microsoft.com/fwlink/?LinkID=154207) in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Help.</span></span>  
  
 <span data-ttu-id="e518f-134">在變更協調流程中的結構描述的版本，請使用 多部分訊息類型。</span><span class="sxs-lookup"><span data-stu-id="e518f-134">When changing the version of schemas in an orchestration, use multipart message types.</span></span> <span data-ttu-id="e518f-135">這樣會導致更大的彈性時結構描述版本。</span><span class="sxs-lookup"><span data-stu-id="e518f-135">Doing so will result in greater flexibility when versioning schemas.</span></span> <span data-ttu-id="e518f-136">使用多部分訊息類型的優勢的相關資訊，請參閱 MSDN Magazine 文件中秘訣 #1，「 永遠使用多部分訊息類型，」 [8 秘訣和訣竅更好的 BizTalk 程式設計](http://go.microsoft.com/fwlink/?LinkId=101594)(http://go.microsoft.com/fwlink/？LinkId = 101594)。</span><span class="sxs-lookup"><span data-stu-id="e518f-136">For more information about the advantages of using multipart message types, see tip #1, “Always Use Multi-Part Message Types,” in the MSDN Magazine article [8 Tips And Tricks For Better BizTalk Programming](http://go.microsoft.com/fwlink/?LinkId=101594) (http://go.microsoft.com/fwlink/?LinkId=101594).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e518f-137">另請參閱</span><span class="sxs-lookup"><span data-stu-id="e518f-137">See Also</span></span>  
 [<span data-ttu-id="e518f-138">更新應用程式的最佳作法</span><span class="sxs-lookup"><span data-stu-id="e518f-138">Best Practices for Updating Applications</span></span>](../technical-guides/best-practices-for-updating-applications.md)