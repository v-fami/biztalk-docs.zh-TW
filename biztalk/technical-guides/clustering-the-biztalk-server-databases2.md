---
title: 叢集資料庫 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 1b68bc3f-c0c4-4050-8ca3-df6dd1927637
caps.latest.revision: 3
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: bcdc4c2c628a031ab235ce5821c01b56e5f86851
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "36991503"
---
# <a name="clustering-the-biztalk-server-databases"></a><span data-ttu-id="72867-102">叢集 BizTalk Server 資料庫</span><span class="sxs-lookup"><span data-stu-id="72867-102">Clustering the BizTalk Server Databases</span></span>
<span data-ttu-id="72867-103">若 BizTalk Server 資料庫變成無法使用，則 BizTalk Server 環境將無法正確運作。</span><span class="sxs-lookup"><span data-stu-id="72867-103">If the BizTalk Server databases become unavailable, the BizTalk Server environment will not function correctly.</span></span> <span data-ttu-id="72867-104">若要提供高可用性，您可以為 BizTalk Server 資料庫建立 Microsoft SQL Server 叢集，如下圖所示。</span><span class="sxs-lookup"><span data-stu-id="72867-104">To provide high availability, you can create a Microsoft SQL Server cluster for the BizTalk Server databases, as shown in the following figure.</span></span>  
  
 <span data-ttu-id="72867-105">![BizTalk Server 資料庫層](../core/media/tdi-highava-sqlcluster.gif "TDI_HighAva_SQLCluster")</span><span class="sxs-lookup"><span data-stu-id="72867-105">![BizTalk Server Database Tier](../core/media/tdi-highava-sqlcluster.gif "TDI_HighAva_SQLCluster")</span></span>  
  
 <span data-ttu-id="72867-106">若要為 BizTalk Server 資料庫建立高度可用的解決方案，您必須擁有至少兩部執行 SQL Server 的電腦以及在叢集中的共用磁碟陣列。</span><span class="sxs-lookup"><span data-stu-id="72867-106">To create a highly available solution for the BizTalk Server databases, you must have at least two computers that are running SQL Server and a shared disk array in the cluster.</span></span>  
  
## <a name="clustering-options"></a><span data-ttu-id="72867-107">叢集選項</span><span class="sxs-lookup"><span data-stu-id="72867-107">Clustering Options</span></span>  
 <span data-ttu-id="72867-108">為您的企業需求決定 BizTalk Server 資料庫的最佳叢集組態。</span><span class="sxs-lookup"><span data-stu-id="72867-108">Determine the best cluster configuration for the BizTalk Server databases for your business needs.</span></span> <span data-ttu-id="72867-109">以下是選項的清單：</span><span class="sxs-lookup"><span data-stu-id="72867-109">Here is a list of the options:</span></span>  
  
-   <span data-ttu-id="72867-110">**主動/被動**。</span><span class="sxs-lookup"><span data-stu-id="72867-110">**Active/passive**.</span></span> <span data-ttu-id="72867-111">BizTalk Server 資料庫的高可用性通常包含兩個或多個設定為主動/被動伺服器叢集組態的資料庫電腦。</span><span class="sxs-lookup"><span data-stu-id="72867-111">High availability for the BizTalk Server databases typically consists of two or more database computers configured in an active/passive server cluster configuration.</span></span> <span data-ttu-id="72867-112">這些電腦會共用一般磁碟資源 (例如 RAID 1 + 0 SCSI 磁碟陣列或儲存區域網路) 並使用 Windows 叢集提供備份備援和容錯。</span><span class="sxs-lookup"><span data-stu-id="72867-112">These computers share a common disk resource (such as a RAID 1+0 SCSI disk array or storage area network) and use Windows Clustering to provide backup redundancy and fault tolerance.</span></span>  
  
-   <span data-ttu-id="72867-113">**主動/主動**。</span><span class="sxs-lookup"><span data-stu-id="72867-113">**Active/active**.</span></span> <span data-ttu-id="72867-114">Windows 叢集和 SQL Server 可讓您執行 SQL Server 以主動/主動模式叢集的每個節點的 「 作用中 」 且正在執行一個以上的 SQL Server 執行個體。</span><span class="sxs-lookup"><span data-stu-id="72867-114">Windows Clustering and SQL Server allow you to run SQL Server in Active/Active mode where each node of the cluster is “active” and running one or more SQL Server instances.</span></span> <span data-ttu-id="72867-115">比方說，這可讓您在上一個節點和所有其他的 BizTalk Server 資料庫的 MessageBox 資料庫上另一個節點。</span><span class="sxs-lookup"><span data-stu-id="72867-115">For example, this would allow you to have the MessageBox database on one node and all other BizTalk Server databases on the other node.</span></span> <span data-ttu-id="72867-116">這可讓您發揮最大叢集的硬體使用量，但應該要小心使用主動/主動 SQL Server 組態。</span><span class="sxs-lookup"><span data-stu-id="72867-116">This allows you to maximize cluster hardware usage, but an active/active SQL Server configuration should be used with care.</span></span>  
  
     <span data-ttu-id="72867-117">可以每個節點同時處理所有的 SQL Server 執行個體的負載在 SQL Server 叢集節點容錯移轉案例期間？</span><span class="sxs-lookup"><span data-stu-id="72867-117">Can each node simultaneously handle the load of all SQL Server instances during a SQL Server cluster node failover scenario?</span></span> <span data-ttu-id="72867-118">是否有足夠的 CPU 資源？</span><span class="sxs-lookup"><span data-stu-id="72867-118">Are there enough CPU resources?</span></span> <span data-ttu-id="72867-119">是否有足夠的記憶體？</span><span class="sxs-lookup"><span data-stu-id="72867-119">Is there sufficient memory?</span></span> <span data-ttu-id="72867-120">網路頻寬呢？</span><span class="sxs-lookup"><span data-stu-id="72867-120">What about network bandwidth?</span></span> <span data-ttu-id="72867-121">相關做法磁碟 I/O 競爭？</span><span class="sxs-lookup"><span data-stu-id="72867-121">How about disk I/O contention?</span></span>  
  
     <span data-ttu-id="72867-122">這些只是部分問題，必須回答才能判斷是否適合您的 BizTalk 應用程式的主動/主動 SQL Server 叢集。</span><span class="sxs-lookup"><span data-stu-id="72867-122">These are just some of the questions that need to be answered in order to determine if an active/active SQL Server cluster is right for your BizTalk applications.</span></span> <span data-ttu-id="72867-123">如果判定有一個節點無法處理所有的 SQL Server 執行個體在容錯移轉的案例中，替代方法是使用主動/主動/被動叢集。</span><span class="sxs-lookup"><span data-stu-id="72867-123">If it is determined that one node cannot handle all SQL Server instances in a failover scenario, an alternative is to use active/active/passive clustering.</span></span>  
  
-   <span data-ttu-id="72867-124">**主動/主動/被動**。</span><span class="sxs-lookup"><span data-stu-id="72867-124">**Active/active/passive**.</span></span> <span data-ttu-id="72867-125">執行階段程序會寫入 BizTalk 管理資料庫、MessageBox 資料庫、追蹤 Analysis Services 資料庫、BAM 分析資料庫、BAM 星狀結構描述資料庫、BAM 主要匯入資料庫以及 BAM 封存資料庫。</span><span class="sxs-lookup"><span data-stu-id="72867-125">The run-time processes write to the BizTalk Management database, MessageBox databases, Tracking Analysis Services database, BAM Analysis database, BAM Star Schema database, BAM Primary Import database, and BAM Archive database.</span></span> <span data-ttu-id="72867-126">因此，若發生嚴重損毀，這些資料庫就顯得特別重要，而且在決定要叢集哪些資料庫時必須有較高的優先順序。</span><span class="sxs-lookup"><span data-stu-id="72867-126">Therefore, these databases are especially important if a disaster occurs, and must have greater priority when determining what databases to cluster.</span></span> <span data-ttu-id="72867-127">只有使用者或工具會寫入其他資料庫。</span><span class="sxs-lookup"><span data-stu-id="72867-127">Only users or tools write to the other databases.</span></span> <span data-ttu-id="72867-128">MessageBox 資料庫中，您可以考慮主動/主動/被動或主動/主動/主動/被動組態，以減少所需的硬體。</span><span class="sxs-lookup"><span data-stu-id="72867-128">For the MessageBox databases, you can consider an active/active/passive or active/active/active/passive configuration to minimize the hardware needed.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="72867-129">SQL Server Standard Edition 支援 2 個節點的容錯移轉叢集。</span><span class="sxs-lookup"><span data-stu-id="72867-129">SQL Server Standard Edition supports 2-node failover clusters.</span></span> <span data-ttu-id="72867-130">如果您決定使用 SQL Server 上的主動/主動/被動組態中，您必須使用 Enterprise Edition。</span><span class="sxs-lookup"><span data-stu-id="72867-130">If you decide to use the active/active/passive configuration on SQL Server, you must use the Enterprise Edition.</span></span>  
  
## <a name="procedures-for-clustering-the-databases"></a><span data-ttu-id="72867-131">叢集資料庫的程序</span><span class="sxs-lookup"><span data-stu-id="72867-131">Procedures for Clustering the Databases</span></span>  
 <span data-ttu-id="72867-132">請確定您符合下列必要條件，再開始叢集 BizTalk Server 資料庫。</span><span class="sxs-lookup"><span data-stu-id="72867-132">Make sure you meet the following prerequisites before you start clustering the BizTalk Server databases.</span></span>  
  
-   <span data-ttu-id="72867-133">當您為 BizTalk Server 環境建立網域群組時，您必須建立全域網域帳戶。</span><span class="sxs-lookup"><span data-stu-id="72867-133">When you create the domain groups for your BizTalk Server environment, you must create global domain accounts.</span></span>  
  
-   <span data-ttu-id="72867-134">安裝和設定 BizTalk Server 之前，請設定 SQL Server 叢集。</span><span class="sxs-lookup"><span data-stu-id="72867-134">Configure the SQL Server cluster before you install and configure BizTalk Server.</span></span> <span data-ttu-id="72867-135">請參閱[Windows Server 容錯移轉叢集 (WSFC) 與 SQL Server](https://docs.microsoft.com/sql/sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server)或是[Alwayson 容錯移轉叢集執行個體 (SQL Server)](https://docs.microsoft.com/sql/sql-server/failover-clusters/windows/always-on-failover-cluster-instances-sql-server)。</span><span class="sxs-lookup"><span data-stu-id="72867-135">See [Windows Server Failover Clustering (WSFC) with SQL Server](https://docs.microsoft.com/sql/sql-server/failover-clusters/windows/windows-server-failover-clustering-wsfc-with-sql-server) or [Always On Failover Cluster Instances (SQL Server)](https://docs.microsoft.com/sql/sql-server/failover-clusters/windows/always-on-failover-cluster-instances-sql-server).</span></span>  
  
-   <span data-ttu-id="72867-136">若您也要叢集主要密碼伺服器，請先設定該伺服器。</span><span class="sxs-lookup"><span data-stu-id="72867-136">If you are also clustering the master secret server, configure that server first.</span></span> <span data-ttu-id="72867-137">請參閱[主要密碼伺服器的高可用性](../technical-guides/high-availability-for-the-master-secret-server.md)。</span><span class="sxs-lookup"><span data-stu-id="72867-137">See [High Availability for the Master Secret Server](../technical-guides/high-availability-for-the-master-secret-server.md).</span></span>  
  
#### <a name="run-biztalk-configuration"></a><span data-ttu-id="72867-138">執行 BizTalk 組態</span><span class="sxs-lookup"><span data-stu-id="72867-138">Run BizTalk Configuration</span></span>  
  
1. <span data-ttu-id="72867-139">在執行階段伺服器上安裝 BizTalk Server。</span><span class="sxs-lookup"><span data-stu-id="72867-139">Install BizTalk Server on a runtime server.</span></span>  
  
2. <span data-ttu-id="72867-140">開啟 [BizTalk Server 組態]。</span><span class="sxs-lookup"><span data-stu-id="72867-140">Open **BizTalk Server Configuration**.</span></span>  
  
3. <span data-ttu-id="72867-141">若要套用自訂組態，請參閱[匯入和匯出 BizTalk Server 組態](../install-and-config-guides/import-and-export-biztalk-server-configuration.md)。</span><span class="sxs-lookup"><span data-stu-id="72867-141">To apply a custom configuration, see [Import and Export BizTalk Server Configuration](../install-and-config-guides/import-and-export-biztalk-server-configuration.md).</span></span> <span data-ttu-id="72867-142">若要指定 SQL Server 叢集的 BizTalk Server 資料庫輸入中的 SQL Server 叢集的名稱**資料庫**設定的對話方塊。</span><span class="sxs-lookup"><span data-stu-id="72867-142">To specify the SQL Server cluster for the BizTalk Server databases enter the name of the SQL Server cluster in the **Databases** dialog of the configuration.</span></span>  
  
4. <span data-ttu-id="72867-143">BizTalk Server 組態使用完成[自訂組態](../install-and-config-guides/configure-biztalk-server.md)。</span><span class="sxs-lookup"><span data-stu-id="72867-143">Complete the BizTalk Server configuration using a [Custom Configuration](../install-and-config-guides/configure-biztalk-server.md).</span></span>
  
   <span data-ttu-id="72867-144">如需有關叢集 BizTalk Server 資料庫的詳細資訊，請參閱[改善在 BizTalk Server 中使用 Windows Server 2008 容錯移轉叢集或 Windows Server 2003 伺服器叢集的容錯能力](https://www.microsoft.com/download/details.aspx?id=2290)。</span><span class="sxs-lookup"><span data-stu-id="72867-144">For more information about clustering BizTalk Server databases, see [Improving Fault Tolerance in BizTalk Server by Using a Windows Server 2008 Failover Cluster or Windows Server 2003 Server Cluster](https://www.microsoft.com/download/details.aspx?id=2290).</span></span>  
  
## <a name="behavior-of-biztalk-host-instances-during-sql-server-failover"></a><span data-ttu-id="72867-145">SQL Server 容錯移轉期間的 BizTalk 主控件執行個體的行為</span><span class="sxs-lookup"><span data-stu-id="72867-145">Behavior of BizTalk Host Instances During SQL Server Failover</span></span>  
 <span data-ttu-id="72867-146">如需詳細資訊行為 BizTalk 主控件執行個體的 SQL Server 容錯移轉期間，請參閱[行為的 BizTalk Server 主控件執行個體在 SQL Server 容錯移轉期間](../core/behavior-of-biztalk-server-host-instances-during-sql-server-failover.md)。</span><span class="sxs-lookup"><span data-stu-id="72867-146">For more information about behavior of BizTalk host instances during SQL Server failover, see [Behavior of BizTalk Server Host Instances during SQL Server Failover](../core/behavior-of-biztalk-server-host-instances-during-sql-server-failover.md).</span></span>  
  
## <a name="using-sql-server-database-mirroring"></a><span data-ttu-id="72867-147">使用 SQL Server 資料庫鏡像</span><span class="sxs-lookup"><span data-stu-id="72867-147">Using SQL Server Database Mirroring</span></span>  
 <span data-ttu-id="72867-148">如需使用 相對於 BizTalk Server 資料庫叢集的 SQL Server 資料庫鏡像的詳細資訊，請參閱 < [SQL Server 資料庫鏡像、 磁碟區陰影複製服務和 AlwaysOn](../core/sql-server-database-mirroring-volume-shadow-copy-service-and-alwayson.md)。</span><span class="sxs-lookup"><span data-stu-id="72867-148">For more information about using SQL Server database mirroring with respect to BizTalk Server database clustering, see [SQL Server database mirroring, Volume Shadow Copy service and AlwaysOn](../core/sql-server-database-mirroring-volume-shadow-copy-service-and-alwayson.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="72867-149">另請參閱</span><span class="sxs-lookup"><span data-stu-id="72867-149">See Also</span></span>  
 [<span data-ttu-id="72867-150">向外擴充 BizTalk Server 資料庫</span><span class="sxs-lookup"><span data-stu-id="72867-150">Scaling Out the BizTalk Server Databases</span></span>](../technical-guides/scaling-out-the-biztalk-server-databases.md)