---
title: "叢集 BizTalk Server Databases2 |Microsoft 文件"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 1b68bc3f-c0c4-4050-8ca3-df6dd1927637
caps.latest.revision: "3"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 4c84f8f6ef26c567a1bbac44df078f2df58ca9da
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
---
# <a name="clustering-the-biztalk-server-databases"></a><span data-ttu-id="c83cf-102">叢集 BizTalk Server 資料庫</span><span class="sxs-lookup"><span data-stu-id="c83cf-102">Clustering the BizTalk Server Databases</span></span>
<span data-ttu-id="c83cf-103">如果[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]資料庫會變成無法使用，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]環境將無法正確運作。</span><span class="sxs-lookup"><span data-stu-id="c83cf-103">If the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases become unavailable, the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment will not function correctly.</span></span> <span data-ttu-id="c83cf-104">若要提供高可用性，您可以建立 Microsoft[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]叢集以[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]資料庫，如下圖所示。</span><span class="sxs-lookup"><span data-stu-id="c83cf-104">To provide high availability, you can create a Microsoft [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] cluster for the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases, as shown in the following figure.</span></span>  
  
 <span data-ttu-id="c83cf-105">![BizTalk Server 資料庫層](../core/media/tdi-highava-sqlcluster.gif "TDI_HighAva_SQLCluster")</span><span class="sxs-lookup"><span data-stu-id="c83cf-105">![BizTalk Server Database Tier](../core/media/tdi-highava-sqlcluster.gif "TDI_HighAva_SQLCluster")</span></span>  
  
 <span data-ttu-id="c83cf-106">若要建立的高可用性解決方案[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]資料庫，您必須擁有至少兩部電腦執行[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]與叢集中的共用的磁碟陣列。</span><span class="sxs-lookup"><span data-stu-id="c83cf-106">To create a highly available solution for the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases, you must have at least two computers that are running [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] and a shared disk array in the cluster.</span></span>  
  
## <a name="clustering-options"></a><span data-ttu-id="c83cf-107">叢集選項</span><span class="sxs-lookup"><span data-stu-id="c83cf-107">Clustering Options</span></span>  
 <span data-ttu-id="c83cf-108">判斷的最佳叢集組態[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]針對商務需求的資料庫。</span><span class="sxs-lookup"><span data-stu-id="c83cf-108">Determine the best cluster configuration for the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases for your business needs.</span></span> <span data-ttu-id="c83cf-109">以下是一串選項：</span><span class="sxs-lookup"><span data-stu-id="c83cf-109">Here is a list of the options:</span></span>  
  
-   <span data-ttu-id="c83cf-110">**主動/被動**。</span><span class="sxs-lookup"><span data-stu-id="c83cf-110">**Active/passive**.</span></span> <span data-ttu-id="c83cf-111">高可用性的[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]資料庫通常包含兩個或多個設定為主動/被動伺服器叢集組態的資料庫電腦。</span><span class="sxs-lookup"><span data-stu-id="c83cf-111">High availability for the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases typically consists of two or more database computers configured in an active/passive server cluster configuration.</span></span> <span data-ttu-id="c83cf-112">這些電腦會共用一般磁碟資源 (例如 RAID 1 + 0 SCSI 磁碟陣列或儲存區域網路)，並使用 Windows 叢集提供備份備援和容錯功能。</span><span class="sxs-lookup"><span data-stu-id="c83cf-112">These computers share a common disk resource (such as a RAID 1+0 SCSI disk array or storage area network) and use Windows Clustering to provide backup redundancy and fault tolerance.</span></span>  
  
-   <span data-ttu-id="c83cf-113">**主動/主動**。</span><span class="sxs-lookup"><span data-stu-id="c83cf-113">**Active/active**.</span></span> <span data-ttu-id="c83cf-114">Windows 叢集和[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]可讓您執行[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]以主動/主動模式叢集的每個節點其中是 「 作用中 」 且正在執行的一或多個[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]執行個體。</span><span class="sxs-lookup"><span data-stu-id="c83cf-114">Windows Clustering and [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] allow you to run [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] in Active/Active mode where each node of the cluster is “active” and running one or more [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] instances.</span></span> <span data-ttu-id="c83cf-115">比方說，這樣可讓您有一個節點和所有其他 MessageBox 資料庫[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]另一個節點上的資料庫。</span><span class="sxs-lookup"><span data-stu-id="c83cf-115">For example, this would allow you to have the MessageBox database on one node and all other [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases on the other node.</span></span> <span data-ttu-id="c83cf-116">這可讓您以最大化叢集硬體的使用方式，但主動/主動[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]組態應該小心使用。</span><span class="sxs-lookup"><span data-stu-id="c83cf-116">This allows you to maximize cluster hardware usage, but an active/active [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] configuration should be used with care.</span></span>  
  
     <span data-ttu-id="c83cf-117">可以每個節點同時處理所有的負載[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]執行個體期間[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]容錯移轉叢集節點的案例？</span><span class="sxs-lookup"><span data-stu-id="c83cf-117">Can each node simultaneously handle the load of all [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] instances during a [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] cluster node failover scenario?</span></span> <span data-ttu-id="c83cf-118">有足夠的 CPU 資源嗎？</span><span class="sxs-lookup"><span data-stu-id="c83cf-118">Are there enough CPU resources?</span></span> <span data-ttu-id="c83cf-119">是否有足夠的記憶體？</span><span class="sxs-lookup"><span data-stu-id="c83cf-119">Is there sufficient memory?</span></span> <span data-ttu-id="c83cf-120">網路頻寬呢？</span><span class="sxs-lookup"><span data-stu-id="c83cf-120">What about network bandwidth?</span></span> <span data-ttu-id="c83cf-121">如何磁碟 I/O 競爭？</span><span class="sxs-lookup"><span data-stu-id="c83cf-121">How about disk I/O contention?</span></span>  
  
     <span data-ttu-id="c83cf-122">這些只是部分的問題時必須回答才能判斷主動/主動[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]叢集是否適合您的 BizTalk 應用程式。</span><span class="sxs-lookup"><span data-stu-id="c83cf-122">These are just some of the questions that need to be answered in order to determine if an active/active [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] cluster is right for your BizTalk applications.</span></span> <span data-ttu-id="c83cf-123">如果它由決定有一個節點無法處理所有[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]容錯移轉狀況中的執行個體，另一個方法是使用主動/主動/被動叢集。</span><span class="sxs-lookup"><span data-stu-id="c83cf-123">If it is determined that one node cannot handle all [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] instances in a failover scenario, an alternative is to use active/active/passive clustering.</span></span>  
  
-   <span data-ttu-id="c83cf-124">**主動/主動/被動**。</span><span class="sxs-lookup"><span data-stu-id="c83cf-124">**Active/active/passive**.</span></span> <span data-ttu-id="c83cf-125">執行階段程序會寫入 BizTalk 管理資料庫、MessageBox 資料庫、追蹤 Analysis Services 資料庫、BAM 分析資料庫、BAM 星狀結構描述資料庫、BAM 主要匯入資料庫以及 BAM 封存資料庫。</span><span class="sxs-lookup"><span data-stu-id="c83cf-125">The run-time processes write to the BizTalk Management database, MessageBox databases, Tracking Analysis Services database, BAM Analysis database, BAM Star Schema database, BAM Primary Import database, and BAM Archive database.</span></span> <span data-ttu-id="c83cf-126">因此，若發生嚴重損毀，這些資料庫就顯得特別重要，而且在決定要叢集哪些資料庫時必須有較高的優先順序。</span><span class="sxs-lookup"><span data-stu-id="c83cf-126">Therefore, these databases are especially important if a disaster occurs, and must have greater priority when determining what databases to cluster.</span></span> <span data-ttu-id="c83cf-127">只有使用者或工具會寫入其他資料庫。</span><span class="sxs-lookup"><span data-stu-id="c83cf-127">Only users or tools write to the other databases.</span></span> <span data-ttu-id="c83cf-128">MessageBox 資料庫中，您可以考慮主動/主動/被動或主動/主動/主動/被動組態，以減少所需的硬體。</span><span class="sxs-lookup"><span data-stu-id="c83cf-128">For the MessageBox databases, you can consider an active/active/passive or active/active/active/passive configuration to minimize the hardware needed.</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[btsSQLServer2008R2](../includes/btssqlserver2008r2-md.md)]<span data-ttu-id="c83cf-129">和[!INCLUDE[btsSQLServer2008](../includes/btssqlserver2008-md.md)]Standard Edition 支援 2 個節點的容錯移轉叢集。</span><span class="sxs-lookup"><span data-stu-id="c83cf-129"> and [!INCLUDE[btsSQLServer2008](../includes/btssqlserver2008-md.md)] Standard Edition supports 2-node failover clusters.</span></span> <span data-ttu-id="c83cf-130">如果您決定使用上的主動/主動/被動組態[!INCLUDE[btsSQLServer2008R2](../includes/btssqlserver2008r2-md.md)]或[!INCLUDE[btsSQLServer2008](../includes/btssqlserver2008-md.md)]，您必須使用 Enterprise Edition [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="c83cf-130">If you decide to use the active/active/passive configuration on [!INCLUDE[btsSQLServer2008R2](../includes/btssqlserver2008r2-md.md)] or [!INCLUDE[btsSQLServer2008](../includes/btssqlserver2008-md.md)], you must use the Enterprise Edition of [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)].</span></span>  
  
## <a name="procedures-for-clustering-the-databases"></a><span data-ttu-id="c83cf-131">叢集資料庫的程序</span><span class="sxs-lookup"><span data-stu-id="c83cf-131">Procedures for Clustering the Databases</span></span>  
 <span data-ttu-id="c83cf-132">請確定您符合下列必要條件，再啟動叢集[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]資料庫。</span><span class="sxs-lookup"><span data-stu-id="c83cf-132">Make sure you meet the following prerequisites before you start clustering the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases.</span></span>  
  
-   <span data-ttu-id="c83cf-133">當您建立網域群組您[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]環境中，您必須建立全域網域帳戶。</span><span class="sxs-lookup"><span data-stu-id="c83cf-133">When you create the domain groups for your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment, you must create global domain accounts.</span></span>  
  
-   <span data-ttu-id="c83cf-134">設定[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]叢集才能安裝及設定[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="c83cf-134">Configure the [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] cluster before you install and configure [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="c83cf-135">如需有關叢集[!INCLUDE[btsSQLServer2008R2](../includes/btssqlserver2008r2-md.md)]，請參閱[Started with SQL Server 2008 R2 容錯移轉叢集](http://go.microsoft.com/fwlink/?LinkId=156820)(http://go.microsoft.com/fwlink/?LinkId=156820)。</span><span class="sxs-lookup"><span data-stu-id="c83cf-135">For more information about clustering [!INCLUDE[btsSQLServer2008R2](../includes/btssqlserver2008r2-md.md)], see [Getting Started with SQL Server 2008 R2 Failover Clustering](http://go.microsoft.com/fwlink/?LinkId=156820) (http://go.microsoft.com/fwlink/?LinkId=156820).</span></span>  
  
-   <span data-ttu-id="c83cf-136">若您也要叢集主要密碼伺服器，請先設定該伺服器。</span><span class="sxs-lookup"><span data-stu-id="c83cf-136">If you are also clustering the master secret server, configure that server first.</span></span> <span data-ttu-id="c83cf-137">如需高可用性的企業單一登入，請參閱[主要密碼伺服器的高可用性](../technical-guides/high-availability-for-the-master-secret-server.md)。</span><span class="sxs-lookup"><span data-stu-id="c83cf-137">For more information about high availability for Enterprise Single Sign-On, see [High Availability for the Master Secret Server](../technical-guides/high-availability-for-the-master-secret-server.md).</span></span>  
  
#### <a name="to-run-the-biztalk-server-configuration-wizard"></a><span data-ttu-id="c83cf-138">若要執行 BizTalk Server 組態精靈</span><span class="sxs-lookup"><span data-stu-id="c83cf-138">To run the BizTalk Server Configuration Wizard</span></span>  
  
1.  <span data-ttu-id="c83cf-139">在執行階段伺服器上安裝 [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="c83cf-139">Install [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)] on a runtime server.</span></span>  
  
2.  <span data-ttu-id="c83cf-140">啟動[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]組態程式。</span><span class="sxs-lookup"><span data-stu-id="c83cf-140">Launch the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Configuration program.</span></span> <span data-ttu-id="c83cf-141">按一下**啟動**，指向 **程式**，指向  **Microsoft [!INCLUDE[btsBizTalkServer2006r3ui](../includes/btsbiztalkserver2006r3ui-md.md)]** ，然後按一下 **BizTalk Server 組態**。</span><span class="sxs-lookup"><span data-stu-id="c83cf-141">Click **Start**, point to **Programs**, point to **Microsoft [!INCLUDE[btsBizTalkServer2006r3ui](../includes/btsbiztalkserver2006r3ui-md.md)]**, and then click **BizTalk Server Configuration**.</span></span>  
  
3.  <span data-ttu-id="c83cf-142">若要套用自訂的設定，請遵循[使用自訂組態管理員](http://go.microsoft.com/fwlink/?LinkId=156822)(http://go.microsoft.com/fwlink/?LinkId=156822) 中[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]幫助。</span><span class="sxs-lookup"><span data-stu-id="c83cf-142">To apply a custom configuration, follow the steps in [Working with the Custom Configuration Manager](http://go.microsoft.com/fwlink/?LinkId=156822) (http://go.microsoft.com/fwlink/?LinkId=156822) in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Help.</span></span> <span data-ttu-id="c83cf-143">若要指定 SQL Server 叢集的 BizTalk Server 資料庫輸入中的 SQL Server 叢集的名稱**資料庫**的組態對話方塊。</span><span class="sxs-lookup"><span data-stu-id="c83cf-143">To specify the SQL Server cluster for the BizTalk Server databases enter the name of the SQL Server cluster in the **Databases** dialog of the configuration.</span></span>  
  
4.  <span data-ttu-id="c83cf-144">完成[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]組態設定中的指示[自訂組態](http://go.microsoft.com/fwlink/?LinkId=156823)(http://go.microsoft.com/fwlink/?LinkId=156823) 中[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]幫助。</span><span class="sxs-lookup"><span data-stu-id="c83cf-144">Complete the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] configuration by following the instructions in [Custom Configuration](http://go.microsoft.com/fwlink/?LinkId=156823) (http://go.microsoft.com/fwlink/?LinkId=156823) in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Help.</span></span>  
  
 <span data-ttu-id="c83cf-145">如需有關叢集[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]資料庫，請參閱[改善在 BizTalk Server 中使用 Windows Server 2008 容錯移轉叢集或 Windows Server 2003 伺服器叢集的容錯功能](http://go.microsoft.com/fwlink/?LinkId=156819)(http://go.microsoft.com/fwlink/?LinkId=156819)。</span><span class="sxs-lookup"><span data-stu-id="c83cf-145">For more information about clustering [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases, see [Improving Fault Tolerance in BizTalk Server by Using a Windows Server 2008 Failover Cluster or Windows Server 2003 Server Cluster](http://go.microsoft.com/fwlink/?LinkId=156819) (http://go.microsoft.com/fwlink/?LinkId=156819).</span></span>  
  
## <a name="behavior-of-biztalk-host-instances-during-sql-server-failover"></a><span data-ttu-id="c83cf-146">SQL Server 容錯移轉期間的 BizTalk 主控件執行個體的行為</span><span class="sxs-lookup"><span data-stu-id="c83cf-146">Behavior of BizTalk Host Instances During SQL Server Failover</span></span>  
 <span data-ttu-id="c83cf-147">如需有關行為 BizTalk 主控件執行個體的 SQL Server 容錯移轉期間，請參閱[行為的 BizTalk Server 主控件執行個體在 SQL Server 容錯移轉期間](http://go.microsoft.com/fwlink/?LinkId=151287)(http://go.microsoft.com/fwlink/?LinkId=151287)。</span><span class="sxs-lookup"><span data-stu-id="c83cf-147">For more information about behavior of BizTalk host instances during SQL Server failover, see [Behavior of BizTalk Server Host Instances during SQL Server Failover](http://go.microsoft.com/fwlink/?LinkId=151287) (http://go.microsoft.com/fwlink/?LinkId=151287).</span></span>  
  
## <a name="using-sql-server-database-mirroring"></a><span data-ttu-id="c83cf-148">使用 SQL Server 資料庫鏡像</span><span class="sxs-lookup"><span data-stu-id="c83cf-148">Using SQL Server Database Mirroring</span></span>  
 <span data-ttu-id="c83cf-149">如需使用相對於 BizTalk Server 資料庫叢集的 SQL Server 資料庫鏡像的詳細資訊，請參閱[使用 SQL Server 資料庫鏡像或磁碟區陰影複製服務](http://go.microsoft.com/fwlink/?LinkId=151288)(http://go.microsoft.com/fwlink/?LinkId = 151288) 在 BizTalk Server 說明。</span><span class="sxs-lookup"><span data-stu-id="c83cf-149">For more information about using SQL Server database mirroring with respect to BizTalk Server database clustering, see [Use of SQL Server database mirroring or the Volume Shadow Copy service](http://go.microsoft.com/fwlink/?LinkId=151288) (http://go.microsoft.com/fwlink/?LinkId=151288) in BizTalk Server help.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c83cf-150">另請參閱</span><span class="sxs-lookup"><span data-stu-id="c83cf-150">See Also</span></span>  
 [<span data-ttu-id="c83cf-151">向外延展 BizTalk Server 資料庫</span><span class="sxs-lookup"><span data-stu-id="c83cf-151">Scaling Out the BizTalk Server Databases</span></span>](../technical-guides/scaling-out-the-biztalk-server-databases.md)