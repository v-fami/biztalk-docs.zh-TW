---
title: 資料庫的高可用性 |Microsoft 文件
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 63813d87-1ce4-4645-bb2a-d55e413fcace
caps.latest.revision: 3
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 24e17afbf9e33f3e12553d7ded5068370d8ca085
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/01/2017
ms.locfileid: "26009359"
---
# <a name="high-availability-for-databases"></a><span data-ttu-id="b5b21-102">資料庫的高可用性</span><span class="sxs-lookup"><span data-stu-id="b5b21-102">High Availability for Databases</span></span>
<span data-ttu-id="b5b21-103">BizTalk Server 高度依賴 SQL Server 資料存放區和資料持續性。</span><span class="sxs-lookup"><span data-stu-id="b5b21-103">BizTalk Server relies heavily on SQL Server for data store and data persistence.</span></span> <span data-ttu-id="b5b21-104">在 BizTalk Server 中所有其他元件和主控件在整合不同的商業應用程式的程序中都有特定的角色 (例如，接收、處理或路由訊息)，但是資料庫電腦會擷取此工作並將它保存到磁碟中。</span><span class="sxs-lookup"><span data-stu-id="b5b21-104">All other components and hosts in BizTalk Server have specific roles in the process of integrating disparate business applications (for example, receiving, processing, or routing messages), but the database computer captures this work and persists it to disk.</span></span> <span data-ttu-id="b5b21-105">例如，當 BizTalk Server 接收內送訊息，接收主控件它保存到 MessageBox 資料庫之前其他主控件擷取協調流程處理和傳送的訊息。</span><span class="sxs-lookup"><span data-stu-id="b5b21-105">For example, when BizTalk Server receives an incoming message, the receive host persists it to the MessageBox database before other hosts retrieve the message for orchestration processing and sending.</span></span> <span data-ttu-id="b5b21-106">如果您的 BizTalk 方案包含協調流程，BizTalk Server 會將訊息路由的主控件執行商務程序 （處理主控件），並在協調流程完成之後，將訊息儲存到 MessageBox 資料庫。</span><span class="sxs-lookup"><span data-stu-id="b5b21-106">If your BizTalk solution involves orchestration, BizTalk Server routes the message to the host that executes the business process (processing host), and saves the message to the MessageBox database after the orchestration finishes.</span></span> <span data-ttu-id="b5b21-107">傳送主控件接著會從資料庫擷取訊息，再透過適當的傳送配接器將它傳送到外部應用程式。</span><span class="sxs-lookup"><span data-stu-id="b5b21-107">The sending host then retrieves the message from the database before sending it to the external application through the appropriate send adapter.</span></span>  
  
 <span data-ttu-id="b5b21-108">若要為 BizTalk Server 資料庫提供高可用性，使用 Windows 叢集來設定兩個或多個執行 SQL Server 建立伺服器叢集的電腦。</span><span class="sxs-lookup"><span data-stu-id="b5b21-108">To provide high availability for the BizTalk Server databases, use Windows Clustering to configure two or more computers that are running SQL Server to create a server cluster.</span></span> <span data-ttu-id="b5b21-109">這個伺服器叢集提供備援和容錯功能，BizTalk Server 資料庫。</span><span class="sxs-lookup"><span data-stu-id="b5b21-109">This server clustering provides redundancy and fault tolerance for the BizTalk Server databases.</span></span> <span data-ttu-id="b5b21-110">不像載入平衡叢集是以一組電腦一起運作以增加可用性和延展性，伺服器叢集通常包含兩個一組的主動/被動組態的資料庫電腦，如此，其中一部電腦即可為另一部電腦提供備份資源。</span><span class="sxs-lookup"><span data-stu-id="b5b21-110">Unlike load-balanced clustering, where a group of computers functions together to increase availability and scalability, server clustering typically involves a pair of database computers in an active/passive configuration so that one computer provides backup resources for the other.</span></span>  
  
 <span data-ttu-id="b5b21-111">下圖顯示 BizTalk Server 資料庫層透過主動/被動伺服器叢集提供高可用性。</span><span class="sxs-lookup"><span data-stu-id="b5b21-111">The following figure shows a BizTalk Server database tier with high availability through active/passive server clustering.</span></span>  
  
 <span data-ttu-id="b5b21-112">![BizTalk Server 資料庫層](../core/media/tdi-highava-sqlcluster.gif "TDI_HighAva_SQLCluster")</span><span class="sxs-lookup"><span data-stu-id="b5b21-112">![BizTalk Server Database Tier](../core/media/tdi-highava-sqlcluster.gif "TDI_HighAva_SQLCluster")</span></span>  
  
 <span data-ttu-id="b5b21-113">若主動資料庫電腦發生錯誤或失敗，則被動電腦會變成主動並掌控資料庫資源，直到失敗的電腦修復為止。</span><span class="sxs-lookup"><span data-stu-id="b5b21-113">If the active database computer encounters errors or fails, the passive computer becomes active and assumes control over the database resources until the failed computer is repaired.</span></span> <span data-ttu-id="b5b21-114">資料庫服務會容錯移轉將資料連接還原至新的作用中電腦並讓 BizTalk 應用程式繼續運作。</span><span class="sxs-lookup"><span data-stu-id="b5b21-114">The database service fails over and restores data connections to the new active computer and enables the BizTalk application to continue functioning.</span></span>  
  
## <a name="biztalk-server-databases"></a><span data-ttu-id="b5b21-115">BizTalk Server 資料庫</span><span class="sxs-lookup"><span data-stu-id="b5b21-115">BizTalk Server Databases</span></span>  
 <span data-ttu-id="b5b21-116">Microsoft BizTalk Server 會在 SQL Server 中安裝數個資料庫。</span><span class="sxs-lookup"><span data-stu-id="b5b21-116">Microsoft BizTalk Server installs several databases in SQL Server.</span></span> <span data-ttu-id="b5b21-117">下表顯示 BizTalk Server 資料庫的一般使用特性。</span><span class="sxs-lookup"><span data-stu-id="b5b21-117">The following table shows typical usage characteristics for the BizTalk Server databases.</span></span>  
  
|<span data-ttu-id="b5b21-118">資料庫</span><span class="sxs-lookup"><span data-stu-id="b5b21-118">Database</span></span>|<span data-ttu-id="b5b21-119">預設資料庫名稱</span><span class="sxs-lookup"><span data-stu-id="b5b21-119">Default database name</span></span>|<span data-ttu-id="b5b21-120">使用特性</span><span class="sxs-lookup"><span data-stu-id="b5b21-120">Usage characteristics</span></span>|  
|--------------|---------------------------|---------------------------|  
|<span data-ttu-id="b5b21-121">管理資料庫</span><span class="sxs-lookup"><span data-stu-id="b5b21-121">Management database</span></span>|<span data-ttu-id="b5b21-122">BizTalkMgmtDb</span><span class="sxs-lookup"><span data-stu-id="b5b21-122">BizTalkMgmtDb</span></span>|<span data-ttu-id="b5b21-123">此資料庫控制代碼低使用量讀取和寫入作業。</span><span class="sxs-lookup"><span data-stu-id="b5b21-123">This database handles low-usage read and write operations.</span></span>|  
|<span data-ttu-id="b5b21-124">MessageBox 資料庫</span><span class="sxs-lookup"><span data-stu-id="b5b21-124">MessageBox database</span></span>|<span data-ttu-id="b5b21-125">BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="b5b21-125">BizTalkMsgBoxDb</span></span>|<span data-ttu-id="b5b21-126">此資料庫控制代碼高使用量讀取和寫入作業。</span><span class="sxs-lookup"><span data-stu-id="b5b21-126">This database handles high-usage read and write operations.</span></span>|  
|<span data-ttu-id="b5b21-127">追蹤資料庫</span><span class="sxs-lookup"><span data-stu-id="b5b21-127">Tracking database</span></span>|<span data-ttu-id="b5b21-128">BizTalkDTADb</span><span class="sxs-lookup"><span data-stu-id="b5b21-128">BizTalkDTADb</span></span>|<span data-ttu-id="b5b21-129">這個資料庫負責處理可能高使用量寫入作業，您可以設定為要追蹤的資料數量而定，和低使用量讀取作業。</span><span class="sxs-lookup"><span data-stu-id="b5b21-129">This database handles potentially high-usage write operations depending on the amount of data that you configure to be tracked, and low-usage read operations.</span></span>|  
|<span data-ttu-id="b5b21-130">SSO 資料庫</span><span class="sxs-lookup"><span data-stu-id="b5b21-130">SSO database</span></span>|<span data-ttu-id="b5b21-131">SSODB</span><span class="sxs-lookup"><span data-stu-id="b5b21-131">SSODB</span></span>|<span data-ttu-id="b5b21-132">此資料庫控制代碼低使用量讀取和寫入作業。</span><span class="sxs-lookup"><span data-stu-id="b5b21-132">This database handles low-usage read and write operations.</span></span>|  
|<span data-ttu-id="b5b21-133">BAM 分析資料庫</span><span class="sxs-lookup"><span data-stu-id="b5b21-133">BAM Analysis database</span></span>|<span data-ttu-id="b5b21-134">BAMAnalysis</span><span class="sxs-lookup"><span data-stu-id="b5b21-134">BAMAnalysis</span></span>|<span data-ttu-id="b5b21-135">此 SQL Server Analysis Services 資料庫處理可能高使用量的讀取和寫入作業，根據監視執行的層級。</span><span class="sxs-lookup"><span data-stu-id="b5b21-135">This SQL Server Analysis Services database handles potentially high-usage read and write operations, depending on the level of monitoring performed.</span></span>|  
|<span data-ttu-id="b5b21-136">BAM 星狀結構描述資料庫</span><span class="sxs-lookup"><span data-stu-id="b5b21-136">BAM Star Schema database</span></span>|<span data-ttu-id="b5b21-137">BAMStarSchema</span><span class="sxs-lookup"><span data-stu-id="b5b21-137">BAMStarSchema</span></span>|<span data-ttu-id="b5b21-138">此 SQL Server Analysis Services 資料庫處理可能高使用量的讀取和寫入作業，根據監視執行的層級。</span><span class="sxs-lookup"><span data-stu-id="b5b21-138">This SQL Server Analysis Services database handles potentially high-usage read and write operations, depending on the level of monitoring performed.</span></span>|  
|<span data-ttu-id="b5b21-139">BAM 主要匯入資料庫</span><span class="sxs-lookup"><span data-stu-id="b5b21-139">BAM Primary Import database</span></span>|<span data-ttu-id="b5b21-140">BAMPrimaryImport</span><span class="sxs-lookup"><span data-stu-id="b5b21-140">BAMPrimaryImport</span></span>|<span data-ttu-id="b5b21-141">此 SQL Server Analysis Services 資料庫處理可能高使用量的讀取和寫入作業，根據監視執行的層級。</span><span class="sxs-lookup"><span data-stu-id="b5b21-141">This SQL Server Analysis Services database handles potentially high-usage read and write operations, depending on the level of monitoring performed.</span></span>|  
|<span data-ttu-id="b5b21-142">BAM 封存資料庫</span><span class="sxs-lookup"><span data-stu-id="b5b21-142">BAM Archive database</span></span>|<span data-ttu-id="b5b21-143">BAMArchive</span><span class="sxs-lookup"><span data-stu-id="b5b21-143">BAMArchive</span></span>|<span data-ttu-id="b5b21-144">此 SQL Server Analysis Services 資料庫處理可能高使用量的讀取和寫入作業，根據監視執行的層級。</span><span class="sxs-lookup"><span data-stu-id="b5b21-144">This SQL Server Analysis Services database handles potentially high-usage read and write operations, depending on the level of monitoring performed.</span></span>|  
|<span data-ttu-id="b5b21-145">規則引擎資料庫</span><span class="sxs-lookup"><span data-stu-id="b5b21-145">Rule Engine database</span></span>|<span data-ttu-id="b5b21-146">BizTalkRuleEngineDb</span><span class="sxs-lookup"><span data-stu-id="b5b21-146">BizTalkRuleEngineDb</span></span>|<span data-ttu-id="b5b21-147">這個資料庫會處理潛在的低使用量讀取和寫入作業，除非您更新的規則。</span><span class="sxs-lookup"><span data-stu-id="b5b21-147">This database handles potentially low-usage read and write operations, unless you update the rules.</span></span>|  
|<span data-ttu-id="b5b21-148">追蹤 Analysis Services 資料庫</span><span class="sxs-lookup"><span data-stu-id="b5b21-148">Tracking Analysis Services database</span></span>|<span data-ttu-id="b5b21-149">BizTalkAnalysisDb</span><span class="sxs-lookup"><span data-stu-id="b5b21-149">BizTalkAnalysisDb</span></span>|<span data-ttu-id="b5b21-150">此 SQL Server Analysis Services 資料庫高使用量讀取和寫入作業的控制代碼。</span><span class="sxs-lookup"><span data-stu-id="b5b21-150">This SQL Server Analysis Services database handles high-usage read and write operations.</span></span>|  
  
 <span data-ttu-id="b5b21-151">BizTalk Server 執行階段作業通常會使用前四個的資料庫 （管理資料庫、 MessageBox 資料庫、 追蹤資料庫以及 SSO 資料庫）。</span><span class="sxs-lookup"><span data-stu-id="b5b21-151">BizTalk Server runtime operations typically use the first four databases (Management database, MessageBox databases, Tracking database, and SSO database).</span></span> <span data-ttu-id="b5b21-152">根據這些資料庫上的流量，您可以將它們放在個別執行 SQL Server 的電腦上。</span><span class="sxs-lookup"><span data-stu-id="b5b21-152">Depending on the traffic on these databases, you can put them on separate computers that are running SQL Server.</span></span> <span data-ttu-id="b5b21-153">視您所使用的 BizTalk Server 功能而定，您可能有資料表中部分或全部的其他資料庫。</span><span class="sxs-lookup"><span data-stu-id="b5b21-153">Depending on the BizTalk Server functionality that you use, you may have some or all of the other databases in the table.</span></span> <span data-ttu-id="b5b21-154">您可以向外延展，並視需要叢集這些資料庫。</span><span class="sxs-lookup"><span data-stu-id="b5b21-154">You can scale out and cluster these databases as needed.</span></span>  
  
 <span data-ttu-id="b5b21-155">請確定您遵循優良的 SQL Server 部署作法，例如每個資料庫使用不同的磁碟。</span><span class="sxs-lookup"><span data-stu-id="b5b21-155">Make sure that you follow good SQL Server deployment practices, such as using separate disks for each database.</span></span>  
  
 <span data-ttu-id="b5b21-156">BizTalk Server 資料庫中，我們建議您下列：</span><span class="sxs-lookup"><span data-stu-id="b5b21-156">For the BizTalk Server databases, we recommend that you do the following:</span></span>  
  
-   <span data-ttu-id="b5b21-157">**設定容錯移轉叢集**。</span><span class="sxs-lookup"><span data-stu-id="b5b21-157">**Set up failover clustering**.</span></span> <span data-ttu-id="b5b21-158">容錯移轉叢集可讓 SQL Server 會自動切換 SQL server 從失敗的伺服器正常運作的伺服器執行個體處理。</span><span class="sxs-lookup"><span data-stu-id="b5b21-158">Failover clustering enables SQL Server to automatically switch the processing for an instance of SQL Server from a failed server to a working server.</span></span>  
  
     <span data-ttu-id="b5b21-159">「BAM 主要匯入」資料庫收集事件資料。</span><span class="sxs-lookup"><span data-stu-id="b5b21-159">The BAM Primary Import database collects event data.</span></span> <span data-ttu-id="b5b21-160">在嚴重損毀的事件中，從上次備份寫入「BAM 主要匯入」資料庫中的資料會遺失。</span><span class="sxs-lookup"><span data-stu-id="b5b21-160">In the event of a disaster, data that was written to the BAM Primary Import database since the last backup will be lost.</span></span> <span data-ttu-id="b5b21-161">沒有任何方法來重新產生遺失的事件，因為它是特別重要，您會啟用容錯移轉叢集上 BAM 主要匯入資料庫。</span><span class="sxs-lookup"><span data-stu-id="b5b21-161">Because there is no way to regenerate lost events, it is especially important that you enable failover clustering on your BAM Primary Import database.</span></span>  
  
-   <span data-ttu-id="b5b21-162">**使用 SQL Server RAID 1 + 0 （獨立磁碟備援陣列）**，特別是針對 MessageBox 資料庫和 BAM 主要匯入資料庫。</span><span class="sxs-lookup"><span data-stu-id="b5b21-162">**Use SQL Server RAID 1+0 (redundant array of independent disks)**, especially for the MessageBox database and the BAM Primary Import database.</span></span>  
  
 <span data-ttu-id="b5b21-163">如需 BizTalk Server 資料庫備份的詳細資訊，請參閱[災害復原的最佳作法](../technical-guides/best-practices-for-disaster-recovery.md)。</span><span class="sxs-lookup"><span data-stu-id="b5b21-163">For information about backing up your BizTalk Server databases, see [Best Practices for Disaster Recovery](../technical-guides/best-practices-for-disaster-recovery.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="b5b21-164">Microsoft SQL Server 提供一種軟體解決方案，稱為 「 資料庫鏡像增加資料庫的可用機率。</span><span class="sxs-lookup"><span data-stu-id="b5b21-164">Microsoft SQL Server provides a software solution known as database mirroring for increasing the probability that a database is available.</span></span> <span data-ttu-id="b5b21-165">使用 SQL Server 資料庫鏡像目前不支援的解決方案，可確保 Microsoft BizTalk Server 資料庫的高可用性，因為維護 BizTalk Server 資料庫中的交易一致性的潛在問題。</span><span class="sxs-lookup"><span data-stu-id="b5b21-165">The use of SQL Server database mirroring is not currently a supported solution for ensuring high availability of the Microsoft BizTalk Server databases because of potential problems maintaining transactional consistency in the BizTalk Server databases.</span></span>  
>   
>  <span data-ttu-id="b5b21-166">如需有關資料庫鏡像和 SQL Server 中的跨資料庫交易的詳細資訊，請參閱[交易的可用性群組和資料庫鏡像](https://docs.microsoft.com/sql/database-engine/availability-groups/windows/transactions-always-on-availability-and-database-mirroring)。</span><span class="sxs-lookup"><span data-stu-id="b5b21-166">For more information about database mirroring and cross-database transactions in SQL Server, see [Transactions - availability groups and database mirroring](https://docs.microsoft.com/sql/database-engine/availability-groups/windows/transactions-always-on-availability-and-database-mirroring).</span></span> <span data-ttu-id="b5b21-167">BizTalk Server 資料庫應該安裝在 SQL Server 叢集，以確保高可用性和災害復原用途應該利用記錄傳送。</span><span class="sxs-lookup"><span data-stu-id="b5b21-167">BizTalk Server databases should be installed on a SQL Server cluster to ensure high availability and log shipping should be utilized for purposes of disaster recovery.</span></span>  
>   
>  <span data-ttu-id="b5b21-168">如需記錄傳送的詳細資訊，請參閱[什麼是 BizTalk Server 記錄傳送嗎？](../technical-guides/what-is-biztalk-server-log-shipping.md)</span><span class="sxs-lookup"><span data-stu-id="b5b21-168">For more information about log shipping, see [What Is BizTalk Server Log Shipping?](../technical-guides/what-is-biztalk-server-log-shipping.md)</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="b5b21-169">本節內容</span><span class="sxs-lookup"><span data-stu-id="b5b21-169">In This Section</span></span>  
  
-   [<span data-ttu-id="b5b21-170">叢集 BizTalk Server 資料庫</span><span class="sxs-lookup"><span data-stu-id="b5b21-170">Clustering the BizTalk Server Databases</span></span>](../technical-guides/clustering-the-biztalk-server-databases2.md)  
  
-   [<span data-ttu-id="b5b21-171">向外擴充 BizTalk Server 資料庫</span><span class="sxs-lookup"><span data-stu-id="b5b21-171">Scaling Out the BizTalk Server Databases</span></span>](../technical-guides/scaling-out-the-biztalk-server-databases.md)  
  
## <a name="see-also"></a><span data-ttu-id="b5b21-172">請參閱</span><span class="sxs-lookup"><span data-stu-id="b5b21-172">See Also</span></span>  
 <span data-ttu-id="b5b21-173">[高可用性規劃](../technical-guides/planning-for-high-availability2.md) </span><span class="sxs-lookup"><span data-stu-id="b5b21-173">[Planning for High Availability](../technical-guides/planning-for-high-availability2.md) </span></span>  
 <span data-ttu-id="b5b21-174">[BizTalk 主控件的高可用性](../technical-guides/high-availability-for-biztalk-hosts.md) </span><span class="sxs-lookup"><span data-stu-id="b5b21-174">[High Availability for BizTalk Hosts](../technical-guides/high-availability-for-biztalk-hosts.md) </span></span>  
 <span data-ttu-id="b5b21-175">[主要密碼伺服器的高可用性](../technical-guides/high-availability-for-the-master-secret-server.md) </span><span class="sxs-lookup"><span data-stu-id="b5b21-175">[High Availability for the Master Secret Server](../technical-guides/high-availability-for-the-master-secret-server.md) </span></span>  
 [<span data-ttu-id="b5b21-176">災害復原</span><span class="sxs-lookup"><span data-stu-id="b5b21-176">Disaster Recovery</span></span>](../technical-guides/disaster-recovery.md)