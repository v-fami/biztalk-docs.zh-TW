---
title: 避免瓶頸的最佳作法 |Microsoft 文件
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 81da2e31-dce0-43fb-841f-e65ff99e80a7
caps.latest.revision: 6
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 08f2291d6aa4d16c251a110bc6f94c6288dc5064
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
ms.locfileid: "22299662"
---
# <a name="best-practices-for-avoiding-bottlenecks"></a><span data-ttu-id="a51cc-102">避免瓶頸的最佳作法</span><span class="sxs-lookup"><span data-stu-id="a51cc-102">Best Practices for Avoiding Bottlenecks</span></span>
<span data-ttu-id="a51cc-103">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 的預設設定會針對許多軟硬體組態提供最佳效能，但有時候修改此設定或部署組態會有助益。</span><span class="sxs-lookup"><span data-stu-id="a51cc-103">While the default settings in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] provide optimal performance for many hardware and software configurations, in some scenarios it may be beneficial to modify the settings or deployment configuration.</span></span> <span data-ttu-id="a51cc-104">在設定 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 時，請考慮下列效能指導方針：</span><span class="sxs-lookup"><span data-stu-id="a51cc-104">When configuring [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], consider the following performance guidelines:</span></span>  
  
-   <span data-ttu-id="a51cc-105">若要避免資源爭用，隔離接收協調流程和傳送個別主機上。</span><span class="sxs-lookup"><span data-stu-id="a51cc-105">To prevent resource contention, isolate receiving, orchestration, and sending on separate hosts.</span></span> <span data-ttu-id="a51cc-106">若要進一步將爭用情形降至最低，請將追蹤服務與其他主控件分離。</span><span class="sxs-lookup"><span data-stu-id="a51cc-106">To further minimize contention, isolate the tracking service from other hosts.</span></span>  
  
-   <span data-ttu-id="a51cc-107">如果執行 BizTalk Server 的電腦上的 CPU 處理是瓶頸，向上擴充包含額外的 Cpu 或升級至更快速的 Cpu 執行 BizTalk Server 的電腦。</span><span class="sxs-lookup"><span data-stu-id="a51cc-107">If CPU processing on the computer running BizTalk Server is the bottleneck, scale up the computer running BizTalk Server by including additional CPUs or upgrading to faster CPUs.</span></span>  
  
## <a name="sql-server-guidelines"></a><span data-ttu-id="a51cc-108">SQL Server 指導方針</span><span class="sxs-lookup"><span data-stu-id="a51cc-108">SQL Server Guidelines</span></span>  
 <span data-ttu-id="a51cc-109">搭配 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 設定 Microsoft SQL Server 時，請考慮下列效能指導方針：</span><span class="sxs-lookup"><span data-stu-id="a51cc-109">Consider the following performance guidelines when configuring Microsoft SQL Server with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]:</span></span>  
  
-   <span data-ttu-id="a51cc-110">盡可能搭配 SQL Server 使用快速磁碟子系統。</span><span class="sxs-lookup"><span data-stu-id="a51cc-110">Whenever possible, use a fast disk subsystem with SQL Server.</span></span> <span data-ttu-id="a51cc-111">使用 10 別的獨立磁碟備援陣列 (RAID10 0 + 1) 或存放區域網路 (SAN) 具有備份電源供應器。</span><span class="sxs-lookup"><span data-stu-id="a51cc-111">Use a redundant array of independent disks type 10 (RAID10/0+1) or a storage area network (SAN) with backup power supply.</span></span>  
  
-   <span data-ttu-id="a51cc-112">隔離從 BizTalk 追蹤資料庫 (BizTalkDTADb) 不同的伺服器上每個 MessageBox 資料庫。</span><span class="sxs-lookup"><span data-stu-id="a51cc-112">Isolate each MessageBox database on a separate server from the BizTalk Tracking database (BizTalkDTADb).</span></span> <span data-ttu-id="a51cc-113">較小的部署 CPU 資源時，可能不足以隔離在不同的實體磁碟從 BizTalk 追蹤資料庫上的 MessageBox 資料庫。</span><span class="sxs-lookup"><span data-stu-id="a51cc-113">For smaller deployments if CPU resources are available, it might be sufficient to isolate the MessageBox database on a separate physical disk from the BizTalk Tracking database.</span></span>  
  
-   <span data-ttu-id="a51cc-114">主要 MessageBox 資料庫可能是由於 CPU 處理器飽和或因磁碟作業 （平均磁碟佇列長度） 延遲瓶頸。</span><span class="sxs-lookup"><span data-stu-id="a51cc-114">The primary MessageBox database could be the bottleneck due to CPU processor saturation or latency from disk operations (average disk queue length).</span></span> <span data-ttu-id="a51cc-115">如果 CPU 處理是瓶頸，CPU 處理器加入主要 MessageBox。</span><span class="sxs-lookup"><span data-stu-id="a51cc-115">If CPU processing is the bottleneck, add CPU processors to the primary MessageBox.</span></span> <span data-ttu-id="a51cc-116">否則，請嘗試停用主要 MessageBox 資料庫的發行。</span><span class="sxs-lookup"><span data-stu-id="a51cc-116">If not, try to disable publishing on the master MessageBox database.</span></span> <span data-ttu-id="a51cc-117">如此一來，主要 MessageBox 資料庫會更有效率地處理傳遞至其他 MessageBox 資料庫的訊息。</span><span class="sxs-lookup"><span data-stu-id="a51cc-117">This way the master MessageBox database can more efficiently handle routing of messages to the other MessageBox databases.</span></span> <span data-ttu-id="a51cc-118">若要停用發行選項無效，當您使用多個 MessageBox 資料庫。</span><span class="sxs-lookup"><span data-stu-id="a51cc-118">The option to disable publishing is valid when you are using multiple MessageBox databases.</span></span>  
  
-   <span data-ttu-id="a51cc-119">如果磁碟作業是瓶頸，請將 「 BizTalk 追蹤資料庫移至專用的 SQL Server 電腦和 （或） 專用的磁碟。</span><span class="sxs-lookup"><span data-stu-id="a51cc-119">If disk operations are the bottleneck, move the BizTalk Tracking database to a dedicated SQL Server computer and/or dedicated disk.</span></span> <span data-ttu-id="a51cc-120">如果主要 MessageBox 資料庫上的 CPU 處理和磁碟作業都不是瓶頸，您可以在相同的 SQL Server 電腦，以善用現有硬體上建立新的 MessageBox 資料庫。</span><span class="sxs-lookup"><span data-stu-id="a51cc-120">If CPU processing and disk operations on the primary MessageBox database are not the bottleneck, you can create new MessageBox databases on the same SQL Server computer to leverage your existing hardware.</span></span>  
  
-   <span data-ttu-id="a51cc-121">請依照下列中的建議事項[Databases2 最佳化檔案群組](../technical-guides/optimizing-filegroups-for-the-databases2.md)隔離交易和資料記錄到個別的實體磁碟上的 MessageBox 和 「 BizTalk 追蹤資料庫的檔案。</span><span class="sxs-lookup"><span data-stu-id="a51cc-121">Follow recommendations in [Optimizing Filegroups for the Databases2](../technical-guides/optimizing-filegroups-for-the-databases2.md)to isolate the transaction and data log files for the MessageBox and BizTalk Tracking databases onto separate physical disks.</span></span>  
  
-   <span data-ttu-id="a51cc-122">資料和記錄檔配置足夠的儲存空間。</span><span class="sxs-lookup"><span data-stu-id="a51cc-122">Allocate sufficient storage space for the data and log files.</span></span> <span data-ttu-id="a51cc-123">否則 SQL Server 會自動使用所有可用空間的磁碟上存放的記錄檔。</span><span class="sxs-lookup"><span data-stu-id="a51cc-123">Otherwise SQL Server will automatically consume all of the available space on the disks where the log files are kept.</span></span> <span data-ttu-id="a51cc-124">記錄檔的初始大小取決於您的案例中的特定需求。</span><span class="sxs-lookup"><span data-stu-id="a51cc-124">The initial size of the log files depends on the specific requirements in your scenario.</span></span> <span data-ttu-id="a51cc-125">根據測試結果評估部署時的平均檔案大小，在實作解決方案之前擴充儲存空間。</span><span class="sxs-lookup"><span data-stu-id="a51cc-125">Estimate the average file size in your deployment based on testing results, and expand the storage space before implementing your solution.</span></span>  
  
-   <span data-ttu-id="a51cc-126">針對高磁碟使用的資料庫，例如 MessageBox、 健全狀況與活動追蹤 (HAT) 及商務活動監控 (BAM) 配置足夠的儲存空間。</span><span class="sxs-lookup"><span data-stu-id="a51cc-126">Allocate sufficient storage space for high-disk-use databases, such as the MessageBox, Health and Activity Tracking (HAT), and Business Activity Monitoring (BAM).</span></span> <span data-ttu-id="a51cc-127">如果您的解決方案使用 BizTalk Framework 傳訊通訊協定，請針對 BizTalk 組態資料庫 (BizTalkMgmtDb) 配置足夠的儲存空間。</span><span class="sxs-lookup"><span data-stu-id="a51cc-127">If your solution uses the BizTalk Framework messaging protocol, allocate sufficient storage space for the BizTalk Configuration database (BizTalkMgmtDb).</span></span>  
  
-   <span data-ttu-id="a51cc-128">根據商務需求時，例如資料保留期限，以及您的案例中處理的資料磁碟區設定的 「 DTA 封存和清除 「 SQL Server Agent 作業在 HAT 追蹤資料庫上，BizTalk 追蹤資料庫不會變得太大。</span><span class="sxs-lookup"><span data-stu-id="a51cc-128">Depending on business needs, such as data retention periods, and the volume of data processed in your scenario, configure the "DTA Archive and Purge" SQL Server Agent job on the HAT-Tracking database such that the BizTalk Tracking database does not grow too large.</span></span> <span data-ttu-id="a51cc-129">此資料庫的成長會降低效能，因為達到資料庫全部容量會加諸的限制資料插入作業的速率。</span><span class="sxs-lookup"><span data-stu-id="a51cc-129">The growth of this database can degrade performance because reaching the full capacity of the database imposes a limit on the rate of data insertion.</span></span> <span data-ttu-id="a51cc-130">當一個 BizTalk 追蹤資料庫支援多個 MessageBox 資料庫時，這是特別有用。</span><span class="sxs-lookup"><span data-stu-id="a51cc-130">This is especially true when one BizTalk Tracking database supports multiple MessageBox databases.</span></span>  
  
-   <span data-ttu-id="a51cc-131">如果是瓶頸，裝載 MessageBox 和 「 BizTalk 追蹤資料庫的伺服器向上延展。</span><span class="sxs-lookup"><span data-stu-id="a51cc-131">Scale up the servers hosting the MessageBox and BizTalk Tracking databases if they are the bottleneck.</span></span> <span data-ttu-id="a51cc-132">您可以加入 Cpu、 增加記憶體，升級至更快速的 Cpu，並使用高速專用的磁碟擴充的硬體。</span><span class="sxs-lookup"><span data-stu-id="a51cc-132">You can scale up the hardware by adding CPUs, adding memory, upgrading to faster CPUs, and using high-speed dedicated disks.</span></span>  
  
-   <span data-ttu-id="a51cc-133">將 TempDB 檔案分割到多個檔案，可能可以解決與 I/O 作業相關的效能問題。</span><span class="sxs-lookup"><span data-stu-id="a51cc-133">Splitting the TempDB files across multiple files may resolve performance issues related to I/O operations.</span></span> <span data-ttu-id="a51cc-134">一般來說，建立一個檔案資料檔，每個處理器，並建立的所有檔案使用相同的大小。</span><span class="sxs-lookup"><span data-stu-id="a51cc-134">As a general guideline, create one file data file per processor and use the same size for all files created.</span></span>  
  
-   <span data-ttu-id="a51cc-135">變更資料庫自動成長設定，例如 100-150 MB 的固定值。</span><span class="sxs-lookup"><span data-stu-id="a51cc-135">Change the database auto-grow settings to a fixed value such as 100-150MB.</span></span> <span data-ttu-id="a51cc-136">根據預設資料庫的成長設定為 10%，這會導致延遲增大較大的資料庫時。</span><span class="sxs-lookup"><span data-stu-id="a51cc-136">By default the database growth is configured to 10%, which can lead to delays when growing larger databases.</span></span>  
  
-   <span data-ttu-id="a51cc-137">SQL Server 記憶體應設為固定值的最小伺服器記憶體和最大伺服器記憶體設為相同的值。</span><span class="sxs-lookup"><span data-stu-id="a51cc-137">SQL Server memory should be set to a fixed value by setting both Min Server Memory and Max Server Memory to the same value.</span></span> <span data-ttu-id="a51cc-138">一般情況下，配置的實體記憶體的 75%到 SQL Server，並將其餘部分的作業系統和任何應用程式的 25%。</span><span class="sxs-lookup"><span data-stu-id="a51cc-138">In general, allocate 75% of physical memory to SQL Server and leave 25% for the rest of the operating system and any applications.</span></span> <span data-ttu-id="a51cc-139">如果這是專用的 SQL Server，您可以減少保留供作業系統在最小值的 1 GB。</span><span class="sxs-lookup"><span data-stu-id="a51cc-139">If this is a dedicated SQL Server, you can decrease the amount reserved for the operating system to a minimum of 1GB.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a51cc-140">另請參閱</span><span class="sxs-lookup"><span data-stu-id="a51cc-140">See Also</span></span>  
 [<span data-ttu-id="a51cc-141">尋找並排除瓶頸</span><span class="sxs-lookup"><span data-stu-id="a51cc-141">Finding and Eliminating Bottlenecks</span></span>](../technical-guides/finding-and-eliminating-bottlenecks.md)