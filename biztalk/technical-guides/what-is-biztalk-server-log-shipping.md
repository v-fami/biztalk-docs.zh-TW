---
title: 什麼是 BizTalk Server 記錄傳送？ | Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 79a2088a-ff36-4590-97c9-51d5bb245486
caps.latest.revision: 2
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 7735617b0d70aa3c693b1808b07d7670e6137f15
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "36999335"
---
# <a name="what-is-biztalk-server-log-shipping"></a><span data-ttu-id="8d5a0-103">什麼是 BizTalk Server 記錄傳送？</span><span class="sxs-lookup"><span data-stu-id="8d5a0-103">What Is BizTalk Server Log Shipping?</span></span>
<span data-ttu-id="8d5a0-104">BizTalk Server 嚴重損壞修復程序是以 BizTalk 記錄傳送。</span><span class="sxs-lookup"><span data-stu-id="8d5a0-104">BizTalk Server disaster recovery procedures are built around BizTalk log shipping.</span></span> <span data-ttu-id="8d5a0-105">BizTalk 記錄傳送發生災害時的資料庫還原藉由簡化了持續到災害復原站台資料庫中套用交易記錄檔更新。</span><span class="sxs-lookup"><span data-stu-id="8d5a0-105">BizTalk log shipping simplifies database restoration in the event of a disaster by continuously applying transaction log updates to the disaster recovery site databases.</span></span>  
  
 <span data-ttu-id="8d5a0-106">雖然記錄傳送根據類似的原則，做為 BizTalk[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]記錄傳送，[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]不支援記錄傳送[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]備份資料庫做為備份 BizTalk Server SQL Agent 作業的一部分。</span><span class="sxs-lookup"><span data-stu-id="8d5a0-106">While BizTalk log shipping is based on similar principles as [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] log shipping, [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] log shipping is not supported for the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases backed up as part of the Backup BizTalk Server SQL Agent Job.</span></span>  
  
## <a name="how-does-biztalk-log-shipping-work"></a><span data-ttu-id="8d5a0-107">BizTalk 記錄傳送工作如何？</span><span class="sxs-lookup"><span data-stu-id="8d5a0-107">How Does BizTalk Log Shipping Work?</span></span>  
 <span data-ttu-id="8d5a0-108">BizTalk 記錄傳送功能，以類似方式[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]記錄傳送。</span><span class="sxs-lookup"><span data-stu-id="8d5a0-108">BizTalk log shipping functions in a manner similar to [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] log shipping.</span></span> <span data-ttu-id="8d5a0-109">生產[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]群組設定為備份[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]UNC 位置的資料庫。</span><span class="sxs-lookup"><span data-stu-id="8d5a0-109">The production [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] group is configured to back up the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases to a UNC location.</span></span> <span data-ttu-id="8d5a0-110">根據預設，每隔一小時的完整備份和記錄備份每隔 15 分鐘，會執行備份的 BizTalk SQL Agent 作業。</span><span class="sxs-lookup"><span data-stu-id="8d5a0-110">By default, the Backup BizTalk SQL Agent job performs a full backup every hour and a log backup every 15 minutes.</span></span> <span data-ttu-id="8d5a0-111">「 備份 BizTalk Server 」 工作會實作邏輯，以自動啟動的完整備份，如果偵測到備份失敗。</span><span class="sxs-lookup"><span data-stu-id="8d5a0-111">The Backup BizTalk Server job implements logic to automatically start a full backup if a backup failure is detected.</span></span>  
  
 <span data-ttu-id="8d5a0-112">當損毀修復[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]執行個體已針對 BizTalk 記錄傳送備份 BizTalk Server SQL 代理程式作業會在災害復原站台每隔 15 分鐘預設還原所建立的備份檔案。</span><span class="sxs-lookup"><span data-stu-id="8d5a0-112">When the disaster recovery [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] instances are configured for BizTalk log shipping, the backup files created by the Backup BizTalk Server SQL Agent job are restored at the disaster recovery site every 15 minutes by default.</span></span> <span data-ttu-id="8d5a0-113">備份檔案會透過網路複製 SQL 還原命令。</span><span class="sxs-lookup"><span data-stu-id="8d5a0-113">The backup files are copied over the network by a SQL RESTORE command.</span></span> <span data-ttu-id="8d5a0-114">只有在下列情況下，會複製完整備份的檔案：</span><span class="sxs-lookup"><span data-stu-id="8d5a0-114">Full backup files are copied only in the following situations:</span></span>  
  
- <span data-ttu-id="8d5a0-115">第一次設定時 BizTalk 記錄傳送</span><span class="sxs-lookup"><span data-stu-id="8d5a0-115">When BizTalk log shipping is first configured</span></span>  
  
- <span data-ttu-id="8d5a0-116">當新的資料庫新增至 「 備份 BizTalk Server 」 工作。</span><span class="sxs-lookup"><span data-stu-id="8d5a0-116">When a new database is added to the Backup BizTalk Server job.</span></span>  
  
- <span data-ttu-id="8d5a0-117">還原失敗發生在災害復原站台</span><span class="sxs-lookup"><span data-stu-id="8d5a0-117">When a RESTORE failure occurs at the disaster recovery site</span></span>  
  
  <span data-ttu-id="8d5a0-118">每個[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]在災害復原站台的執行個體一部分 BizTalk 記錄傳送還原資料庫裝載在實際執行上個別設定[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]資料庫執行個體。</span><span class="sxs-lookup"><span data-stu-id="8d5a0-118">Each [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] instance at the disaster recovery site is configured individually as part of BizTalk log shipping to restore databases hosted on a production [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] database instance.</span></span> <span data-ttu-id="8d5a0-119">當[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]執行個體設定 BizTalk server 記錄傳送和**BTS 記錄傳送還原資料庫**啟用作業時， **BTS 記錄傳送還原資料庫**作業將會連接到在生產環境的 BizTalk 管理資料庫[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]群組。</span><span class="sxs-lookup"><span data-stu-id="8d5a0-119">When a [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] instance is configured for BizTalk Server log shipping and the **BTS Log Shipping Restore Databases** job is enabled, the **BTS Log Shipping Restore Databases** job will connect to the BizTalk Management database on the production [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] group.</span></span>  
  
  <span data-ttu-id="8d5a0-120">如上方所述，當第一次設定目的地伺服器的完整資料庫備份還原到目的地伺服器。</span><span class="sxs-lookup"><span data-stu-id="8d5a0-120">As described above, when the destination server is first configured the full database backup is restored to the destination server.</span></span> <span data-ttu-id="8d5a0-121">大部分的時間還原的記錄檔時**BTS 記錄傳送還原資料庫**作業執行。</span><span class="sxs-lookup"><span data-stu-id="8d5a0-121">Most of the time only the logs are restored when the **BTS Log Shipping Restore Databases** job runs.</span></span>  
  
  <span data-ttu-id="8d5a0-122">檢視的災害復原時[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]執行個體與[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]Management Studio 中，資料庫將會顯示在 「 載入 」 的狀態。</span><span class="sxs-lookup"><span data-stu-id="8d5a0-122">When viewing the disaster recovery [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] instances with [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] Management Studio, the databases will be displayed in a “Loading” state.</span></span> <span data-ttu-id="8d5a0-123">這是因為永遠不會自動還原備份組中的最後一個記錄檔。</span><span class="sxs-lookup"><span data-stu-id="8d5a0-123">This is because the last log in a backup set is never restored automatically.</span></span> <span data-ttu-id="8d5a0-124">一旦新的記錄檔可供使用，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]記錄傳送還原至最後一個記錄檔的下一步。</span><span class="sxs-lookup"><span data-stu-id="8d5a0-124">Once a new log is available, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] log shipping restores the next to last log.</span></span> <span data-ttu-id="8d5a0-125">當在災害復原事件發生和災害復原站台必須上線、 使用 STOPATMARK 命令可將資料庫復原還原最後一個記錄檔和資料庫將不再顯示為處於 「 正在載入 」 狀態。</span><span class="sxs-lookup"><span data-stu-id="8d5a0-125">When a disaster recovery event occurs and the disaster recovery site must be brought online, the last log is restored using the STOPATMARK command to recover the databases and the databases will no longer be displayed as being in a “Loading” state.</span></span>