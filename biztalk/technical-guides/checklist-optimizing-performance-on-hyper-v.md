---
title: 檢查清單： HYPER-V 上最佳化效能 |Microsoft 文件
ms.custom: ''
ms.date: 06/29/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 942a61eb-0fdd-4c8b-b0ad-d32951f0f631
caps.latest.revision: 23
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: db0afbdc9d89296f8aaff94db057bf2e9c072392
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/01/2017
ms.locfileid: "26010343"
---
# <a name="checklist-optimizing-performance-on-hyper-v"></a><span data-ttu-id="2e3ff-102">檢查清單： HYPER-V 上最佳化效能</span><span class="sxs-lookup"><span data-stu-id="2e3ff-102">Checklist: Optimizing Performance on Hyper-V</span></span>
<span data-ttu-id="2e3ff-103">執行 BizTalk Server 時，適用下列考量和/或[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]HYPER-V 虛擬機器有 BizTalk Server 資料庫的執行個體。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-103">The following considerations apply when running BizTalk Server and/or the [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] instance(s) that have the BizTalk Server databases on Hyper-V virtual machines.</span></span>  
  
## <a name="allocate-110125-of-cpu-and-disk-resources-to-the-hyper-v-virtual-machines"></a><span data-ttu-id="2e3ff-104">110%-125%的 CPU 和磁碟資源配置到 HYPER-V 虛擬機器</span><span class="sxs-lookup"><span data-stu-id="2e3ff-104">Allocate 110%–125% of CPU and Disk Resources to the Hyper-V Virtual Machines</span></span>  
 <span data-ttu-id="2e3ff-105">計劃配置 110%到 125%的 CPU 資源和 105%-110%的方案用的 HYPER-V 虛擬機器的實體硬體解決方案所需的磁碟資源。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-105">Plan to allocate 110% to 125% of the CPU resources and 105% - 110% of the disk resources required by a physical hardware solution to the Hyper-V virtual machines used for the solution.</span></span> <span data-ttu-id="2e3ff-106">藉由設定 HYPER-V 虛擬機器與其他資源，您要確定它可以提供與實體硬體同等的效能，同時配合任何 HYPER-V 虛擬化技術所需的額外負荷。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-106">By configuring the Hyper-V virtual machine with additional resources, you will ensure that it can provide performance on par with physical hardware while accommodating any overhead required by Hyper-V virtualization technology.</span></span>  
  
|<span data-ttu-id="2e3ff-107">步驟</span><span class="sxs-lookup"><span data-stu-id="2e3ff-107">Step</span></span>|<span data-ttu-id="2e3ff-108">參考</span><span class="sxs-lookup"><span data-stu-id="2e3ff-108">Reference</span></span>|  
|----------|---------------|  
|<span data-ttu-id="2e3ff-109">範圍的硬體需求[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]方案。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-109">Scope the hardware requirements for the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] solution.</span></span>|<span data-ttu-id="2e3ff-110">-請遵循 < 規劃環境的 BizTalk Server > 一節中的指引[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]操作指南 》，網址[http://go.microsoft.com/fwlink/?LinkId=122399](http://go.microsoft.com/fwlink/?LinkId=122399)範圍解決方案的硬體需求。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-110">-   Follow the guidance in the “Planning the Environment for BizTalk Server” section of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Operations Guide at [http://go.microsoft.com/fwlink/?LinkId=122399](http://go.microsoft.com/fwlink/?LinkId=122399) to scope the hardware requirements for the solution.</span></span><br /><span data-ttu-id="2e3ff-111">對範圍版並將此方案所需的 BizTalk 伺服器數目檢閱的規劃考量記載於 「 規劃 BizTalk Server 層 」 的 BizTalk Server [http://go.microsoft.com/fwlink/?LinkId=122401](http://go.microsoft.com/fwlink/?LinkId=122401)。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-111">-   To scope the edition and number of BizTalk Servers that will be required by the solution review BizTalk Server planning considerations documented in “Planning the BizTalk Server Tier” at [http://go.microsoft.com/fwlink/?LinkId=122401](http://go.microsoft.com/fwlink/?LinkId=122401).</span></span><br /><span data-ttu-id="2e3ff-112">-若要界定範圍的版本和數目[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]將此方案中，所需的電腦在檢閱的規劃考量記載於 「 規劃資料庫層 」 的資料庫[http://go.microsoft.com/fwlink/?LinkId = 122402](http://go.microsoft.com/fwlink/?LinkId=122402)以及 「 效能額外負荷的執行 SQL Server 中 HYPER-V 」 的章節，可在 「 執行 SQL Server 2008 in a HYPER-V 環境最佳作法和效能考量 > 技術白皮書[http://go.microsoft.com/fwlink/ 嗎？LinkId = 144622](http://go.microsoft.com/fwlink/?LinkId=144622)。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-112">-   To scope the version and number of [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] computers that will be required by the solution, review database planning considerations documented in “Planning the Database Tier” at [http://go.microsoft.com/fwlink/?LinkId=122402](http://go.microsoft.com/fwlink/?LinkId=122402) and the “Performance Overhead of Running SQL Server in Hyper-V” section of the “Running SQL Server 2008 in a Hyper-V Environment Best Practices and Performance Considerations” whitepaper available at [http://go.microsoft.com/fwlink/?LinkId=144622](http://go.microsoft.com/fwlink/?LinkId=144622).</span></span><br /><span data-ttu-id="2e3ff-113">-若要完成規劃開發、 測試、 預備及生產環境檢閱 「 規劃開發、 測試、 預備及實際執行環境 」 在[http://go.microsoft.com/fwlink/?LinkId=122403](http://go.microsoft.com/fwlink/?LinkId=122403)。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-113">-   To complete planning for development, testing, staging, and production environments review “Planning the Development, Testing, Staging, and Production Environments” at [http://go.microsoft.com/fwlink/?LinkId=122403](http://go.microsoft.com/fwlink/?LinkId=122403).</span></span>|  
|<span data-ttu-id="2e3ff-114">之後設定 BizTalk Server 解決方案的硬體需求的範圍，計劃設定的 HYPER-V 機器**110%-125%** 的 CPU 和磁碟資源的話。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-114">After scoping the hardware requirements of your BizTalk Server solution, plan to configure the Hyper-V machines with **110% – 125%** of the CPU and disk resources if possible.</span></span>|<span data-ttu-id="2e3ff-115">比方說，如果解決方案使用的實體 BizTalk Server 電腦的硬體需求會決定為 2 GB RAM，雙核心 CPU 執行 2 GHZ，以及將 2 x 500 GB 的實體磁碟，則在理想情況下，解決方案使用的 HYPER-V 虛擬機器會使用 2 個或更多虛擬處理器的執行設定 > = 2.2 GHZ，以及更快的實體磁碟 （通常是藉由增加主軸或使用較快速的磁碟）。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-115">For example, if the hardware requirements for a physical BizTalk Server computer used by the solution is determined to be 2GB RAM, a dual core CPU running at 2GHZ, and 2x 500 GB physical disks, then ideally, the Hyper-V virtual machine used by the solution would be configured with 2 or more virtual processors running >= 2.2 GHZ, and faster physical disks (typically by adding spindles or using faster disks).</span></span>|  
  
## <a name="optimize-hyper-v-performance"></a><span data-ttu-id="2e3ff-116">使用 HYPER-V 的效能最佳化</span><span class="sxs-lookup"><span data-stu-id="2e3ff-116">Optimize Hyper-V Performance</span></span>  
 <span data-ttu-id="2e3ff-117">使用下列指導方針來設定 HYPER-V 以獲得最佳效能。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-117">Use the following general guidelines to configure Hyper-V for optimal performance.</span></span>  
  
|<span data-ttu-id="2e3ff-118">步驟</span><span class="sxs-lookup"><span data-stu-id="2e3ff-118">Step</span></span>|<span data-ttu-id="2e3ff-119">參考</span><span class="sxs-lookup"><span data-stu-id="2e3ff-119">Reference</span></span>|  
|----------|---------------|  
|<span data-ttu-id="2e3ff-120">適用於效能調整的虛擬化伺服器建議的指引。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-120">Apply recommended guidance for performance tuning virtualization servers.</span></span> <span data-ttu-id="2e3ff-121">**注意：** 的測試案例所述[測試 BizTalk 伺服器虛擬化效能](~/technical-guides/testing-biztalk-server-virtualization-performance.md)，已套用的組態選項所述 」 實體基礎結構細節"和"虛擬化的詳細資料 」 區段[測試案例概觀](~/technical-guides/test-scenario-overview.md)主題。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-121">**Note:**  For the test scenarios described in [Testing BizTalk Server Virtualization Performance](~/technical-guides/testing-biztalk-server-virtualization-performance.md), the configuration options that were applied are described in the “Physical Infrastructure Specifics” and the “Virtualization Specifics” sections of the [Test Scenario Overview](~/technical-guides/test-scenario-overview.md) topic.</span></span>|<span data-ttu-id="2e3ff-122">「 效能調整指導方針的 Windows Server 2008 R2"文件可在 「 虛擬化伺服器的效能微調 」 區段[http://go.microsoft.com/fwlink/?LinkID=202087](http://go.microsoft.com/fwlink/?LinkID=202087)。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-122">“Performance Tuning for Virtualization Servers” section of the “Performance Tuning Guidelines for Windows Server 2008 R2” document available at [http://go.microsoft.com/fwlink/?LinkID=202087](http://go.microsoft.com/fwlink/?LinkID=202087).</span></span>|  
|<span data-ttu-id="2e3ff-123">關閉不會使用任何虛擬機器連線視窗。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-123">Close any Virtual Machine Connection windows that aren’t being used.</span></span>|<span data-ttu-id="2e3ff-124">按兩下 HYPER-V 管理員中的虛擬機器名稱時顯示的虛擬機器連線視窗耗用無法否則過低的資源。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-124">The Virtual Machine Connection window(s) displayed when double-clicking a virtual machine name in the Hyper-V manager consume resources that could be otherwise utilized.</span></span>|  
|<span data-ttu-id="2e3ff-125">最小化 HYPER-V 管理員或關閉。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-125">Close or minimize the Hyper-V manager.</span></span>|<span data-ttu-id="2e3ff-126">HYPER-V 管理員會藉由持續輪詢每個執行中虛擬機器的 CPU 使用率和執行時間消耗資源。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-126">The Hyper-V manager consumes resources by continually polling each running virtual machine for CPU utilization and uptime.</span></span> <span data-ttu-id="2e3ff-127">關閉或最小化 HYPER-V 管理員可釋放這些資源。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-127">Closing or minimizing the Hyper-V manager will free up these resources.</span></span>|  
  
## <a name="optimize-performance-of-disk-memory-network-and-processor-in-a-hyper-v-environment"></a><span data-ttu-id="2e3ff-128">最佳化效能的磁碟、 記憶體、 網路及 HYPER-V 環境中的處理器</span><span class="sxs-lookup"><span data-stu-id="2e3ff-128">Optimize Performance of Disk, Memory, Network, and Processor in a Hyper-V Environment</span></span>  
 <span data-ttu-id="2e3ff-129">使用下列指導方針來最佳化效能的磁碟、 記憶體、 網路及 HYPER-V 的虛擬環境中的處理器。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-129">Use the following guidelines to optimize performance of disk, memory, network, and processor in a Hyper-V virtual environment.</span></span>  
  
### <a name="optimize-processor-performance"></a><span data-ttu-id="2e3ff-130">處理器效能最佳化</span><span class="sxs-lookup"><span data-stu-id="2e3ff-130">Optimize Processor Performance</span></span>  
 <span data-ttu-id="2e3ff-131">請遵循下列指導方針來最佳化的 HYPER-V 虛擬環境中執行的客體作業系統的處理器效能：</span><span class="sxs-lookup"><span data-stu-id="2e3ff-131">Follow these guidelines to optimize processor performance of guest operating systems running in a Hyper-V virtual environment:</span></span>  
  
-   <span data-ttu-id="2e3ff-132">**設定 1 到 1 的配置虛擬處理器給可用的邏輯處理器，為了達到最佳效能-** 的最佳組態時執行 CPU 密集的應用程式，是 1-1 至客體作業系統中的虛擬處理器的比例主機作業系統可使用的邏輯處理器。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-132">**Configure a 1-to-1 allocation of virtual processors to available logical processors for best performance -** When running a CPU intensive application, the best configuration is a 1-to-1 ratio of virtual processors in the guest operating system(s) to the logical processors available to the host operating system.</span></span> <span data-ttu-id="2e3ff-133">任何其他設定 2:1 或 1:2 例如沒有效率。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-133">Any other configuration such as 2:1 or 1:2 is less efficient.</span></span> <span data-ttu-id="2e3ff-134">下圖說明在客體作業系統，到主機作業系統可使用的邏輯處理器的虛擬處理器核心的 1-1 配置：</span><span class="sxs-lookup"><span data-stu-id="2e3ff-134">The following graphic illustrates a 1-to-1 allocation of virtual processor cores in the guest operating system(s) to logical processors available to the host operating system:</span></span>  
  
     <span data-ttu-id="2e3ff-135">![一對一實體與虛擬處理器比率](../technical-guides/media/90f98f0d-a223-404c-b419-81369dc92970.gif "一對一實體與虛擬處理器比率")</span><span class="sxs-lookup"><span data-stu-id="2e3ff-135">![One to One Physical to Virtual Processor Ratio](../technical-guides/media/90f98f0d-a223-404c-b419-81369dc92970.gif "One to One Physical to Virtual Processor Ratio")</span></span>  
<span data-ttu-id="2e3ff-136">虛擬與邏輯處理器比例</span><span class="sxs-lookup"><span data-stu-id="2e3ff-136">Virtual to logical processor ratio</span></span>  
  
-   <span data-ttu-id="2e3ff-137">**請注意，不同的客體作業系統的虛擬處理器限制，並據此-規劃**HYPER-V 虛擬機器中執行的客體作業系統可用的處理器核心的數目可能會影響整體裝載的應用程式的效能。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-137">**Be aware of the virtual processor limit for different guest operating systems and plan accordingly -** The number of processor cores that are available to the guest operating system running in a Hyper-V virtual machine can impact the overall performance of the hosted application.</span></span> <span data-ttu-id="2e3ff-138">因此，應考慮將裝載 BizTalk Server 在 HYPER-V 虛擬機器上安裝對於哪些客體作業系統和/或[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]裝載 BizTalk Server 資料庫的執行個體。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-138">Therefore, consideration should be made as to which guest operating system will be installed on the Hyper-V virtual machine to host the BizTalk Server and/or [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] instance(s) that host the BizTalk Server databases.</span></span> <span data-ttu-id="2e3ff-139">HYPER-V 可容納下列指定的客體作業系統的虛擬處理器的數目：</span><span class="sxs-lookup"><span data-stu-id="2e3ff-139">Hyper-V accommodates the following number of virtual processors for the specified guest operating system:</span></span>  
  
|<span data-ttu-id="2e3ff-140">作業系統</span><span class="sxs-lookup"><span data-stu-id="2e3ff-140">Operating system</span></span>|<span data-ttu-id="2e3ff-141">虛擬處理器限制</span><span class="sxs-lookup"><span data-stu-id="2e3ff-141">Virtual processor limit</span></span>|  
|----------------------|-----------------------------|  
|[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]<span data-ttu-id="2e3ff-142">。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-142">.</span></span> <span data-ttu-id="2e3ff-143">所有版本的[!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)]僅有 64 位元。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-143">All editions of [!INCLUDE[btsWinSvr2k8R2](../includes/btswinsvr2k8r2-md.md)] are 64-bit only.</span></span>|<span data-ttu-id="2e3ff-144">4</span><span class="sxs-lookup"><span data-stu-id="2e3ff-144">4</span></span>|  
|[!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)]<span data-ttu-id="2e3ff-145">64 位元</span><span class="sxs-lookup"><span data-stu-id="2e3ff-145"> 64-bit</span></span>|<span data-ttu-id="2e3ff-146">4</span><span class="sxs-lookup"><span data-stu-id="2e3ff-146">4</span></span>|  
|[!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)]<span data-ttu-id="2e3ff-147">32 位元</span><span class="sxs-lookup"><span data-stu-id="2e3ff-147"> 32-bit</span></span>|<span data-ttu-id="2e3ff-148">4</span><span class="sxs-lookup"><span data-stu-id="2e3ff-148">4</span></span>|  
|<span data-ttu-id="2e3ff-149">Windows 7 64 位元</span><span class="sxs-lookup"><span data-stu-id="2e3ff-149">Windows 7 64-bit</span></span>|<span data-ttu-id="2e3ff-150">4</span><span class="sxs-lookup"><span data-stu-id="2e3ff-150">4</span></span>|  
|<span data-ttu-id="2e3ff-151">Windows 7 32 位元</span><span class="sxs-lookup"><span data-stu-id="2e3ff-151">Windows 7 32-bit</span></span>|<span data-ttu-id="2e3ff-152">4</span><span class="sxs-lookup"><span data-stu-id="2e3ff-152">4</span></span>|  
|<span data-ttu-id="2e3ff-153">Windows Vista 64 位元</span><span class="sxs-lookup"><span data-stu-id="2e3ff-153">Windows Vista 64-bit</span></span>|<span data-ttu-id="2e3ff-154">2</span><span class="sxs-lookup"><span data-stu-id="2e3ff-154">2</span></span>|  
|<span data-ttu-id="2e3ff-155">Windows Vista 32 位元</span><span class="sxs-lookup"><span data-stu-id="2e3ff-155">Windows Vista  32-bit</span></span>|<span data-ttu-id="2e3ff-156">2</span><span class="sxs-lookup"><span data-stu-id="2e3ff-156">2</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="2e3ff-157">如需 HYPER-V 上支援的客體作業系統的詳細資訊，請參閱[http://go.microsoft.com/fwlink/?LinkID=118347](http://go.microsoft.com/fwlink/?LinkID=118347)。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-157">For more information about the guest operating systems that are supported on Hyper-V, see [http://go.microsoft.com/fwlink/?LinkID=118347](http://go.microsoft.com/fwlink/?LinkID=118347).</span></span>  
  
### <a name="optimize-disk-performance"></a><span data-ttu-id="2e3ff-158">最佳化磁碟效能</span><span class="sxs-lookup"><span data-stu-id="2e3ff-158">Optimize Disk Performance</span></span>  
 <span data-ttu-id="2e3ff-159">請遵循下列指導方針來最佳化磁碟效能的 HYPER-V 虛擬環境中執行的客體作業系統：</span><span class="sxs-lookup"><span data-stu-id="2e3ff-159">Follow these guidelines to optimize disk performance of guest operating systems running in a Hyper-V virtual environment:</span></span>  
  
|<span data-ttu-id="2e3ff-160">步驟</span><span class="sxs-lookup"><span data-stu-id="2e3ff-160">Step</span></span>|<span data-ttu-id="2e3ff-161">參考</span><span class="sxs-lookup"><span data-stu-id="2e3ff-161">Reference</span></span>|  
|----------|---------------|  
|<span data-ttu-id="2e3ff-162">使用的虛擬磁碟包含 HYPER-V 虛擬機器設定使用固定大小的虛擬硬碟 (VHD) 選項。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-162">Configure virtual disks for use with the Hyper-V virtual machines using the fixed-size virtual hard disk (VHD) option.</span></span> <span data-ttu-id="2e3ff-163">固定大小的 VHD 提供的實體磁碟的功能，例如叢集支援，以及快照集磁碟支援彈性以及效能。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-163">Fixed-size VHD offers performance approaching that of physical disks together with the flexibility of features such as clustering support and snapshot disk support.</span></span>|<span data-ttu-id="2e3ff-164">在 HYPER-V 環境中的磁碟儲存體是透過虛擬 IDE 控制器或虛擬 SCSI 控制器。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-164">Disk storage in a Hyper-V environment is accessible through a virtual IDE controller or a virtual SCSI controller.</span></span> <span data-ttu-id="2e3ff-165">不同於舊版的 Microsoft 虛擬化技術，沒有任何存取虛擬硬碟時，使用虛擬 IDE 控制器或虛擬 SCSI 控制站之間的效能差異。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-165">Unlike previous versions of Microsoft virtualization technology, there is no performance difference between using a virtual IDE controller or a virtual SCSI controller when accessing virtual hard disks.</span></span> <span data-ttu-id="2e3ff-166">在 HYPER-V 環境中使用有下列的磁碟儲存體選項：</span><span class="sxs-lookup"><span data-stu-id="2e3ff-166">The following disk storage options are available for use in a Hyper-V environment:</span></span><br /><br /> <span data-ttu-id="2e3ff-167">-   **固定大小磁碟-** 大小固定虛擬硬碟 (VHD) 是其中一個資料區塊是根據在建立時定義的最大磁碟大小的實體磁碟上預先配置。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-167">-   **Fixed size disks -** A fixed-size virtual hard disk (VHD) is one for which data blocks are pre-allocated on a physical disk based on the maximum disk size defined at the time of creation.</span></span> <span data-ttu-id="2e3ff-168">比方說，如果您建立一個 100 GB 的大小固定 VHD，HYPER-V 會配置所有 100 GB 的資料區塊儲存區，除了在建立新的 VHD 時，所需的 VHD 頁首和頁尾的額外負荷。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-168">For example, if you create a 100 GB fixed-size VHD, Hyper-V will allocate all 100 GB of data block storage in addition to the overhead required for the VHD headers and footers when it creates the new VHD.</span></span><br /><span data-ttu-id="2e3ff-169">-   **動態擴充磁碟-** 動態擴充的 VHD 是其中一個為其初始的虛擬硬碟包含任何資料區塊。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-169">-   **Dynamically expanding disks -** A dynamically expanding VHD is one for which the initial virtual hard disk contains no data blocks.</span></span> <span data-ttu-id="2e3ff-170">而是在資料寫入至 VHD，到建立 VHD 時所指定的大小上限，會以動態方式配置空間。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-170">Instead space is dynamically allocated as data is written to the VHD, up to the maximum size specified when the VHD was created.</span></span> <span data-ttu-id="2e3ff-171">例如，100 GB 的動態擴充磁碟一開始包含只有 VHD 標頭，且需要不超過 2 MB 的實體儲存體空間。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-171">For example, a 100-GB dynamically expanding disk initially contains only VHD headers and requires less than 2 MB of physical storage space.</span></span> <span data-ttu-id="2e3ff-172">新的資料寫入虛擬機器的動態擴充的 VHD 時，其他實體的資料區塊會配置 2 MB 增量的 VHD 檔案，最大值 100 gb。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-172">As new data is written by the virtual machine to the dynamically expanding VHD, additional physical data blocks are allocated in 2-MB increments to the VHD file, up to a maximum of 100 GB.</span></span><br /><span data-ttu-id="2e3ff-173">-   **差異磁碟-** 差異磁碟是一種特殊的動態擴充 「 父 」 VHD 相關聯的 VHD 檔案。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-173">-   **Differencing Disks -** A differencing disk is a special type of dynamically expanding VHD file that is associated with a “parent” VHD.</span></span> <span data-ttu-id="2e3ff-174">在這個父子式存放裝置拓撲中，父磁碟仍維持不變，「 子 」 差異磁碟只對所做的任何寫入作業。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-174">In this parent/child storage topology, the parent disk remains unchanged and any write operations made to the “child” differencing disk only.</span></span> <span data-ttu-id="2e3ff-175">任何讀取的作業會先檢查對差異磁碟，以查看更新的內容是否已寫入差異磁碟。如果內容不在差異磁碟，從父 VHD 讀取內容。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-175">Any read operations are first checked against the differencing disk to see whether updated content was written to the differencing disk; if the content isn’t in the differencing disk, then the content is read from the parent VHD.</span></span> <span data-ttu-id="2e3ff-176">差異磁碟可用於需要維護的特定基準設定，而且想要輕鬆地進行測試，然後再復原變更基準的案例。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-176">Differencing disks are useful for scenarios where you need to maintain a particular baseline configuration and would like to easily test and then rollback changes to the baseline.</span></span> <span data-ttu-id="2e3ff-177">適用於測試的父子式存放裝置拓撲，透過差異磁碟提供彈性時，這不是效能最適合的設定，所以與維護的父子式拓撲相關聯的額外負荷需要： 當使用差異磁碟。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-177">While the flexibility of the parent/child storage topology provided through differencing disks is useful for testing, this is not the optimal configuration for performance because there is overhead associated with maintaining the parent/child topology required when using differencing disks.</span></span><br /><span data-ttu-id="2e3ff-178">-   **傳遞磁碟 –** 穿通磁碟功能可讓客體作業系統，略過 HYPER-V 主機檔案系統，並直接存取磁碟。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-178">-   **Passthrough disks –** The passthrough disk feature allows the guest operating system to bypass the Hyper-V Host file system and access the disk directly.</span></span> <span data-ttu-id="2e3ff-179">磁碟可供傳遞透過客體作業系統必須設定為 「 離線 」 狀態中 HYPER-V 主機，以確保主機和客體作業系統執行不會嘗試同時存取磁碟。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-179">Disks that are made available to guest operating systems via passthrough must be set to “offline” in the Hyper-V host to ensure that both the host and guest operating system do not attempt to access the disk simultaneously.</span></span> <span data-ttu-id="2e3ff-180">傳遞磁碟的確有提供邊際效能的優勢其他磁碟儲存體選項，但不支援虛擬磁碟，例如虛擬機器的快照集和叢集支援的特定功能。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-180">The passthrough disk does offer a marginal performance advantage over other disk storage options but does not support certain functionality of virtual disks, such as Virtual machine snapshots and clustering support.</span></span> <span data-ttu-id="2e3ff-181">因此穿通磁碟功能不是建議使用 BizTalk 或 SQL Server 環境中因為邊際效能優點是多個遺漏的功能，位移。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-181">Therefore use of the passthrough disk feature is not recommended in a BizTalk or SQL Server environment because the marginal performance benefits are more than offset by the missing functionality.</span></span><br /><br /> <span data-ttu-id="2e3ff-182">多個磁碟儲存體選項，提供與 HYPER-V 的相對效能的詳細資訊，請參閱部落格文章: 「 HYPER-V 儲存體分析 」，網址[http://go.microsoft.com/fwlink/?LinkID=132848](http://go.microsoft.com/fwlink/?LinkID=132848)。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-182">For more information about the relative performance of disk storage choices provided with Hyper-V, see the blog entry “Hyper-V Storage Analysis”, at [http://go.microsoft.com/fwlink/?LinkID=132848](http://go.microsoft.com/fwlink/?LinkID=132848).</span></span>|  
|<span data-ttu-id="2e3ff-183">設定為使用 SCSI 控制站的資料磁碟區的磁碟</span><span class="sxs-lookup"><span data-stu-id="2e3ff-183">Configure disks for data volumes using the SCSI controller</span></span>|<span data-ttu-id="2e3ff-184">這被建議因為如果而不需要安裝 HYPER-V 整合服務是使用模擬的 IDE 控制器，已安裝 HYPER-V 整合服務，可以只安裝 SCSI 控制器。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-184">This is recommended because the SCSI controller can only be installed if Hyper-V integration services are installed whereas the emulated IDE controller is available without installing Hyper-V integration services.</span></span> <span data-ttu-id="2e3ff-185">使用 integration services 提供 IDE 篩選器驅動程式執行磁碟 I/O 是明顯優於磁碟 I/O 效能所提供的模擬的 IDE 控制器。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-185">Disk I/O performed using the IDE filter driver provided with integration services is significantly better than disk I/O performance provided with the emulated IDE controller.</span></span> <span data-ttu-id="2e3ff-186">因此，若要確保最佳的磁碟 I/O 效能中 HYPER-V 虛擬化環境中的資料檔案，在主機和客體作業系統上安裝 integration services 及設定資料磁碟區的磁碟與綜合 SCSI 控制器。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-186">Therefore, to ensure optimal disk I/O performance for the data files in a Hyper-V virtualized environment, install integration services on both the host and guest operating system and configure disks for data volumes with the synthetic SCSI controller.</span></span> <span data-ttu-id="2e3ff-187">對於跨越多個資料磁碟機的極大量的儲存體 I/O 工作負載，每個 VHD 應該附加到另一個更佳的整體效能的綜合 SCSI 控制器。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-187">For highly intensive storage I/O workloads that span multiple data drives, each VHD should be attached to a separate synthetic SCSI controller for better overall performance.</span></span> <span data-ttu-id="2e3ff-188">此外，每個 VHD 應該儲存在個別的實體磁碟上。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-188">In addition, each VHD should be stored on separate physical disks.</span></span> <span data-ttu-id="2e3ff-189">**重要事項：** 不將系統磁碟連接到 SCSI 控制器。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-189">**Important:**  Do not attach a system disk to a SCSI controller.</span></span> <span data-ttu-id="2e3ff-190">包含作業系統的虛擬硬碟必須連接到 IDE 控制器。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-190">A virtual hard disk that contains an operating system must be attached to an IDE controller.</span></span>|  
  
### <a name="optimize-memory-performance"></a><span data-ttu-id="2e3ff-191">記憶體效能最佳化</span><span class="sxs-lookup"><span data-stu-id="2e3ff-191">Optimize Memory Performance</span></span>  
 <span data-ttu-id="2e3ff-192">請遵循下列指導方針來最佳化記憶體的 HYPER-V 虛擬環境中執行的客體作業系統的效能：</span><span class="sxs-lookup"><span data-stu-id="2e3ff-192">Follow these guidelines to optimize memory performance of guest operating systems running in a Hyper-V virtual environment:</span></span>  
  
|<span data-ttu-id="2e3ff-193">步驟</span><span class="sxs-lookup"><span data-stu-id="2e3ff-193">Step</span></span>|<span data-ttu-id="2e3ff-194">參考</span><span class="sxs-lookup"><span data-stu-id="2e3ff-194">Reference</span></span>|  
|----------|---------------|  
|<span data-ttu-id="2e3ff-195">請確認有足夠的記憶體裝載 HYPER-V 虛擬機器的實體電腦上安裝</span><span class="sxs-lookup"><span data-stu-id="2e3ff-195">Ensure there is sufficient memory installed on the physical computer that hosts the Hyper-V virtual machines</span></span>|<span data-ttu-id="2e3ff-196">提供的實體記憶體，通常是最重要的效能因素，以便讓 BizTalk Server 為 HYPER-V 虛擬機器上執行。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-196">-   Available physical memory is often the most significant performance factor for BizTalk Server running on a Hyper-V virtual machine.</span></span> <span data-ttu-id="2e3ff-197">這是因為每個虛擬機器必須位在非-分頁集區記憶體或無法分頁至磁碟的記憶體。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-197">This is because each virtual machine must reside in non-paged-pool memory, or memory that cannot be paged to the disk.</span></span> <span data-ttu-id="2e3ff-198">因為非-分頁集區記憶體無法分頁至磁碟時，裝載虛擬機器的實體電腦應該有可用的實體記憶體的記憶體總和等於配置給每個虛擬機器以及下列所述：</span><span class="sxs-lookup"><span data-stu-id="2e3ff-198">Because non-paged-pool memory cannot be paged to disk, the physical computer that hosts the virtual machines should have available physical memory equal to the sum of the memory allocated for each virtual machine plus the following:</span></span><br />     <span data-ttu-id="2e3ff-199">300 MB 的 Hypervisor，加上 32 MB 的第一個 GB 的 RAM 配置給每個虛擬機器加上另一個 8 MB 的每個其他 GB 的 RAM 配置給每個虛擬機器加上主機的 512 MB在根磁碟分割上執行的作業系統</span><span class="sxs-lookup"><span data-stu-id="2e3ff-199">300 MB for the Hypervisor                         plus 32 MB for the first GB of RAM allocated to each virtual machine                         plus another 8 MB for every additional GB of RAM allocated to each virtual machine                         plus 512 MB for the host operating system running on the root partition</span></span><br />     <span data-ttu-id="2e3ff-200">例如，如果 HYPER-V 虛擬機器會配置 2 GB 的記憶體在 HYPER-V 管理員中，當執行這個 HYPER-V 虛擬機器可能會大約 2388 MB 時所使用的實際實體記憶體 (300 MB 的 hypervisor 的虛擬機器配置 + 2 GB +32 MB + 8 MB = 2388 MB)。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-200">For example, if a Hyper-V virtual machine is allocated 2 GB of memory in the Hyper-V Manager, the actual physical memory used when running that Hyper-V virtual machine would be approximately 2388MB (300MB for the hypervisor +2GB allocated for the virtual machine + 32MB + 8MB = 2388MB).</span></span> <span data-ttu-id="2e3ff-201">Hypervisor 只必須載入一次，因為初始設定後續的虛擬機器不會造成載入 hypervisor 與相關聯的 300 MB 額外負荷。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-201">Because the hypervisor only needs to be loaded once, initialization of subsequent virtual machines does not incur the 300 MB overhead associated with loading the hypervisor.</span></span> <span data-ttu-id="2e3ff-202">因此，如果兩個 HYPER-V 虛擬機器配置 2 記憶體每 GB 的 [HYPER-V 管理員] 中，執行這些 HYPER-V 虛擬機器時所使用的實際實體記憶體會大約 4476 MB （300 MB 的 hypervisor + 4 GB 配置給虛擬機器 + 64 MB + 16 MB = 4476 MB)。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-202">Therefore, if two Hyper-V virtual machines are each allocated 2 GB of memory in the Hyper-V Manager, the actual physical memory used when running these Hyper-V virtual machines would be approximately 4476MB (300MB for the hypervisor +4GB allocated for the virtual machines + 64 MB + 16MB = 4476MB).</span></span> <span data-ttu-id="2e3ff-203">**注意：** 為一般的經驗法則，計劃配置至少 512 MB 的記憶體，以提供服務，例如 I/O 虛擬化、 快照集檔案支援和子資料分割管理根磁碟分割。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-203">**Note:**      As a general rule of thumb, plan to allocate at least 512 MB memory for the root partition to provide services such as I/O virtualization, snapshot files support, and child partition management.</span></span><br /><span data-ttu-id="2e3ff-204">-   **使用 64 位元的客體作業系統盡可能**– 請考慮使用針對每個客體作業系統的 64 位元作業系統。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-204">-   **Use a 64-bit guest operating system when possible** – Consider using a 64-bit operating system for each guest operating system.</span></span> <span data-ttu-id="2e3ff-205">這應該會完成，因為根據預設，32 位元 Windows 作業系統可以只處理 2 GB 的每個處理序虛擬位址空間。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-205">This should be done because by default, 32-bit Windows operating systems can only address up to 2GB of virtual address space per process.</span></span> <span data-ttu-id="2e3ff-206">64 位元作業系統的安裝可讓應用程式利用完整裝載 HYPER-V 虛擬機器的實體電腦上安裝的記憶體。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-206">Installation of a 64-bit operating system allows applications to take full advantage of the memory installed on the physical computer that hosts the Hyper-V virtual machines.</span></span>|  
  
### <a name="optimize-network-performance"></a><span data-ttu-id="2e3ff-207">將網路效能最佳化</span><span class="sxs-lookup"><span data-stu-id="2e3ff-207">Optimize Network Performance</span></span>  
 <span data-ttu-id="2e3ff-208">HYPER-V 虛擬機器中支援的綜合和模擬網路介面卡，但綜合裝置提供大幅提升效能並減少 CPU 額外負荷。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-208">Hyper-V supports synthetic and emulated network adapters in virtual machines, but the synthetic devices offer significantly better performance and reduced CPU overhead.</span></span> <span data-ttu-id="2e3ff-209">每張介面卡會連接至虛擬網路交換器，如果需要外部網路連線可以連接至實體網路介面卡。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-209">Each of these adapters is connected to a virtual network switch, which can be connected to a physical network adapter if external network connectivity is needed.</span></span> <span data-ttu-id="2e3ff-210">遵循本節中的建議，以最佳化網路效能的 HYPER-V 虛擬環境中執行的客體作業系統。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-210">Follow the recommendations in this section to optimize network performance of guest operating systems running in a Hyper-V virtual environment.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2e3ff-211">這些建議都是從 「 效能調整指導方針的 Windows Server 2008 R2 」 白皮書下載的 「 效能調整的虛擬化伺服器 」 一節[http://go.microsoft.com/fwlink/?LinkID=202087](http://go.microsoft.com/fwlink/?LinkID=202087)。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-211">These recommendations are from the “Performance Tuning for Virtualization Servers” section of the “Performance Tuning Guidelines for Windows Server 2008 R2” whitepaper available for download at [http://go.microsoft.com/fwlink/?LinkID=202087](http://go.microsoft.com/fwlink/?LinkID=202087).</span></span> <span data-ttu-id="2e3ff-212">如需瞭解如何微調根磁碟分割，包括插斷仲裁中的網路介面卡，請參閱本指南的 「 效能調整的網路子系統 」 一節。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-212">For how to tune the network adapter in the root partition, including interrupt moderation, refer to the “Performance Tuning for Networking Subsystem” section of this guide.</span></span> <span data-ttu-id="2e3ff-213">應套用 TCP tunings，在該區段中，如果所需的子資料分割。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-213">The TCP tunings in that section should be applied, if required, to the child partitions.</span></span>  
  
|<span data-ttu-id="2e3ff-214">步驟</span><span class="sxs-lookup"><span data-stu-id="2e3ff-214">Step</span></span>|<span data-ttu-id="2e3ff-215">參考</span><span class="sxs-lookup"><span data-stu-id="2e3ff-215">Reference</span></span>|  
|----------|---------------|  
|<span data-ttu-id="2e3ff-216">設定要使用私人虛擬網路相同的 HYPER-V 主機電腦執行的 HYPER-V 虛擬機器</span><span class="sxs-lookup"><span data-stu-id="2e3ff-216">Configure Hyper-V Virtual Machines that are Running on the same Hyper-V host computer to use a Private Virtual Network</span></span>|<span data-ttu-id="2e3ff-217">請遵循 「 設定相同的 HYPER-V 上執行的 HYPER-V 虛擬機器主機使用的私人虛擬網路的電腦 」 一節中的建議[網路最佳化](~/technical-guides/network-optimizations.md)。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-217">Follow recommendations in the “Configure Hyper-V Virtual Machines that are Running on the same Hyper-V host computer to use a Private Virtual Network” section of [Network Optimizations](~/technical-guides/network-optimizations.md).</span></span>|  
|<span data-ttu-id="2e3ff-218">停用 TCP 卸載，以將虛擬機器網路卡</span><span class="sxs-lookup"><span data-stu-id="2e3ff-218">Disable TCP Offloading for the Virtual Machine Network Cards</span></span>|<span data-ttu-id="2e3ff-219">請遵循 「 停用 TCP 卸載的虛擬機器網路卡數 」 一節中的建議[網路最佳化](~/technical-guides/network-optimizations.md)。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-219">Follow recommendations in the “Disable TCP Offloading for the Virtual Machine Network Cards” section of [Network Optimizations](~/technical-guides/network-optimizations.md).</span></span>|  
|<span data-ttu-id="2e3ff-220">設定為使用 HYPER-V 綜合網路介面卡的客體作業系統。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-220">Configure guest operating systems to use the Hyper-V synthetic network adapter.</span></span>|<span data-ttu-id="2e3ff-221">綜合網路介面卡，特別針對 Vm 來達成大幅降低 CPU 額外負荷的 HYPER-V 功能網路 I/O 的比較來模擬的網路介面卡，以模擬現有硬體時。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-221">Hyper-V features a synthetic network adapter that is designed specifically for VMs to achieve significantly reduced CPU overhead on network I/O when it is compared to the emulated network adapter that mimics existing hardware.</span></span> <span data-ttu-id="2e3ff-222">綜合網路介面卡會透過使用共用的記憶體更有效率的資料傳輸 VMBus 子系和根資料分割之間進行通訊。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-222">The synthetic network adapter communicates between the child and root partitions over the VMBus by using shared memory for more efficient data transfer.</span></span> <br /><span data-ttu-id="2e3ff-223">模擬的網路介面卡應該透過 VM 的 [設定] 對話方塊來移除並取代的綜合網路介面卡。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-223">The emulated network adapter should be removed through the VM settings dialog box and replaced with a synthetic network adapter.</span></span> <span data-ttu-id="2e3ff-224">客體會需要安裝 VM 整合服務。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-224">The guest requires that the VM integration services be installed.</span></span>|  
|<span data-ttu-id="2e3ff-225">如果有的話，啟用卸載功能的根磁碟分割的實體網路介面卡驅動程式。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-225">If available, enable offload capabilities for the physical network adapter driver in the root partition.</span></span>|<span data-ttu-id="2e3ff-226">因為原生的案例中，以卸載實體網路介面卡中的功能，減少 CPU 使用量 VM 案例中的網路 I/o。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-226">As with the native scenario, offload capabilities in the physical network adapter reduce the CPU usage of network I/Os in VM scenarios.</span></span> <span data-ttu-id="2e3ff-227">HYPER-V 目前使用 LSOv1 TCPv4 總和檢查碼卸載和。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-227">Hyper-V currently uses LSOv1 and TCPv4 checksum offload.</span></span> <span data-ttu-id="2e3ff-228">在根磁碟分割中的實體網路介面卡的驅動程式，必須啟用卸載功能。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-228">The offload capabilities must be enabled in the driver for the physical network adapter in the root partition.</span></span> <span data-ttu-id="2e3ff-229">如需中網路介面卡卸載功能的詳細資訊，請參閱適用於 「 效能調整指導方針的 Windows Server 2008 R2"技術白皮書的 「 效能調整的虛擬化伺服器 」 一節的 「 選擇網路介面卡 」 一節從下列網址下載[http://go.microsoft.com/fwlink/?LinkID=202087](http://go.microsoft.com/fwlink/?LinkID=202087)。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-229">For details on offload capabilities in network adapters, refer to the “Choosing a Network Adapter” section of the “Performance Tuning for Virtualization Servers” section of the “Performance Tuning Guidelines for Windows Server 2008 R2” whitepaper available for download at [http://go.microsoft.com/fwlink/?LinkID=202087](http://go.microsoft.com/fwlink/?LinkID=202087).</span></span><br /><span data-ttu-id="2e3ff-230">驅動程式特定網路介面卡停用 LSOv1，但依預設會啟用 LSOv2。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-230">Drivers for certain network adapters disable LSOv1 but enable LSOv2 by default.</span></span> <span data-ttu-id="2e3ff-231">系統管理員必須明確使用驅動程式啟用 LSOv1**屬性**對話方塊的 [裝置管理員] 中。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-231">System administrators must explicitly enable LSOv1 by using the driver **Properties** dialog box in Device Manager.</span></span>|  
|<span data-ttu-id="2e3ff-232">設定網路交換器拓撲，讓使用多個網路介面卡。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-232">Configure network switch topology to make use of multiple network adapters.</span></span>|<span data-ttu-id="2e3ff-233">HYPER-V 支援建立多個虛擬網路交換器，其中每個可附加至實體網路介面卡有需要。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-233">Hyper-V supports creating multiple virtual network switches, each of which can be attached to a physical network adapter if needed.</span></span> <span data-ttu-id="2e3ff-234">在 VM 中的每個網路介面卡可以連接至虛擬網路交換器。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-234">Each network adapter in a VM can be connected to a virtual network switch.</span></span> <span data-ttu-id="2e3ff-235">如果實體伺服器有多張網路介面卡，Vm 網路需要大量載入可以發揮不必連接至不同的虛擬交換器，更有效地使用實體網路介面卡。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-235">If the physical server has multiple network adapters, VMs with network-intensive loads can benefit from being connected to different virtual switches to better use the physical network adapters.</span></span>|  
|<span data-ttu-id="2e3ff-236">如果安裝多張實體網路卡的 HYPER-V 主機電腦上，在一個邏輯處理器每張網路卡的繫結裝置中斷。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-236">If multiple physical network cards are installed on the Hyper-V host computer, bind device interrupts for each network card to a single logical processor.</span></span>|<span data-ttu-id="2e3ff-237">在某些工作負載，繫結至一個邏輯處理器的單一網路介面卡的裝置中斷可以改進效能 HYPER-V。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-237">Under certain workloads, binding the device interrupts for a single network adapter to a single logical processor can improve performance for Hyper-V.</span></span> <span data-ttu-id="2e3ff-238">我們建議此進階微調，只以解決特定問題的完整使用網路頻寬。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-238">We recommend this advanced tuning only to address specific problems in fully using network bandwidth.</span></span> <span data-ttu-id="2e3ff-239">系統管理員可以使用 IntPolicy 工具，將繫結至特定處理器的裝置插斷。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-239">System administrators can use the IntPolicy tool to bind device interrupts to specific processors.</span></span> <span data-ttu-id="2e3ff-240">如需 IntPolicy 工具的詳細資訊，請參閱[http://go.microsoft.com/fwlink/?LinkID=129773](http://go.microsoft.com/fwlink/?LinkID=129773)。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-240">For more information about the IntPolicy tool, see [http://go.microsoft.com/fwlink/?LinkID=129773](http://go.microsoft.com/fwlink/?LinkID=129773).</span></span>|  
|<span data-ttu-id="2e3ff-241">可能的話，請啟用 VLAN 標記 HYPER-V 綜合網路介面卡。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-241">If possible, enable VLAN tagging for the Hyper-V synthetic network adapter.</span></span>|<span data-ttu-id="2e3ff-242">HYPER-V 的綜合網路介面卡支援 VLAN 標記。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-242">The Hyper-V synthetic network adapter supports VLAN tagging.</span></span> <span data-ttu-id="2e3ff-243">如果實體網路介面卡支援的 NDIS_ENCAPSULATION_IEEE_802_3_P_AND_Q_IN_OOB 封裝大型傳送與總和檢查碼卸載，它可以提供大幅提升網路效能。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-243">It provides significantly better network performance if the physical network adapter supports NDIS_ENCAPSULATION_IEEE_802_3_P_AND_Q_IN_OOB encapsulation for both large send and checksum offload.</span></span> <span data-ttu-id="2e3ff-244">如果沒有這項支援，HYPER-V 需要 VLAN 標記的封包不能使用硬體卸載，可以減少網路效能。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-244">Without this support, Hyper-V cannot use hardware offload for packets that require VLAN tagging and network performance can be decreased.</span></span>|  
|<span data-ttu-id="2e3ff-245">在 HYPER-V 主機電腦上安裝適當的高速網路介面卡，並設定最大效能。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-245">Install high speed network adapter on the Hyper-V host computer and configure for maximum performance.</span></span>|<span data-ttu-id="2e3ff-246">請考慮安裝在 HYPER-V 主機電腦上的 1 GB 網路介面卡，並使用固定的速度，而不是使用 「 自動交涉 」 設定的網路介面卡-它是非常重要的網路速度、 雙工和流程控制參數設定為對應交換器上設定它們所連接。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-246">Consider installing 1-GB network adapters on the Hyper-V host computer and configure the network adapters with a fixed speed as opposed to using “auto negotiate” - It is very important that the network speed, duplex, and flow control parameters are set to correspond to the settings on the switch to which they are connected.</span></span>|  
|<span data-ttu-id="2e3ff-247">請遵循網路效能最佳化最佳的作法。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-247">Follow best practices for optimizing network performance.</span></span>|<span data-ttu-id="2e3ff-248">本主題[網路最佳化](~/technical-guides/network-optimizations.md)提供網路效能最佳化的一般指導方針。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-248">The topic [Network Optimizations](~/technical-guides/network-optimizations.md) offers general guidance for optimizing network performance.</span></span> <span data-ttu-id="2e3ff-249">雖然本主題不提供的效能最佳化的特定建議[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]在 HYPER-V 虛擬化環境中，則適用於任何技術[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]方案中，是否在實體硬體上，或在 HYPER-V 上執行虛擬化的環境。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-249">While this topic does not offer specific recommendations for optimizing performance of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] in a Hyper-V virtualized environment, the techniques are applicable to any [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] solution, whether running on physical hardware or on a Hyper-V virtualized environment.</span></span>|  
  
## <a name="optimize-sql-server-performance"></a><span data-ttu-id="2e3ff-250">最佳化 SQL Server 效能</span><span class="sxs-lookup"><span data-stu-id="2e3ff-250">Optimize SQL Server Performance</span></span>  
 <span data-ttu-id="2e3ff-251">請依照下列主題中的建議[SQL Server 最佳化](~/technical-guides/sql-server-optimizations.md)至 BizTalk Server 解決方案的 SQL Server 效能最佳化。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-251">Follow the recommendations in the topic [SQL Server Optimizations](~/technical-guides/sql-server-optimizations.md) to optimize SQL Server performance for the BizTalk Server solution.</span></span> <span data-ttu-id="2e3ff-252">雖然本主題不提供的效能最佳化的特定建議[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]在 HYPER-V 虛擬化環境中，則適用於任何技術[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]方案中，是否在實體硬體上，或在 HYPER-V 上執行虛擬化的環境。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-252">While this topic does not offer specific recommendations for optimizing performance of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] in a Hyper-V virtualized environment, the techniques are applicable to any [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] solution, whether running on physical hardware or on a Hyper-V virtualized environment.</span></span>  
  
## <a name="optimize-biztalk-server-solution"></a><span data-ttu-id="2e3ff-253">最佳化 BizTalk Server 解決方案</span><span class="sxs-lookup"><span data-stu-id="2e3ff-253">Optimize BizTalk Server Solution</span></span>  
 <span data-ttu-id="2e3ff-254">請依照下列主題中的建議[BizTalk Server 最佳化](~/technical-guides/biztalk-server-optimizations.md)最佳化 BizTalk Server 解決方案的效能。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-254">Follow the recommendations in the topic [BizTalk Server Optimizations](~/technical-guides/biztalk-server-optimizations.md) to optimize performance of the BizTalk Server solution.</span></span> <span data-ttu-id="2e3ff-255">雖然本主題不提供的效能最佳化的特定建議[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]在 HYPER-V 虛擬化環境中，則適用於任何技術[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]方案中，是否在實體硬體上，或在 HYPER-V 上執行虛擬化的環境。</span><span class="sxs-lookup"><span data-stu-id="2e3ff-255">While this topic does not offer specific recommendations for optimizing performance of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] in a Hyper-V virtualized environment, the techniques are applicable to any [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] solution, whether running on physical hardware or on a Hyper-V virtualized environment.</span></span>