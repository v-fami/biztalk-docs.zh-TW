---
title: 系統層級瓶頸 |Microsoft 文件
ms.custom: ''
ms.date: 06/29/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 0bdff435-76eb-495f-9fb6-1f1acef3921e
caps.latest.revision: ''
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 058fd60e1c38a3045197b4a36bdcc81250ab5be5
ms.sourcegitcommit: 8418b1a8f38b7f56979cd6e203f0b591e2f40fe1
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/23/2018
---
# <a name="system-level-bottlenecks"></a><span data-ttu-id="faac4-102">系統層級的瓶頸</span><span class="sxs-lookup"><span data-stu-id="faac4-102">System-Level Bottlenecks</span></span>
<span data-ttu-id="faac4-103">本主題描述如何解決常見的系統層級瓶頸，可能會影響 BizTalk Server 解決方案的效能。</span><span class="sxs-lookup"><span data-stu-id="faac4-103">This topic describes how to address common system-level bottlenecks that can impact the performance of a BizTalk Server solution.</span></span>  
  
## <a name="creating-a-snapshot-of-the-baseline-configuration"></a><span data-ttu-id="faac4-104">建立基準設定的快照</span><span class="sxs-lookup"><span data-stu-id="faac4-104">Creating a snapshot of the baseline configuration</span></span>  
 <span data-ttu-id="faac4-105">收集下列資訊可以提供您可用來協助修正系統層級瓶頸中，基準設定的快照集。</span><span class="sxs-lookup"><span data-stu-id="faac4-105">Gathering the following information can provide you with a snapshot of the baseline configuration that you can use to assist in correcting system-level bottlenecks.</span></span>  
  
### <a name="gather-documentation"></a><span data-ttu-id="faac4-106">蒐集文件</span><span class="sxs-lookup"><span data-stu-id="faac4-106">Gather documentation</span></span>  
 <span data-ttu-id="faac4-107">檢閱架構與您的案例的基礎結構的文件。</span><span class="sxs-lookup"><span data-stu-id="faac4-107">Review the documentation of the architecture and infrastructure of your scenario.</span></span>  
  
### <a name="run-the-baseline-security-analyzer"></a><span data-ttu-id="faac4-108">執行 Baseline Security Analyzer</span><span class="sxs-lookup"><span data-stu-id="faac4-108">Run the Baseline Security Analyzer</span></span>  
 <span data-ttu-id="faac4-109">請遵循下列步驟來執行 Baseline Security Analyzer:</span><span class="sxs-lookup"><span data-stu-id="faac4-109">Follow these steps to run the Baseline Security Analyzer:</span></span>  
  
1.  <span data-ttu-id="faac4-110">下載[Microsoft Baseline Security Analyzer 2.2](http://go.microsoft.com/fwlink/?LinKID=204006) (http://go.microsoft.com/fwlink/?LinkId=204006)。</span><span class="sxs-lookup"><span data-stu-id="faac4-110">Download the [Microsoft Baseline Security Analyzer 2.2](http://go.microsoft.com/fwlink/?LinKID=204006) (http://go.microsoft.com/fwlink/?LinkId=204006).</span></span>  
  
2.  <span data-ttu-id="faac4-111">使用網域系統管理員帳戶，登入裝載 BizTalk Server 和 SQL Server 電腦的相同網路上的電腦。</span><span class="sxs-lookup"><span data-stu-id="faac4-111">Using a domain administrator account, log on to a computer on the same network that is hosting the BizTalk Server and SQL Server computers.</span></span>  
  
3.  <span data-ttu-id="faac4-112">安裝 Microsoft Baseline Security Analyzer （例如，其中一部 BizTalk Server 電腦或另一部電腦） 目前電腦上。</span><span class="sxs-lookup"><span data-stu-id="faac4-112">Install the Microsoft Baseline Security Analyzer on the current computer (for example, one of the BizTalk Server computers or a separate computer).</span></span>  
  
4.  <span data-ttu-id="faac4-113">執行個別的掃描 (**開始掃描**)，指定為參數的名稱或 IP 位址，每一部 BizTalk Server 和 SQL Server 的電腦。</span><span class="sxs-lookup"><span data-stu-id="faac4-113">Execute a separate scan (**Start Scan**), specifying as a parameter the name or the IP address of each BizTalk Server and SQL Server computer.</span></span>  
  
5.  <span data-ttu-id="faac4-114">複製 %userprofile%\SecurityScans 目錄中的每一個安全性報告 （.mbsa 檔案）。</span><span class="sxs-lookup"><span data-stu-id="faac4-114">Copy each security report (.mbsa files) from the %userprofile%\SecurityScans directory.</span></span>  
  
### <a name="run-the-biztalk-server-best-practices-analyzer"></a><span data-ttu-id="faac4-115">執行 BizTalk Server Best Practices Analyzer</span><span class="sxs-lookup"><span data-stu-id="faac4-115">Run the BizTalk Server Best Practices Analyzer</span></span>  
 <span data-ttu-id="faac4-116">請遵循下列步驟來執行 BizTalk Server Best Practices Analyzer:</span><span class="sxs-lookup"><span data-stu-id="faac4-116">Follow these steps to run the BizTalk Server Best Practices Analyzer:</span></span>  
  
1.  <span data-ttu-id="faac4-117">下載[BizTalk Server 最佳做法分析程式 v1.2](http://go.microsoft.com/fwlink/?LinkID=83317) (http://go.microsoft.com/fwlink/?LinkID=83317)。</span><span class="sxs-lookup"><span data-stu-id="faac4-117">Download the [BizTalk Server Best Practices Analyzer v1.2](http://go.microsoft.com/fwlink/?LinkID=83317) (http://go.microsoft.com/fwlink/?LinkID=83317).</span></span>  
  
2.  <span data-ttu-id="faac4-118">使用屬於 BizTalk Server 系統管理員安全性群組的使用者帳戶，登入到 BizTalk Server 節點。</span><span class="sxs-lookup"><span data-stu-id="faac4-118">Using a user account that is part of the BizTalk Server Administrator security group, log on to a BizTalk Server node.</span></span>  
  
3.  <span data-ttu-id="faac4-119">目前的電腦上安裝 BizTalk Server Best Practices Analyzer。</span><span class="sxs-lookup"><span data-stu-id="faac4-119">Install the BizTalk Server Best Practices Analyzer on the current computer.</span></span>  
  
4.  <span data-ttu-id="faac4-120">執行工具，並儲存報表。</span><span class="sxs-lookup"><span data-stu-id="faac4-120">Run the tool and save the report.</span></span>  
  
### <a name="run-msinfo32-and-save-the-results"></a><span data-ttu-id="faac4-121">執行 MSInfo32 並儲存結果</span><span class="sxs-lookup"><span data-stu-id="faac4-121">Run MSInfo32 and save the results</span></span>  
 <span data-ttu-id="faac4-122">請遵循下列步驟來執行 MSInfo32:</span><span class="sxs-lookup"><span data-stu-id="faac4-122">Follow these steps to run MSInfo32:</span></span>  
  
1.  <span data-ttu-id="faac4-123">使用網域或本機系統管理員帳戶，登入每個 BizTalk Server 和 SQL Server 電腦。</span><span class="sxs-lookup"><span data-stu-id="faac4-123">Using a domain or a local administrator account, log on to each BizTalk Server and SQL Server computer.</span></span>  
  
2.  <span data-ttu-id="faac4-124">啟動命令提示字元，並將目錄變更為電腦的 %windir%\system32 目錄。</span><span class="sxs-lookup"><span data-stu-id="faac4-124">Launch a command prompt and change directories to the %windir%\system32 directory of the computer.</span></span>  
  
3.  <span data-ttu-id="faac4-125">從命令提示字元，請執行 MSinfo32.exe。</span><span class="sxs-lookup"><span data-stu-id="faac4-125">Run MSinfo32.exe from the command prompt.</span></span>  
  
4.  <span data-ttu-id="faac4-126">按一下**檔案**功能表，然後選取**匯出**功能表項目匯出至儲存電腦組態。</span><span class="sxs-lookup"><span data-stu-id="faac4-126">Click the **File** menu and select the **Export** menu item to export to save the computer configuration.</span></span>  
  
### <a name="export-the-biztalk-server-and-sql-server-computer-tcpip-registry-setting-"></a><span data-ttu-id="faac4-127">匯出 BizTalk Server 和 SQL Server 電腦 TCP/IP 登錄設定-</span><span class="sxs-lookup"><span data-stu-id="faac4-127">Export the BizTalk Server and SQL Server computer TCP/IP registry setting-</span></span>  
 <span data-ttu-id="faac4-128">請遵循下列步驟來儲存 BizTalk Server 和 SQL Server TCP/IP 登錄設定：</span><span class="sxs-lookup"><span data-stu-id="faac4-128">Follow these steps to save the BizTalk Server and SQL Server TCP/IP registry settings:</span></span>  
  
1.  <span data-ttu-id="faac4-129">啟動命令提示字元，並將目錄變更為電腦的 %windir%\system32 目錄。</span><span class="sxs-lookup"><span data-stu-id="faac4-129">Launch a command prompt and change directories to the %windir%\system32 directory of the computer.</span></span>  
  
2.  <span data-ttu-id="faac4-130">從命令提示字元中執行 Regedit.exe。</span><span class="sxs-lookup"><span data-stu-id="faac4-130">Run Regedit.exe from the command prompt.</span></span>  
  
3.  <span data-ttu-id="faac4-131">瀏覽至下列登錄機碼：</span><span class="sxs-lookup"><span data-stu-id="faac4-131">Navigate to the following key in the registry:</span></span>  
  
    ```  
    [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters] (network settings)  
    ```  
  
4.  <span data-ttu-id="faac4-132">以滑鼠右鍵按一下這個索引鍵，然後選取**匯出**將登錄機碼匯出到檔案。</span><span class="sxs-lookup"><span data-stu-id="faac4-132">Right-click this key and select **Export** to export the registry key to a file.</span></span>  
  
### <a name="collect-the-biztalk-configuration-files"></a><span data-ttu-id="faac4-133">收集 BizTalk 組態檔</span><span class="sxs-lookup"><span data-stu-id="faac4-133">Collect the BizTalk configuration files</span></span>  
 <span data-ttu-id="faac4-134">每個 BizTalk Server 在節點上，收集 BizTalk Server 組態檔案、 BTSNTSvc.exe.config 檔案 （或 64 位元主控件的 BTSNTSvc64.exe.config），位於 BizTalk Server 安裝資料夾 (例如 C:\Program Files\Microsoft BizTalk Server 2010)。</span><span class="sxs-lookup"><span data-stu-id="faac4-134">On each BizTalk Server node, collect the BizTalk Server configuration file, BTSNTSvc.exe.config file (or BTSNTSvc64.exe.config for 64-bit hosts), located in the BizTalk Server installation folder (e.g. C:\Program Files\Microsoft BizTalk Server 2010).</span></span>  
  
### <a name="collect-the-net-configuration-files"></a><span data-ttu-id="faac4-135">收集.NET 設定檔</span><span class="sxs-lookup"><span data-stu-id="faac4-135">Collect the .NET configuration files</span></span>  
 <span data-ttu-id="faac4-136">每個 BizTalk Server 在節點上，收集 machine.config 和 web.config 的.NET Framework 4.0 組態檔。</span><span class="sxs-lookup"><span data-stu-id="faac4-136">On each BizTalk Server node, collect the machine.config and web.config .NET Framework 4.0 configuration files.</span></span> <span data-ttu-id="faac4-137">您可以在下列位置找到的組態檔：</span><span class="sxs-lookup"><span data-stu-id="faac4-137">You can find the configuration files in the following location:</span></span>  
  
-   <span data-ttu-id="faac4-138">適用於 32 位元： %windir%\Microsoft.NET\Framework\v4.0.30319\CONFIG 資料夾</span><span class="sxs-lookup"><span data-stu-id="faac4-138">For 32-bit: %windir%\Microsoft.NET\Framework\v4.0.30319\CONFIG folder</span></span>  
  
-   <span data-ttu-id="faac4-139">針對 64 位元： %windir%\Microsoft.NET\Framework64\v4.0.30319\CONFIG 資料夾</span><span class="sxs-lookup"><span data-stu-id="faac4-139">For 64-bit: %windir%\Microsoft.NET\Framework64\v4.0.30319\CONFIG folder</span></span>  
  
### <a name="use-the-biztalk-msgboxviewer-tool-to-collect-information-about-the-messagebox-database"></a><span data-ttu-id="faac4-140">使用 BizTalk MsgBoxViewer 工具收集 MessageBox 資料庫的相關資訊</span><span class="sxs-lookup"><span data-stu-id="faac4-140">Use the BizTalk MsgBoxViewer tool to collect information about the MessageBox database</span></span>  
 <span data-ttu-id="faac4-141">請遵循下列步驟來收集有關使用 BizTalk MsgBoxViewer 工具的 MessageBox 資料庫的資訊：</span><span class="sxs-lookup"><span data-stu-id="faac4-141">Follow these steps to collect information about the MessageBox database using the BizTalk MsgBoxViewer tool:</span></span>  
  
1.  <span data-ttu-id="faac4-142">下載[BizTalk MsgBoxViewer 工具](http://go.microsoft.com/fwlink/?LinkID=117289)(http://go.microsoft.com/fwlink/?LinkID=117289)。</span><span class="sxs-lookup"><span data-stu-id="faac4-142">Download the [BizTalk MsgBoxViewer tool](http://go.microsoft.com/fwlink/?LinkID=117289) (http://go.microsoft.com/fwlink/?LinkID=117289).</span></span>  
  
2.  <span data-ttu-id="faac4-143">BizTalk Server 電腦屬於 BizTalk Server 系統管理員安全性群組的使用者帳戶登入。</span><span class="sxs-lookup"><span data-stu-id="faac4-143">Log on to the BizTalk Server computer with a user account that is part of the BizTalk Server Administrator security group.</span></span>  
  
3.  <span data-ttu-id="faac4-144">將 MsgBoxViewer.exe 複製到 BizTalk Server 電腦。</span><span class="sxs-lookup"><span data-stu-id="faac4-144">Copy the MsgBoxViewer.exe to the BizTalk Server computer.</span></span>  
  
4.  <span data-ttu-id="faac4-145">啟動工具。</span><span class="sxs-lookup"><span data-stu-id="faac4-145">Launch the tool.</span></span>  
  
5.  <span data-ttu-id="faac4-146">按一下**要收集的選擇性資訊**索引標籤，然後再按一下**選取的所有資訊**。</span><span class="sxs-lookup"><span data-stu-id="faac4-146">Click the **Optional Info to Collect** tab, and then click **Select All Info**.</span></span>  
  
6.  <span data-ttu-id="faac4-147">按一下**開始收集**。</span><span class="sxs-lookup"><span data-stu-id="faac4-147">Click **Start to Collect**.</span></span>  
  
7.  <span data-ttu-id="faac4-148">狀態標籤會顯示當**結束集合**訊息，切換至包含 MsgBoxViewer.exe 可執行檔的資料夾，複製所產生的報表 (.htm) 和記錄檔。</span><span class="sxs-lookup"><span data-stu-id="faac4-148">When the Status label shows the **End Collection** message, switch to the folder containing the MsgBoxViewer.exe executable and copy the resulting report (.htm) and log files.</span></span>  
  
### <a name="collect-and-store-the-source-code-for-all-components-used-in-the-solution"></a><span data-ttu-id="faac4-149">收集並儲存在方案中使用的所有元件的原始程式碼</span><span class="sxs-lookup"><span data-stu-id="faac4-149">Collect and store the source code for all components used in the solution</span></span>  
 <span data-ttu-id="faac4-150">儲存在個別的檔案共用上的所有元件 （例如協調流程、 自訂管線元件，以及協助程式元件的程式碼） 的原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="faac4-150">Store the source code for all components (for example Orchestration, Custom Pipeline Component, and Helper components code) on a separate file share.</span></span>  
  
## <a name="initial-troubleshooting"></a><span data-ttu-id="faac4-151">初始疑難排解</span><span class="sxs-lookup"><span data-stu-id="faac4-151">Initial troubleshooting</span></span>  
 <span data-ttu-id="faac4-152">沒有 BizTalk Server 方案，如果未啟用，將會造成效能問題，不論整體大小的某些元件或 BizTalk 解決方案的設計。</span><span class="sxs-lookup"><span data-stu-id="faac4-152">There are certain components of a BizTalk Server solution which, if not enabled, will cause performance problems regardless of the overall size or design of the BizTalk solution.</span></span> <span data-ttu-id="faac4-153">排除某些"常見的類別 」 參與 BizTalk 解決方案的獨占瓶頸分析之前應該完成下列初步疑難排解工作。</span><span class="sxs-lookup"><span data-stu-id="faac4-153">The following preliminary troubleshooting tasks should be completed to rule out some of the “usual suspects” before engaging in an exhaustive bottleneck analysis of a BizTalk solution.</span></span>  
  
-   <span data-ttu-id="faac4-154">**確認追蹤主控件執行個體正在執行-**追蹤主控件執行個體負責將 BAM 和 HAT 資料從 MessageBox 資料庫的 TrackingData 資料表移到 BizTalkDTADb 和 （或） BAMPrimaryImport 資料庫資料表。</span><span class="sxs-lookup"><span data-stu-id="faac4-154">**Verify the Tracking host instance is running -** The Tracking host instance is responsible for moving both BAM and HAT data from the TrackingData table of the MessageBox database to the BizTalkDTADb and/or BAMPrimaryImport database tables.</span></span> <span data-ttu-id="faac4-155">如果追蹤主控件執行個體未執行，則追蹤資料會累積在 MessageBox 資料庫和 BizTalk Server 解決方案的效能產生負面影響。</span><span class="sxs-lookup"><span data-stu-id="faac4-155">If the tracking host instance is not running, then tracking data will accumulate in the MessageBox database and negatively impact performance of the BizTalk Server solution.</span></span>  
  
-   <span data-ttu-id="faac4-156">**確認企業單一登入 (ENTSSO) 服務正在執行的所有 BizTalk Server 電腦-上**BizTalk 主控件執行個體維護相依性中的 ENTSSO 服務在本機執行個體。</span><span class="sxs-lookup"><span data-stu-id="faac4-156">**Verify the Enterprise Single Sign-On (ENTSSO) service is running on all BizTalk Server computers -** BizTalk host instances maintain a dependency on a locally running instance of the ENTSSO service.</span></span> <span data-ttu-id="faac4-157">如果 ENTSSO 服務未執行 BizTalk Server 上，然後在伺服器上的主控件執行個體將無法執行。</span><span class="sxs-lookup"><span data-stu-id="faac4-157">If the ENTSSO service is not running on the BizTalk Server, then host instances on the server will not be able to run either.</span></span>  
  
-   <span data-ttu-id="faac4-158">**確認 SQL Server Agent 服務正在執行的所有 SQL Server 電腦-上**必須執行 SQL Server Agent 服務，為了讓 BizTalk SQL Server Agent 作業來執行。</span><span class="sxs-lookup"><span data-stu-id="faac4-158">**Verify the SQL Server Agent service is running on all SQL Server computers -** The SQL Server Agent service must be running in order for the BizTalk SQL Server Agent jobs to execute.</span></span> <span data-ttu-id="faac4-159">這些工作會執行重要功能以維持伺服器運作且狀況良好。</span><span class="sxs-lookup"><span data-stu-id="faac4-159">These jobs perform important functions to keep your servers operational and healthy.</span></span>  
  
-   <span data-ttu-id="faac4-160">**確認 BizTalk SQL Server Agent 作業已啟用且正在執行不含例外-**即使 SQL Server Agent 服務正在執行，它是命令式會啟用所有預設 BizTalk SQL Server Agent 作業和執行成功。</span><span class="sxs-lookup"><span data-stu-id="faac4-160">**Verify the BizTalk SQL Server Agent jobs are enabled and running without exceptions -** Even if the SQL Server Agent service is running, it is imperative that all of the default BizTalk SQL Server Agent jobs are enabled and running successfully.</span></span>  
  
-   <span data-ttu-id="faac4-161">**請檢查 BizTalk Server 和 SQL Server 事件記錄檔-**概略檢查 BizTalk Server 或 SQL Server 事件記錄檔可能會顯示可能需要耗費大量時間來診斷和解決的問題。</span><span class="sxs-lookup"><span data-stu-id="faac4-161">**Check the BizTalk Server and SQL Server event logs -** A cursory examination of the BizTalk Server or SQL Server event logs may reveal a problem that could otherwise take a significant amount of time to diagnose and resolve.</span></span>  
  
-   <span data-ttu-id="faac4-162">**執行 BizTalk Server Best Practices Analyzer-** BizTalk Server Best Practices Analyzer 會檢查 BizTalk Server 部署，並產生的最佳做法標準相關的問題清單。</span><span class="sxs-lookup"><span data-stu-id="faac4-162">**Run the BizTalk Server Best Practices Analyzer -** The BizTalk Server Best Practices Analyzer examines a BizTalk Server deployment and generates a list of issues pertaining to best practices standards.</span></span> <span data-ttu-id="faac4-163">工具會執行組態層級驗證，以從不同的資訊來源，例如 Windows Management Instrumentation (WMI) 類別、 SQL Server 資料庫和登錄項目收集資料。</span><span class="sxs-lookup"><span data-stu-id="faac4-163">The tool performs configuration-level verification by gathering data from different information sources, such as Windows Management Instrumentation (WMI) classes, SQL Server databases, and registry entries.</span></span> <span data-ttu-id="faac4-164">將資料再用於評估的部署組態。</span><span class="sxs-lookup"><span data-stu-id="faac4-164">The data is then used to evaluate the deployment configuration.</span></span> <span data-ttu-id="faac4-165">工具讀取然後只會報告不會修改任何系統設定，並不是自我調整工具。</span><span class="sxs-lookup"><span data-stu-id="faac4-165">The tool reads and reports only and does not modify any system settings, and is not a self-tuning tool.</span></span> <span data-ttu-id="faac4-166">下載 BizTalk Server 最佳做法分析程式 v1.2 從[BizTalk Server 最佳做法分析程式 v1.2](http://go.microsoft.com/fwlink/?LinkID=83317) (http://go.microsoft.com/fwlink/?LinkID=83317)。</span><span class="sxs-lookup"><span data-stu-id="faac4-166">Download the BizTalk Server Best Practices Analyzer v1.2 from [BizTalk Server Best Practices Analyzer v1.2](http://go.microsoft.com/fwlink/?LinkID=83317) (http://go.microsoft.com/fwlink/?LinkID=83317).</span></span>  
  
## <a name="high-level-system-bottlenecks"></a><span data-ttu-id="faac4-167">高層級的系統瓶頸</span><span class="sxs-lookup"><span data-stu-id="faac4-167">High-level system bottlenecks</span></span>  
 <span data-ttu-id="faac4-168">本章節描述可能會出現在 BizTalk Server 解決方案以及可能的移轉策略的系統層級瓶頸。</span><span class="sxs-lookup"><span data-stu-id="faac4-168">This section describes system-level bottlenecks that may be present in a BizTalk Server solution and possible mitigation strategies.</span></span>  
  
### <a name="disk-io-bottlenecks"></a><span data-ttu-id="faac4-169">磁碟 I/O 瓶頸</span><span class="sxs-lookup"><span data-stu-id="faac4-169">Disk I/O bottlenecks</span></span>  
 <span data-ttu-id="faac4-170">磁碟 I/O 是指的讀取和寫入作業的實體磁碟上的應用程式所執行或安裝在您的伺服器中的多個磁碟數目。</span><span class="sxs-lookup"><span data-stu-id="faac4-170">Disk I/O refers to the number of read and write operations performed by your application on a physical disk or multiple disks installed in your server.</span></span> <span data-ttu-id="faac4-171">可能會造成磁碟 I/O 和相關的瓶頸的一般活動包含長時間執行的檔案 I/O 作業、 資料加密和解密，讀取資料庫資料表和實體記憶體不足，這樣可能會造成過度分頁的不必要的資料活動。</span><span class="sxs-lookup"><span data-stu-id="faac4-171">Common activities that can cause disk I/O and related bottlenecks include long-running file I/O operations, data encryption and decryption, reading unnecessary data from database tables, and an insufficient physical memory, which can lead to excessive paging activity.</span></span> <span data-ttu-id="faac4-172">磁碟速度是另一個要評估磁碟 I/O 瓶頸; 時，考慮因素較快速的磁碟提供更高的效能，並協助降低磁碟 I/O 瓶頸。</span><span class="sxs-lookup"><span data-stu-id="faac4-172">Disk speed is another factor to consider when evaluating disk I/O bottlenecks; faster disks provide increased performance and help reduce disk I/O bottlenecks.</span></span>  
  
 <span data-ttu-id="faac4-173">下表提供規劃磁碟子系統的 BizTalk Server 解決方案時，應考量的因素。</span><span class="sxs-lookup"><span data-stu-id="faac4-173">The table below provides factors that should be considered when planning the disk subsystem for a BizTalk Server solution.</span></span>  
  
|<span data-ttu-id="faac4-174">磁碟子系統的因素</span><span class="sxs-lookup"><span data-stu-id="faac4-174">Disk subsystem factor</span></span>|<span data-ttu-id="faac4-175">詳細資料</span><span class="sxs-lookup"><span data-stu-id="faac4-175">Details</span></span>|  
|---------------------------|-------------|  
|<span data-ttu-id="faac4-176">磁碟記憶體快取和可用的實體記憶體</span><span class="sxs-lookup"><span data-stu-id="faac4-176">Disk memory cache and available physical memory</span></span>|<span data-ttu-id="faac4-177">因為記憶體會快取至磁碟的實體記憶體限制時，請確定您有足夠的可用記憶體數量。</span><span class="sxs-lookup"><span data-stu-id="faac4-177">Because memory is cached to disk as physical memory becomes limited, make sure that you have a sufficient amount of memory available.</span></span> <span data-ttu-id="faac4-178">更多的分頁記憶體不足時，會寫入至磁碟，導致更大的磁碟活動。</span><span class="sxs-lookup"><span data-stu-id="faac4-178">When memory is scarce, more pages are written to disk, resulting in increased disk activity.</span></span> <span data-ttu-id="faac4-179">此外，請確定分頁檔設為適當的大小。</span><span class="sxs-lookup"><span data-stu-id="faac4-179">Also, make sure to set the paging file to an appropriate size.</span></span> <span data-ttu-id="faac4-180">額外的磁碟記憶體快取有助於位移的尖峰磁碟 I/O 要求。</span><span class="sxs-lookup"><span data-stu-id="faac4-180">Additional disk memory cache will help offset peaks in disk I/O requests.</span></span> <span data-ttu-id="faac4-181">不過，您應該注意很少的大型磁碟記憶體快取解決了在沒有足夠的主軸，問題，並具有足夠的磁針可以變換正負號的大型磁碟記憶體快取的需求。</span><span class="sxs-lookup"><span data-stu-id="faac4-181">However, it should be noted that a large disk memory cache seldom solves the problem of not having enough spindles, and having enough spindles can negate the need for a large disk memory cache.</span></span> <span data-ttu-id="faac4-182">如需設定 Windows 分頁檔，以獲得最佳效能的資訊，請參閱主題中的 「 設定 Windows 分頁檔，以獲得最佳效能 」 區段[最佳化作業系統效能](~/technical-guides/optimizing-operating-system-performance.md)。</span><span class="sxs-lookup"><span data-stu-id="faac4-182">For information on configuring the Windows paging file for optimal performance, see the section “Configure the Windows PAGEFILE for optimal performance” in the topic [Optimizing Operating System Performance](~/technical-guides/optimizing-operating-system-performance.md).</span></span>|  
|<span data-ttu-id="faac4-183">儲存體控制器類型</span><span class="sxs-lookup"><span data-stu-id="faac4-183">Storage controller type</span></span>|<span data-ttu-id="faac4-184">如果您有電池供電的快取時，啟用寫入快取來改善資料庫磁碟區和交易記錄檔磁碟區上的磁碟寫入效能。</span><span class="sxs-lookup"><span data-stu-id="faac4-184">If you have battery-backed cache, enable write caching to improve disk write performance on the transaction log file volumes and on the database volumes.</span></span> <span data-ttu-id="faac4-185">寫入快取提供回應時間 2 毫秒的寫入 I/O 要求，而不是 10 到 20 毫秒，而不啟用寫入快取的回應時間。</span><span class="sxs-lookup"><span data-stu-id="faac4-185">Write caching provides a response time of 2 ms for a write I/O request, as opposed to a response time of 10 to 20 ms without write caching enabled.</span></span> <span data-ttu-id="faac4-186">啟用寫入快取可大幅改善用戶端寫入要求的回應能力。</span><span class="sxs-lookup"><span data-stu-id="faac4-186">Enabling write caching greatly improves the responsiveness for client write requests.</span></span> <span data-ttu-id="faac4-187">因為才有用只能出現在交易記錄檔的循序的磁碟讀取的讀取快取無法改善在 BizTalk 伺服器案例的效能。</span><span class="sxs-lookup"><span data-stu-id="faac4-187">Read caching does not improve performance in a BizTalk Server scenario because it is only useful for sequential disk reads, which occur only in transaction log files.</span></span><br /><br /> <span data-ttu-id="faac4-188">它們會在播放時，才從讀取交易記錄檔，例如資料庫之後還原或當伺服器不是正常關機。</span><span class="sxs-lookup"><span data-stu-id="faac4-188">Transaction log files are read from only when they are being played back, such as after a database restore or when a server is not properly shutdown.</span></span> <span data-ttu-id="faac4-189">較大的快取容納更多的資料進行緩衝處理，也就是說，可以容納較長的飽和度。</span><span class="sxs-lookup"><span data-stu-id="faac4-189">Larger caches allow for more data to be buffered, meaning that longer periods of saturation can be accommodated.</span></span> <span data-ttu-id="faac4-190">如果您的控制器可讓您設定的快取的頁面大小，您應該設為 4 KB。</span><span class="sxs-lookup"><span data-stu-id="faac4-190">If your controller allows you to configure the cache page size, you should set it to 4 KB.</span></span> <span data-ttu-id="faac4-191">較大的大小，例如 8 KB，導致浪費快取，因為 4 KB 的 I/O 要求會佔用整個快取頁面為 8 KB，藉此剪下半中的您可使用快取。</span><span class="sxs-lookup"><span data-stu-id="faac4-191">A larger size, such as 8 KB, results in wasted cache because a 4 KB I/O request takes up the entire cache page of 8 KB, thereby cutting your usable cache in half.</span></span>|  
|<span data-ttu-id="faac4-192">主軸</span><span class="sxs-lookup"><span data-stu-id="faac4-192">Spindles</span></span>|<span data-ttu-id="faac4-193">磁針更重要的是比容量，而且如果磁針支援大量的隨機 I/O 要求，BizTalk Server 效能已獲得改善。</span><span class="sxs-lookup"><span data-stu-id="faac4-193">Spindles are more important than capacity, and BizTalk Server performance is improved if the spindles support a high number of random I/O requests.</span></span> <span data-ttu-id="faac4-194">計劃不超過 80%的總使用率，以確定即使中磁針失敗的情況下，有足夠的 I/O。</span><span class="sxs-lookup"><span data-stu-id="faac4-194">Plan for no more than 80 percent total utilization to ensure sufficient I/O is available, even in cases of a spindle failure.</span></span>|  
|<span data-ttu-id="faac4-195">Raid</span><span class="sxs-lookup"><span data-stu-id="faac4-195">Raid</span></span>|<span data-ttu-id="faac4-196">您使用的 RAID 解決方案應該根據成本和效能取捨適用於您的環境。</span><span class="sxs-lookup"><span data-stu-id="faac4-196">The RAID solution you use should be based on the cost and performance trade-offs that are appropriate for your environment.</span></span> <span data-ttu-id="faac4-197">因此，為特定的資料儲存體需求可能會建議的 RAID 解決方案的多個類型。</span><span class="sxs-lookup"><span data-stu-id="faac4-197">Therefore, more than one type of RAID solution may be recommended for a particular data storage requirement.</span></span> <span data-ttu-id="faac4-198">一般建議如下：</span><span class="sxs-lookup"><span data-stu-id="faac4-198">General recommendations are as follows:</span></span><br /><br /> <span data-ttu-id="faac4-199">-使用 Raid-1 + 0 （鏡像組中的等量集） 的 BizTalk Server 資料庫。</span><span class="sxs-lookup"><span data-stu-id="faac4-199">-   Use Raid-1+0 (striped sets in a mirrored set) for the BizTalk Server databases.</span></span><br /><span data-ttu-id="faac4-200">-使用交易記錄檔磁碟區的 Raid 1 （不含同位的鏡像組）。</span><span class="sxs-lookup"><span data-stu-id="faac4-200">-   Use Raid-1 (mirrored set without parity) for the transaction log file volumes.</span></span><br /><span data-ttu-id="faac4-201">-一般而言，Raid 5 （分散式同位檢查等量集） 建議您不要因為 Raid 5 沒有提供最佳的可靠性、 可用性和效能，相較於其他 Raid 組態。</span><span class="sxs-lookup"><span data-stu-id="faac4-201">-   In general, Raid 5 (striped set with distributed parity) is not recommended as Raid 5 does not provide optimal reliability, availability and performance as compared to other Raid configurations.</span></span><br /><span data-ttu-id="faac4-202">由於對永久的資料遺失的可能性，Raid 0 （不含同位的等量集） 組態應該永遠不會使用 BizTalk Server 實際執行環境中。</span><span class="sxs-lookup"><span data-stu-id="faac4-202">-   Due to the possibility of permanent data loss, a Raid-0 (striped set without parity) configuration should never be used in a BizTalk Server production environment.</span></span>|  
|<span data-ttu-id="faac4-203">匯流排類型</span><span class="sxs-lookup"><span data-stu-id="faac4-203">Bus type</span></span>|<span data-ttu-id="faac4-204">較高的輸送量提供更佳的效能。</span><span class="sxs-lookup"><span data-stu-id="faac4-204">Higher throughput provides better performance.</span></span> <span data-ttu-id="faac4-205">一般情況下，SCSI 匯流排提供更佳的輸送量和延展性比 IDE 或 ATA 匯流排。</span><span class="sxs-lookup"><span data-stu-id="faac4-205">In general, SCSI buses provide better throughput and scalability than IDE or ATA buses.</span></span> <span data-ttu-id="faac4-206">您可以使用下列方程式，以判斷理論的輸送量限制的匯流排類型：</span><span class="sxs-lookup"><span data-stu-id="faac4-206">You can use the following equation to determine the theoretical throughput limit for your bus type:</span></span><br /><br /> <span data-ttu-id="faac4-207">(匯流排速度 （以位元） / 8 位元，每個位元組)作業系統速度 （MHz) x = 輸送量 （以 MB/s)</span><span class="sxs-lookup"><span data-stu-id="faac4-207">(Bus speed (in bits) / 8 bits per byte) X Operating speed (in MHz) = Throughput (in MB/s)</span></span><br /><br /> <span data-ttu-id="faac4-208">您也可以置於個別的 I/O 匯流排中的多個磁碟機，以改善磁碟 I/O 效能。</span><span class="sxs-lookup"><span data-stu-id="faac4-208">You can also improve disk I/O performance by placing multiple drives on separate I/O buses.</span></span>|  
  
#### <a name="performance-counters-for-measuring-disk-io-bottlenecks"></a><span data-ttu-id="faac4-209">效能計數器來測量磁碟 I/O 瓶頸</span><span class="sxs-lookup"><span data-stu-id="faac4-209">Performance counters for measuring disk I/O bottlenecks</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="faac4-210">嘗試分析磁碟效能瓶頸，您應該一律使用實體磁碟計數器。</span><span class="sxs-lookup"><span data-stu-id="faac4-210">When attempting to analyze disk performance bottlenecks, you should always use physical disk counters.</span></span> <span data-ttu-id="faac4-211">不過，如果您使用軟體 RAID，您應該使用邏輯磁碟計數器。</span><span class="sxs-lookup"><span data-stu-id="faac4-211">However, if you use software RAID, you should use logical disk counters.</span></span> <span data-ttu-id="faac4-212">邏輯磁碟和實體磁碟計數器，相同的計數器可用於每個計數器物件。</span><span class="sxs-lookup"><span data-stu-id="faac4-212">As for Logical Disk and Physical Disk Counters, the same counters are available in each of these counter objects.</span></span> <span data-ttu-id="faac4-213">邏輯磁碟資料的大量管理員 （或管理員），而資料分割管理員會追蹤實體磁碟的資料。</span><span class="sxs-lookup"><span data-stu-id="faac4-213">Logical disk data is tracked by the volume manager (or managers), and physical disk data is tracked by the partition manager.</span></span>  
  
 <span data-ttu-id="faac4-214">下列效能計數器應該用來判斷是否您的系統發生磁碟 I/O 相關的瓶頸：</span><span class="sxs-lookup"><span data-stu-id="faac4-214">The following performance counters should be used to determine if your system is experiencing a disk I/O related bottleneck:</span></span>  
  
-   <span data-ttu-id="faac4-215">**PhysicalDisk\Avg.磁碟佇列長度**</span><span class="sxs-lookup"><span data-stu-id="faac4-215">**PhysicalDisk\Avg. Disk Queue Length**</span></span>  
  
    -   <span data-ttu-id="faac4-216">臨界值： 不能高於磁針加上兩個數目。</span><span class="sxs-lookup"><span data-stu-id="faac4-216">Threshold: Should not be higher than the number of spindles plus two.</span></span>  
  
    -   <span data-ttu-id="faac4-217">重要： 此計數器表示這兩個讀取的平均數目，並將取樣間隔時間內在佇列中對於所選磁碟的要求。</span><span class="sxs-lookup"><span data-stu-id="faac4-217">Significance: This counter indicates the average number of both read and writes requests that were queued for the selected disk during the sample interval.</span></span> <span data-ttu-id="faac4-218">這個計數器是用來收集並行資料，包括資料暴增和尖峰負載。</span><span class="sxs-lookup"><span data-stu-id="faac4-218">This counter is useful for gathering concurrency data, including data bursts and peak loads.</span></span> <span data-ttu-id="faac4-219">這些值代表在收集統計資料的驅動程式之下執行的要求數目。</span><span class="sxs-lookup"><span data-stu-id="faac4-219">These values represent the number of requests in flight below the driver taking the statistics.</span></span> <span data-ttu-id="faac4-220">這表示要求都不一定在佇列，但實際上可以是在服務中或已完成的方式備份路徑。</span><span class="sxs-lookup"><span data-stu-id="faac4-220">This means the requests are not necessarily queued but could actually be in service or completed and on the way back up the path.</span></span> <span data-ttu-id="faac4-221">可能的傳遞位置如下：</span><span class="sxs-lookup"><span data-stu-id="faac4-221">Possible in-flight locations include the following:</span></span>  
  
        -   <span data-ttu-id="faac4-222">SCSIport 或 Storport 佇列</span><span class="sxs-lookup"><span data-stu-id="faac4-222">SCSIport or Storport queue</span></span>  
  
        -   <span data-ttu-id="faac4-223">OEM 驅動程式佇列</span><span class="sxs-lookup"><span data-stu-id="faac4-223">OEM driver queue</span></span>  
  
        -   <span data-ttu-id="faac4-224">磁碟控制器的佇列</span><span class="sxs-lookup"><span data-stu-id="faac4-224">Disk controller queue</span></span>  
  
        -   <span data-ttu-id="faac4-225">硬碟佇列</span><span class="sxs-lookup"><span data-stu-id="faac4-225">Hard disk queue</span></span>  
  
        -   <span data-ttu-id="faac4-226">主動接收從硬碟</span><span class="sxs-lookup"><span data-stu-id="faac4-226">Actively receiving from a hard disk</span></span>  
  
-   <span data-ttu-id="faac4-227">**PhysicalDisk\Avg.Disk Read Queue Length**</span><span class="sxs-lookup"><span data-stu-id="faac4-227">**PhysicalDisk\Avg. Disk Read Queue Length**</span></span>  
  
    -   <span data-ttu-id="faac4-228">臨界值： 應該是少於兩個。</span><span class="sxs-lookup"><span data-stu-id="faac4-228">Threshold: Should be less than two.</span></span>  
  
    -   <span data-ttu-id="faac4-229">重要： 此計數器表示取樣間隔時間內在佇列中對於所選磁碟的讀取要求平均的數目。</span><span class="sxs-lookup"><span data-stu-id="faac4-229">Significance: This counter indicates the average number of read requests that were queued for the selected disk during the sample interval.</span></span>  
  
-   <span data-ttu-id="faac4-230">**PhysicalDisk\Avg.磁碟寫入佇列長度**</span><span class="sxs-lookup"><span data-stu-id="faac4-230">**PhysicalDisk\Avg. Disk Write Queue Length**</span></span>  
  
    -   <span data-ttu-id="faac4-231">臨界值： 應該是少於兩個。</span><span class="sxs-lookup"><span data-stu-id="faac4-231">Threshold: Should be less than two.</span></span>  
  
    -   <span data-ttu-id="faac4-232">重要： 此計數器表示取樣間隔時間內在佇列中對於所選磁碟的寫入要求平均的數目。</span><span class="sxs-lookup"><span data-stu-id="faac4-232">Significance: This counter indicates the average number of write requests that were queued for the selected disk during the sample interval.</span></span>  
  
-   <span data-ttu-id="faac4-233">**PhysicalDisk\Avg.Disk sec/Read**</span><span class="sxs-lookup"><span data-stu-id="faac4-233">**PhysicalDisk\Avg. Disk sec/Read**</span></span>  
  
    -   <span data-ttu-id="faac4-234">臨界值： 沒有特定的值。</span><span class="sxs-lookup"><span data-stu-id="faac4-234">Threshold: No specific value.</span></span>  
  
        -   <span data-ttu-id="faac4-235">小於 10 毫秒 （毫秒） = 良好</span><span class="sxs-lookup"><span data-stu-id="faac4-235">Less than 10 milliseconds (ms) = good</span></span>  
  
        -   <span data-ttu-id="faac4-236">介於 15 到 25 的 ms = 公平</span><span class="sxs-lookup"><span data-stu-id="faac4-236">Between 15 and 25 ms = fair</span></span>  
  
        -   <span data-ttu-id="faac4-237">大於 25 毫秒 = 差</span><span class="sxs-lookup"><span data-stu-id="faac4-237">Greater than 25 ms = poor</span></span>  
  
    -   <span data-ttu-id="faac4-238">重要： 此計數器表示的平均時間，以秒為單位的資料從磁碟讀取作業。</span><span class="sxs-lookup"><span data-stu-id="faac4-238">Significance: This counter indicates the average time, in seconds, of a data read operation from the disk.</span></span> <span data-ttu-id="faac4-239">如果數目大於 25 毫秒 (ms) 為單位，表示磁碟系統從磁碟讀取時遇到延遲。</span><span class="sxs-lookup"><span data-stu-id="faac4-239">If the number is larger than 25 milliseconds (ms), that means the disk system is experiencing latency when reading from the disk.</span></span> <span data-ttu-id="faac4-240">裝載 BizTalk Server 關鍵任務的伺服器，可接受的閾值是比較低，大約 10 毫秒。</span><span class="sxs-lookup"><span data-stu-id="faac4-240">For mission-critical servers hosting BizTalk Server, the acceptable threshold is much lower, approximately 10 ms.</span></span>  
  
-   <span data-ttu-id="faac4-241">**PhysicalDisk\Avg.Disk sec/Write**</span><span class="sxs-lookup"><span data-stu-id="faac4-241">**PhysicalDisk\Avg. Disk sec/Write**</span></span>  
  
    -   <span data-ttu-id="faac4-242">臨界值： 沒有特定的值。</span><span class="sxs-lookup"><span data-stu-id="faac4-242">Threshold: No specific value.</span></span>  
  
        -   <span data-ttu-id="faac4-243">小於 10 毫秒 （毫秒） = 良好</span><span class="sxs-lookup"><span data-stu-id="faac4-243">Less than 10 milliseconds (ms) = good</span></span>  
  
        -   <span data-ttu-id="faac4-244">介於 15 到 25 的 ms = 公平</span><span class="sxs-lookup"><span data-stu-id="faac4-244">Between 15 and 25 ms = fair</span></span>  
  
        -   <span data-ttu-id="faac4-245">大於 25 毫秒 = 差</span><span class="sxs-lookup"><span data-stu-id="faac4-245">Greater than 25 ms = poor</span></span>  
  
    -   <span data-ttu-id="faac4-246">重要： 此計數器表示的平均時間，以秒為單位，將資料寫入磁碟作業。</span><span class="sxs-lookup"><span data-stu-id="faac4-246">Significance: This counter indicates the average time, in seconds, of a data write operation to the disk.</span></span> <span data-ttu-id="faac4-247">如果數目大於 25 毫秒，磁碟系統寫入磁碟時，就會發生延遲。</span><span class="sxs-lookup"><span data-stu-id="faac4-247">If the number is larger than 25 ms, the disk system experiences latency when writing to the disk.</span></span> <span data-ttu-id="faac4-248">裝載 BizTalk Server 關鍵任務的伺服器，可接受的閾值是比較低，大約 10 毫秒。</span><span class="sxs-lookup"><span data-stu-id="faac4-248">For mission-critical servers hosting BizTalk Server, the acceptable threshold is much lower, approximately 10 ms.</span></span>  
  
-   <span data-ttu-id="faac4-249">**PhysicalDisk\Avg.Disk sec/Transfer**</span><span class="sxs-lookup"><span data-stu-id="faac4-249">**PhysicalDisk\Avg. Disk sec/Transfer**</span></span>  
  
    -   <span data-ttu-id="faac4-250">臨界值： 不應該超過 18 （毫秒）。</span><span class="sxs-lookup"><span data-stu-id="faac4-250">Threshold: Should not be more than 18 milliseconds.</span></span>  
  
    -   <span data-ttu-id="faac4-251">重要： 此計數器表示的時間，以秒為單位的平均磁碟傳輸。</span><span class="sxs-lookup"><span data-stu-id="faac4-251">Significance: This counter indicates the time, in seconds, of the average disk transfer.</span></span> <span data-ttu-id="faac4-252">這可能表示大量磁碟分散程度、 緩慢的磁碟或磁碟故障。</span><span class="sxs-lookup"><span data-stu-id="faac4-252">This may indicate a large amount of disk fragmentation, slow disks, or disk failures.</span></span> <span data-ttu-id="faac4-253">將的值相乘**Physical disk\avg.。Disk sec/Transfer**和**Memory\Pages/sec**計數器。</span><span class="sxs-lookup"><span data-stu-id="faac4-253">Multiply the values of the **Physical Disk\Avg. Disk sec/Transfer** and **Memory\Pages/sec** counters.</span></span> <span data-ttu-id="faac4-254">如果這些計數器的乘積超過 0.1，分頁佔用超過 10%的磁碟存取時間，因此您需要更多實體記憶體可用。</span><span class="sxs-lookup"><span data-stu-id="faac4-254">If the product of these counters exceeds 0.1, paging is taking more than 10 percent of disk access time, so you need more physical memory available.</span></span>  
  
-   <span data-ttu-id="faac4-255">**PhysicalDisk\Disk Writes/sec**</span><span class="sxs-lookup"><span data-stu-id="faac4-255">**PhysicalDisk\Disk Writes/sec**</span></span>  
  
    -   <span data-ttu-id="faac4-256">臨界值： 取決於製造商的規格。</span><span class="sxs-lookup"><span data-stu-id="faac4-256">Threshold: Depends on manufacturer’s specifications.</span></span>  
  
    -   <span data-ttu-id="faac4-257">重要： 此計數器表示磁碟上的寫入操作速率。</span><span class="sxs-lookup"><span data-stu-id="faac4-257">Significance: This counter indicates the rate of write operations on the disk.</span></span>  
  
-   <span data-ttu-id="faac4-258">**處理器\\%DPC Time、 %Interrupt Time 及 %Privileged Time-**如果插斷的時間和延遲程序呼叫 (DPC) 的時間大部分的特殊權限的時間，核心會花費大量時間處理 I/O 要求。</span><span class="sxs-lookup"><span data-stu-id="faac4-258">**Processor\\% DPC Time, % Interrupt Time and % Privileged Time -** If Interrupt Time and Deferred Procedure Call (DPC) time are a large portion of Privileged Time, the kernel is spending a significant amount of time processing I/O requests.</span></span> <span data-ttu-id="faac4-259">在某些情況下，藉由在多處理器系統上設定插斷和 DPC 少量的 Cpu 相似性可改善效能，進而改善快取位置。</span><span class="sxs-lookup"><span data-stu-id="faac4-259">In some cases performance can be improved by configuring interrupts and DPC affinity to a small number of CPUs on a multiprocessor system, which improves cache locality.</span></span> <span data-ttu-id="faac4-260">在其他情況下，它最適合散發插斷和 Dpc，在多個 Cpu，以防止變成瓶頸的插斷和 DPC 活動之間。</span><span class="sxs-lookup"><span data-stu-id="faac4-260">In other cases, it works best to distribute the interrupts and DPCs among many CPUs, so as to keep the interrupt and DPC activity from becoming a bottleneck.</span></span> <span data-ttu-id="faac4-261">使用繫結至多處理器電腦上的特定處理器的網路介面卡插斷的插斷篩選組態工具的資訊，請參閱 > 一節 「 使用插斷篩選組態工具來繫結至特定的網路介面卡插斷中的處理器多處理器電腦上 「[最佳化作業系統效能](~/technical-guides/optimizing-operating-system-performance.md)。</span><span class="sxs-lookup"><span data-stu-id="faac4-261">For information on using the Interrupt Filter Configuration tool to bind network adapter interrupts to specific processors on multiprocessor computers, see the section “Use the Interrupt Filter Configuration tool to bind network adapter interrupts to specific processors on multiprocessor computers” in [Optimizing Operating System Performance](~/technical-guides/optimizing-operating-system-performance.md).</span></span>  
  
-   <span data-ttu-id="faac4-262">**Processor\DPCs 排入佇列 / sec-**測量 Dpc 正在耗用 CPU 時間與核心資源的方式。</span><span class="sxs-lookup"><span data-stu-id="faac4-262">**Processor\DPCs Queued / sec -** Measures how DPCs are consuming CPU time and kernel resources.</span></span>  
  
-   <span data-ttu-id="faac4-263">**Processor\Interrupts / sec-**的插斷如何耗用 CPU 時間與核心資源的另一個測量。</span><span class="sxs-lookup"><span data-stu-id="faac4-263">**Processor\Interrupts / sec -** Another measurement of how interrupts are consuming CPU time and kernel resources.</span></span> <span data-ttu-id="faac4-264">現代磁碟控制卡通常會結合，或聯合插斷，以便單一插斷會產生多個 I/O 完成的處理。</span><span class="sxs-lookup"><span data-stu-id="faac4-264">Modern disk controllers often combine or coalesce interrupts so that a single interrupt results in the processing of multiple I/O completions.</span></span> <span data-ttu-id="faac4-265">當然，沒有延遲插斷 （和完成） 和 economizing CPU 處理時間之間的取捨。</span><span class="sxs-lookup"><span data-stu-id="faac4-265">Of course, there is a trade-off between delaying interrupts (and thus completions) and economizing CPU processing time.</span></span>  
  
#### <a name="disk-io-tuning-options"></a><span data-ttu-id="faac4-266">磁碟 I/O 的微調選項</span><span class="sxs-lookup"><span data-stu-id="faac4-266">Disk I/O tuning options</span></span>  
 <span data-ttu-id="faac4-267">如果您判斷磁碟 I/O 是您的環境中的瓶頸，可以使用下列技巧來減少瓶頸：</span><span class="sxs-lookup"><span data-stu-id="faac4-267">If you determine that disk I/O is a bottleneck in your environment, the following techniques may be used to alleviate the bottleneck:</span></span>  
  
-   <span data-ttu-id="faac4-268">**重組磁碟-**使用可在[PageDefrag 公用程式](http://go.microsoft.com/fwlink/?LinkId=108976)(http://go.microsoft.com/fwlink/?LinkId=108976)重組 Windows 分頁檔，並預先配置主檔案表格。</span><span class="sxs-lookup"><span data-stu-id="faac4-268">**Defragment your disks -** Use the available at [PageDefrag utility](http://go.microsoft.com/fwlink/?LinkId=108976) (http://go.microsoft.com/fwlink/?LinkId=108976) to defragment the Windows paging file and pre-allocate the Master File Tables.</span></span>  
  
-   <span data-ttu-id="faac4-269">**使用等量集來同時處理 I/O 要求，透過多個磁碟-**使用鏡像磁碟區來提供容錯能力並提升 I/O 效能。</span><span class="sxs-lookup"><span data-stu-id="faac4-269">**Use stripe sets to process I/O requests concurrently over multiple disks -** Use mirrored volumes to provide fault tolerance and increase I/O performance.</span></span> <span data-ttu-id="faac4-270">如果您不需要容錯功能，實作等量磁碟區設定為快速讀取和寫入，進而改善儲存體容量。</span><span class="sxs-lookup"><span data-stu-id="faac4-270">If you do not require fault tolerance, implement stripe sets for fast reading and writing and improved storage capacity.</span></span> <span data-ttu-id="faac4-271">當使用等量磁碟區時，每個磁碟使用量會減少，因為工作會分散到磁碟區，並提高整體輸送量。</span><span class="sxs-lookup"><span data-stu-id="faac4-271">When stripe sets are used, per disk utilization is reduced because work is distributed across the volumes, and overall throughput increases.</span></span> <span data-ttu-id="faac4-272">如果您在等量磁碟區中加入額外的磁碟設定不會增加輸送量，則您的系統可能會遇到瓶頸，因為磁碟的磁碟控制卡之間的競爭。</span><span class="sxs-lookup"><span data-stu-id="faac4-272">If you adding additional disks in a stripe set does not increase throughput, then your system might be experiencing a bottleneck due to contention between disks by the disk controller.</span></span> <span data-ttu-id="faac4-273">在此情況下，加入額外的磁碟控制器會協助分散負載，以及提高效能。</span><span class="sxs-lookup"><span data-stu-id="faac4-273">In this case, adding an additional disk controller will help distribute load and increase performance.</span></span>  
  
-   <span data-ttu-id="faac4-274">**分散在多個磁碟機-之間的工作負載**Windows 叢集和分散式檔案系統提供多個磁碟機上的負載平衡解決方案。</span><span class="sxs-lookup"><span data-stu-id="faac4-274">**Distribute workload among multiple drives -** Windows Clustering and Distributed File System provide solutions for load balancing on multiple disk drives.</span></span>  
  
-   <span data-ttu-id="faac4-275">**限制使用檔案壓縮或加密-**檔案壓縮和加密是 I/O 密集作業。</span><span class="sxs-lookup"><span data-stu-id="faac4-275">**Limit the use of file compression or encryption -** File compression and encryption are I/O-intensive operations.</span></span> <span data-ttu-id="faac4-276">您應該只使用它們其中有絕對的必要性。</span><span class="sxs-lookup"><span data-stu-id="faac4-276">You should only use them where absolutely necessary.</span></span>  
  
-   <span data-ttu-id="faac4-277">**停用建立短檔名-**如果您不支援 MS-DOS 適用於 Windows 3.x 用戶端，停用短檔名，以改善效能。</span><span class="sxs-lookup"><span data-stu-id="faac4-277">**Disable creation of short names -** If you are not supporting MS-DOS for Windows 3.x clients, disable short names to improve performance.</span></span> <span data-ttu-id="faac4-278">多個停用建立簡短名稱的詳細資訊，請參閱 「 停用簡短檔案名稱 (8.3) 第代 」 一節中,[最佳化作業系統效能](~/technical-guides/optimizing-operating-system-performance.md)。</span><span class="sxs-lookup"><span data-stu-id="faac4-278">For more information about disabling the creation of short names, see the section “Disable short-file-name (8.3) generation” in [Optimizing Operating System Performance](~/technical-guides/optimizing-operating-system-performance.md).</span></span>  
  
-   <span data-ttu-id="faac4-279">**停用存取的最新更新-**根據預設，NTFS 更新目錄的上次存取日期和時間戳記每當周遊目錄。</span><span class="sxs-lookup"><span data-stu-id="faac4-279">**Disable last access update -** By default, NTFS updates the date and time stamp of the last access on directories whenever it traverses the directory.</span></span> <span data-ttu-id="faac4-280">對於大型的 NTFS 磁碟區，這個更新程序可能會降低效能。</span><span class="sxs-lookup"><span data-stu-id="faac4-280">For a large NTFS volume, this update process may hinder performance.</span></span> <span data-ttu-id="faac4-281">如需停用上次存取更新的詳細資訊，請參閱下節中的 [停用 NTFS 上次存取的更新][最佳化作業系統效能](~/technical-guides/optimizing-operating-system-performance.md)。</span><span class="sxs-lookup"><span data-stu-id="faac4-281">For more information about disabling last access updates, see the section “Disable NTFS last access updates” in [Optimizing Operating System Performance](~/technical-guides/optimizing-operating-system-performance.md).</span></span>  
  
    > [!CAUTION]
    >  <span data-ttu-id="faac4-282">某些應用程式，例如增量備份公用程式，依賴 NTFS 更新資訊，而且不將則沒有正確運作。</span><span class="sxs-lookup"><span data-stu-id="faac4-282">Some applications, such as incremental backup utilities, rely on the NTFS update information and will not function correctly without it.</span></span>  
  
-   <span data-ttu-id="faac4-283">**保留的主檔案表格-適當空間**新增**NtfsMftZoneReservation**登錄根據通常儲存在 NTFS 磁碟區的檔案數目的項目。</span><span class="sxs-lookup"><span data-stu-id="faac4-283">**Reserve appropriate space for the master file table -** Add the **NtfsMftZoneReservation** entry to the registry depending on the number of files that are typically stored on your NTFS volumes.</span></span> <span data-ttu-id="faac4-284">當您將此項目加入登錄時，系統會保留之磁碟區的 主檔案表格空間。</span><span class="sxs-lookup"><span data-stu-id="faac4-284">When you add this entry to the registry, the system reserves space on the volume for the master file table.</span></span> <span data-ttu-id="faac4-285">保留空間以這種方式可讓主檔案表格，以最佳方式成長。</span><span class="sxs-lookup"><span data-stu-id="faac4-285">Reserving space in this manner allows the master file table to grow optimally.</span></span> <span data-ttu-id="faac4-286">如果您的 NTFS 磁碟區通常儲存相當幾個檔案，設定此登錄項目的值為預設值為 1。</span><span class="sxs-lookup"><span data-stu-id="faac4-286">If your NTFS volumes generally store relatively few files, set the value of this registry entry to the default value of 1.</span></span> <span data-ttu-id="faac4-287">通常您可以使用的值為 2 或 3，如果您的 NTFS 磁碟區儲存適量的檔案，且使用的值為 4 （上限），如果您的 NTFS 磁碟區通常會包含相對較大的數字的檔案。</span><span class="sxs-lookup"><span data-stu-id="faac4-287">Typically you can use a value of 2 or 3 if your NTFS volumes store a moderate numbers of files, and use a value of 4 (the maximum) if your NTFS volumes tend to contain a relatively large number of files.</span></span> <span data-ttu-id="faac4-288">不過，請務必測試任何設定大於 2，因為這些更大的值會造成系統上，以保留較大一部分的主檔案表格的磁碟。</span><span class="sxs-lookup"><span data-stu-id="faac4-288">However, make sure to test any settings greater than 2, because these greater values cause the system to reserve a much larger portion of the disk for the master file table.</span></span> <span data-ttu-id="faac4-289">如需有關加入**NtfsMftZoneReservation**至登錄，請參閱 > 一節 「 增加中的可用空間的主檔案表格"[最佳化作業系統效能](~/technical-guides/optimizing-operating-system-performance.md)。</span><span class="sxs-lookup"><span data-stu-id="faac4-289">For more information about adding the **NtfsMftZoneReservation** to the registry, see the section “Increase space available for the master file table” in [Optimizing Operating System Performance](~/technical-guides/optimizing-operating-system-performance.md).</span></span>  
  
-   <span data-ttu-id="faac4-290">**使用最有效率的磁碟系統使用-**除了使用實體磁碟，請考慮將使用的磁碟控制卡和纜線的類型。</span><span class="sxs-lookup"><span data-stu-id="faac4-290">**Use the most efficient disk systems available -** In addition to the physical disk that is used, consider the type of disk controller and cabling that will be used.</span></span> <span data-ttu-id="faac4-291">有效的磁碟子系統也應該提供支援插斷仲裁或中斷避免降低磁碟 I/O 所造成的處理器插斷活動的驅動程式。</span><span class="sxs-lookup"><span data-stu-id="faac4-291">An efficient disk subsystem should also provide drivers that support interrupt moderation or interrupt avoidance to mitigate processor interrupt activity caused by disk I/O.</span></span>  
  
-   <span data-ttu-id="faac4-292">**請確定您使用適當的 RAID 設定-**使用 RAID 10 可以發揮 （條狀配置與鏡像） 的最佳效能和容錯功能。</span><span class="sxs-lookup"><span data-stu-id="faac4-292">**Ensure that you are using the appropriate RAID configuration -** Use RAID 10 (striping and mirroring) for optimal performance and fault tolerance.</span></span> <span data-ttu-id="faac4-293">代價是，使用 RAID 10 可以發揮是高度耗費資源。</span><span class="sxs-lookup"><span data-stu-id="faac4-293">The tradeoff is that using RAID 10 is expensive.</span></span> <span data-ttu-id="faac4-294">請避免使用 RAID 5，當您有大量的寫入作業。</span><span class="sxs-lookup"><span data-stu-id="faac4-294">Avoid using RAID 5 when you have extensive write operations.</span></span> <span data-ttu-id="faac4-295">如需 BizTalk Server 環境中實作 RAID 的詳細資訊，請參閱 「 磁碟基礎結構 」 一節中[BizTalk Server 資料庫最佳化白皮書](http://go.microsoft.com/fwlink/?LinkID=101578)(http://go.microsoft.com/fwlink/?LinkID=101578)。</span><span class="sxs-lookup"><span data-stu-id="faac4-295">For more information about implementing RAID in a BizTalk Server environment, see the section “Disk Infrastructure” in the [BizTalk Server Database Optimization white paper](http://go.microsoft.com/fwlink/?LinkID=101578) (http://go.microsoft.com/fwlink/?LinkID=101578).</span></span>  
  
-   <span data-ttu-id="faac4-296">**請考慮使用資料庫資料分割-**如果資料庫瓶頸，請考慮使用資料庫資料分割，並將磁碟對應至特定資料表及交易記錄檔。</span><span class="sxs-lookup"><span data-stu-id="faac4-296">**Consider using database partitions -** If you have a database bottleneck, consider using database partitions and mapping disks to specific tables and transaction logs.</span></span> <span data-ttu-id="faac4-297">資料分割的主要目的是為了克服磁碟瓶頸對於大型資料表。</span><span class="sxs-lookup"><span data-stu-id="faac4-297">The primary purpose of partitions is to overcome disk bottlenecks for large tables.</span></span> <span data-ttu-id="faac4-298">如果您有大量的資料列的資料表，且您判斷它是瓶頸的來源，請考慮使用資料分割。</span><span class="sxs-lookup"><span data-stu-id="faac4-298">If you have a table with large number of rows and you determine that it is the source of a bottleneck, consider using partitions.</span></span> <span data-ttu-id="faac4-299">針對 SQL Server，您可以使用檔案群組來改善 I/O 效能。</span><span class="sxs-lookup"><span data-stu-id="faac4-299">For SQL Server, you can use file groups to improve I/O performance.</span></span> <span data-ttu-id="faac4-300">您可以將資料表與檔案群組產生關聯，並將與特定的硬碟產生關聯的檔案群組。</span><span class="sxs-lookup"><span data-stu-id="faac4-300">You can associate tables with file groups, and then associate the file groups with a specific hard disk.</span></span> <span data-ttu-id="faac4-301">如需有關如何使用 BizTalk Server 資料庫最佳化的檔案群組的詳細資訊，請參閱[最佳化的檔案群組的資料庫](~/technical-guides/optimizing-filegroups-for-the-databases2.md)。</span><span class="sxs-lookup"><span data-stu-id="faac4-301">For more information about using optimizing filegroups for the BizTalk Server databases, see [Optimizing Filegroups for the Databases](~/technical-guides/optimizing-filegroups-for-the-databases2.md).</span></span>  
  
-   <span data-ttu-id="faac4-302">**請考慮增加實體記憶體中，如果您有過多的分頁錯誤-**值很高**記憶體： Pages/sec**效能計數器可能代表過度分頁將會增加磁碟 I / 0。</span><span class="sxs-lookup"><span data-stu-id="faac4-302">**Consider adding physical memory, if you have excessive page faults -** A high value for the **Memory: Pages/sec** performance counter could indicate excessive paging which will increase disk I/0.</span></span> <span data-ttu-id="faac4-303">如果發生這種情況，請考慮新增實體記憶體，以降低磁碟 I/O，並提高效能。</span><span class="sxs-lookup"><span data-stu-id="faac4-303">If this occurs, consider adding physical memory to reduce disk I/O and increase performance.</span></span>  
  
-   <span data-ttu-id="faac4-304">**請考慮磁碟具有較高的 RPM 評等，或使用存放區域網路 (SAN) 裝置-**磁碟具有更高 RPM 評等提供改進的效能相較於磁碟具有較低 RPM 評等。</span><span class="sxs-lookup"><span data-stu-id="faac4-304">**Consider using a disk with a higher RPM rating or using a Storage Area Network (SAN) device -** Disks with higher RPM ratings offer improved performance compared to disks with lower RPM ratings.</span></span> <span data-ttu-id="faac4-305">SAN 裝置通常會提供最上層效能而在錢。</span><span class="sxs-lookup"><span data-stu-id="faac4-305">SAN devices typically offer top tier performance but at a price premium.</span></span>  
  
-   <span data-ttu-id="faac4-306">請遵循建議[最佳化資料庫效能](~/technical-guides/optimizing-database-performance.md)。</span><span class="sxs-lookup"><span data-stu-id="faac4-306">Follow the recommendations in [Optimizing Database Performance](~/technical-guides/optimizing-database-performance.md).</span></span> <span data-ttu-id="faac4-307">本主題提供數個最佳化之前和之後設定 BizTalk Server 資料庫效能的建議。</span><span class="sxs-lookup"><span data-stu-id="faac4-307">This topic provides several recommendations for optimizing database performance both before and after configuring BizTalk Server.</span></span>  
  
### <a name="cpu-bottlenecks"></a><span data-ttu-id="faac4-308">CPU 瓶頸</span><span class="sxs-lookup"><span data-stu-id="faac4-308">CPU bottlenecks</span></span>  
 <span data-ttu-id="faac4-309">每個伺服器執行的應用程式取得 CPU 的時間配量。</span><span class="sxs-lookup"><span data-stu-id="faac4-309">Each application that runs on a server gets a time slice of the CPU.</span></span> <span data-ttu-id="faac4-310">CPU 可能會有效率地處理所有的電腦上，執行的處理序，或可能超載。</span><span class="sxs-lookup"><span data-stu-id="faac4-310">The CPU might be able to efficiently handle all of the processes running on the computer, or it might be overloaded.</span></span> <span data-ttu-id="faac4-311">藉由檢查處理器活動及活動的個別處理程序包括執行緒建立、 切換執行緒和內容切換，您可以深入了處理器工作負載和效能。</span><span class="sxs-lookup"><span data-stu-id="faac4-311">By examining processor activity and the activity of individual processes including thread creation, thread switching and context switching, you can gain insight into processor workload and performance.</span></span>  
  
#### <a name="you-may-have-a-cpu-bottleneck-if"></a><span data-ttu-id="faac4-312">如果，可能會有 CPU 瓶頸...</span><span class="sxs-lookup"><span data-stu-id="faac4-312">You may have a CPU bottleneck if…</span></span>  
  
-   <span data-ttu-id="faac4-313">值**處理器\\%Processor Time**效能計數器通常超過 75%。</span><span class="sxs-lookup"><span data-stu-id="faac4-313">The value of the **Processor\\% Processor Time** performance counter often exceeds 75%.</span></span>  
  
-   <span data-ttu-id="faac4-314">值**System\ Processor Queue Length**效能計數器為 2 或多個 for 持續一段時間。</span><span class="sxs-lookup"><span data-stu-id="faac4-314">The value of the **System\ Processor Queue Length** performance counter is 2 or more for a sustained period of time.</span></span>  
  
-   <span data-ttu-id="faac4-315">值**處理器\\%Privileged Time**或**System\Context Switches/sec**有異常高的效能計數器。</span><span class="sxs-lookup"><span data-stu-id="faac4-315">The value of the **Processor\\% Privileged Time** or **System\Context Switches/sec** performance counters are unusually high.</span></span>  
  
     <span data-ttu-id="faac4-316">如果值**Processor\ %Processor Time**效能計數器很高，則佇列會發生，並在大部分情況下的值**System\ Processor Queue Length**也會比較高。</span><span class="sxs-lookup"><span data-stu-id="faac4-316">If the value of **Processor\ % Processor Time** performance counter is high, then queuing occurs, and in most scenarios the value of **System\ Processor Queue Length** will also be high.</span></span>  
  
#### <a name="performance-counters-for-measuring-cpu-bottlenecks"></a><span data-ttu-id="faac4-317">效能計數器來測量 CPU 瓶頸</span><span class="sxs-lookup"><span data-stu-id="faac4-317">Performance counters for measuring CPU bottlenecks</span></span>  
 <span data-ttu-id="faac4-318">下列效能計數器應該用來判斷您的系統是否發生 CPU 相關的瓶頸：</span><span class="sxs-lookup"><span data-stu-id="faac4-318">The following performance counters should be used to determine if your system is experiencing a CPU related bottleneck:</span></span>  
  
-   <span data-ttu-id="faac4-319">**處理器\\%處理器時間**</span><span class="sxs-lookup"><span data-stu-id="faac4-319">**Processor\\% Processor Time**</span></span>  
  
    -   <span data-ttu-id="faac4-320">閾值： 應低於 85%。</span><span class="sxs-lookup"><span data-stu-id="faac4-320">Threshold: Should be less than 85%.</span></span>  
  
    -   <span data-ttu-id="faac4-321">重要： 此計數器是處理器活動的主要指示器。</span><span class="sxs-lookup"><span data-stu-id="faac4-321">Significance: This counter is the primary indicator of processor activity.</span></span> <span data-ttu-id="faac4-322">高值許多不一定會是不正確。</span><span class="sxs-lookup"><span data-stu-id="faac4-322">High values many not necessarily be bad.</span></span> <span data-ttu-id="faac4-323">不過，其他處理器相關的計數器會以線性方式例如增加**處理器\\%Privileged Time**或**System\Processor Queue Length**，CPU 使用率過高可能值得調查。</span><span class="sxs-lookup"><span data-stu-id="faac4-323">However, if the other processor-related counters are increasing linearly such as **Processor\\% Privileged Time** or **System\Processor Queue Length**, high CPU utilization may be worth investigating.</span></span>  
  
-   <span data-ttu-id="faac4-324">**處理器\\%特殊權限時間**</span><span class="sxs-lookup"><span data-stu-id="faac4-324">**Processor\\% Privileged Time**</span></span>  
  
    -   <span data-ttu-id="faac4-325">臨界值： 過去一直是 75%的圖形會指出是效能瓶頸。</span><span class="sxs-lookup"><span data-stu-id="faac4-325">Threshold: A figure that is consistently over 75 percent indicates a bottleneck.</span></span>  
  
    -   <span data-ttu-id="faac4-326">重要： 此計數器表示執行緒在特權模式下執行的時間的百分比。</span><span class="sxs-lookup"><span data-stu-id="faac4-326">Significance: This counter indicates the percentage of time a thread runs in privileged mode.</span></span> <span data-ttu-id="faac4-327">當您的應用程式呼叫作業系統函式 （例如來執行檔案或網路 I/O，或配置記憶體） 時，這些作業系統函式會執行特殊權限模式。</span><span class="sxs-lookup"><span data-stu-id="faac4-327">When your application calls operating system functions (for example to perform file or network I/O or to allocate memory), these operating system functions are executed in privileged mode.</span></span>  
  
-   <span data-ttu-id="faac4-328">**處理器\\插斷時間百分比**</span><span class="sxs-lookup"><span data-stu-id="faac4-328">**Processor\\% Interrupt Time**</span></span>  
  
    -   <span data-ttu-id="faac4-329">臨界值： 取決於處理器。</span><span class="sxs-lookup"><span data-stu-id="faac4-329">Threshold: Depends on the processor.</span></span>  
  
    -   <span data-ttu-id="faac4-330">重要： 此計數器表示百分比的處理器花費在接收和服務硬體插斷的時間。</span><span class="sxs-lookup"><span data-stu-id="faac4-330">Significance: This counter indicates the percentage of time the processor spends receiving and servicing hardware interrupts.</span></span> <span data-ttu-id="faac4-331">這個值是產生插斷，例如網路介面卡的裝置活動的間接指示器。</span><span class="sxs-lookup"><span data-stu-id="faac4-331">This value is an indirect indicator of the activity of devices that generate interrupts, such as network adapters.</span></span> <span data-ttu-id="faac4-332">在此計數器指出可能硬體問題。</span><span class="sxs-lookup"><span data-stu-id="faac4-332">A dramatic increase in this counter indicates potential hardware problems.</span></span>  
  
-   <span data-ttu-id="faac4-333">**System\Processor Queue Length**</span><span class="sxs-lookup"><span data-stu-id="faac4-333">**System\Processor Queue Length**</span></span>  
  
    -   <span data-ttu-id="faac4-334">臨界值： 一致高於 2 平均值會指出是效能瓶頸。</span><span class="sxs-lookup"><span data-stu-id="faac4-334">Threshold: An average value consistently higher than 2 indicates a bottleneck.</span></span>  
  
    -   <span data-ttu-id="faac4-335">重要： 如果有多個工作準備好要執行比處理器，執行緒排入佇列。</span><span class="sxs-lookup"><span data-stu-id="faac4-335">Significance: If there are more tasks ready to run than there are processors, threads queue up.</span></span> <span data-ttu-id="faac4-336">處理器佇列已準備好，但您不能因為另一個執行緒目前正在執行的處理器來執行執行緒的集合。</span><span class="sxs-lookup"><span data-stu-id="faac4-336">The processor queue is the collection of threads that are ready but not able to be executed by the processor because another thread is currently executing.</span></span> <span data-ttu-id="faac4-337">持續性或重複執行佇列的兩個以上的執行緒是清除指示處理器瓶頸。</span><span class="sxs-lookup"><span data-stu-id="faac4-337">A sustained or recurring queue of more than two threads is a clear indication of a processor bottleneck.</span></span> <span data-ttu-id="faac4-338">藉由減少平行處理原則，在這些情況下可能會得到更多的輸送量。</span><span class="sxs-lookup"><span data-stu-id="faac4-338">You may get more throughput by reducing parallelism in those cases.</span></span>  
  
         <span data-ttu-id="faac4-339">您可以使用此計數器搭配**處理器\\%Processor Time**計數器以判斷您的應用程式的更多的 Cpu 可以受益。</span><span class="sxs-lookup"><span data-stu-id="faac4-339">You can use this counter in conjunction with the **Processor\\% Processor Time** counter to determine if your application can benefit from more CPUs.</span></span> <span data-ttu-id="faac4-340">沒有單一佇列的處理器時間，即使在多處理器電腦上。</span><span class="sxs-lookup"><span data-stu-id="faac4-340">There is a single queue for processor time, even on multiprocessor computers.</span></span> <span data-ttu-id="faac4-341">因此，在多處理器電腦上，除以處理器佇列長度 (PQL) 值的工作負載的處理器數目。</span><span class="sxs-lookup"><span data-stu-id="faac4-341">Therefore, in a multiprocessor computer, divide the Processor Queue Length (PQL) value by the number of processors servicing the workload.</span></span>  
  
         <span data-ttu-id="faac4-342">若 CPU 非常忙碌 （90%或更高的使用率） 且 PQL 平均值高於持續 2 每個處理器，您可能無法受益新增 Cpu 處理器瓶頸。</span><span class="sxs-lookup"><span data-stu-id="faac4-342">If the CPU is very busy (90 percent or higher utilization) and the PQL average is consistently higher than 2 per processor, you may have a processor bottleneck that could benefit from adding CPUs.</span></span> <span data-ttu-id="faac4-343">或者，您無法減少的應用程式層級的多個執行緒和佇列。</span><span class="sxs-lookup"><span data-stu-id="faac4-343">Or, you could reduce the number of threads and queue more at the application level.</span></span> <span data-ttu-id="faac4-344">這會導致較少的內容切換，以及較少的環境切換是適合用來降低 CPU 負載。</span><span class="sxs-lookup"><span data-stu-id="faac4-344">This will cause less context switching, and less context switching is good for reducing CPU load.</span></span> <span data-ttu-id="faac4-345">處理器時間的要求到達隨機，而執行緒要求異常大量的處理器時間 PQL 值為 2 或更低 CPU 使用率最高的一個常見原因。</span><span class="sxs-lookup"><span data-stu-id="faac4-345">A common reason for a PQL value of 2 or higher with low CPU utilization is that requests for processor time arrive randomly and threads demand irregular amounts of time from the processor.</span></span> <span data-ttu-id="faac4-346">這表示處理器不是瓶頸，但應該可以改善應用程式執行緒邏輯。</span><span class="sxs-lookup"><span data-stu-id="faac4-346">This means that the processor is not a bottleneck but that the application threading logic should be improved.</span></span>  
  
-   <span data-ttu-id="faac4-347">**System\Context Switches/sec**</span><span class="sxs-lookup"><span data-stu-id="faac4-347">**System\Context Switches/sec**</span></span>  
  
    -   <span data-ttu-id="faac4-348">臨界值： 一般而言，內容切換率小於每個處理器每秒 5000 不值得擔心。</span><span class="sxs-lookup"><span data-stu-id="faac4-348">Threshold: As a general rule, a context switching rate less than 5,000 per second per processor is not worth worrying about.</span></span> <span data-ttu-id="faac4-349">如果內容切換率超過 15,000 每秒針對每個處理器，然後內容切換成為瓶頸。</span><span class="sxs-lookup"><span data-stu-id="faac4-349">If context switching rates exceed 15,000 per second per processor, then context switching can become a bottleneck.</span></span>  
  
    -   <span data-ttu-id="faac4-350">當高優先順序的執行緒優先執行較低優先順序的執行緒，目前正在執行，或當較高優先順序的執行緒會封鎖其他執行緒發生內容切換的意義:。</span><span class="sxs-lookup"><span data-stu-id="faac4-350">Significance: Context switching occurs when a higher priority thread preempts a lower priority thread that is currently running or when a high priority thread blocks other threads.</span></span> <span data-ttu-id="faac4-351">多執行緒共用相同的優先權層級，就會發生內容切換的高層級。</span><span class="sxs-lookup"><span data-stu-id="faac4-351">High levels of context switching can occur when many threads share the same priority level.</span></span> <span data-ttu-id="faac4-352">這通常表示有競爭系統上處理器的執行緒太多。</span><span class="sxs-lookup"><span data-stu-id="faac4-352">This often indicates that there are too many threads competing for the processors on the system.</span></span> <span data-ttu-id="faac4-353">如果處理器使用量和內容切換層級的較低，這通常是表示執行緒會被封鎖。</span><span class="sxs-lookup"><span data-stu-id="faac4-353">If both processor utilization and context switching levels are low, this is often an indication that threads are blocked.</span></span>  
  
#### <a name="resolving-cpu-bottlenecks"></a><span data-ttu-id="faac4-354">解決 CPU 瓶頸</span><span class="sxs-lookup"><span data-stu-id="faac4-354">Resolving CPU bottlenecks</span></span>  
 <span data-ttu-id="faac4-355">第一個步驟是找出哪些處理程序會耗用過多的處理器時間。</span><span class="sxs-lookup"><span data-stu-id="faac4-355">The first step is to identify which process is consuming excessive processor time.</span></span> <span data-ttu-id="faac4-356">使用 Windows**工作管理員**來識別哪些程序耗用的 CPU 高等級藉由查看**CPU**上的資料行**處理程序**頁面。</span><span class="sxs-lookup"><span data-stu-id="faac4-356">Use Windows **Task Manager** to identify which process is consuming high levels of CPU by looking at the **CPU** column on the **Processes** page.</span></span> <span data-ttu-id="faac4-357">您也可以決定這藉由監視**程序\\%Processor Time**效能監視器] 和 [選取您想要監視的處理程序中。</span><span class="sxs-lookup"><span data-stu-id="faac4-357">You can also determine this by monitoring **Process\\%Processor Time** in Performance Monitor and selecting the processes you want to monitor.</span></span>  
  
 <span data-ttu-id="faac4-358">另一個功能強大的工具，來判斷哪些處理程序正在耗用過多 CPU 時間是 Visual Studio Team System 分析工具所提供的 Visual Studio Team System (VSTS) 套件。</span><span class="sxs-lookup"><span data-stu-id="faac4-358">Another powerful tool for determining which processes are consuming excessive CPU time is the Visual Studio Team System Profiler that is available with the Visual Studio Team System (VSTS) suite.</span></span> <span data-ttu-id="faac4-359">如需有關使用 Visual Studio Team System 分析工具的詳細資訊，請參閱 Visual Studio Team System 文件。</span><span class="sxs-lookup"><span data-stu-id="faac4-359">For more information about using the Visual Studio Team System Profiler, see the Visual Studio Team System documentation.</span></span>  
  
 <span data-ttu-id="faac4-360">之後您判斷 CPU 瓶頸，您有數個選項，包括下列：</span><span class="sxs-lookup"><span data-stu-id="faac4-360">After you determine that your CPU is a bottleneck you have several options, including the following:</span></span>  
  
-   <span data-ttu-id="faac4-361">如果您有多執行緒應用程式，請加入多個處理器。</span><span class="sxs-lookup"><span data-stu-id="faac4-361">Add multiple processors if you have multi-threaded applications.</span></span> <span data-ttu-id="faac4-362">請考慮升級至更強大的處理器，如果您的應用程式是單一執行緒。</span><span class="sxs-lookup"><span data-stu-id="faac4-362">Consider upgrading to a more powerful processor if your application is single-threaded.</span></span>  
  
-   <span data-ttu-id="faac4-363">如果您觀察有高比率的內容切換，請考慮減少您的處理序的執行緒計數前的處理器數目增加。</span><span class="sxs-lookup"><span data-stu-id="faac4-363">If you observe a high rate of context switching, consider reducing the thread count for your process before increasing the number of processors.</span></span>  
  
-   <span data-ttu-id="faac4-364">分析和微調應用程式造成高 CPU 使用率。</span><span class="sxs-lookup"><span data-stu-id="faac4-364">Analyze and tune the application that is causing high CPU utilization.</span></span> <span data-ttu-id="faac4-365">您可以使用 ADPLUS 公用程式傾印執行的處理序，並使用 Windbg 分析可能的原因。</span><span class="sxs-lookup"><span data-stu-id="faac4-365">You can dump the running process by using the ADPLUS utility and analyze the cause by using Windbg.</span></span> <span data-ttu-id="faac4-366">這些公用程式是 Windows 偵錯工具組的一部分。</span><span class="sxs-lookup"><span data-stu-id="faac4-366">These utilities are part of the Windows debugging toolkit.</span></span> <span data-ttu-id="faac4-367">您可以下載這些工具從[Debugging Tools for Windows](http://go.microsoft.com/fwlink/?LinkID=106624) (http://go.microsoft.com/fwlink/?LinkID=106624)。</span><span class="sxs-lookup"><span data-stu-id="faac4-367">You can download these tools from [Debugging Tools for Windows](http://go.microsoft.com/fwlink/?LinkID=106624) (http://go.microsoft.com/fwlink/?LinkID=106624).</span></span>  
  
-   <span data-ttu-id="faac4-368">分析您的應用程式隔離所花的時間執行的最大數量的子系統所產生的檢測記錄檔。</span><span class="sxs-lookup"><span data-stu-id="faac4-368">Analyze the instrumentation log generated by your application to isolate the subsystem that is taking the maximum amount of time for execution.</span></span> <span data-ttu-id="faac4-369">判斷程式碼檢閱是否會比只微調 BizTalk Server 環境更有效率。</span><span class="sxs-lookup"><span data-stu-id="faac4-369">Determine whether a code review would be more beneficial than just tuning the BizTalk Server environment.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="faac4-370">雖然您可以變更應用程式的處理序優先權層級使用**工作管理員**或從命令提示字元中，您通常應該避免這樣。</span><span class="sxs-lookup"><span data-stu-id="faac4-370">Although you can change the process priority level of an application by using **Task Manager** or from a command prompt, you should generally avoid doing so.</span></span>  
  
### <a name="memory-bottlenecks"></a><span data-ttu-id="faac4-371">記憶體瓶頸</span><span class="sxs-lookup"><span data-stu-id="faac4-371">Memory bottlenecks</span></span>  
 <span data-ttu-id="faac4-372">當評估記憶體相關的瓶頸，請考慮不必要的配置、 效率不佳清除，而且不適當快取以及狀態管理機制。</span><span class="sxs-lookup"><span data-stu-id="faac4-372">When evaluating memory-related bottlenecks, consider unnecessary allocations, inefficient clean up, and inappropriate caching and state management mechanisms.</span></span> <span data-ttu-id="faac4-373">若要解決記憶體相關的瓶頸，最佳化您的程式碼才能避免這些問題，然後調整配置給您的應用程式的記憶體數量。</span><span class="sxs-lookup"><span data-stu-id="faac4-373">To resolve memory-related bottlenecks, optimize your code to eliminate these issues and then tune the amount of memory allocated to your application(s).</span></span> <span data-ttu-id="faac4-374">如果您確定在微調期間發生的記憶體爭用和過度分頁，您可能需要額外的實體記憶體新增至伺服器。</span><span class="sxs-lookup"><span data-stu-id="faac4-374">If you determine during tuning that memory contention and excessive paging are occurring, you may need to add additional physical memory to the server.</span></span> <span data-ttu-id="faac4-375">記憶體不足會導致增加應用程式的虛擬位址空間與磁碟的分頁。</span><span class="sxs-lookup"><span data-stu-id="faac4-375">Low memory leads to increased paging of an application's virtual address space to and from disk.</span></span> <span data-ttu-id="faac4-376">如果分頁變得過多，會增加磁碟 I/O，並對整體系統效能造成負面影響。</span><span class="sxs-lookup"><span data-stu-id="faac4-376">If paging becomes excessive, disk I/O will increase and negatively impact overall system performance.</span></span>  
  
#### <a name="you-might-have-a-memory-bottleneck-if"></a><span data-ttu-id="faac4-377">如果，可能有記憶體瓶頸...</span><span class="sxs-lookup"><span data-stu-id="faac4-377">You might have a memory bottleneck if…</span></span>  
  
-   <span data-ttu-id="faac4-378">值**Memory\Available MBytes**效能計數器很低，可能是因為系統記憶體限制或應用程式沒有釋出記憶體。</span><span class="sxs-lookup"><span data-stu-id="faac4-378">The value of the **Memory\Available MBytes** performance counter is low, either due to system memory limitations or an application that is not releasing memory.</span></span> <span data-ttu-id="faac4-379">監視值**Process\Working Set**執行每個處理序的效能計數器。</span><span class="sxs-lookup"><span data-stu-id="faac4-379">Monitor the value of the **Process\Working Set** performance counter for each process that is running.</span></span> <span data-ttu-id="faac4-380">如果值**Process\Working Set**維持高處理程序不在作用中，即使這可能是處理程序不釋放記憶體其應有的指示。</span><span class="sxs-lookup"><span data-stu-id="faac4-380">If value of the **Process\Working Set** remains high even when the process is not active, this may be an indication that the process is not releasing memory as it should.</span></span>  
  
-   <span data-ttu-id="faac4-381">值**Memory\Pages/sec**效能計數器很高。</span><span class="sxs-lookup"><span data-stu-id="faac4-381">The value of the **Memory\Pages/sec** performance counter is high.</span></span> <span data-ttu-id="faac4-382">平均**Memory\Pages Input/sec**除以平均**Memory\Page Reads/sec**提供每秒磁碟讀取頁面數目。</span><span class="sxs-lookup"><span data-stu-id="faac4-382">The average of **Memory\Pages Input/sec** divided by average of **Memory\Page Reads/sec** gives the number of pages per disk read.</span></span> <span data-ttu-id="faac4-383">這個值通常不可以超過五秒頁面數。</span><span class="sxs-lookup"><span data-stu-id="faac4-383">This value should not generally exceed five pages per second.</span></span> <span data-ttu-id="faac4-384">大於 5 的頁面每秒的值表示系統花太多時間分頁，且需要更多的記憶體 （假設應用程式已經過最佳化）。</span><span class="sxs-lookup"><span data-stu-id="faac4-384">A value greater than five pages per second indicates that the system is spending too much time paging and requires more memory (assuming that the application has been optimized).</span></span>  
  
#### <a name="performance-counters-for-measuring-memory-bottlenecks"></a><span data-ttu-id="faac4-385">效能計數器來測量記憶體瓶頸</span><span class="sxs-lookup"><span data-stu-id="faac4-385">Performance counters for measuring memory bottlenecks</span></span>  
 <span data-ttu-id="faac4-386">下列效能計數器應該用來判斷您的系統是否遇到記憶體相關的瓶頸：</span><span class="sxs-lookup"><span data-stu-id="faac4-386">The following performance counters should be used to determine if your system is experiencing a memory related bottleneck:</span></span>  
  
-   <span data-ttu-id="faac4-387">**Memory\Available Mbytes**</span><span class="sxs-lookup"><span data-stu-id="faac4-387">**Memory\Available Mbytes**</span></span>  
  
    -   <span data-ttu-id="faac4-388">臨界值： 一致的值低於 20 到 25%的已安裝的 RAM 是記憶體不足的指示。</span><span class="sxs-lookup"><span data-stu-id="faac4-388">Threshold: A consistent value of less than 20 to 25 percent of installed RAM is an indication of insufficient memory.</span></span>  
  
    -   <span data-ttu-id="faac4-389">重要： 這表示電腦上執行的處理序可用的實體記憶體數量。</span><span class="sxs-lookup"><span data-stu-id="faac4-389">Significance: This indicates the amount of physical memory available to processes running on the computer.</span></span> <span data-ttu-id="faac4-390">請注意，此計數器會顯示最後觀察到的值只。</span><span class="sxs-lookup"><span data-stu-id="faac4-390">Note that this counter displays the last observed value only.</span></span> <span data-ttu-id="faac4-391">它不是平均值。</span><span class="sxs-lookup"><span data-stu-id="faac4-391">It is not an average.</span></span>  
  
-   <span data-ttu-id="faac4-392">**Memory\Page Reads/sec**</span><span class="sxs-lookup"><span data-stu-id="faac4-392">**Memory\Page Reads/sec**</span></span>  
  
    -   <span data-ttu-id="faac4-393">臨界值： 持續性的五個以上的值表示大量的讀取要求的分頁錯誤。</span><span class="sxs-lookup"><span data-stu-id="faac4-393">Threshold: Sustained values of more than five indicate a large number of page faults for read requests.</span></span>  
  
    -   <span data-ttu-id="faac4-394">重要： 此計數器指出處理程序的工作集是太大，導致記憶體分頁到磁碟的可用實體記憶體。</span><span class="sxs-lookup"><span data-stu-id="faac4-394">Significance: This counter indicates that the working set of a process is too large for the available physical memory which is causing memory to page to disk.</span></span> <span data-ttu-id="faac4-395">它會顯示讀取作業數目，而不考慮每個作業所擷取的頁數。</span><span class="sxs-lookup"><span data-stu-id="faac4-395">It shows the number of read operations, without regard to the number of pages retrieved in each operation.</span></span> <span data-ttu-id="faac4-396">較高的值表示記憶體瓶頸。</span><span class="sxs-lookup"><span data-stu-id="faac4-396">Higher values indicate a memory bottleneck.</span></span>  
  
         <span data-ttu-id="faac4-397">如果較低的頁面讀取作業率伴隨的數值偏高**實體磁碟\\%Disk Time**和**Physical disk\avg.。磁碟佇列長度**，可能存在的磁碟 I/O 瓶頸狀況。</span><span class="sxs-lookup"><span data-stu-id="faac4-397">If a low rate of page-read operations coincides with high values for **Physical Disk\\% Disk Time** and **Physical Disk\Avg. Disk Queue Length**, a disk I/O bottleneck condition may exist.</span></span> <span data-ttu-id="faac4-398">如果佇列長度的增加未伴隨頁面讀取速率降低，記憶體瓶頸存在實體記憶體不足所造成。</span><span class="sxs-lookup"><span data-stu-id="faac4-398">If an increase in queue length is not accompanied by a decrease in the pages-read rate, a memory bottleneck exists due to insufficient physical memory.</span></span>  
  
-   <span data-ttu-id="faac4-399">**Memory\Pages/sec**</span><span class="sxs-lookup"><span data-stu-id="faac4-399">**Memory\Pages/sec**</span></span>  
  
    -   <span data-ttu-id="faac4-400">臨界值： 持續超過五個值會指出是效能瓶頸。</span><span class="sxs-lookup"><span data-stu-id="faac4-400">Threshold: A sustained value of more than five indicates a bottleneck.</span></span>  
  
    -   <span data-ttu-id="faac4-401">重要： 此計數器表示的讀取或寫入為解決硬體分頁錯誤而對磁碟頁面的速率。</span><span class="sxs-lookup"><span data-stu-id="faac4-401">Significance: This counter indicates the rate at which pages are read from or written to disk to resolve hard page faults.</span></span> <span data-ttu-id="faac4-402">將的值相乘**Physical disk\avg.。Disk sec/Transfer**和**Memory\Pages/sec**效能計數器。</span><span class="sxs-lookup"><span data-stu-id="faac4-402">Multiply the values of the **Physical Disk\Avg. Disk sec/Transfer** and **Memory\Pages/sec** performance counters.</span></span> <span data-ttu-id="faac4-403">如果這些值的乘積超過**0.1**，分頁利用超過 10%的磁碟存取時間，表示實體記憶體不足，無法使用。</span><span class="sxs-lookup"><span data-stu-id="faac4-403">If the product of these values exceeds **0.1**, paging is utilizing more than 10 percent of disk access time, which indicates that insufficient physical memory is available.</span></span>  
  
-   <span data-ttu-id="faac4-404">**Memory\Pool Nonpaged 的 Bytes**</span><span class="sxs-lookup"><span data-stu-id="faac4-404">**Memory\Pool Nonpaged Bytes**</span></span>  
  
    -   <span data-ttu-id="faac4-405">臨界值： 監看值**Memory\Pool Nonpaged Bytes**增加 10%以上的值在系統啟動。</span><span class="sxs-lookup"><span data-stu-id="faac4-405">Threshold: Watch the value of **Memory\Pool Nonpaged Bytes** for an increase of 10 percent or more from its value at system startup.</span></span>  
  
    -   <span data-ttu-id="faac4-406">意義： 增加 10%或更多的值，在啟動時可能表示有記憶體流失。</span><span class="sxs-lookup"><span data-stu-id="faac4-406">Significance: An increase of 10 percent or more from the value at startup may be an indication of a memory leak.</span></span>  
  
-   <span data-ttu-id="faac4-407">**Server\Pool Nonpaged 的失敗**</span><span class="sxs-lookup"><span data-stu-id="faac4-407">**Server\Pool Nonpaged Failures**</span></span>  
  
    -   <span data-ttu-id="faac4-408">臨界值： 一般的非零值表示發生瓶頸。</span><span class="sxs-lookup"><span data-stu-id="faac4-408">Threshold: Regular nonzero values indicate a bottleneck.</span></span>  
  
    -   <span data-ttu-id="faac4-409">重要： 此計數器表示從非分頁集區的配置失敗次數。</span><span class="sxs-lookup"><span data-stu-id="faac4-409">Significance: This counter indicates the number of times allocations from the non-paged pool have failed.</span></span> <span data-ttu-id="faac4-410">非分頁集區包含從處理序的虛擬位址空間，不要讓空出給分頁檔，在磁碟上，例如處理程序的核心物件表格的網頁。</span><span class="sxs-lookup"><span data-stu-id="faac4-410">The non-paged pool contains pages from a process's virtual address space that are not to be swapped out to the page file on disk, such as a process kernel object table.</span></span> <span data-ttu-id="faac4-411">非分頁集區的可用性會決定多少處理程序、 執行緒和其他可以建立這類物件。</span><span class="sxs-lookup"><span data-stu-id="faac4-411">The availability of the non-paged pool determines how many processes, threads, and other such objects can be created.</span></span> <span data-ttu-id="faac4-412">當從非分頁集區的配置失敗時，這可能是因為記憶體流失，處理序中，特別是如果處理器使用量已不會隨之增加。</span><span class="sxs-lookup"><span data-stu-id="faac4-412">When allocations from the non-paged pool fail, this can be due to a memory leak in a process, particularly if processor usage has not increased accordingly.</span></span>  
  
-   <span data-ttu-id="faac4-413">**Server\Pool 分頁失敗**</span><span class="sxs-lookup"><span data-stu-id="faac4-413">**Server\Pool Paged Failures**</span></span>  
  
    -   <span data-ttu-id="faac4-414">臨界值： 沒有特定的值。</span><span class="sxs-lookup"><span data-stu-id="faac4-414">Threshold: No specific value.</span></span>  
  
    -   <span data-ttu-id="faac4-415">意義： 此計數器會指出從該分頁集區的配置失敗次數。</span><span class="sxs-lookup"><span data-stu-id="faac4-415">Significance: This counter indicates the number of times allocations from the paged pool have failed.</span></span> <span data-ttu-id="faac4-416">此計數器的正數值則表示電腦沒有足夠的實體記憶體或 Windows 分頁檔太小。</span><span class="sxs-lookup"><span data-stu-id="faac4-416">A positive value for this counter is an indication that the computer has insufficient physical memory or that the Windows paging file is too small.</span></span>  
  
-   <span data-ttu-id="faac4-417">**Server\Pool Nonpaged 的尖峰**</span><span class="sxs-lookup"><span data-stu-id="faac4-417">**Server\Pool Nonpaged Peak**</span></span>  
  
    -   <span data-ttu-id="faac4-418">臨界值： 沒有特定的值。</span><span class="sxs-lookup"><span data-stu-id="faac4-418">Threshold: No specific value.</span></span>  
  
    -   <span data-ttu-id="faac4-419">重要： 這是伺服器已保留在任何一個時間點使用的非分頁集區中的位元組數目上限。</span><span class="sxs-lookup"><span data-stu-id="faac4-419">Significance: This is the maximum number of bytes in the non-paged pool that the server has reserved for use at any one point.</span></span> <span data-ttu-id="faac4-420">它會指出應該具有電腦的實體記憶體數量。</span><span class="sxs-lookup"><span data-stu-id="faac4-420">It indicates how much physical memory the computer should have.</span></span> <span data-ttu-id="faac4-421">因為非分頁集區必須位於實體記憶體，而且必須要有一些記憶體，剩下的其他作業，做法則電腦應該已安裝是 4 倍的值表示此計數器的實體記憶體。</span><span class="sxs-lookup"><span data-stu-id="faac4-421">Because the non-paged pool must be resident in physical memory and because there has to be some memory left over for other operations, as a rule of thumb the computer should have installed physical memory that is 4 times the value indicated for this counter.</span></span>  
  
-   <span data-ttu-id="faac4-422">**Memory\Cache Bytes**</span><span class="sxs-lookup"><span data-stu-id="faac4-422">**Memory\Cache Bytes**</span></span>  
  
    -   <span data-ttu-id="faac4-423">臨界值： 沒有特定的值。</span><span class="sxs-lookup"><span data-stu-id="faac4-423">Threshold: No specific value.</span></span>  
  
    -   <span data-ttu-id="faac4-424">重要： 監視在不同的負載情況下的快取的大小。</span><span class="sxs-lookup"><span data-stu-id="faac4-424">Significance: Monitors the size of cache under different load conditions.</span></span> <span data-ttu-id="faac4-425">此效能計數器的這個值表示靜態檔案快取的大小。</span><span class="sxs-lookup"><span data-stu-id="faac4-425">This value of this performance counter indicates the size of the static files cache.</span></span> <span data-ttu-id="faac4-426">根據預設，此計數器會使用大約 50%的可用記憶體，但是會減少如果可用的記憶體來壓縮，這會影響系統效能。</span><span class="sxs-lookup"><span data-stu-id="faac4-426">By default, this counter uses approximately 50 percent of available memory, but decreases if available memory shrinks, which affects system performance.</span></span>  
  
-   <span data-ttu-id="faac4-427">**Memory\Cache Faults/sec**</span><span class="sxs-lookup"><span data-stu-id="faac4-427">**Memory\Cache Faults/sec**</span></span>  
  
    -   <span data-ttu-id="faac4-428">臨界值： 沒有特定的值。</span><span class="sxs-lookup"><span data-stu-id="faac4-428">Threshold: No specific value.</span></span>  
  
    -   <span data-ttu-id="faac4-429">意義： 此計數器表示 operating system 頻率尋找檔案系統快取中的資料，但找不到它。</span><span class="sxs-lookup"><span data-stu-id="faac4-429">Significance: This counter indicates how often the operating system looks for data in the file system cache but fails to find it.</span></span> <span data-ttu-id="faac4-430">這個值應該越低越好。</span><span class="sxs-lookup"><span data-stu-id="faac4-430">This value should be as low as possible.</span></span>  
  
-   <span data-ttu-id="faac4-431">**Cache\MDL 讀取點擊 %**</span><span class="sxs-lookup"><span data-stu-id="faac4-431">**Cache\MDL Read Hits %**</span></span>  
  
    -   <span data-ttu-id="faac4-432">臨界值： 愈高此值檔案系統快取的效能愈佳。</span><span class="sxs-lookup"><span data-stu-id="faac4-432">Threshold: The higher this value, the better the performance of the file system cache.</span></span> <span data-ttu-id="faac4-433">值應該接近 100%越好。</span><span class="sxs-lookup"><span data-stu-id="faac4-433">Values should be as close to 100 percent as possible.</span></span>  
  
    -   <span data-ttu-id="faac4-434">重要： 此計數器提供的記憶體描述元清單 (MDL) 讀取至檔案系統快取位置快取傳回的物件直接要求，而不是需要從硬碟讀取百分比。</span><span class="sxs-lookup"><span data-stu-id="faac4-434">Significance: This counter provides the percentage of Memory Descriptor List (MDL) Read requests to the file system cache, where the cache returns the object directly rather than requiring a read from the hard disk.</span></span>  
  
-   <span data-ttu-id="faac4-435">**Process\Working Set**</span><span class="sxs-lookup"><span data-stu-id="faac4-435">**Process\Working Set**</span></span>  
  
    -   <span data-ttu-id="faac4-436">臨界值： 沒有特定的值。</span><span class="sxs-lookup"><span data-stu-id="faac4-436">Threshold: No specific value.</span></span>  
  
    -   <span data-ttu-id="faac4-437">重要： 工作集是目前載入記憶體 （實體 + 虛擬） 中的記憶體分頁的集合。</span><span class="sxs-lookup"><span data-stu-id="faac4-437">Significance: The working set is the set of memory pages currently loaded in memory (physical + virtual).</span></span> <span data-ttu-id="faac4-438">如果系統有足夠的記憶體，它可以維護足夠的空間中的工作集，使它不需要執行將記憶體分頁至磁碟的磁碟作業。</span><span class="sxs-lookup"><span data-stu-id="faac4-438">If the system has sufficient memory, it can maintain enough space in the working set so that it does not need to perform disk operations to page memory to disk.</span></span> <span data-ttu-id="faac4-439">不過，如果沒有記憶體不足，系統會嘗試減少工作設定立即採取的處理序的記憶體而造成分頁錯誤而增加。</span><span class="sxs-lookup"><span data-stu-id="faac4-439">However, if there is insufficient memory, the system tries to reduce the working set by taking away the memory from the processes which results in an increase in page faults.</span></span> <span data-ttu-id="faac4-440">當分頁錯誤的速率上升時，系統會嘗試增加處理程序的工作集。</span><span class="sxs-lookup"><span data-stu-id="faac4-440">When the rate of page faults rises, the system tries to increase the working set of the process.</span></span> <span data-ttu-id="faac4-441">如果您觀察巨幅波動的工作集，則可能表示記憶體不足的問題。</span><span class="sxs-lookup"><span data-stu-id="faac4-441">If you observe wide fluctuations in the working set, it might indicate a memory shortage.</span></span> <span data-ttu-id="faac4-442">較高的工作集的值也可能是因為應用程式中的多個組件中。</span><span class="sxs-lookup"><span data-stu-id="faac4-442">Higher values in the working set may also be due to multiple assemblies in an application.</span></span> <span data-ttu-id="faac4-443">您可以改善所使用的全域組件快取中的共用組件的工作集中。</span><span class="sxs-lookup"><span data-stu-id="faac4-443">You can improve the working set by using assemblies shared in the global assembly cache.</span></span>  
  
#### <a name="resolving-memory-bottlenecks"></a><span data-ttu-id="faac4-444">解決記憶體瓶頸</span><span class="sxs-lookup"><span data-stu-id="faac4-444">Resolving memory bottlenecks</span></span>  
 <span data-ttu-id="faac4-445">如果您判斷該記憶體是在 BizTalk Server 環境中，使用一或多個下列方法來解決瓶頸是效能瓶頸：</span><span class="sxs-lookup"><span data-stu-id="faac4-445">If you determine that memory is a bottleneck in your BizTalk Server environment, use one or more of the following methods to resolve the bottleneck:</span></span>  
  
-   <span data-ttu-id="faac4-446">調整配置在可以控制配置的記憶體數量。</span><span class="sxs-lookup"><span data-stu-id="faac4-446">Tune the amount of memory allocated if you can control the allocation.</span></span> <span data-ttu-id="faac4-447">例如，您可以調整這適用於 BizTalk Server、 ASP.NET 和 SQL Server。</span><span class="sxs-lookup"><span data-stu-id="faac4-447">For example, you can tune this for BizTalk Server, ASP.NET and SQL Server.</span></span>  
  
-   <span data-ttu-id="faac4-448">增加 Windows 分頁檔的大小，並依照中的 < 設定 Windows 分頁檔以獲得最佳效能 > 一節的步驟[最佳化作業系統效能](~/technical-guides/optimizing-operating-system-performance.md)。</span><span class="sxs-lookup"><span data-stu-id="faac4-448">Increase the size of the Windows paging file and follow the steps in the “Configure the Windows PAGEFILE for optimal performance” section of [Optimizing Operating System Performance](~/technical-guides/optimizing-operating-system-performance.md).</span></span>  
  
-   <span data-ttu-id="faac4-449">關閉未使用的服務。</span><span class="sxs-lookup"><span data-stu-id="faac4-449">Turn off services that are not used.</span></span> <span data-ttu-id="faac4-450">停止服務，您不使用定期節省記憶體，並改善系統效能。</span><span class="sxs-lookup"><span data-stu-id="faac4-450">Stopping services that you do not use regularly saves memory and improves system performance.</span></span> <span data-ttu-id="faac4-451">如需詳細資訊，請參閱 停用不必要的服務 」 一節[最佳化作業系統效能](~/technical-guides/optimizing-operating-system-performance.md)。</span><span class="sxs-lookup"><span data-stu-id="faac4-451">For more information, see the “Disable non-essential services” section of [Optimizing Operating System Performance](~/technical-guides/optimizing-operating-system-performance.md).</span></span>  
  
-   <span data-ttu-id="faac4-452">移除不必要的通訊協定和驅動程式。</span><span class="sxs-lookup"><span data-stu-id="faac4-452">Remove unnecessary protocols and drivers.</span></span> <span data-ttu-id="faac4-453">即使閒置的通訊協定中的分頁及非分頁記憶體集區使用的空間。</span><span class="sxs-lookup"><span data-stu-id="faac4-453">Even idle protocols use space in the paged and non-paged memory pools.</span></span> <span data-ttu-id="faac4-454">驅動程式也會耗用記憶體，所以您應該移除不必要的。</span><span class="sxs-lookup"><span data-stu-id="faac4-454">Drivers also consume memory, so you should remove unnecessary ones.</span></span> <span data-ttu-id="faac4-455">如需詳細資訊，請參閱 「 移除不必要的網路通訊協定 」 一節[最佳化作業系統效能](~/technical-guides/optimizing-operating-system-performance.md)。</span><span class="sxs-lookup"><span data-stu-id="faac4-455">For more information, see the “Remove unnecessary network protocols” section of [Optimizing Operating System Performance](~/technical-guides/optimizing-operating-system-performance.md).</span></span>  
  
-   <span data-ttu-id="faac4-456">在 BizTalk Server 環境中的電腦上安裝額外的實體記憶體。</span><span class="sxs-lookup"><span data-stu-id="faac4-456">Install additional physical memory on the computers in the BizTalk Server environment.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="faac4-457">在 32 位元系統上，BizTalk 就可以使用最大值為 2 GB 的記憶體，限制會增加到 3 GB，與 BizTalk Server 2010 和更新版本，如果使用 /3GB 參數。</span><span class="sxs-lookup"><span data-stu-id="faac4-457">On a 32-bit system, BizTalk can use a maximum of 2GB of memory, the limit increases to 3GB with BizTalk Server 2010 and later if the /3GB switch is used.</span></span> <span data-ttu-id="faac4-458">如需有關記憶體使用量的詳細資訊，請參閱[版本的記憶體限制 Windows](http://go.microsoft.com/fwlink/?LinkId=118349) (http://go.microsoft.com/fwlink/?LinkId=118349)。</span><span class="sxs-lookup"><span data-stu-id="faac4-458">For more information on memory usage, see [Memory Limits for Windows Releases](http://go.microsoft.com/fwlink/?LinkId=118349) (http://go.microsoft.com/fwlink/?LinkId=118349).</span></span>  
  
### <a name="network-io-bottlenecks"></a><span data-ttu-id="faac4-459">網路 I/O 瓶頸</span><span class="sxs-lookup"><span data-stu-id="faac4-459">Network I/O bottlenecks</span></span>  
  
#### <a name="you-might-have-a-network-io-bottleneck-if"></a><span data-ttu-id="faac4-460">如果，可能會有網路 I/O 瓶頸...</span><span class="sxs-lookup"><span data-stu-id="faac4-460">You might have a network I/O bottleneck if…</span></span>  
  
-   <span data-ttu-id="faac4-461">值**Network Interface\Bytes Total/sec**效能計數器超過 80%的可用網路頻寬。</span><span class="sxs-lookup"><span data-stu-id="faac4-461">The value of the **Network Interface\Bytes Total/sec** performance counter exceeds 80% of available network bandwidth.</span></span>  
  
-   <span data-ttu-id="faac4-462">值**Server\Bytes Total/sec**大於可用的網路頻寬的 50% 效能計數器。</span><span class="sxs-lookup"><span data-stu-id="faac4-462">The value of the **Server\Bytes Total/sec** performance counter is greater than 50% of available network bandwidth.</span></span>  
  
#### <a name="performance-counters-for-measuring-network-io-bottlenecks"></a><span data-ttu-id="faac4-463">測量網路 I/O 瓶頸的效能計數器</span><span class="sxs-lookup"><span data-stu-id="faac4-463">Performance counters for measuring network I/O bottlenecks</span></span>  
 <span data-ttu-id="faac4-464">下列效能計數器應該用來測量網路 I/O，並且判斷網路 I/O 相關的瓶頸時，是否要發生在系統中：</span><span class="sxs-lookup"><span data-stu-id="faac4-464">The following performance counters should be used to measure network I/O and determine if your system is experiencing a network I/O related bottleneck:</span></span>  
  
-   <span data-ttu-id="faac4-465">**Network Interface\Bytes Total/sec**</span><span class="sxs-lookup"><span data-stu-id="faac4-465">**Network Interface\Bytes Total/sec**</span></span>  
  
    -   <span data-ttu-id="faac4-466">多個網路容量的 80%的閾值： 持續的值。</span><span class="sxs-lookup"><span data-stu-id="faac4-466">Threshold: Sustained value of more than 80 percent of network capacity.</span></span>  
  
    -   <span data-ttu-id="faac4-467">重要： 此計數器表示會傳送及每個網路介面卡接收位元組的速率。</span><span class="sxs-lookup"><span data-stu-id="faac4-467">Significance: This counter indicates the rate at which bytes are sent and received over each network adapter.</span></span> <span data-ttu-id="faac4-468">此計數器可協助判斷是否已飽和的網路介面卡，以及是否應該將一個或多個網路介面卡，若要增加可用的網路頻寬。</span><span class="sxs-lookup"><span data-stu-id="faac4-468">This counter helps determine if a network adapter is saturated and whether you should add one or more network adapters to increase available network bandwidth.</span></span>  
  
-   <span data-ttu-id="faac4-469">**網路 Interface\Bytes Received/sec**</span><span class="sxs-lookup"><span data-stu-id="faac4-469">**Network Interface\Bytes Received/sec**</span></span>  
  
    -   <span data-ttu-id="faac4-470">臨界值： 沒有特定的值。</span><span class="sxs-lookup"><span data-stu-id="faac4-470">Threshold: No specific value.</span></span>  
  
    -   <span data-ttu-id="faac4-471">重要： 此計數器指出透過每張網路介面卡接收位元組的速率。</span><span class="sxs-lookup"><span data-stu-id="faac4-471">Significance: This counter indicates the rate at which bytes are received over each network adapter.</span></span> <span data-ttu-id="faac4-472">使用此計數器的值來計算傳入資料的速率的總可用的頻寬百分比。</span><span class="sxs-lookup"><span data-stu-id="faac4-472">Use the value of this counter to calculate the rate of incoming data as a percentage of total available bandwidth.</span></span> <span data-ttu-id="faac4-473">這將有助於判斷在用戶端將資料傳送到 BizTalk Server 或 BizTalk Server 電腦本身，應會增加網路頻寬，就應增加網路頻寬。</span><span class="sxs-lookup"><span data-stu-id="faac4-473">This will help determine if network bandwidth should be increased on the client sending data to BizTalk Server or if network bandwidth should be increased on the BizTalk Server computer itself.</span></span>  
  
-   <span data-ttu-id="faac4-474">**Network Interface\Bytes 傳送/sec**</span><span class="sxs-lookup"><span data-stu-id="faac4-474">**Network Interface\Bytes Sent/sec**</span></span>  
  
    -   <span data-ttu-id="faac4-475">臨界值： 沒有特定的值。</span><span class="sxs-lookup"><span data-stu-id="faac4-475">Threshold: No specific value.</span></span>  
  
    -   <span data-ttu-id="faac4-476">重要： 此計數器指出透過每張網路介面卡傳送位元組的速率。</span><span class="sxs-lookup"><span data-stu-id="faac4-476">Significance: This counter indicates the rate at which bytes are sent over each network adapter.</span></span> <span data-ttu-id="faac4-477">使用此計數器的值來計算的輸出資料的速率的總可用的頻寬百分比。</span><span class="sxs-lookup"><span data-stu-id="faac4-477">Use the value of this counter to calculate the rate of outgoing data as a percentage of total available bandwidth.</span></span> <span data-ttu-id="faac4-478">這可協助判斷是否應增加網路頻寬，BizTalk Server 將資料傳送到用戶端上，或是在用戶端電腦接收資料，從 BizTalk Server 上，應增加網路頻寬。</span><span class="sxs-lookup"><span data-stu-id="faac4-478">This will help determine if network bandwidth should be increased on the BizTalk Server sending data to a client or if network bandwidth should be increased on the client computer receiving data from BizTalk Server.</span></span>  
  
-   <span data-ttu-id="faac4-479">**Server\Bytes Total/sec**</span><span class="sxs-lookup"><span data-stu-id="faac4-479">**Server\Bytes Total/sec**</span></span>  
  
    -   <span data-ttu-id="faac4-480">超過 50%的網路容量閾值： 持續的值。</span><span class="sxs-lookup"><span data-stu-id="faac4-480">Threshold: Sustained value of more than 50 percent of network capacity.</span></span>  
  
    -   <span data-ttu-id="faac4-481">重要： 此計數器指出透過網路傳送及接收的位元組數目。</span><span class="sxs-lookup"><span data-stu-id="faac4-481">Significance: This counter indicates the number of bytes sent and received over the network.</span></span> <span data-ttu-id="faac4-482">較高的值會指出網路 I/O 瓶頸。</span><span class="sxs-lookup"><span data-stu-id="faac4-482">Higher values indicate a network I/O bottleneck.</span></span> <span data-ttu-id="faac4-483">如果總和**Bytes Total/sec**所有伺服器為大約等於您網路的最大傳輸速率，請考慮以改善效能的網路子網路 >。</span><span class="sxs-lookup"><span data-stu-id="faac4-483">If the sum of **Bytes Total/sec** for all servers is roughly equal to the maximum transfer rate of your network, consider subnetting the network to improve performance.</span></span> <span data-ttu-id="faac4-484">如需以改善效能的網路子網路 > 的詳細資訊，請參閱**子網路**區段[BizTalk Server 資料庫最佳化白皮書](http://go.microsoft.com/fwlink/?LinkID=101578)(http://go.microsoft.com/fwlink/?LinkID=101578)。</span><span class="sxs-lookup"><span data-stu-id="faac4-484">For more information about subnetting a network to improve performance, see the **Subnets** section of the [BizTalk Server Database Optimization white paper](http://go.microsoft.com/fwlink/?LinkID=101578) (http://go.microsoft.com/fwlink/?LinkID=101578).</span></span>  
  
#### <a name="resolving-network-io-bottlenecks"></a><span data-ttu-id="faac4-485">解決網路 I/O 瓶頸</span><span class="sxs-lookup"><span data-stu-id="faac4-485">Resolving network I/O bottlenecks</span></span>  
 <span data-ttu-id="faac4-486">如果您判斷網路 I/O 瓶頸，以您的環境中，使用一或多個下列方法來解決瓶頸：</span><span class="sxs-lookup"><span data-stu-id="faac4-486">If you determine that network I/O is a bottleneck in your environment, use one or more of the following methods to resolve the bottleneck:</span></span>  
  
-   <span data-ttu-id="faac4-487">遵循 「 改善網路效能的一般指導方針 」 一節中的建議[最佳化網路效能](~/technical-guides/optimizing-network-performance.md)。</span><span class="sxs-lookup"><span data-stu-id="faac4-487">Follow the recommendations in the “General guidelines for improving network performance” section of [Optimizing Network Performance](~/technical-guides/optimizing-network-performance.md).</span></span>  
  
-   <span data-ttu-id="faac4-488">執行本主題說明 Windows Powershell 網路最佳化指令碼[最佳化網路效能](~/technical-guides/optimizing-network-performance.md)BizTalk Server 環境中的每一部電腦上。</span><span class="sxs-lookup"><span data-stu-id="faac4-488">Run the Windows Powershell network optimization script described in the topic [Optimizing Network Performance](~/technical-guides/optimizing-network-performance.md) on each computer in the BizTalk Server environment.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="faac4-489">另請參閱</span><span class="sxs-lookup"><span data-stu-id="faac4-489">See Also</span></span>  
 [<span data-ttu-id="faac4-490">尋找並排除瓶頸</span><span class="sxs-lookup"><span data-stu-id="faac4-490">Finding and Eliminating Bottlenecks</span></span>](~/technical-guides/finding-and-eliminating-bottlenecks.md)