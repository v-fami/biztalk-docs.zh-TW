---
title: 最佳化檔案群組的資料庫 |Microsoft 文件
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 8d7fa4c9-e504-4f43-a308-517a4a574c26
caps.latest.revision: 10
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 9333a88817e96b52ffe186f0a6a598b225ef5202
ms.sourcegitcommit: 36350889f318e1f7e0ac9506dc8df794d475bda6
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/20/2018
---
# <a name="optimizing-filegroups-for-the-databases"></a><span data-ttu-id="5833b-102">最佳化檔案群組的資料庫</span><span class="sxs-lookup"><span data-stu-id="5833b-102">Optimizing Filegroups for the Databases</span></span>
<span data-ttu-id="5833b-103">檔案輸入/輸出 (I/O) 競爭的情況通常是限制因素或在生產環境 BizTalk Server 環境中的瓶頸。</span><span class="sxs-lookup"><span data-stu-id="5833b-103">File input/output (I/O) contention is frequently a limiting factor, or bottleneck, in a production BizTalk Server environment.</span></span> <span data-ttu-id="5833b-104">BizTalk Server 資料庫非常密集的應用程式，而接著，BizTalk Server 所使用的 SQL Server 資料庫檔案最需要大量 I/O。</span><span class="sxs-lookup"><span data-stu-id="5833b-104">BizTalk Server is a very database intensive application and in turn, the SQL Server database used by BizTalk Server is very file I/O intensive.</span></span> <span data-ttu-id="5833b-105">本主題描述如何最有效地利用檔案及檔案群組功能的 SQL Server 檔案 I/O 競爭次數降到最低，並改善 BizTalk Server 解決方案的整體效能。</span><span class="sxs-lookup"><span data-stu-id="5833b-105">This topic describes how to make optimal use of the files and filegroups feature of SQL Server to minimize the occurrence of file I/O contention and improve the overall performance of a BizTalk Server solution.</span></span>  
  
## <a name="overview"></a><span data-ttu-id="5833b-106">概觀</span><span class="sxs-lookup"><span data-stu-id="5833b-106">Overview</span></span>  
 <span data-ttu-id="5833b-107">每個 BizTalk Server 解決方案最終將會遇到檔案 I/O 競爭，提升輸送量。</span><span class="sxs-lookup"><span data-stu-id="5833b-107">Every BizTalk Server solution will eventually encounter file I/O contention as throughput is increased.</span></span> <span data-ttu-id="5833b-108">I/O 子系統或儲存引擎是任何關聯式資料庫的重要元件。</span><span class="sxs-lookup"><span data-stu-id="5833b-108">The I/O subsystem, or storage engine, is a key component of any relational database.</span></span> <span data-ttu-id="5833b-109">成功的資料庫實作通常需要在專案早期就進行周密的規劃。</span><span class="sxs-lookup"><span data-stu-id="5833b-109">A successful database implementation typically requires careful planning at the early stages of a project.</span></span> <span data-ttu-id="5833b-110">這項規劃應考量下列問題：</span><span class="sxs-lookup"><span data-stu-id="5833b-110">This planning should include consideration of the following issues:</span></span>  
  
-   <span data-ttu-id="5833b-111">應使用哪種磁碟硬體，如 RAID (磁碟陣列) 裝置。</span><span class="sxs-lookup"><span data-stu-id="5833b-111">What type of disk hardware to use, such as RAID (redundant array of independent disks) devices.</span></span> 
  
-   <span data-ttu-id="5833b-112">如何分配使用檔案和檔案群組的磁碟上的資料。</span><span class="sxs-lookup"><span data-stu-id="5833b-112">How to apportion data on the disks using files and filegroups.</span></span> <span data-ttu-id="5833b-113">如需有關如何使用 SQL Server 中的檔案和檔案群組的詳細資訊，請參閱[Database Files and Filegroups](https://docs.microsoft.com/sql/relational-databases/databases/database-files-and-filegroups)。</span><span class="sxs-lookup"><span data-stu-id="5833b-113">For more information about using files and filegroups in SQL Server, see [Database Files and Filegroups](https://docs.microsoft.com/sql/relational-databases/databases/database-files-and-filegroups).</span></span>
  
-   <span data-ttu-id="5833b-114">實作最佳的索引設計來存取資料時改善效能。</span><span class="sxs-lookup"><span data-stu-id="5833b-114">Implementing the optimal index design for improving performance when accessing data.</span></span> <span data-ttu-id="5833b-115">如需設計索引的詳細資訊，請參閱[設計索引](https://docs.microsoft.com/sql/relational-databases/sql-server-index-design-guide)。</span><span class="sxs-lookup"><span data-stu-id="5833b-115">For more information about designing indexes, see [Designing Indexes](https://docs.microsoft.com/sql/relational-databases/sql-server-index-design-guide).</span></span>
  
-   <span data-ttu-id="5833b-116">如何設定 SQL Server 組態參數，以獲得最佳效能。</span><span class="sxs-lookup"><span data-stu-id="5833b-116">How to set SQL Server configuration parameters for optimal performance.</span></span> <span data-ttu-id="5833b-117">適用於 SQL Server 設定最佳的設定參數的相關資訊，請參閱[伺服器組態選項](https://docs.microsoft.com/sql/database-engine/configure-windows/server-configuration-options-sql-server)。</span><span class="sxs-lookup"><span data-stu-id="5833b-117">For more information about setting optimal configuration parameters for SQL Server, see [Server Configuration Options](https://docs.microsoft.com/sql/database-engine/configure-windows/server-configuration-options-sql-server).</span></span>
  
 <span data-ttu-id="5833b-118">BizTalk server 的主要設計目標之一是確保訊息是**從未**遺失。</span><span class="sxs-lookup"><span data-stu-id="5833b-118">One of the primary design goals of BizTalk Server is to ensure that a message is **never** lost.</span></span> <span data-ttu-id="5833b-119">若要降低訊息遺失的可能性，訊息會經常寫入至 MessageBox 資料庫在處理訊息。</span><span class="sxs-lookup"><span data-stu-id="5833b-119">In order to mitigate the possibility of message loss, messages are frequently written to the MessageBox database as the message is processed.</span></span> <span data-ttu-id="5833b-120">當協調流程處理訊息時，訊息會寫入協調流程中每個持續點的 MessageBox 資料庫中。</span><span class="sxs-lookup"><span data-stu-id="5833b-120">When messages are processed by an orchestration, the message is written to the MessageBox database at every persistence point in the orchestration.</span></span> <span data-ttu-id="5833b-121">這些持續點會導致 MessageBox 實體磁碟寫入的訊息和相關的狀態。</span><span class="sxs-lookup"><span data-stu-id="5833b-121">These persistence points cause the MessageBox to write the message and related state to physical disk.</span></span> <span data-ttu-id="5833b-122">在更高的輸送量，此持續性會造成相當大的磁碟爭用情況，而可能成為瓶頸。</span><span class="sxs-lookup"><span data-stu-id="5833b-122">At higher throughputs, this persistence can result in considerable disk contention and can potentially become a bottleneck.</span></span>  
  
 <span data-ttu-id="5833b-123">進行最佳使用的檔案，並有效地解決檔案 IO 瓶頸，改善在 BizTalk Server 解決方案的整體效能可能會在 SQL Server 中的檔案群組功能。</span><span class="sxs-lookup"><span data-stu-id="5833b-123">Making optimal use of the files and filegroups feature in SQL Server has been shown to effectively address File IO bottlenecks and improve overall performance in BizTalk Server solutions.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5833b-124">此最佳化只應該由有經驗的 SQL Server 資料庫系統管理員和只有之後所有 BizTalk Server 資料庫已正確地備份。</span><span class="sxs-lookup"><span data-stu-id="5833b-124">This optimization should only be done by an experienced SQL Server database administrator and only after all BizTalk Server databases have been properly backed up.</span></span> <span data-ttu-id="5833b-125">應該在 BizTalk Server 環境中的所有 SQL Server 電腦上執行此最佳化。</span><span class="sxs-lookup"><span data-stu-id="5833b-125">This optimization should be performed on all SQL Server computers in the BizTalk Server environment.</span></span>  
  
 <span data-ttu-id="5833b-126">SQL Server 的檔案和檔案群組可用來改善資料庫效能，因為這項功能可讓資料庫來建立跨多個磁碟、 多個磁碟控制卡或 RAID （獨立磁碟備援陣列） 系統。</span><span class="sxs-lookup"><span data-stu-id="5833b-126">SQL Server files and filegroups can be used to improve database performance because this functionality allows a database to be created across multiple disks, multiple disk controllers, or RAID (redundant array of independent disks) systems.</span></span> <span data-ttu-id="5833b-127">例如，若電腦有 4 個磁碟，您可以建立由 3 個資料檔和 1 個記錄檔組成的資料庫，每一個檔案各在一個磁碟上。</span><span class="sxs-lookup"><span data-stu-id="5833b-127">For example, if your computer has four disks, you can create a database that is made up of three data files and one log file, with one file on each disk.</span></span> <span data-ttu-id="5833b-128">存取資料時，四個讀寫頭可以同時存取平行的資料。</span><span class="sxs-lookup"><span data-stu-id="5833b-128">As data is accessed, four read/write heads can concurrently access the data in parallel.</span></span> <span data-ttu-id="5833b-129">大幅加快資料庫作業。</span><span class="sxs-lookup"><span data-stu-id="5833b-129">This speeds up database operations significantly.</span></span> <span data-ttu-id="5833b-130">如需有關實作 SQL Server 磁碟的硬體解決方案的詳細資訊，請參閱[資料庫效能](http://go.microsoft.com/fwlink/?LinkID=71419)(http://go.microsoft.com/fwlink/?LinkID=71419)中 SQL Server 線上叢書 》。</span><span class="sxs-lookup"><span data-stu-id="5833b-130">For more information about implementing hardware solutions for SQL Server disks, see [Database Performance](http://go.microsoft.com/fwlink/?LinkID=71419) (http://go.microsoft.com/fwlink/?LinkID=71419) in the SQL Server Books Online.</span></span>  
  
 <span data-ttu-id="5833b-131">此外，檔案和檔案群組啟用資料位置選項，可以在特定的檔案群組中建立資料表。</span><span class="sxs-lookup"><span data-stu-id="5833b-131">Additionally, files and filegroups enable data placement, because tables can be created in specific filegroups.</span></span> <span data-ttu-id="5833b-132">這可改善效能，因為指定資料表的所有檔案 I/O 都可都導向特定的磁碟。</span><span class="sxs-lookup"><span data-stu-id="5833b-132">This improves performance, because all file I/O for a given table can be directed at a specific disk.</span></span> <span data-ttu-id="5833b-133">比方說，經常使用的資料表可以放在檔案群組，在某個磁碟，並在資料庫中其他較少存取的資料表可以位於不同的檔案放在第二個磁碟上的另一個檔案群組中。</span><span class="sxs-lookup"><span data-stu-id="5833b-133">For example, a heavily used table can be placed on a file in a filegroup, located on one disk, and the other less heavily accessed tables in the database can be located on different files in another filegroup, located on a second disk.</span></span>  
  
 <span data-ttu-id="5833b-134">檔案 I/O 瓶頸相當詳細地討論[資料庫層中的瓶頸](../technical-guides/bottlenecks-in-the-database-tier.md)。</span><span class="sxs-lookup"><span data-stu-id="5833b-134">File I/O bottlenecks are discussed in considerable detail in [Bottlenecks in the Database Tier](../technical-guides/bottlenecks-in-the-database-tier.md).</span></span> <span data-ttu-id="5833b-135">最常見檔案 I/O （磁碟 I/O） 是一個瓶頸的指標是 「 實體磁碟： 平均磁碟佇列長度 」 計數器的值。</span><span class="sxs-lookup"><span data-stu-id="5833b-135">The most common indicator that file I/O (disk I/O) is a bottleneck is the value of the “Physical Disk:Average Disk Queue Length” counter.</span></span> <span data-ttu-id="5833b-136">「 實體磁碟： 平均磁碟佇列長度 」 計數器的值大於約 3 的任何執行 SQL Server 的電腦上任何指定的磁碟，然後檔案 I/O 時，可能是效能瓶頸。</span><span class="sxs-lookup"><span data-stu-id="5833b-136">When the value of the “Physical Disk:Average Disk Queue Length” counter is greater than about 3 for any given disk on any of the computers running SQL Server, then file I/O is likely a bottleneck.</span></span>  
  
 <span data-ttu-id="5833b-137">如果套用檔案群組的最佳化，不會解決檔案 I/O 瓶頸問題，可能必須加入額外的實體或 SAN 磁碟機來增加磁碟子系統的輸送量。</span><span class="sxs-lookup"><span data-stu-id="5833b-137">If applying file or filegroup optimization doesn't resolve a file I/O bottleneck problem, it may be necessary to increase the throughput of the disk subsystem by adding additional physical or SAN drives.</span></span>  
  
 <span data-ttu-id="5833b-138">本主題描述如何將手動套用 file 和 filegroup 最佳化，但也可撰寫這些最佳化。</span><span class="sxs-lookup"><span data-stu-id="5833b-138">This topic describes how to manually apply file and filegroup optimizations, but these optimizations can also be scripted.</span></span> <span data-ttu-id="5833b-139">中提供的範例 SQL 指令碼[BizTalk Server MessageBox 資料庫檔案群組 SQL 指令碼](../technical-guides/biztalk-server-messagebox-database-filegroups-sql-script.md)。</span><span class="sxs-lookup"><span data-stu-id="5833b-139">A sample SQL script is provided in [BizTalk Server MessageBox Database Filegroups SQL Script](../technical-guides/biztalk-server-messagebox-database-filegroups-sql-script.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5833b-140">請務必注意，此指令碼會需要修改，以配合檔案、 檔案群組，以及任何指定的 BizTalk Server 解決方案的 SQL Server 資料庫所使用的磁碟組態。</span><span class="sxs-lookup"><span data-stu-id="5833b-140">It is important to note that this script would need to be modified to accommodate the file, filegroup, and disk configuration used by the SQL Server databases for any given BizTalk Server solution.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5833b-141">本主題也描述如何建立多個檔案和檔案群組的 BizTalk MessageBox 資料庫。</span><span class="sxs-lookup"><span data-stu-id="5833b-141">This topic also describes how to create multiple files and filegroups for the BizTalk MessageBox database.</span></span> <span data-ttu-id="5833b-142">建議的檔案和檔案群組的所有 BizTalk Server 資料庫的完整清單，請參閱 「 附錄 B 「 [BizTalk Server 資料庫最佳化](http://go.microsoft.com/fwlink/?LinkID=101578)白皮書 (http://go.microsoft.com/fwlink/?LinkID=101578)。</span><span class="sxs-lookup"><span data-stu-id="5833b-142">For an exhaustive list of recommended files and filegroups for all of the BizTalk Server databases, see “Appendix B” of the [BizTalk Server Database Optimization](http://go.microsoft.com/fwlink/?LinkID=101578) white paper (http://go.microsoft.com/fwlink/?LinkID=101578).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5833b-143">即使[BizTalk Server 資料庫最佳化](http://go.microsoft.com/fwlink/?LinkID=101578)白皮書 (http://go.microsoft.com/fwlink/?LinkID=101578)撰寫時[!INCLUDE[btsbiztalkserver2006r2](../includes/btsbiztalkserver2006r2-md.md)]納入考量，相同的原則套用至 BizTalk Server。</span><span class="sxs-lookup"><span data-stu-id="5833b-143">Even though the [BizTalk Server Database Optimization](http://go.microsoft.com/fwlink/?LinkID=101578) white paper (http://go.microsoft.com/fwlink/?LinkID=101578) was written with [!INCLUDE[btsbiztalkserver2006r2](../includes/btsbiztalkserver2006r2-md.md)] in mind, the same principles apply to BizTalk Server.</span></span>  
  
## <a name="databases-created-with-a-default-biztalk-server-configuration"></a><span data-ttu-id="5833b-144">使用預設的 BizTalk Server 組態建立的資料庫</span><span class="sxs-lookup"><span data-stu-id="5833b-144">Databases created with a default BizTalk Server configuration</span></span>  
 <span data-ttu-id="5833b-145">依據 13 不同資料庫中設定 BizTalk Server 中，可能會建立在 SQL Server 及所有的這些資料庫會建立預設檔案群組中時，會啟用功能。</span><span class="sxs-lookup"><span data-stu-id="5833b-145">Depending on which features are enabled when configuring BizTalk Server, up to 13 different databases may be created in SQL Server and all of these databases are created in the default filegroup.</span></span> <span data-ttu-id="5833b-146">SQL Server 的預設檔案群組是主要檔案群組，除非使用 ALTER DATABASE 命令來變更預設檔案群組。</span><span class="sxs-lookup"><span data-stu-id="5833b-146">The default filegroup for SQL Server is the PRIMARY filegroup unless the default filegroup is changed by using the ALTER DATABASE command.</span></span> <span data-ttu-id="5833b-147">下表列出的資料庫所建立的 SQL Server 中，如果設定 BizTalk Server 時，會啟用所有功能。</span><span class="sxs-lookup"><span data-stu-id="5833b-147">The following table lists the databases that are created in SQL Server if all features are enabled when configuring BizTalk Server.</span></span>  
  
### <a name="biztalk-server-databases"></a><span data-ttu-id="5833b-148">BizTalk Server 資料庫</span><span class="sxs-lookup"><span data-stu-id="5833b-148">BizTalk Server Databases</span></span>  
  
||||  
|-|-|-|  
|<span data-ttu-id="5833b-149">**資料庫**</span><span class="sxs-lookup"><span data-stu-id="5833b-149">**Database**</span></span>|<span data-ttu-id="5833b-150">**預設的資料庫名稱**</span><span class="sxs-lookup"><span data-stu-id="5833b-150">**Default Database Name**</span></span>|<span data-ttu-id="5833b-151">**說明**</span><span class="sxs-lookup"><span data-stu-id="5833b-151">**Description**</span></span>|  
|<span data-ttu-id="5833b-152">設定資料庫</span><span class="sxs-lookup"><span data-stu-id="5833b-152">Configuration database</span></span>|<span data-ttu-id="5833b-153">BizTalkMgmtDb</span><span class="sxs-lookup"><span data-stu-id="5833b-153">BizTalkMgmtDb</span></span>|<span data-ttu-id="5833b-154">中央中繼資訊存放區的所有 BizTalk Server 群組中的 BizTalk Server 執行個體。</span><span class="sxs-lookup"><span data-stu-id="5833b-154">The central meta-information store for all instances of BizTalk Server in the BizTalk Server group.</span></span>|  
|<span data-ttu-id="5833b-155">BizTalk MessageBox 資料庫</span><span class="sxs-lookup"><span data-stu-id="5833b-155">BizTalk MessageBox database</span></span>|<span data-ttu-id="5833b-156">BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="5833b-156">BizTalkMsgBoxDb</span></span>|<span data-ttu-id="5833b-157">儲存訂閱述詞。</span><span class="sxs-lookup"><span data-stu-id="5833b-157">Stores subscriptions predicates.</span></span> <span data-ttu-id="5833b-158">它是主機平台，並會保留每個 BizTalk Server 主控件佇列和狀態資料表。</span><span class="sxs-lookup"><span data-stu-id="5833b-158">It is a host platform, and keeps queues and state tables for each BizTalk Server host.</span></span> <span data-ttu-id="5833b-159">MessageBox 資料庫也儲存訊息及訊息屬性。</span><span class="sxs-lookup"><span data-stu-id="5833b-159">The MessageBox database also stores the messages and message properties.</span></span>|  
|<span data-ttu-id="5833b-160">BizTalk 追蹤資料庫</span><span class="sxs-lookup"><span data-stu-id="5833b-160">BizTalk Tracking database</span></span>|<span data-ttu-id="5833b-161">BizTalkDTADb</span><span class="sxs-lookup"><span data-stu-id="5833b-161">BizTalkDTADb</span></span>|<span data-ttu-id="5833b-162">儲存商務和狀況監控 BizTalk Server 追蹤引擎所追蹤的資料。</span><span class="sxs-lookup"><span data-stu-id="5833b-162">Stores business and health monitoring data tracked by the BizTalk Server tracking engine.</span></span>|  
|<span data-ttu-id="5833b-163">BAM 分析資料庫</span><span class="sxs-lookup"><span data-stu-id="5833b-163">BAM Analysis database</span></span>|<span data-ttu-id="5833b-164">BAMAnalysis</span><span class="sxs-lookup"><span data-stu-id="5833b-164">BAMAnalysis</span></span>|<span data-ttu-id="5833b-165">SQL Server Analysis Services 資料庫的彙總的歷程記錄資料會保留商務活動。</span><span class="sxs-lookup"><span data-stu-id="5833b-165">SQL Server Analysis Services database that keeps the aggregated historical data for Business Activities.</span></span>|  
|<span data-ttu-id="5833b-166">BAM 星狀結構描述資料庫</span><span class="sxs-lookup"><span data-stu-id="5833b-166">BAM Star Schema database</span></span>|<span data-ttu-id="5833b-167">BAMStarSchema</span><span class="sxs-lookup"><span data-stu-id="5833b-167">BAMStarSchema</span></span>|<span data-ttu-id="5833b-168">轉換的 OLAP 處理從商務活動監控所收集的資料。</span><span class="sxs-lookup"><span data-stu-id="5833b-168">Transforms the data collected from Business Activity Monitoring for OLAP Processing.</span></span> <span data-ttu-id="5833b-169">使用 BAM 分析資料庫時，此資料庫是必要的。</span><span class="sxs-lookup"><span data-stu-id="5833b-169">This database is required when using the BAM Analysis database.</span></span>|  
|<span data-ttu-id="5833b-170">BAM 主要匯入資料庫</span><span class="sxs-lookup"><span data-stu-id="5833b-170">BAM Primary Import database</span></span>|<span data-ttu-id="5833b-171">BAMPrimaryImport</span><span class="sxs-lookup"><span data-stu-id="5833b-171">BAMPrimaryImport</span></span>|<span data-ttu-id="5833b-172">活動執行個體之後，會儲存商務活動，然後查詢的進度和資料的事件。</span><span class="sxs-lookup"><span data-stu-id="5833b-172">Stores the events from Business Activities and then queries for the progress and data after activity instances.</span></span> <span data-ttu-id="5833b-173">此資料庫也會執行即時彙總。</span><span class="sxs-lookup"><span data-stu-id="5833b-173">This database also performs real-time aggregations.</span></span>|  
|<span data-ttu-id="5833b-174">BAM 封存資料庫</span><span class="sxs-lookup"><span data-stu-id="5833b-174">BAM Archive database</span></span>|<span data-ttu-id="5833b-175">BAMArchive</span><span class="sxs-lookup"><span data-stu-id="5833b-175">BAMArchive</span></span>|<span data-ttu-id="5833b-176">儲存訂閱述詞。</span><span class="sxs-lookup"><span data-stu-id="5833b-176">Stores subscription predicates.</span></span> <span data-ttu-id="5833b-177">BAM 封存資料庫可將 BAM 主要匯入資料庫中的商務活動資料累積降到最低。</span><span class="sxs-lookup"><span data-stu-id="5833b-177">The BAM Archive database minimizes the accumulation of Business Activity data in the BAM Primary Import database.</span></span>|  
|<span data-ttu-id="5833b-178">SSO 資料庫</span><span class="sxs-lookup"><span data-stu-id="5833b-178">SSO database</span></span>|<span data-ttu-id="5833b-179">SSODB</span><span class="sxs-lookup"><span data-stu-id="5833b-179">SSODB</span></span>|<span data-ttu-id="5833b-180">安全地儲存組態資訊的接收位置。</span><span class="sxs-lookup"><span data-stu-id="5833b-180">Securely stores the configuration information for receive locations.</span></span> <span data-ttu-id="5833b-181">儲存資訊的 SSO 分支機構應用程式，以及所有分支機構應用程式已加密的使用者認證。</span><span class="sxs-lookup"><span data-stu-id="5833b-181">Stores information for SSO affiliate applications, as well as the encrypted user credentials to all the affiliate applications.</span></span>|  
|<span data-ttu-id="5833b-182">規則引擎資料庫</span><span class="sxs-lookup"><span data-stu-id="5833b-182">Rule Engine database</span></span>|<span data-ttu-id="5833b-183">BizTalkRuleEngineDb</span><span class="sxs-lookup"><span data-stu-id="5833b-183">BizTalkRuleEngineDb</span></span>|<span data-ttu-id="5833b-184">儲存機制：</span><span class="sxs-lookup"><span data-stu-id="5833b-184">Repository for:</span></span><br /><br /> <span data-ttu-id="5833b-185">-原則，也就是相關規則的集合。</span><span class="sxs-lookup"><span data-stu-id="5833b-185">-   Policies, which are sets of related rules.</span></span><br /><span data-ttu-id="5833b-186">-詞彙，規則中關於資料參考的使用者易記、 網域特定名稱的集合。</span><span class="sxs-lookup"><span data-stu-id="5833b-186">-   Vocabularies, which are collections of user-friendly, domain-specific names for data references in rules.</span></span>|  
|<span data-ttu-id="5833b-187">BizTalk 基底 EDI 資料庫</span><span class="sxs-lookup"><span data-stu-id="5833b-187">BizTalk Base EDI database</span></span>|<span data-ttu-id="5833b-188">BizTalkEDIDb</span><span class="sxs-lookup"><span data-stu-id="5833b-188">BizTalkEDIDb</span></span>|<span data-ttu-id="5833b-189">儲存追蹤及處理資料的 EDI 文件。</span><span class="sxs-lookup"><span data-stu-id="5833b-189">Stores EDI document tracking and processing data.</span></span>|  
|<span data-ttu-id="5833b-190">人力工作流程服務管理資料庫</span><span class="sxs-lookup"><span data-stu-id="5833b-190">Human Workflow Services Administration database</span></span>|<span data-ttu-id="5833b-191">BizTalkHwsDb</span><span class="sxs-lookup"><span data-stu-id="5833b-191">BizTalkHwsDb</span></span>|<span data-ttu-id="5833b-192">會儲存 BizTalk 「 人力工作流程服務所需的系統管理資訊。</span><span class="sxs-lookup"><span data-stu-id="5833b-192">Stores administrative information required by the BizTalk Human Workflow Services.</span></span>|  
|<span data-ttu-id="5833b-193">交易夥伴管理資料庫</span><span class="sxs-lookup"><span data-stu-id="5833b-193">Trading Partner Management database</span></span>|<span data-ttu-id="5833b-194">TPM</span><span class="sxs-lookup"><span data-stu-id="5833b-194">TPM</span></span>|<span data-ttu-id="5833b-195">商務活動服務 (BAS) 交易夥伴資料存放區。</span><span class="sxs-lookup"><span data-stu-id="5833b-195">Stores trading partner data for Business Activity Services (BAS).</span></span>|  
|<span data-ttu-id="5833b-196">追蹤 Analysis Server 管理資料庫</span><span class="sxs-lookup"><span data-stu-id="5833b-196">Tracking Analysis Server Administration database</span></span>|<span data-ttu-id="5833b-197">BizTalkAnalysisDb</span><span class="sxs-lookup"><span data-stu-id="5833b-197">BizTalkAnalysisDb</span></span>|<span data-ttu-id="5833b-198">儲存商務和狀況監控 OLAP cube。</span><span class="sxs-lookup"><span data-stu-id="5833b-198">Stores both business and health monitoring OLAP cubes.</span></span>|  
  
## <a name="separation-of-data-files-and-log-files"></a><span data-ttu-id="5833b-199">分隔資料檔和記錄檔</span><span class="sxs-lookup"><span data-stu-id="5833b-199">Separation of data files and log files</span></span>  
 <span data-ttu-id="5833b-200">如前文所述，預設的 BizTalk Server 組態會將 MessageBox 資料庫置於單一檔案中的預設檔案群組。</span><span class="sxs-lookup"><span data-stu-id="5833b-200">As noted earlier, a default BizTalk Server configuration places the MessageBox Database into a single file in the default filegroup.</span></span> <span data-ttu-id="5833b-201">根據預設，MessageBox 資料庫的資料和交易記錄檔會放在相同的磁碟機和路徑。</span><span class="sxs-lookup"><span data-stu-id="5833b-201">By default, the data and transaction logs for the MessageBox database are placed on the same drive and path.</span></span> <span data-ttu-id="5833b-202">這是為了配合單一磁碟系統。</span><span class="sxs-lookup"><span data-stu-id="5833b-202">This is done to accommodate systems with a single disk.</span></span> <span data-ttu-id="5833b-203">單一檔案/檔案群組磁碟組態是**並非最佳**實際執行環境中。</span><span class="sxs-lookup"><span data-stu-id="5833b-203">A single file/filegroup/disk configuration is **not optimal** in a production environment.</span></span> <span data-ttu-id="5833b-204">為了達到最佳效能，資料檔案和記錄檔應放在不同磁碟上。</span><span class="sxs-lookup"><span data-stu-id="5833b-204">For optimal performance, the data files and log files should be placed on separate disks.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5833b-205">記錄檔絕不能做為檔案群組的一部分。</span><span class="sxs-lookup"><span data-stu-id="5833b-205">Log files are never part of a filegroup.</span></span> <span data-ttu-id="5833b-206">記錄空間將與資料空間分別管理。</span><span class="sxs-lookup"><span data-stu-id="5833b-206">Log space is managed separately from data space.</span></span>  
  
## <a name="the-8020-rule-of-distributing-biztalk-server-databases"></a><span data-ttu-id="5833b-207">BizTalk Server 資料庫的散發的 80/20 規則</span><span class="sxs-lookup"><span data-stu-id="5833b-207">The 80/20 rule of distributing BizTalk Server databases</span></span>  
 <span data-ttu-id="5833b-208">在大部分的 BizTalk Server 解決方案，因為磁碟 I/O 競爭或資料庫競爭競爭的主要來源是 BizTalk Server MessageBox 資料庫。</span><span class="sxs-lookup"><span data-stu-id="5833b-208">The main source of contention in most BizTalk Server solutions, either because of disk I/O contention or database contention, is the BizTalk Server MessageBox database.</span></span> <span data-ttu-id="5833b-209">這是在單一和多重 MessageBox 的案例中，則為 true。</span><span class="sxs-lookup"><span data-stu-id="5833b-209">This is true in both single and multi-MessageBox scenarios.</span></span> <span data-ttu-id="5833b-210">它是值的合理假設在最多可達 80%的散發 BizTalk 資料庫會值的衍生自最佳化的 MessageBox 資料檔案和記錄檔。</span><span class="sxs-lookup"><span data-stu-id="5833b-210">It is reasonable to assume that as much as 80% of the value of distributing BizTalk databases will be derived from optimizing the MessageBox data files and log file.</span></span> <span data-ttu-id="5833b-211">下列所述的範例案例會著重於最佳化 MessageBox 資料庫的資料檔案。</span><span class="sxs-lookup"><span data-stu-id="5833b-211">The sample scenario detailed below is focused on optimizing the data files for a MessageBox database.</span></span> <span data-ttu-id="5833b-212">這些步驟然後是其他資料庫，視需要。</span><span class="sxs-lookup"><span data-stu-id="5833b-212">These steps can then be followed for other databases as needed.</span></span> <span data-ttu-id="5833b-213">例如，如果解決方案需要大量的追蹤，追蹤資料庫，也可以最佳化。</span><span class="sxs-lookup"><span data-stu-id="5833b-213">For example, if the solution requires extensive tracking, the Tracking database can also be optimized.</span></span>  
  
## <a name="manually-adding-files-to-the-messagebox-database-step-by-step"></a><span data-ttu-id="5833b-214">手動將檔案加入至 MessageBox 資料庫中，逐步</span><span class="sxs-lookup"><span data-stu-id="5833b-214">Manually adding files to the MessageBox database, step-by-step</span></span>  
 <span data-ttu-id="5833b-215">本節的主題描述可供遵循以手動將檔案加入至 MessageBox 資料庫的步驟。</span><span class="sxs-lookup"><span data-stu-id="5833b-215">This section of the topic describes the steps that can be followed to manually add files to the MessageBox database.</span></span> <span data-ttu-id="5833b-216">在這個範例會加入三個檔案群組，然後將檔案加入至每個檔案群組，以便將檔案發佈的 MessageBox 中，跨多個磁碟。</span><span class="sxs-lookup"><span data-stu-id="5833b-216">In this example three filegroups are added and then a file is added to each filegroup to distribute the files for the MessageBox across multiple disks.</span></span>
  
### <a name="manually-adding-files-to-the-messagebox-database-on-sql-server"></a><span data-ttu-id="5833b-217">手動將檔案加入至 SQL 伺服器上的 MessageBox 資料庫</span><span class="sxs-lookup"><span data-stu-id="5833b-217">Manually adding files to the MessageBox database on SQL Server</span></span>
   
1.  <span data-ttu-id="5833b-218">開啟**SQL Server Management Studio**顯示**連接到伺服器** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="5833b-218">Open **SQL Server Management Studio** to display the **Connect to Server** dialog box.</span></span>  
  
     <span data-ttu-id="5833b-219">![SQL Server 登入畫面](../technical-guides/media/sqlserver2008r2-loginscreen.gif "Sqlserver2008r2-kbxxxxxx Loginscreen")</span><span class="sxs-lookup"><span data-stu-id="5833b-219">![SQL Server Login screen](../technical-guides/media/sqlserver2008r2-loginscreen.gif "SQLServer2008R2-Loginscreen")</span></span>  
  
2.  <span data-ttu-id="5833b-220">在**伺服器名稱**編輯方塊**連接到伺服器**對話方塊方塊中，輸入裝載 BizTalk Server MessageBox 資料庫的 SQL Server 執行個體的名稱，然後按一下**連接**顯示 SQL Server Management Studio。</span><span class="sxs-lookup"><span data-stu-id="5833b-220">In the **Server name** edit box of the **Connect to Server** dialog box, enter the name of the SQL Server instance that houses the BizTalk Server MessageBox databases and click **Connect** to display SQL Server Management Studio.</span></span> <span data-ttu-id="5833b-221">在**物件總管 中**窗格中的 SQL Server Management Studio，展開**資料庫**以檢視資料庫的 SQL Server 的這個執行個體。</span><span class="sxs-lookup"><span data-stu-id="5833b-221">In the **Object Explorer** pane of SQL Server Management Studio, expand **Databases** to view the databases for this instance of SQL Server.</span></span>  
  
     <span data-ttu-id="5833b-222">![SQL Server 2005 Management Studio，物件總管 中](../technical-guides/media/81f13912-fedc-48c3-9669-c18863e637b1.gif "81f13912-fedc-48c3-9669-c18863e637b1")</span><span class="sxs-lookup"><span data-stu-id="5833b-222">![SQL Server 2005 Management Studio, Object Explorer](../technical-guides/media/81f13912-fedc-48c3-9669-c18863e637b1.gif "81f13912-fedc-48c3-9669-c18863e637b1")</span></span>  
  
3.  <span data-ttu-id="5833b-223">以滑鼠右鍵按一下要新增檔案，然後再按資料庫**屬性**顯示**資料庫屬性**資料庫 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="5833b-223">Right-click the database to which to add the files, and then click **Properties** to display the **Database Properties** dialog box for the database.</span></span>  
  
     <span data-ttu-id="5833b-224">![SQL Server 2005 資料庫屬性 對話方塊](../technical-guides/media/82ae7c11-5b3a-4312-876c-70876abdd65c.gif "82ae7c11-5b3a-4312-876c-70876abdd65c")</span><span class="sxs-lookup"><span data-stu-id="5833b-224">![SQL Server 2005 Database Properties dialog box](../technical-guides/media/82ae7c11-5b3a-4312-876c-70876abdd65c.gif "82ae7c11-5b3a-4312-876c-70876abdd65c")</span></span>  
  
4.  <span data-ttu-id="5833b-225">在**資料庫屬性**對話方塊中，選取**檔案群組**頁面。</span><span class="sxs-lookup"><span data-stu-id="5833b-225">In the **Database Properties** dialog box, select the **Filegroups** page.</span></span> <span data-ttu-id="5833b-226">若要建立 BizTalkMsgBoxDb 資料庫的其他檔案群組，請按一下**新增**。</span><span class="sxs-lookup"><span data-stu-id="5833b-226">To create additional filegroups for the BizTalkMsgBoxDb databases, click **Add** .</span></span> <span data-ttu-id="5833b-227">在下列範例中，會加入三個額外的檔案群組。</span><span class="sxs-lookup"><span data-stu-id="5833b-227">In the following example, three additional filegroups are added.</span></span>  
  
     <span data-ttu-id="5833b-228">![將檔案群組加入資料庫中的 SQL Server 2005](../technical-guides/media/6be47c0e-06c3-45d9-bce2-a42453da7d19.gif "6be47c0e-06c3-45d9-bce2-a42453da7d19")</span><span class="sxs-lookup"><span data-stu-id="5833b-228">![SQL Server 2005, adding filegroups to a database](../technical-guides/media/6be47c0e-06c3-45d9-bce2-a42453da7d19.gif "6be47c0e-06c3-45d9-bce2-a42453da7d19")</span></span>  
  
5.  <span data-ttu-id="5833b-229">在 **[資料庫屬性]** 對話方塊中，選取 **[檔案]** 頁面。</span><span class="sxs-lookup"><span data-stu-id="5833b-229">In the **Database Properties** dialog box, select the **Files** page.</span></span>  
  
     <span data-ttu-id="5833b-230">若要建立其他檔案加入檔案群組，請按一下**新增**，然後按一下 **確定**。</span><span class="sxs-lookup"><span data-stu-id="5833b-230">To create additional files to add to the filegroups, click **Add** , and then click **OK**.</span></span> <span data-ttu-id="5833b-231">MessageBox 資料庫現在都會分散到多個磁碟、 將提供顯著的效能優勢，透過單一磁碟組態中。</span><span class="sxs-lookup"><span data-stu-id="5833b-231">The MessageBox database is now distributed across multiple disks, which will provide a significant performance advantage over a single disk configuration.</span></span>  
  
     <span data-ttu-id="5833b-232">在下列範例中，針對每個稍早建立的檔案群組建立一個檔案，每個檔案放在不同磁碟上。</span><span class="sxs-lookup"><span data-stu-id="5833b-232">In the following example, a file is created for each of the filegroups that were created earlier and each file is placed on a separate disk.</span></span>  
  
     <span data-ttu-id="5833b-233">![SQL Server 2005，新增檔案至檔案群組](../technical-guides/media/d5d5c5df-d483-4f01-8128-f98228de51b9.gif "d5d5c5df-d483-4f01-8128-f98228de51b9")</span><span class="sxs-lookup"><span data-stu-id="5833b-233">![SQL Server 2005, adding files to a filegroup](../technical-guides/media/d5d5c5df-d483-4f01-8128-f98228de51b9.gif "d5d5c5df-d483-4f01-8128-f98228de51b9")</span></span>  
  
## <a name="sample-sql-script-for-adding-filegroups-and-files-to-the-biztalk-messagebox-database"></a><span data-ttu-id="5833b-234">BizTalk MessageBox 資料庫中加入檔案群組和檔案的範例 SQL 指令碼</span><span class="sxs-lookup"><span data-stu-id="5833b-234">Sample SQL script for adding filegroups and files to the BizTalk MessageBox database</span></span>  
 <span data-ttu-id="5833b-235">本指南包含將檔案群組和檔案加入至 BizTalk Server MessageBox 資料庫的 SQL 指令碼。</span><span class="sxs-lookup"><span data-stu-id="5833b-235">This guide includes an SQL script for adding filegroups and files to the BizTalk Server MessageBox database.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="5833b-236">SQL Server 循序寫入其記錄檔，因為沒有任何效能優勢，藉由建立多個 SQL Server 資料庫的記錄檔，才能實現。</span><span class="sxs-lookup"><span data-stu-id="5833b-236">Because SQL Server writes to its log files sequentially, there is no performance advantage realized by creating multiple log files for a SQL Server database.</span></span>  
  
 <span data-ttu-id="5833b-237">若要執行此指令碼，請遵循下列步驟：</span><span class="sxs-lookup"><span data-stu-id="5833b-237">To run this script, follow these steps:</span></span>  
  
1.  <span data-ttu-id="5833b-238">開啟**SQL Server Management Studio**顯示**連接到伺服器** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="5833b-238">Open **SQL Server Management Studio** to display the **Connect to Server** dialog box.</span></span>  
  
2.  <span data-ttu-id="5833b-239">在**伺服器名稱**編輯方塊**連接到伺服器**對話方塊方塊中，輸入裝載 BizTalk Server MessageBox 資料庫的 SQL Server 執行個體的名稱，然後按一下**連接**以顯示 [SQL Server Management Studio] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="5833b-239">In the **Server name** edit box of the **Connect to Server** dialog box, enter the name of the SQL Server instance that houses the BizTalk Server MessageBox databases and click **Connect** to display the SQL Server Management Studio dialog box.</span></span>  
  
3.  <span data-ttu-id="5833b-240">在 SQL Server Management Studio 中，按一下 **檔案**功能表上，指向**新增**，然後按一下 **使用目前的連接查詢**SQL 查詢編輯器啟動。</span><span class="sxs-lookup"><span data-stu-id="5833b-240">In SQL Server Management Studio, click the **File** menu, point to **New**, and then click **Query with Current Connection** to start the SQL Query Editor.</span></span>  
  
4.  <span data-ttu-id="5833b-241">複製的範例指令碼，從[BizTalk Server MessageBox 資料庫檔案群組 SQL 指令碼](../technical-guides/biztalk-server-messagebox-database-filegroups-sql-script.md)到 查詢編輯器。</span><span class="sxs-lookup"><span data-stu-id="5833b-241">Copy the sample script from [BizTalk Server MessageBox Database Filegroups SQL Script](../technical-guides/biztalk-server-messagebox-database-filegroups-sql-script.md) into the Query Editor.</span></span>  
  
5.  <span data-ttu-id="5833b-242">編輯指令碼以符合您的 BizTalk Server 環境中的參數，然後執行指令碼。</span><span class="sxs-lookup"><span data-stu-id="5833b-242">Edit the parameters in the script to match your BizTalk Server environment, and execute the script.</span></span>  
  
 <span data-ttu-id="5833b-243">指令碼的優點是指令碼可以快速地執行多個工作，可以明確地說，重現和減少人為錯誤的可能性。</span><span class="sxs-lookup"><span data-stu-id="5833b-243">The advantage to scripting is that scripts can perform multiple tasks quickly, can be reproduced precisely, and reduce the possibility of human error.</span></span> <span data-ttu-id="5833b-244">指令碼的缺點是，撰寫不正確的指令碼的執行都可能會造成嚴重的問題，可能需要從頭重新設定 BizTalk Server 資料庫。</span><span class="sxs-lookup"><span data-stu-id="5833b-244">The disadvantage of scripting is that the execution of an incorrectly written script can potentially cause serious problems that could require the BizTalk Server databases to be re-configured from scratch.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="5833b-245">它是責 SQL 指令碼，例如本指南中的範例指令碼會徹底測試，才能在生產環境中執行。</span><span class="sxs-lookup"><span data-stu-id="5833b-245">It is of utmost importance that SQL scripts such as the sample script in this guide are thoroughly tested before being executed in a production environment.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5833b-246">另請參閱</span><span class="sxs-lookup"><span data-stu-id="5833b-246">See Also</span></span>  
 [<span data-ttu-id="5833b-247">最佳化資料庫效能</span><span class="sxs-lookup"><span data-stu-id="5833b-247">Optimizing Database Performance</span></span>](../technical-guides/optimizing-database-performance.md)