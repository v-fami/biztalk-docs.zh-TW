---
title: "不應該變更的 SQL Server 設定 |Microsoft 文件"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 4b383bfb-c3d9-47d4-b294-f6be94302734
caps.latest.revision: "2"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: d2fb6e2553c005d3ba8651c860ff844e8cc74106
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
---
# <a name="sql-server-settings-that-should-not-be-changed"></a><span data-ttu-id="b946e-102">不應該變更的 SQL Server 設定</span><span class="sxs-lookup"><span data-stu-id="b946e-102">SQL Server Settings That Should Not Be Changed</span></span>
<span data-ttu-id="b946e-103">設定時[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]操作整備程序期間[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]，您應該對下列設定進行變更。</span><span class="sxs-lookup"><span data-stu-id="b946e-103">When setting up [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] during the operational readiness procedures for [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], you should not make changes to the following settings.</span></span>  
  
## <a name="sql-server-max-degree-of-parallelism"></a><span data-ttu-id="b946e-104">SQL Server 平行處理原則的最大程度</span><span class="sxs-lookup"><span data-stu-id="b946e-104">SQL Server Max Degree of Parallelism</span></span>  
 <span data-ttu-id="b946e-105">最大程度的平行處理原則 (MDOP) 設定為"1"的組態期間[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]如[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]instance(s) 裝載[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]MessageBox 資料庫。</span><span class="sxs-lookup"><span data-stu-id="b946e-105">Max Degree of Parallelism (MDOP) is set to “1” during the configuration of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] for the [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] instance(s) that host the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] MessageBox database(s).</span></span> <span data-ttu-id="b946e-106">這是[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]執行個體層級設定。</span><span class="sxs-lookup"><span data-stu-id="b946e-106">This is a [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] instance-level setting.</span></span> <span data-ttu-id="b946e-107">從"1"的值不應該變更此設定。</span><span class="sxs-lookup"><span data-stu-id="b946e-107">This setting should not be changed from the value of “1”.</span></span> <span data-ttu-id="b946e-108">將這變更為"1"以外的任何可能造成顯著負面影響[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]預存程序和效能。</span><span class="sxs-lookup"><span data-stu-id="b946e-108">Changing this to anything other than “1” can have a significant negative impact on the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] stored procedures and performance.</span></span> <span data-ttu-id="b946e-109">如果變更的執行個體的平行處理原則設定[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]必須正在執行的其他資料庫應用程式造成負面影響[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]執行個體，您應該建立個別的執行個體[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]專門用來裝載[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]資料庫。</span><span class="sxs-lookup"><span data-stu-id="b946e-109">If changing the parallelism setting for an instance of [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] will have an adverse effect on other database applications that are being executed on the [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] instance, you should create a separate instance of [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] dedicated to hosting the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases.</span></span>  
  
 <span data-ttu-id="b946e-110">平行查詢通常最適合批次處理和決策支援工作負載。</span><span class="sxs-lookup"><span data-stu-id="b946e-110">Parallel queries are generally best suited to batch processing and decision support workloads.</span></span> <span data-ttu-id="b946e-111">它們都是通常不需要在您具有許多簡短、 快速查詢以平行方式執行交易處理環境中。</span><span class="sxs-lookup"><span data-stu-id="b946e-111">They are typically not desirable in a transaction processing environment where you have many short, fast queries running in parallel.</span></span> <span data-ttu-id="b946e-112">此外，變更 MDOP 有時設定原因查詢計畫，以變更，這會導致查詢效能不佳或甚至使用死結[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]查詢。</span><span class="sxs-lookup"><span data-stu-id="b946e-112">In addition, changing the MDOP setting sometimes causes the query plan to be changed, which leads to poor query performance or even deadlocks with the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] queries.</span></span>  
  
 <span data-ttu-id="b946e-113">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]預存程序提供正確的聯結，以及可能的情況下才能讓查詢最佳化工具執行的工作量，以及變更計劃重試鎖定提示。</span><span class="sxs-lookup"><span data-stu-id="b946e-113">The [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] stored procedures provide the correct joins and lock hints wherever possible in order to try to keep the query optimizer from doing much work and changing the plan.</span></span> <span data-ttu-id="b946e-114">這些預存程序來建構查詢，使得查詢最佳化工具取自圖片盡量提供一致的查詢執行。</span><span class="sxs-lookup"><span data-stu-id="b946e-114">These stored procedures provide consistent query executions by constructing the queries such that the query optimizer is taken out of the picture as much as possible.</span></span>  
  
 <span data-ttu-id="b946e-115">如需詳細資訊，請參閱 Microsoft 知識庫文章 899000， [「 平行處理原則設定執行個體的 SQL Server，當您設定 BizTalk Server 」](http://go.microsoft.com/fwlink/?LinkId=153432) (http://go.microsoft.com/fwlink/?LinkId=153432)。</span><span class="sxs-lookup"><span data-stu-id="b946e-115">For more information, see Microsoft Knowledge Base article 899000, ["The Parallelism setting for the instance of SQL Server when you configure BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153432) (http://go.microsoft.com/fwlink/?LinkId=153432).</span></span>  
  
## <a name="sql-server-statistics-on-the-messagebox-database"></a><span data-ttu-id="b946e-116">MessageBox 資料庫上的 SQL Server 統計資料</span><span class="sxs-lookup"><span data-stu-id="b946e-116">SQL Server Statistics on the MessageBox Database</span></span>  
 <span data-ttu-id="b946e-117">下列選項會根據預設，在關閉[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]MessageBox 資料庫建立時：</span><span class="sxs-lookup"><span data-stu-id="b946e-117">The following options are turned off by default in the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] MessageBox database when it is created:</span></span>  
  
-   <span data-ttu-id="b946e-118">自動建立統計資料</span><span class="sxs-lookup"><span data-stu-id="b946e-118">Auto create statistics</span></span>  
  
-   <span data-ttu-id="b946e-119">自動更新統計資料</span><span class="sxs-lookup"><span data-stu-id="b946e-119">Auto update statistics</span></span>  
  
 <span data-ttu-id="b946e-120">請勿啟用這些選項的 MessageBox 資料庫上。</span><span class="sxs-lookup"><span data-stu-id="b946e-120">Do not enable these options on MessageBox databases.</span></span> <span data-ttu-id="b946e-121">啟用 「 自動建立統計資料 」 和 「 自動更新統計資料 」 選項可能會造成非預期的查詢執行延遲，尤其是在高負載的環境。</span><span class="sxs-lookup"><span data-stu-id="b946e-121">Enabling the "auto create statistics" and "auto update statistics" options can cause undesirable query execution delays, especially in a high-load environment.</span></span>  
  
 <span data-ttu-id="b946e-122">此外，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]預存程序有完全聯結和查詢中指定的鎖定提示。</span><span class="sxs-lookup"><span data-stu-id="b946e-122">In addition, the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] stored procedures have exact joins and lock hints specified on the queries.</span></span> <span data-ttu-id="b946e-123">這樣做可確保最佳查詢計劃由[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]中的查詢[!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="b946e-123">This is done to ensure that the optimal query plan is used by the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] queries in [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)].</span></span> <span data-ttu-id="b946e-124">已知的分佈和預期的結果的查詢。已知傳回資料列的大約數目。</span><span class="sxs-lookup"><span data-stu-id="b946e-124">The distributions and expected results for the queries are known; the approximate number of rows returned is known.</span></span> <span data-ttu-id="b946e-125">通常不需要統計資料。</span><span class="sxs-lookup"><span data-stu-id="b946e-125">Statistics are generally not needed.</span></span>  
  
 <span data-ttu-id="b946e-126">如需詳細資訊，請參閱下列 Microsoft 知識庫文件：</span><span class="sxs-lookup"><span data-stu-id="b946e-126">For more information, see the following Microsoft Knowledge Base articles:</span></span>  
  
-   <span data-ttu-id="b946e-127">**912262**—[「 自動更新統計資料選項、 自動建立統計資料選項和平行處理原則設定關閉的裝載 BizTalk Server BizTalkMsgBoxDB 資料庫的 SQL Server 資料庫執行個體 」](http://go.microsoft.com/fwlink/?LinkId=153430)(http://go.microsoft.com/fwlink/?LinkId=153430)。</span><span class="sxs-lookup"><span data-stu-id="b946e-127">**912262**—["The auto update statistics option, the auto create statistics option, and the Parallelism setting are turned off in the SQL Server database instance that hosts the BizTalk Server BizTalkMsgBoxDB database"](http://go.microsoft.com/fwlink/?LinkId=153430) (http://go.microsoft.com/fwlink/?LinkId=153430).</span></span>  
  
-   <span data-ttu-id="b946e-128">**917845**—["您遇到封鎖，死結狀況或其他 SQL Server 問題，當您嘗試連接到 BizTalk Server 中的 BizTalkMsgBoxDb 資料庫"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429)。</span><span class="sxs-lookup"><span data-stu-id="b946e-128">**917845**—["You experience blocking, deadlock conditions, or other SQL Server issues when you try to connect to the BizTalkMsgBoxDb database in BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429).</span></span>  
  
## <a name="changes-to-the-messagebox-database"></a><span data-ttu-id="b946e-129">MessageBox 資料庫的變更</span><span class="sxs-lookup"><span data-stu-id="b946e-129">Changes to the MessageBox Database</span></span>  
 <span data-ttu-id="b946e-130">MessageBox 資料庫應該被視為非 Microsoft 應用程式的原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="b946e-130">The MessageBox database should be treated like non-Microsoft application source code.</span></span> <span data-ttu-id="b946e-131">也就是，您應該不 「 調整 」 透過變更資料表、 索引、 預存程序，以及大多數的 SQL Server 資料庫設定 MessageBox 資料庫。</span><span class="sxs-lookup"><span data-stu-id="b946e-131">That is, you should not “tweak” the MessageBox database via changes to tables, indexes, stored procedures, and most SQL Server database settings.</span></span> <span data-ttu-id="b946e-132">如需詳細資訊，請在 BizTalk 核心引擎的部落格，請參閱文章[」 功能即可與 MessageBox 資料庫伺服器無法執行"](http://go.microsoft.com/fwlink/?LinkId=101577) (http://go.microsoft.com/fwlink/?LinkId=101577)。</span><span class="sxs-lookup"><span data-stu-id="b946e-132">For more information, in the BizTalk Core Engine's WebLog, see the entry ["What you can and can't do with the MessageBox Database server"](http://go.microsoft.com/fwlink/?LinkId=101577) (http://go.microsoft.com/fwlink/?LinkId=101577).</span></span>  
  
## <a name="default-settings-for-the-database-index-rebuilds-and-defragmentation"></a><span data-ttu-id="b946e-133">資料庫索引會重建和重組的預設設定</span><span class="sxs-lookup"><span data-stu-id="b946e-133">Default Settings for the Database Index Rebuilds and Defragmentation</span></span>  
 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="b946e-134">不支援索引重組。</span><span class="sxs-lookup"><span data-stu-id="b946e-134"> does not support defragmenting indexes.</span></span> <span data-ttu-id="b946e-135">「 DBCC INDEXDEFRAG"和"ALTER INDEX …</span><span class="sxs-lookup"><span data-stu-id="b946e-135">“DBCC INDEXDEFRAG” and “ALTER INDEX …</span></span> <span data-ttu-id="b946e-136">重新組織...」</span><span class="sxs-lookup"><span data-stu-id="b946e-136">REORGANIZE …”</span></span> <span data-ttu-id="b946e-137">不支援，因為它們使用頁面鎖定，這會導致封鎖和死結 （deadlock） 與[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="b946e-137">are not supported since they use page locking, which can cause blocking and deadlocks with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="b946e-138">未支援資料庫索引重建作業 （「 DBCC DBREINDEX"和"ALTER INDEX …</span><span class="sxs-lookup"><span data-stu-id="b946e-138"> does support database index rebuilds (“DBCC DBREINDEX” and “ALTER INDEX …</span></span> <span data-ttu-id="b946e-139">REBUILD...")，但只應該執行的維護期間時[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]未處理的資料。</span><span class="sxs-lookup"><span data-stu-id="b946e-139">REBUILD …”), but they should only be done during maintenance windows when [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] is not processing data.</span></span> <span data-ttu-id="b946e-140">索引重建時[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]正在處理不支援資料。</span><span class="sxs-lookup"><span data-stu-id="b946e-140">Index rebuilds while [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] is processing data are not supported.</span></span>  
  
 <span data-ttu-id="b946e-141">如需詳細資訊，請參閱 Microsoft 知識庫文章 917845 ["您遇到封鎖，死結狀況或其他 SQL Server 問題，當您嘗試連接到 BizTalk Server 中的 BizTalkMsgBoxDb 資料庫"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/ 嗎？LinkId = 153429)。</span><span class="sxs-lookup"><span data-stu-id="b946e-141">For more information, see Microsoft Knowledge Base article 917845 [" You experience blocking, deadlock conditions, or other SQL Server issues when you try to connect to the BizTalkMsgBoxDb database in BizTalk Server"](http://go.microsoft.com/fwlink/?LinkId=153429) (http://go.microsoft.com/fwlink/?LinkId=153429).</span></span>  
  
 <span data-ttu-id="b946e-142">索引片段不是最多的效能問題的[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]因為它可以 DSS 系統或 OLTP 系統執行索引掃描。</span><span class="sxs-lookup"><span data-stu-id="b946e-142">Index fragmentation is not as much of a performance issue for [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] as it would be for a DSS system or an OLTP system that performs index scans.</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="b946e-143">沒有謹慎選擇查詢與更新和[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]預存程序不會導致資料表或索引掃描。</span><span class="sxs-lookup"><span data-stu-id="b946e-143"> does very selective queries and updates and [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] stored procedures should not cause table or index scans.</span></span>  
  
 <span data-ttu-id="b946e-144">如需索引片段和工作負載類型的詳細資訊，請參閱["Microsoft SQL Server 2000 索引重組最佳作法 」](http://go.microsoft.com/fwlink/?LinkId=101580) (http://go.microsoft.com/fwlink/?LinkId=101580)。</span><span class="sxs-lookup"><span data-stu-id="b946e-144">For more information about index fragmentation and workload types, see ["Microsoft SQL Server 2000 Index Defragmentation Best Practices"](http://go.microsoft.com/fwlink/?LinkId=101580) (http://go.microsoft.com/fwlink/?LinkId=101580).</span></span> <span data-ttu-id="b946e-145">從發行項的引號：</span><span class="sxs-lookup"><span data-stu-id="b946e-145">A quote from the article:</span></span>  
  
 <span data-ttu-id="b946e-146">「 圖 1 所示，沒有之前和之後重組預存程序的效能之間只有些微的差異。</span><span class="sxs-lookup"><span data-stu-id="b946e-146">“As shown in Figure 1, there is little difference between the performance of the stored procedures before and after defragmenting.</span></span> <span data-ttu-id="b946e-147">發出這些預存程序的基礎查詢作用時謹慎選擇部分資料，因為工作負載效能已不受到負面影響片段化的索引。 」</span><span class="sxs-lookup"><span data-stu-id="b946e-147">Because the underlying queries issued by these stored procedures acted upon very selective portions of the data, workload performance was not adversely affected by fragmented indexes.”</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="b946e-148">發行項的內容也會套用至[!INCLUDE[btsSQLServer2008](../includes/btssqlserver2008-md.md)]和[!INCLUDE[btsSQLServer2005](../includes/btssqlserver2005-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="b946e-148">The contents of the article also apply to [!INCLUDE[btsSQLServer2008](../includes/btssqlserver2008-md.md)] and [!INCLUDE[btsSQLServer2005](../includes/btssqlserver2005-md.md)].</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b946e-149">另請參閱</span><span class="sxs-lookup"><span data-stu-id="b946e-149">See Also</span></span>  
 [<span data-ttu-id="b946e-150">檢查清單： 設定 SQL Server</span><span class="sxs-lookup"><span data-stu-id="b946e-150">Checklist: Configuring SQL Server</span></span>](~/technical-guides/checklist-configuring-sql-server.md)