---
title: 單一登入支援 SOAP 配接器 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- SSO, SOAP adapters
- SOAP adapters, SharePoint Portal Server
- SOAP adapters, SSO
- SharePoint Portal server
ms.assetid: c7bf755c-c37d-4b19-9817-a7f42e1e9656
caps.latest.revision: 18
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: a95673e0f8d7f8a49ba0ad6d5ba6760a6db4b524
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "36966703"
---
# <a name="single-sign-on-support-for-the-soap-adapter"></a><span data-ttu-id="c8b9b-102">SOAP 配接器的單一登入支援</span><span class="sxs-lookup"><span data-stu-id="c8b9b-102">Single Sign-On Support for the SOAP Adapter</span></span>
<span data-ttu-id="c8b9b-103">您可以使用 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 管理主控台來設定「企業單一登入」(SSO) 搭配使用 SOAP 接收位置或傳送埠。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-103">You can use the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console to configure Enterprise Single Sign-On (SSO) for use with the SOAP receive location or send port.</span></span> <span data-ttu-id="c8b9b-104">此主題描述 SSO 如何使用 SOAP 配接器。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-104">This topic describes how SSO works with the SOAP adapter.</span></span>  
  
 <span data-ttu-id="c8b9b-105">**接收位置的 SOAP 的單一登入支援**</span><span class="sxs-lookup"><span data-stu-id="c8b9b-105">**Single Sign-On Support for SOAP Receive Locations**</span></span>  
  
 <span data-ttu-id="c8b9b-106">SOAP 接收位置支援兩個 SSO 版本—[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Enterprise SSO 和 Microsoft SharePoint Portal Server SSO。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-106">SOAP receive locations support two versions of SSO—[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Enterprise SSO and Microsoft SharePoint Portal Server SSO.</span></span> <span data-ttu-id="c8b9b-107">執行「BizTalk Web 服務發佈精靈」可啟用對 SharePoint Portal Server SSO 的支援。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-107">Run the BizTalk Web Services Publishing Wizard to enable support for SharePoint Portal Server SSO.</span></span> <span data-ttu-id="c8b9b-108">如需啟用 SharePoint Portal Server SSO 的詳細資訊，請參閱 <<c0> [ 發佈 Web 服務](../core/publishing-web-services.md)。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-108">For more information about enabling SharePoint Portal Server SSO, see [Publishing Web Services](../core/publishing-web-services.md).</span></span> <span data-ttu-id="c8b9b-109">使用 SOAP 接收位置的屬性頁面可啟用 BizTalk 企業單一登入。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-109">Enable BizTalk Enterprise Single Sign-On by using the property pages for the SOAP receive location.</span></span> <span data-ttu-id="c8b9b-110">如需 SOAP 接收位置啟用 Enterprise SSO 的詳細資訊，請參閱[如何設定 SOAP 接收位置](../core/how-to-configure-a-soap-receive-location.md)。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-110">For more information about enabling Enterprise SSO for the SOAP receive location, see [How to Configure a SOAP Receive Location](../core/how-to-configure-a-soap-receive-location.md).</span></span>  
  
 <span data-ttu-id="c8b9b-111">**企業 SSO 支援 soap 接收位置**</span><span class="sxs-lookup"><span data-stu-id="c8b9b-111">**Enterprise SSO Support for SOAP Receive Locations**</span></span>  
  
 <span data-ttu-id="c8b9b-112">Internet Information Services (IIS) 從 Web 用戶端接收 SOAP 要求，接著 IIS 會驗證使用者，並將安全性識別碼傳遞到 SOAP 配接器。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-112">Internet Information Services (IIS) receives a SOAP request from a Web client, and then IIS authenticates the user and passes the security identifier to the SOAP adapter.</span></span> <span data-ttu-id="c8b9b-113">若 IIS 驗證方法是 [摘要] 驗證、[基本] 驗證或 [整合的 Windows 驗證]，SOAP 配接器會呼叫 SSO 認證存放區，根據已驗證使用者取得加密票證。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-113">If the IIS authentication method is Digest authentication, Basic authentication, or Integrated Windows Authentication, the SOAP adapter calls the SSO credential store to obtain an encrypted ticket based on the authenticated user.</span></span> <span data-ttu-id="c8b9b-114">此票證會儲存為**SSOTicket**訊息內容屬性中的屬性。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-114">This ticket is stored as the **SSOTicket** property in the context property of the message.</span></span>  
  
 <span data-ttu-id="c8b9b-115">在通過實例中，「BizTalk 傳訊引擎」會將訊息導向至 MessageBox 資料庫。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-115">In the pass-through scenario, the BizTalk Messaging Engine directs the message to the MessageBox database.</span></span> <span data-ttu-id="c8b9b-116">當傳送配接器從 MessageBox 資料庫接收訊息時，它會呼叫具有加密票證及應用程式名稱的 RedeemTicket 方法，從 SSO 存放區擷取應用程式的安全性認證。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-116">When a send adapter receives the message from the MessageBox database, it calls the RedeemTicket method with the encrypted ticket along with the application name to retrieve the security credentials for the application from the SSO store.</span></span> <span data-ttu-id="c8b9b-117">接著傳送配接器使用外部認證連接至應用程式並處理要求。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-117">The send adapter then uses the external credentials to connect to the application and process the request.</span></span> <span data-ttu-id="c8b9b-118">如需分支機構應用程式的詳細資訊，請參閱[SSO 分支機構應用程式](../core/sso-affiliate-applications.md)。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-118">For more information about the affiliate applications, see [SSO Affiliate Applications](../core/sso-affiliate-applications.md).</span></span>  
  
 <span data-ttu-id="c8b9b-119">在協調流程叫用傳送配接器的實例中，BizTalk 傳訊引擎會將訊息傳送到 MessageBox 資料庫。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-119">In scenarios where an orchestration invokes the send adapter, the BizTalk Messaging Engine sends the message to the MessageBox database.</span></span> <span data-ttu-id="c8b9b-120">協調流程應確保同時**SSOTicket**內容屬性和**Microsoft.BizTalk.XLANGs.BTXEngine.OriginatorSID**包含票證的訊息內容屬性維護。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-120">The orchestration should ensure that both the **SSOTicket** context property and the **Microsoft.BizTalk.XLANGs.BTXEngine.OriginatorSID** context property of the message that contains the ticket are maintained.</span></span> <span data-ttu-id="c8b9b-121">當配接器從 MessageBox 資料庫接收此訊息時，配接器會呼叫具有加密票證的 RedeemTicket 方法，從 SSO 存放區擷取後端認證。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-121">When the adapter receives this message from the MessageBox database, the adapter calls the RedeemTicket method with the encrypted ticket to retrieve the back-end credentials from the SSO store.</span></span> <span data-ttu-id="c8b9b-122">設計協調流程的使用者應該特別將這個屬性複製到訊息。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-122">The user designing the orchestration should specifically copy this property to the message.</span></span>  
  
 <span data-ttu-id="c8b9b-123">**SharePoint Portal Server SSO 支援 soap 接收位置**</span><span class="sxs-lookup"><span data-stu-id="c8b9b-123">**SharePoint Portal Server SSO Support for SOAP Receive Locations**</span></span>  
  
 <span data-ttu-id="c8b9b-124">與 SharePoint Portal Server 整合時，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 只透過 SOAP 配接器支援使用 Microsoft SharePoint Portal Server SSO。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-124">When integrating with SharePoint Portal Server, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] supports the use of Microsoft SharePoint Portal Server SSO only through the SOAP adapter.</span></span> <span data-ttu-id="c8b9b-125">SharePoint Portal Server 會建立 SSO 票證，並傳送到 SOAP 要求之 SOAP 標頭中的 BizTalk Server。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-125">SharePoint Portal Server creates SSO tickets and sends them to BizTalk Server in a SOAP header of the SOAP request.</span></span> <span data-ttu-id="c8b9b-126">當 SOAP 配接器收到包含 SSO 票證要求時，票證會儲存成**SSOTicket**訊息內容屬性中的屬性。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-126">When the SOAP adapter receives a request containing an SSO ticket, the ticket is stored as the **SSOTicket** property in the context property of the message.</span></span> <span data-ttu-id="c8b9b-127">這個相同的屬性會包含 Enterprise SSO 票證。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-127">This same property would contain an Enterprise SSO ticket.</span></span> <span data-ttu-id="c8b9b-128">只有一個 SSO 票證可以與 BizTalk 訊息關聯。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-128">Only one SSO ticket can be associated with a BizTalk message.</span></span>  
  
 <span data-ttu-id="c8b9b-129">在通過和協調流程實例中，處理從 SharePoint Portal Server 接收的 SSO 票證，與由使用 Enterprise SSO 之 SOAP 配接器建立的票證相同。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-129">In both pass-through and orchestration scenarios, the handling of an SSO ticket received from SharePoint Portal Server is the same as if the ticket were created by the SOAP adapter using Enterprise SSO.</span></span> <span data-ttu-id="c8b9b-130">當傳送配接器接收訊息時，它會呼叫**RedeemTicket**方法具有加密票證產生 SharePoint Portal Server。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-130">When a send adapter receives a message, it calls the **RedeemTicket** method with the encrypted ticket that SharePoint Portal Server generated.</span></span> <span data-ttu-id="c8b9b-131">傳送埠不需要知道存在不同的 SSO 票證。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-131">The send adapter does not need to be aware that different SSO tickets exist.</span></span> <span data-ttu-id="c8b9b-132">**RedeemTicket**會判斷哪個 SSO 系統產生票證方法，並將其兌換的適當位置。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-132">The **RedeemTicket** method will determine which SSO system generated the ticket and redeem it from the appropriate place.</span></span>  
  
 <span data-ttu-id="c8b9b-133">**同時使用 Enterprise SSO 與 SharePoint Portal Server SSO**</span><span class="sxs-lookup"><span data-stu-id="c8b9b-133">**Combined Use of Enterprise SSO and SharePoint Portal Server SSO**</span></span>  
  
 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="c8b9b-134"> 支援同時使用這兩個 SSO 系統。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-134"> supports the simultaneous use of both SSO systems.</span></span> <span data-ttu-id="c8b9b-135">API 可以區分每個 SSO 產生的票證，並將它們從適當的 SSO 資料庫贖回。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-135">The API can differentiate between the tickets generated by each SSO and will redeem them from the appropriate SSO database.</span></span> <span data-ttu-id="c8b9b-136">如果您同時使用這兩個 SSO 系統，下列規則決定的 SSO 票證，SOAP 接收位置將其升級至**SSOTicket**內容屬性：</span><span class="sxs-lookup"><span data-stu-id="c8b9b-136">If you use both SSO systems at the same time, the following rules determine which SSO ticket the SOAP receive location promotes to the **SSOTicket** context property:</span></span>  
  
- <span data-ttu-id="c8b9b-137">若沒有啟用任何一個 SSO，請勿升級票證。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-137">If neither SSO is enabled, do not promote a ticket.</span></span>  
  
- <span data-ttu-id="c8b9b-138">若啟用 Enterprise SSO，但是沒有啟用 SharePoint Portal Server SSO，請擷取並升級 Enterprise SSO 票證。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-138">If the Enterprise SSO is enabled, but the SharePoint Portal Server SSO is not enabled, retrieve and promote the Enterprise SSO ticket.</span></span>  
  
- <span data-ttu-id="c8b9b-139">若啟用 SharePoint Portal Server SSO，但是沒有啟用 Enterprise SSO，請升級現有的 SharePoint Portal Server SSO 票證。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-139">If the SharePoint Portal Server SSO is enabled, but the Enterprise SSO is not enabled, promote the existing SharePoint Portal Server SSO ticket.</span></span>  
  
- <span data-ttu-id="c8b9b-140">若啟用 Enterprise 和 SharePoint Portal Server SSO 兩者：</span><span class="sxs-lookup"><span data-stu-id="c8b9b-140">If both the Enterprise and SharePoint Portal Server SSO are enabled:</span></span>  
  
  -   <span data-ttu-id="c8b9b-141">若已接收 SharePoint Portal Server SSO 票證，請升級該票證。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-141">If the SharePoint Portal Server SSO ticket is received, promote that ticket.</span></span>  
  
  -   <span data-ttu-id="c8b9b-142">若沒有接收 SharePoint Portal Server SSO 票證，請擷取並升級 Enterprise SSO 票證。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-142">If the SharePoint Portal Server SSO ticket is not received, retrieve and promote the Enterprise SSO ticket.</span></span>  
  
  <span data-ttu-id="c8b9b-143">**SOAP 傳送配接器的單一登入支援**</span><span class="sxs-lookup"><span data-stu-id="c8b9b-143">**Single Sign-On Support for the SOAP Send Adapter**</span></span>  
  
  <span data-ttu-id="c8b9b-144">如果已啟用 SSO，當 SOAP 傳送埠收到的訊息**Secure**屬性 (**SSOTicket**)，它會呼叫 SSO 伺服器以驗證並贖回分支機構應用程式的票證。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-144">If SSO is enabled, when a SOAP send port receives a message with the **Secure** property (**SSOTicket**), it calls the SSO server to validate and redeem the ticket for an affiliate application.</span></span> <span data-ttu-id="c8b9b-145">分支機構應用程式的管理應用程式、分支機構系統管理員或 SSO 系統管理員可以呼叫 SSO 贖回票證。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-145">The administration application, affiliate administrators, or SSO administrators for the affiliate application can call SSO to redeem a ticket.</span></span> <span data-ttu-id="c8b9b-146">接著 SSO 會解密票證並取得後端認證。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-146">SSO then decrypts the ticket and obtains the back-end credentials.</span></span> <span data-ttu-id="c8b9b-147">通過和協調流程案例都是相同的 SOAP 傳送埠，主題的 「 企業 SSO 支援 SOAP 接收位置 」 一節中所述[SOAP 配接器的單一登入支援](../core/single-sign-on-support-for-the-soap-adapter.md)。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-147">The pass-through and orchestration scenarios are the same for the SOAP send port, as described in the "Enterprise SSO Support for SOAP Receive Locations" section of the topic [Single Sign-On Support for the SOAP Adapter](../core/single-sign-on-support-for-the-soap-adapter.md).</span></span>  
  
  <span data-ttu-id="c8b9b-148">依照預設，SOAP 傳送埠不會啟用 SSO。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-148">By default, the SOAP send port does not enable SSO.</span></span> <span data-ttu-id="c8b9b-149">如需 SOAP 傳送埠啟用 SSO 的詳細資訊，請參閱 <<c0> [ 如何設定 SOAP 傳送埠](../core/how-to-configure-a-soap-send-port.md)。</span><span class="sxs-lookup"><span data-stu-id="c8b9b-149">For more information about enabling SSO for the SOAP send port, see [How to Configure a SOAP Send Port](../core/how-to-configure-a-soap-send-port.md).</span></span>