---
title: "協議解析、 結構描述探索和授權的收到的 EDI 訊息 |Microsoft 文件"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 503e307c-4cb0-49b5-8751-82dcea203151
caps.latest.revision: "45"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: de5f7fd9b022daf2d123de1c971797b53df202d5
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
---
# <a name="agreement-resolution-schema-discovery-and-authorization-for-received-edi-messages"></a><span data-ttu-id="2f886-102">協議解析、 結構描述探索和授權的收到的 EDI 訊息</span><span class="sxs-lookup"><span data-stu-id="2f886-102">Agreement Resolution, Schema Discovery, and Authorization for Received EDI Messages</span></span>
<span data-ttu-id="2f886-103">當 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 收到 EDI 訊息時，EDI 接收管線會執行交易夥伴協議尋查、結構描述探索和授權程序，以判斷如何處理訊息。</span><span class="sxs-lookup"><span data-stu-id="2f886-103">When [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] receives an EDI message, the EDI receive pipeline performs trading partner agreement lookup, schema discovery, and authorization processes to determine how to process the message.</span></span>  
  
## <a name="agreement-resolution"></a><span data-ttu-id="2f886-104">協議解析</span><span class="sxs-lookup"><span data-stu-id="2f886-104">Agreement Resolution</span></span>  
 <span data-ttu-id="2f886-105">EDI 接收管線會執行一系列的步驟來進行交易夥伴協議解析，以判斷訊息中的標頭欄位和協議定義中的屬性是否相符。</span><span class="sxs-lookup"><span data-stu-id="2f886-105">The EDI receive pipeline performs a trading partner agreement resolution by performing a series of steps to determine whether there is a match between header fields in the message and properties in the agreement definition.</span></span> <span data-ttu-id="2f886-106">一旦 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 判斷出協議，就會決定套用到交換的文件結構描述 (請參閱下文)。</span><span class="sxs-lookup"><span data-stu-id="2f886-106">Once [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] has determined the agreement, it determines the document schema that applies to the interchange (see below).</span></span> <span data-ttu-id="2f886-107">它會使用與相符協議關聯的屬性以及相關的結構描述，來驗證和處理收到的訊息。</span><span class="sxs-lookup"><span data-stu-id="2f886-107">It uses the properties associated with the matching agreement and the relevant schema to validate and process the received message.</span></span>  
  
 <span data-ttu-id="2f886-108">為執行協議解析，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 執行的步驟如下：</span><span class="sxs-lookup"><span data-stu-id="2f886-108">To perform agreement resolution, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] proceeds as follows:</span></span>  
  
1.  <span data-ttu-id="2f886-109">將交換標頭中的傳送者辨識符號和識別碼以及接收者辨識符號和識別碼，與協議屬性中的相同項目比對，以解析協議。</span><span class="sxs-lookup"><span data-stu-id="2f886-109">Resolve the agreement by matching the sender qualifier and identifier, and the receiver qualifier and identifier, in the interchange header with those in the properties of an agreement.</span></span>  
  
2.  <span data-ttu-id="2f886-110">如果步驟 1 未成功，則只比對交換標頭與協議屬性中的傳送者辨識符號和識別碼，以解析協議。</span><span class="sxs-lookup"><span data-stu-id="2f886-110">If step 1 does not succeed, resolve the agreement by matching just the sender qualifier and identifier in the interchange header with those in the properties of an agreement.</span></span> <span data-ttu-id="2f886-111">另外，因為步驟 1 未成功，可以放心地假設 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 將接收訊息。</span><span class="sxs-lookup"><span data-stu-id="2f886-111">Also, because the first step did not succeed, it is safe to assume that [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will be receiving the message.</span></span> <span data-ttu-id="2f886-112">因此，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 會嘗試將接收者辨識符號和識別碼與下列項目比對：</span><span class="sxs-lookup"><span data-stu-id="2f886-112">Hence, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] tries to match the receiver qualifier and identifier with the following:</span></span>  
  
    -   <span data-ttu-id="2f886-113">值 "BT" 與 "HostX12Recvr" (對於 X12 編碼訊息) 和</span><span class="sxs-lookup"><span data-stu-id="2f886-113">Values “BT” and “HostX12Recvr” (for X12-encoded messages) and</span></span>  
  
    -   <span data-ttu-id="2f886-114">值 "BT" 與 "HostEdifactRecvr" (對於 EDIFACT 編碼訊息)</span><span class="sxs-lookup"><span data-stu-id="2f886-114">Values “BT” and “HostEdifactRecvr” (for EDIFACT-encoded messages)</span></span>  
  
    > [!IMPORTANT]
    >  -   <span data-ttu-id="2f886-115">**BizTalk Server 2013 R2 2013 和 2010年**： 是必要的協議設定中的 ISA5、 ISA6、 ISA7、 ISA8、 UNB2.1、 UNB2.2、 UNB3.1 和 UNB3.2 欄位。</span><span class="sxs-lookup"><span data-stu-id="2f886-115">**BizTalk Server 2013 R2, 2013, and 2010**: The ISA5, ISA6, ISA7, ISA8, UNB2.1, UNB2.2, UNB3.1, and UNB3.2 fields are mandatory in the agreement settings.</span></span>  
    > -   <span data-ttu-id="2f886-116">**BizTalk Server 2009 和 2006 R2**: ISA7、 ISA8、 UNB3.1 和 UNB3.2 欄位並非強制的合作對象設定中。</span><span class="sxs-lookup"><span data-stu-id="2f886-116">**BizTalk Server 2009 and 2006 R2**: The ISA7, ISA8, UNB3.1, and UNB3.2 fields are not mandatory in the party settings.</span></span> <span data-ttu-id="2f886-117">如果欄位保留空白，將 EDI 引擎會提供根據 ISA5、 ISA6、 UNB2.1 和 UNB2.2 值解析。</span><span class="sxs-lookup"><span data-stu-id="2f886-117">If the fields are left blank, the EDI engine gives a resolution based on the values of ISA5, ISA6, UNB2.1, and UNB2.2.</span></span>  
    > -   <span data-ttu-id="2f886-118">若要支援較新版本的 BizTalk Server 從 BizTalk Server 2009 和 2006 R2 的解決方式，硬式編碼識別碼 （HostX12Recvr 和 HostEdifactRecvr） 和辨識符號 (BT) 導入。</span><span class="sxs-lookup"><span data-stu-id="2f886-118">To support the resolutions from BizTalk Server 2009 and 2006 R2 to newer versions of BizTalk Server, the hard coded IDs (HostX12Recvr and HostEdifactRecvr) and qualifiers (BT) are introduced.</span></span>  
    > -   <span data-ttu-id="2f886-119">EDIFACT 訊息應該遵循[UNECE 指導方針](http://www.unece.org/tradewelcome/areas-of-work/un-centre-for-trade-facilitation-and-e-business-uncefact/outputs/standards/unedifact/tradeedifactrules.html)訊息語法和規則。</span><span class="sxs-lookup"><span data-stu-id="2f886-119">Your EDIFACT messages should follow the [UNECE guidelines](http://www.unece.org/tradewelcome/areas-of-work/un-centre-for-trade-facilitation-and-e-business-uncefact/outputs/standards/unedifact/tradeedifactrules.html) for message syntax and rules.</span></span>  
  
3.  <span data-ttu-id="2f886-120">如果步驟 2 未成功，則使用後援協議屬性。</span><span class="sxs-lookup"><span data-stu-id="2f886-120">If step 2 does not succeed, use the fallback agreement properties.</span></span>  
  
 <span data-ttu-id="2f886-121">在步驟 1 中，對於 X12，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 將使用下列值來比對：</span><span class="sxs-lookup"><span data-stu-id="2f886-121">In the first step, for X12, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will use the following values to make the match:</span></span>  
  
-   <span data-ttu-id="2f886-122">ISA05 (傳送者辨識符號)</span><span class="sxs-lookup"><span data-stu-id="2f886-122">ISA05 (sender qualifier)</span></span>  
  
-   <span data-ttu-id="2f886-123">ISA06 (傳送者識別碼)</span><span class="sxs-lookup"><span data-stu-id="2f886-123">ISA06 (sender identifier)</span></span>  
  
-   <span data-ttu-id="2f886-124">ISA07 (接收者辨識符號)</span><span class="sxs-lookup"><span data-stu-id="2f886-124">ISA07 (receiver qualifier)</span></span>  
  
-   <span data-ttu-id="2f886-125">ISA08 (接收者識別碼)</span><span class="sxs-lookup"><span data-stu-id="2f886-125">ISA08 (receiver identifier)</span></span>  
  
 <span data-ttu-id="2f886-126">對於 EDIFACT，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 會使用下列值來比對：</span><span class="sxs-lookup"><span data-stu-id="2f886-126">For EDIFACT, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will use the following values to make the match:</span></span>  
  
-   <span data-ttu-id="2f886-127">UNB2.1 （傳送者識別項）</span><span class="sxs-lookup"><span data-stu-id="2f886-127">UNB2.1 (sender identifier)</span></span>  
  
-   <span data-ttu-id="2f886-128">UNB2.2 (傳送者辨識符號)</span><span class="sxs-lookup"><span data-stu-id="2f886-128">UNB2.2 (sender qualifier)</span></span>  
  
-   <span data-ttu-id="2f886-129">UNB3.1 (接收者識別碼)</span><span class="sxs-lookup"><span data-stu-id="2f886-129">UNB3.1 (receiver identifier)</span></span>  
  
-   <span data-ttu-id="2f886-130">UNB3.2 (接收者辨識符號)</span><span class="sxs-lookup"><span data-stu-id="2f886-130">UNB3.2 (receiver qualifier)</span></span>  
  
 <span data-ttu-id="2f886-131">用於比對的協議屬性中定義**識別碼**方向特定協議索引標籤頁面**協議屬性** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2f886-131">The agreement properties used for the match are defined in the **Identifiers** page of the direction-specific agreement tabs of the **Agreement Properties** dialog box.</span></span>  
  
 <span data-ttu-id="2f886-132">這四個接收端和傳送端屬性可唯一識別交易夥伴協議。</span><span class="sxs-lookup"><span data-stu-id="2f886-132">These four receive-side and send-side properties uniquely identify the trading partner agreement.</span></span> <span data-ttu-id="2f886-133">使用這四個屬性，可讓您在接收端處理時有更大的彈性。</span><span class="sxs-lookup"><span data-stu-id="2f886-133">Using the four properties gives you more flexibility in receive-side processing.</span></span> <span data-ttu-id="2f886-134">例如，這種協議解析方式可讓您將通知傳送給多個合作對象，而無須建立多個傳送埠。</span><span class="sxs-lookup"><span data-stu-id="2f886-134">For example, this method of agreement resolution may enable you to send acknowledgments to multiple parties without creating multiple send ports.</span></span>  
  
 <span data-ttu-id="2f886-135">如果[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]無法解析協議使用全部四個傳送者和接收者辨識符號和識別項，它會嘗試解析協議使用傳送者辨識符號和識別項。</span><span class="sxs-lookup"><span data-stu-id="2f886-135">If [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] cannot resolve the agreement using all four sender and receiver qualifiers and identifiers, it will attempt to resolve the agreement using just the sender qualifier and identifier.</span></span> <span data-ttu-id="2f886-136">若為 X12，這些欄位是 ISA05 和 ISA06；若為 EDIFACT，這些欄位則是 UNB2.1 和 UNB2.2。</span><span class="sxs-lookup"><span data-stu-id="2f886-136">For X12, these fields are ISA05 and ISA06; for EDIFACT, these fields are UNB2.1 and UNB2.2.</span></span> <span data-ttu-id="2f886-137">如同傳送者和接收者屬性比對[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]中定義的協議屬性比對交換標頭中的值**識別碼**方向特定協議索引標籤頁面**協議屬性** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2f886-137">As with a match of sender and receiver properties, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] matches the values in the interchange header with the agreement properties defined in the **Identifiers** page of the direction-specific agreement tabs of the **Agreement Properties** dialog box.</span></span> <span data-ttu-id="2f886-138">如果只是傳送者辨識符號和識別項來解析協議，接收者辨識符號和識別項不應定義之雙向協議索引標籤中**協議屬性** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2f886-138">If only the sender qualifier and identifier are used to resolve the agreement, the receiver qualifier and identifier should be undefined in the bi-directional agreement tab of the **Agreement Properties** dialog box.</span></span>  
  
 <span data-ttu-id="2f886-139">如果找不到協議，除非連接埠設定需要驗證，否則 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 會使用遞補交易夥伴協議。</span><span class="sxs-lookup"><span data-stu-id="2f886-139">If no agreement is found, then [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] uses the fallback trading partner agreement, unless the port setting requires authentication.</span></span> <span data-ttu-id="2f886-140">如果通訊埠設定需要驗證 (如果有任一個**驗證失敗時捨棄訊息**或**驗證失敗時保留訊息**上選取了 **一般**頁面**接收埠屬性**)，都需要接收埠收到的任何交換的協議。</span><span class="sxs-lookup"><span data-stu-id="2f886-140">If the port setting requires authentication (if either **Drop messages if authentication fails** or **Keep messages if authentication fails** is selected on the **General** page of the **Receive Port Properties**), an agreement is required for any interchange received by the receive port.</span></span> <span data-ttu-id="2f886-141">在此狀況下，如果協議不是透過比對交換標頭和協議屬性來解析的，則不允許使用後援協議屬性來判斷協議。</span><span class="sxs-lookup"><span data-stu-id="2f886-141">In this case, if the agreement is not resolved by matching the interchange header with agreement properties, using the fallback agreement properties to determine the agreement is not allowed.</span></span> <span data-ttu-id="2f886-142">如果找不到協議，交換會視為驗證失敗並遭擱置。</span><span class="sxs-lookup"><span data-stu-id="2f886-142">The interchange will be treated as though authentication had failed if no agreement is found, and will be suspended.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2f886-143">EDI 管線中的訊息會進入協議解析的後續步驟，直到訊息在協議為啟用狀態的步驟中獲得解析為止。</span><span class="sxs-lookup"><span data-stu-id="2f886-143">A message in the EDI pipeline goes to the succeeding step in Agreement Resolution till the message gets resolved with the step having Agreement in enable state.</span></span> <span data-ttu-id="2f886-144">例如，如果訊息在協議解析的第一個步驟獲得解析，但協議處於停用狀態，則訊息會進入後續解析步驟。</span><span class="sxs-lookup"><span data-stu-id="2f886-144">For example, if the message gets resolved in the first step of Agreement Resolution but the Agreement is in a disabled state then the message goes to the succeeding step for resolution.</span></span>  
  
## <a name="schema-discovery"></a><span data-ttu-id="2f886-145">結構描述探索</span><span class="sxs-lookup"><span data-stu-id="2f886-145">Schema Discovery</span></span>  
 <span data-ttu-id="2f886-146">在 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 判斷解析為訊息的協議之後，它接著必須判斷應使用哪個結構描述來驗證和處理訊息。</span><span class="sxs-lookup"><span data-stu-id="2f886-146">After [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] has determined the agreement that resolves to the message, it must determine the schema that it should use to validate and process the message.</span></span> <span data-ttu-id="2f886-147">它會使用所識別的屬性以**本機主機設定**頁面的單向 （傳送端） 協議索引標籤的**協議屬性** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2f886-147">It does so using the properties identified in the **Local Host Settings** page of the one-way (send side) agreement tab of the **Agreement Properties** dialog box.</span></span>  
  
 <span data-ttu-id="2f886-148">為判斷結構描述，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 必須先判斷結構描述命名空間。</span><span class="sxs-lookup"><span data-stu-id="2f886-148">To determine the schema, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] must first determine the schema namespace.</span></span> <span data-ttu-id="2f886-149">「EDI 解譯器」會使用 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 隨附的標準結構描述預設命名空間，或判斷要用於自訂結構描述的命名空間。</span><span class="sxs-lookup"><span data-stu-id="2f886-149">The EDI Disassembler will either use a default namespace for the standard schemas shipped with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], or it will determine the namespace to be used for a custom schema.</span></span>  
  
 <span data-ttu-id="2f886-150">**本機主機設定**單向協議索引標籤的頁面**協議屬性**對話方塊可讓您設定之值的方格，以判斷自訂命名空間。</span><span class="sxs-lookup"><span data-stu-id="2f886-150">The **Local Host Settings** page of the one-way agreement tab of the **Agreement Properties** dialog box enables you to set up a grid of values to determine a custom namespace.</span></span> <span data-ttu-id="2f886-151">如果找到相符項目在方格中，EDI 解譯器會使用預設的命名空間中**目標命名空間**欄位標示為預設列。</span><span class="sxs-lookup"><span data-stu-id="2f886-151">If no match is found in that grid, the EDI Disassembler uses the default namespace in the **Target namespace** field marked for the default row.</span></span>  
  
### <a name="x12-schema-discovery"></a><span data-ttu-id="2f886-152">X12 結構描述探索</span><span class="sxs-lookup"><span data-stu-id="2f886-152">X12 Schema Discovery</span></span>  
 <span data-ttu-id="2f886-153">若為 X12 編碼訊息，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 會使用內送交換之標頭的應用程式傳送者識別項 (GS02) 和交易集識別碼 (ST01) 來判斷自訂命名空間。</span><span class="sxs-lookup"><span data-stu-id="2f886-153">For X12-encoded messages, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] determines a custom namespace using the application sender identifier (GS02) and the transaction set ID (ST01) from the header of the incoming interchange.</span></span> <span data-ttu-id="2f886-154">它會嘗試尋找這些值和值之間相符項目中的 GS02 和 ST01 屬性**自訂目標命名空間**方格中的**本機主機設定**頁面 (在**交易設定設定**) 之雙向協議索引標籤**協議屬性** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2f886-154">It attempts to find a match between these values and the values for the GS02 and ST01 properties in the **Customize target namespace** grid in the **Local Host Settings** page (under **Transaction Set Settings**) of the bi-directional agreement tab of the **Agreement Properties** dialog box.</span></span> <span data-ttu-id="2f886-155">如果找到相符項目，它會使用格線同一列中指定的目標命名空間，來判斷用來驗證和處理訊息的結構描述。</span><span class="sxs-lookup"><span data-stu-id="2f886-155">If it finds a match, it will use the target namespace identified in the same row of the grid to determine which schema to us to validate and process the message.</span></span> <span data-ttu-id="2f886-156">如果未判斷出目標命名空間，則會使用預設目標命名空間。</span><span class="sxs-lookup"><span data-stu-id="2f886-156">If the target namespace is not determined, then the default target namespace will be used.</span></span> <span data-ttu-id="2f886-157">如果沒有命名空間中**目標命名空間**欄位標示為預設列，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]會使用後援協議屬性中針對指定 X12 編碼訊息，其預設值是目標命名空間`http://schemas.microsoft.com/BizTalk/Edi/X12/2006`.</span><span class="sxs-lookup"><span data-stu-id="2f886-157">If no namespace is identified in the **Target namespace** field marked for the default row, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will use the target namespace identified in the fallback agreement properties for X12-encoded messages, which by default is `http://schemas.microsoft.com/BizTalk/Edi/X12/2006`.</span></span>  
  
 <span data-ttu-id="2f886-158">對於 X12 交換，在找到目標命名空間後，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 會使用下列資訊判斷結構描述：</span><span class="sxs-lookup"><span data-stu-id="2f886-158">For X12 interchanges, after the target namespace is discovered, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] determines the schema using the following information:</span></span>  
  
-   <span data-ttu-id="2f886-159">找到的目標命名空間</span><span class="sxs-lookup"><span data-stu-id="2f886-159">The target namespace just discovered</span></span>  
  
-   <span data-ttu-id="2f886-160">ST03 (如果 GS07 == X - Accredited Standards Committee X12) 的前五個字元代表的版本/版次。</span><span class="sxs-lookup"><span data-stu-id="2f886-160">The version/release in the first five characters of ST03 (if GS07 == X - Accredited Standards Committee X12).</span></span> <span data-ttu-id="2f886-161">如果 ST03 不存在/無效，或未產生結構描述解析，則使用 GS08 或 ISA12 (如果 GS07 != X) 的前五個字元判斷版本。</span><span class="sxs-lookup"><span data-stu-id="2f886-161">If ST03 is not present/invalid or does not result in the schema resolution, then the version is determined by the first five characters of GS08 or of ISA12 (if GS07 != X).</span></span>  
  
-   <span data-ttu-id="2f886-162">ST01 中的 DocType</span><span class="sxs-lookup"><span data-stu-id="2f886-162">The DocType in ST01.</span></span>  
  
 <span data-ttu-id="2f886-163">「EDI 解譯器」會將編碼類型、版本/版次和 DocType 串連在一起來判斷結構描述名稱，例如 "X12_00401_864"。</span><span class="sxs-lookup"><span data-stu-id="2f886-163">The EDI Disassembler concatenates the encoding type, version/release, and DocType to determine the schema name, for example, "X12_00401_864".</span></span> <span data-ttu-id="2f886-164">接著會將目標命名空間與結構描述名稱 (例如，`http://schemas.microsoft.com/BizTalk/Edi/X12/2006/X12#X12_00401_864`) 串連。</span><span class="sxs-lookup"><span data-stu-id="2f886-164">It then concatenates the target namespace with the schema name, for example, `http://schemas.microsoft.com/BizTalk/Edi/X12/2006/X12#X12_00401_864`.</span></span>  
  
 <span data-ttu-id="2f886-165">對於內送 HIPAA 837 交換，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 支援三種 HIPAA 837 結構描述：</span><span class="sxs-lookup"><span data-stu-id="2f886-165">For an incoming HIPAA 837 interchange, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] supports three HIPAA 837 schemas:</span></span>  
  
|<span data-ttu-id="2f886-166">837 結構描述</span><span class="sxs-lookup"><span data-stu-id="2f886-166">837 Schema</span></span>|<span data-ttu-id="2f886-167">版本 4010 中的 GS08 值</span><span class="sxs-lookup"><span data-stu-id="2f886-167">GS08 Value in version 4010</span></span>|<span data-ttu-id="2f886-168">版本 5010 中的 GS08/ST03 值</span><span class="sxs-lookup"><span data-stu-id="2f886-168">GS08/ST03 Value in version 5010</span></span>|  
|----------------|--------------------------------|--------------------------------------|  
|<span data-ttu-id="2f886-169">Claim-Dental_837D</span><span class="sxs-lookup"><span data-stu-id="2f886-169">Claim-Dental_837D</span></span>|<span data-ttu-id="2f886-170">004010X097A1</span><span class="sxs-lookup"><span data-stu-id="2f886-170">004010X097A1</span></span>|<span data-ttu-id="2f886-171">005010X224A1</span><span class="sxs-lookup"><span data-stu-id="2f886-171">005010X224A1</span></span>|  
|<span data-ttu-id="2f886-172">Claim-Institutional_837I</span><span class="sxs-lookup"><span data-stu-id="2f886-172">Claim-Institutional_837I</span></span>|<span data-ttu-id="2f886-173">004010X096A1</span><span class="sxs-lookup"><span data-stu-id="2f886-173">004010X096A1</span></span>|<span data-ttu-id="2f886-174">005010X223A1</span><span class="sxs-lookup"><span data-stu-id="2f886-174">005010X223A1</span></span>|  
|<span data-ttu-id="2f886-175">Claim-Professional_837P</span><span class="sxs-lookup"><span data-stu-id="2f886-175">Claim-Professional_837P</span></span>|<span data-ttu-id="2f886-176">004010X098A1</span><span class="sxs-lookup"><span data-stu-id="2f886-176">004010X098A1</span></span>|<span data-ttu-id="2f886-177">005010X222</span><span class="sxs-lookup"><span data-stu-id="2f886-177">005010X222</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="2f886-178">在 HIPAA 版本中，對於交易集 278 (健康照護服務檢視)，要求與回應配對會針對 GS08 與 ST01 共用相同的值。</span><span class="sxs-lookup"><span data-stu-id="2f886-178">In HIPAA versions, for the transaction set 278 (Health Care Services Review), both the request and response pairs share the same value for GS08 and ST01.</span></span> <span data-ttu-id="2f886-179">依據 BHT02 欄位中的觸發值，您可以區別版本 5010 中的 278 要求/回應：</span><span class="sxs-lookup"><span data-stu-id="2f886-179">Depending on the trigger values in BHT02 field you may differentiate between a 278 Request/ Response in version 5010:</span></span>  
>   
>  1.  <span data-ttu-id="2f886-180">BHT02 中的 01、13 與 36 的任一個值各代表一個健康照護服務檢視要求</span><span class="sxs-lookup"><span data-stu-id="2f886-180">Any of the values 01, 13 and 36 in BHT02 indicates a Health Care Services Review Request</span></span>  
> 2.  <span data-ttu-id="2f886-181">BHT02 中的 11 代表健康照護服務檢視回應</span><span class="sxs-lookup"><span data-stu-id="2f886-181">11 in BHT02 indicates Health Care Services Review Response</span></span>  
  
### <a name="edifact-schema-discovery"></a><span data-ttu-id="2f886-182">EDIFACT 結構描述探索</span><span class="sxs-lookup"><span data-stu-id="2f886-182">EDIFACT Schema Discovery</span></span>  
 <span data-ttu-id="2f886-183">對於 EDIFACT 編碼訊息，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 判斷自訂命名空間的方式是使用內送交換之標頭的訊息類型 (UNH2.1)、訊息版本號碼 (UNH2.2)、訊息版次號碼 (UNH2.3)、指定代碼 (UNH2.5)、功能群組識別碼 (UNG2.1) 以及應用程式傳送識別碼辨識符號 (UNG2.2)。</span><span class="sxs-lookup"><span data-stu-id="2f886-183">For EDIFACT-encoded messages, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] determines a custom namespace using the message type (UNH2.1), message version number (UNH2.2), message release number (UNH2.3), assigned code (UNH2.5), functional group ID (UNG2.1), and application send code qualifier (UNG2.2) from the header of the incoming interchange.</span></span> <span data-ttu-id="2f886-184">接著它會嘗試尋找這些值和值之間相符項目中的 UNH2.1、 UNH2.2、 UNH2.3、 UNH2.5、 UNG2.1 和 UNG2.2 屬性**自訂目標命名空間**方格 (下方**交易集設定**)雙向協議索引標籤的**協議屬性** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="2f886-184">It then attempts to find a match between these values and the values for the UNH2.1, UNH2.2, UNH2.3, UNH2.5, UNG2.1, and UNG2.2 properties in the **Customize target namespace** grid (under **Transaction Set Settings**) of the bi-directional agreement tab of the **Agreement Properties** dialog box.</span></span> <span data-ttu-id="2f886-185">如果找到相符項目，它會使用格線同一列中指定的目標命名空間，來判斷用來驗證和處理訊息的結構描述。</span><span class="sxs-lookup"><span data-stu-id="2f886-185">If it finds a match, it will use the target namespace identified in the same row of the grid to determine which schema to use to validate and process the message.</span></span> <span data-ttu-id="2f886-186">如果未判斷出目標命名空間，則會使用預設目標命名空間。</span><span class="sxs-lookup"><span data-stu-id="2f886-186">If the target namespace is not determined, then the default target namespace will be used.</span></span> <span data-ttu-id="2f886-187">如果沒有命名空間中**目標命名空間**欄位標示為預設列，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]將使用的目標命名空間在後援協議屬性，對於 EDIFACT 編碼訊息，其預設值是`http://schemas.microsoft.com/BizTalk/Edi/EDIFACT/2006`.</span><span class="sxs-lookup"><span data-stu-id="2f886-187">If no namespace is identified in the **Target namespace** field marked for the default row, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will use the target namespace identified in the fallback agreement properties for EDIFACT-encoded messages, which by default is `http://schemas.microsoft.com/BizTalk/Edi/EDIFACT/2006`.</span></span>  
  
 <span data-ttu-id="2f886-188">對於 EDIFACT 交換，在找到目標命名空間後，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 會使用下列資訊判斷結構描述：</span><span class="sxs-lookup"><span data-stu-id="2f886-188">For EDIFACT interchanges, once the target namespace is discovered, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] determines the schema using the following information:</span></span>  
  
-   <span data-ttu-id="2f886-189">找到的目標命名空間。</span><span class="sxs-lookup"><span data-stu-id="2f886-189">The target namespace just discovered.</span></span>  
  
-   <span data-ttu-id="2f886-190">UNH2.2 中的訊息版本號碼。</span><span class="sxs-lookup"><span data-stu-id="2f886-190">The message version number in UNH2.2.</span></span>  
  
-   <span data-ttu-id="2f886-191">UNH2.3 中的訊息版次號碼。</span><span class="sxs-lookup"><span data-stu-id="2f886-191">The message release number in UNH2.3.</span></span>  
  
-   <span data-ttu-id="2f886-192">UNH2.1 中的訊息類型。</span><span class="sxs-lookup"><span data-stu-id="2f886-192">The message type in UNH2.1.</span></span>  
  
-   <span data-ttu-id="2f886-193">UNH2.5 中的指定代碼。</span><span class="sxs-lookup"><span data-stu-id="2f886-193">The assigned code in UNH2.5.</span></span>  
  
 <span data-ttu-id="2f886-194">「EDI 解譯器」會將編碼類型、版本、版次和訊息類型串連在一起來判斷結構描述名稱，例如 " EFACT_D94A_CONTEN"。</span><span class="sxs-lookup"><span data-stu-id="2f886-194">The EDI Disassembler concatenates the encoding type, the version, the release, and the message type to determine the schema name, for example, " EFACT_D94A_CONTEN".</span></span> <span data-ttu-id="2f886-195">接著會將目標命名空間與結構描述名稱 (例如，`http://schemas.microsoft.com/BizTalk/Edi/Edifact/2006/EFACT#EFACT_D94A_CONTEN`) 串連。</span><span class="sxs-lookup"><span data-stu-id="2f886-195">It then concatenates the target namespace with the schema name, for example, `http://schemas.microsoft.com/BizTalk/Edi/Edifact/2006/EFACT#EFACT_D94A_CONTEN`.</span></span>  
  
 <span data-ttu-id="2f886-196">如果訊息中有 UNH2.5，EDI 解譯器會先嘗試使用結構描述名稱中的 UNH2.5 值 (例如，EFACT_D94A_CONTEN_TEST) 來尋找相符的結構描述。</span><span class="sxs-lookup"><span data-stu-id="2f886-196">If UNH2.5 is present in the message, the EDI Disassembler will first attempt to find a matching schema by using the value of UNH2.5 as part of the schema name, for example “EFACT_D94A_CONTEN_TEST”.</span></span> <span data-ttu-id="2f886-197">如果找不到相符的結構描述，EDI 解譯器會回復為尋找不含 UNH2.5 值的結構描述。</span><span class="sxs-lookup"><span data-stu-id="2f886-197">If no matching schema is found, the EDI Disassembler will fall back to finding the schema without the UNH2.5 value.</span></span>  
  
## <a name="authorization"></a><span data-ttu-id="2f886-198">授權</span><span class="sxs-lookup"><span data-stu-id="2f886-198">Authorization</span></span>  
 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="2f886-199"> 會將協議的授權和安全性欄位定義值與訊息中的欄位比對。</span><span class="sxs-lookup"><span data-stu-id="2f886-199"> checks the values of the authorization and security fields defined for the agreement with the fields in the message.</span></span> <span data-ttu-id="2f886-200">如果有不相符的項目，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 會擱置交換。</span><span class="sxs-lookup"><span data-stu-id="2f886-200">If there is a mismatch, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will suspend the interchange.</span></span> <span data-ttu-id="2f886-201">若為 EDIFACT 編碼訊息，這些欄位是收件者參考密碼 (UNB6.1 和 UNB6.2)。</span><span class="sxs-lookup"><span data-stu-id="2f886-201">For EDIFACT-encoded messages, these fields are the recipient reference password (UNB6.1 and UNB6.2).</span></span> <span data-ttu-id="2f886-202">若為 X12 編碼訊息，這些欄位則是 [授權辨識符號和資訊] (ISA1-2) 以及 [安全性辨識符號和資訊] (ISA3-4)。</span><span class="sxs-lookup"><span data-stu-id="2f886-202">For X12-encoded messages, these fields are the Authorization qualifier and information (ISA1-2) and Security qualifier and information (ISA3-4).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2f886-203">另請參閱</span><span class="sxs-lookup"><span data-stu-id="2f886-203">See Also</span></span>  
 [<span data-ttu-id="2f886-204">BizTalk Server 如何接收 EDI 訊息</span><span class="sxs-lookup"><span data-stu-id="2f886-204">How BizTalk Server Receives EDI Messages</span></span>](../core/how-biztalk-server-receives-edi-messages.md)