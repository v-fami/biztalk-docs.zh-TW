---
title: 疑難排解憑證 |Microsoft 文件
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: b7013db6-ebf7-4294-a072-e9b5b0ad0de2
caps.latest.revision: 26
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 963dfdd55937fd3e41fa50a5e2a609dd591f728f
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/28/2017
ms.locfileid: "25975964"
---
# <a name="troubleshooting-certificates"></a><span data-ttu-id="535f9-102">憑證疑難排解</span><span class="sxs-lookup"><span data-stu-id="535f9-102">Troubleshooting Certificates</span></span>
<span data-ttu-id="535f9-103">Microsoft [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 可以將公開金鑰基礎結構 (PKI) 數位憑證用於文件加密和解密作業、文件簽署和驗證 (不可否認性) 作業，以及用於合作對象解析作業。</span><span class="sxs-lookup"><span data-stu-id="535f9-103">Microsoft [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] can make use of public key infrastructure (PKI) digital certificates for purposes of document encryption and decryption, document signing and verification (non-repudiation) and for party resolution.</span></span> <span data-ttu-id="535f9-104">本主題將描述各種憑證使用方式案例和組態選項，並提供搭配 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 使用數位憑證的一些一般性指導方針。</span><span class="sxs-lookup"><span data-stu-id="535f9-104">This topic describes various certification usage scenarios and configuration options and provides some general guidelines for using digital certificates with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
## <a name="certificate-usage-scenarios-and-configuration-options"></a><span data-ttu-id="535f9-105">憑證使用方式案例和組態選項</span><span class="sxs-lookup"><span data-stu-id="535f9-105">Certificate Usage Scenarios and Configuration Options</span></span>  
 <span data-ttu-id="535f9-106">在搭配 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 使用憑證時所發生的大多數問題，都是因為組態不正確或不完整所造成。</span><span class="sxs-lookup"><span data-stu-id="535f9-106">Most problems that occur while using certificates with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] are a result of incorrect or incomplete configuration.</span></span> <span data-ttu-id="535f9-107">例如，將正確的憑證匯入錯誤的憑證存放區、將不正確的憑證匯入正確的存放區，或是未能將適當的資訊輸入到 BizTalk 管理主控台，將會造成使用憑證時發生執行階段錯誤。</span><span class="sxs-lookup"><span data-stu-id="535f9-107">For example importing the correct certificate into the wrong certificate store, the incorrect certificate into the correct store, or failure to enter the appropriate information into the BizTalk Administration console will cause run-time errors to occur when using certificates.</span></span>  
  
 <span data-ttu-id="535f9-108">使用下表當做 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 中提供之憑證使用方式案例和組態選項的參考：</span><span class="sxs-lookup"><span data-stu-id="535f9-108">Use the following table as a reference for the certificate usage scenarios and configuration options available in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]:</span></span>  
  
|<span data-ttu-id="535f9-109">**憑證使用方式**</span><span class="sxs-lookup"><span data-stu-id="535f9-109">**Certificate Usage**</span></span>|<span data-ttu-id="535f9-110">**使用者內容**</span><span class="sxs-lookup"><span data-stu-id="535f9-110">**User Context**</span></span>|<span data-ttu-id="535f9-111">**憑證存放區位置**</span><span class="sxs-lookup"><span data-stu-id="535f9-111">**Certificate Store Location**</span></span>|<span data-ttu-id="535f9-112">**憑證類型**</span><span class="sxs-lookup"><span data-stu-id="535f9-112">**Certificate Type**</span></span>|<span data-ttu-id="535f9-113">**使用的管線元件**</span><span class="sxs-lookup"><span data-stu-id="535f9-113">**Pipeline Component Used**</span></span>|<span data-ttu-id="535f9-114">**BizTalk Server 管理主控台中的組態參數**</span><span class="sxs-lookup"><span data-stu-id="535f9-114">**Configuration Parameters in the BizTalk Server Administration Console**</span></span>|  
|---------------------------|----------------------|------------------------------------|--------------------------|---------------------------------|-------------------------------------------------------------------------------|  
|<span data-ttu-id="535f9-115">加密 (傳送)</span><span class="sxs-lookup"><span data-stu-id="535f9-115">Encryption (Sending)</span></span>|<span data-ttu-id="535f9-116">與傳送處理常式關聯之主控件執行個體所使用的帳戶</span><span class="sxs-lookup"><span data-stu-id="535f9-116">Account used by the host instance associated with the send handler</span></span>|<span data-ttu-id="535f9-117">登入執行每一部電腦[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]，將要裝載 S/MIME 編碼器管線，並加密憑證匯入**本機電腦 \ 其他人**儲存。</span><span class="sxs-lookup"><span data-stu-id="535f9-117">Log on to each computer running [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] that will host S/MIME encoder pipelines and import the encryption certificate into the **Local Computer \ Other People** store.</span></span>|<span data-ttu-id="535f9-118">交易夥伴公用憑證</span><span class="sxs-lookup"><span data-stu-id="535f9-118">Trading partner public certificate</span></span>|<span data-ttu-id="535f9-119">MIME/SMIME 編碼器</span><span class="sxs-lookup"><span data-stu-id="535f9-119">MIME/SMIME encoder</span></span>|<span data-ttu-id="535f9-120">-指定的加密憑證值**一般名稱**和**指紋**上**憑證**頁面**傳送埠屬性** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="535f9-120">-   Specify values for the encryption certificate **Common Name** and **Thumbprint** on the **Certificate** page of the **Send Port Properties** dialog box.</span></span><br /><span data-ttu-id="535f9-121">指定管線**編碼**中選項**設定管線** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="535f9-121">-   Specify pipeline **Encode** options in the **Configure Pipeline** dialog box.</span></span> <span data-ttu-id="535f9-122">**設定管線**旁按一下按鈕會顯示對話方塊**傳送管線**下拉式清單上的**一般**頁面**傳送連接埠內容** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="535f9-122">The **Configure Pipeline** dialog box is displayed by clicking the button next to the **Send pipeline** drop-down list on the **General** page of the **Send Port Properties** dialog box.</span></span>|  
|<span data-ttu-id="535f9-123">解密 (接收)</span><span class="sxs-lookup"><span data-stu-id="535f9-123">Decryption (Receiving)</span></span>|<span data-ttu-id="535f9-124">與接收處理常式關聯之主控件執行個體所使用的帳戶</span><span class="sxs-lookup"><span data-stu-id="535f9-124">Account used by the host instance associated with the receive handler</span></span>|<span data-ttu-id="535f9-125">登入執行每一部電腦[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]，server 將要裝載 S/MIME 解碼器管線做為每個主控件執行個體服務帳戶 」，並將解密憑證匯入**目前使用者 \ 個人**儲存。</span><span class="sxs-lookup"><span data-stu-id="535f9-125">Log on to each computer running [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] that will host S/MIME decoder pipelines as each host instance service account, and import the decryption certificate to the **Current User \ Personal** store.</span></span> <span data-ttu-id="535f9-126">**注意：** IIS 7.0 電腦上成功解密管線，請確認 IIS 應用程式集區帳戶和相關聯的接收處理常式的主控件執行個體所使用的帳戶都相同，而且此帳戶是的成員\<machineName\>\IIS_WPG 群組。</span><span class="sxs-lookup"><span data-stu-id="535f9-126">**Note:**  For pipeline decryption to succeed on an IIS 7.0 computer, ensure that the account for the IIS application pool and the account used by the host instance associated with the receive handler are the same and that this account is a member of the \<machineName\>\IIS_WPG group.</span></span> <span data-ttu-id="535f9-127">如需適用於 IIS 7.0 設定 IIS 處理序識別的詳細資訊，請參閱[解決 IIS 權限問題的指導方針](../core/guidelines-for-resolving-iis-permissions-problems.md)。</span><span class="sxs-lookup"><span data-stu-id="535f9-127">For more information about setting IIS process identity for IIS 7.0, see [Guidelines for Resolving IIS Permissions Problems](../core/guidelines-for-resolving-iis-permissions-problems.md).</span></span> <span data-ttu-id="535f9-128">這些處理序必須在相同的帳戶下執行，以確保可載入帳戶設定檔，而這樣會載入在管線中執行解密所需的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="535f9-128">These processes must run under the same account to ensure that the account profile is loaded which in turns loads the registry keys required to perform decryption in the pipeline.</span></span> <span data-ttu-id="535f9-129">基於效能的理由，IIS 6.0 在啟動關聯的 w3wp.exe 處理序時，並不會載入帳戶設定檔，如此一來，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 主控件執行個體就必須設定相同的帳戶，好讓 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 會載入帳戶設定檔和登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="535f9-129">For performance reasons, IIS 6.0 does not load the account profile when starting the associated w3wp.exe process so the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] host instance must be configured with the same account so that [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will load the account profile and registry keys.</span></span>|<span data-ttu-id="535f9-130">自有私用憑證</span><span class="sxs-lookup"><span data-stu-id="535f9-130">Own private certificate</span></span>|<span data-ttu-id="535f9-131">MIME/SMIME 解碼器</span><span class="sxs-lookup"><span data-stu-id="535f9-131">MIME/SMIME decoder</span></span>|<span data-ttu-id="535f9-132">-指定的解密憑證值**一般名稱**和**指紋**上**憑證**每個頁面**主控件屬性** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="535f9-132">-   Specify values for the decryption certificate **Common Name** and **Thumbprint** on the **Certificates** page of each **Host Properties** dialog box.</span></span><br /><span data-ttu-id="535f9-133">指定管線**解碼**中選項**設定管線** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="535f9-133">-   Specify pipeline **Decode** options in the **Configure Pipeline** dialog box.</span></span> <span data-ttu-id="535f9-134">**設定管線**旁按一下按鈕會顯示對話方塊**接收管線**下拉式清單上的**一般**頁面**接收位置屬性** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="535f9-134">The **Configure Pipeline** dialog box is displayed by clicking the button next to the **Receive pipeline** drop-down list on the **General** page of the **Receive Location Properties** dialog box.</span></span>|  
|<span data-ttu-id="535f9-135">簽章 (傳送)</span><span class="sxs-lookup"><span data-stu-id="535f9-135">Signature (Sending)</span></span>|<span data-ttu-id="535f9-136">與傳送處理常式關聯之主控件執行個體所使用的帳戶</span><span class="sxs-lookup"><span data-stu-id="535f9-136">Account used by the host instance associated with the send handler</span></span>|<span data-ttu-id="535f9-137">登入執行每一部電腦[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]，server 將要裝載 S/MIME 編碼器管線做為每個主控件執行個體服務帳戶 」，並將簽章憑證匯入**目前使用者 \ 個人**儲存。</span><span class="sxs-lookup"><span data-stu-id="535f9-137">Log on to each computer running [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] that will host S/MIME encoder pipelines as each host instance service account, and import the signature certificate to the **Current User \ Personal** store.</span></span>|<span data-ttu-id="535f9-138">自有私用憑證</span><span class="sxs-lookup"><span data-stu-id="535f9-138">Own private certificate</span></span>|<span data-ttu-id="535f9-139">MIME/SMIME 編碼器</span><span class="sxs-lookup"><span data-stu-id="535f9-139">MIME/SMIME encoder</span></span>|<span data-ttu-id="535f9-140">-指定的簽章憑證值**一般名稱**和**指紋**上**憑證**頁面**BizTalk 群組屬性** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="535f9-140">-   Specify values for the signature certificate **Common Name** and **Thumbprint** on the **Certificate** page of the **BizTalk Group Properties** dialog box.</span></span> <span data-ttu-id="535f9-141">**注意：** 只有一個簽章憑證可以指定每個[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]群組。</span><span class="sxs-lookup"><span data-stu-id="535f9-141">**Note:**      Only one signature certificate can be specified per each [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] group.</span></span><br /><span data-ttu-id="535f9-142">指定管線**編碼**中選項**設定管線** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="535f9-142">-   Specify pipeline **Encode** options in the **Configure Pipeline** dialog box.</span></span> <span data-ttu-id="535f9-143">**設定管線**旁按一下按鈕會顯示對話方塊**傳送管線**下拉式清單上的**一般**頁面**傳送連接埠內容** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="535f9-143">The **Configure Pipeline** dialog box is displayed by clicking the button next to the **Send pipeline** drop-down list on the **General** page of the **Send Port Properties** dialog box.</span></span>|  
|<span data-ttu-id="535f9-144">簽章驗證 (接收)</span><span class="sxs-lookup"><span data-stu-id="535f9-144">Signature Verification (Receiving)</span></span>|<span data-ttu-id="535f9-145">與接收處理常式關聯之主控件執行個體所使用的帳戶</span><span class="sxs-lookup"><span data-stu-id="535f9-145">Account used by the host instance associated with the receive handler</span></span>|<span data-ttu-id="535f9-146">登入執行每一部電腦[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]，將要裝載 S/MIME 解碼器管線，並將簽章憑證匯入**本機電腦 \ 其他人**儲存。</span><span class="sxs-lookup"><span data-stu-id="535f9-146">Log on to each computer running [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] that will host S/MIME decoder pipelines and import the signature certificate to the **Local Computer \ Other People** store.</span></span>|<span data-ttu-id="535f9-147">交易夥伴公用憑證</span><span class="sxs-lookup"><span data-stu-id="535f9-147">Trading partner public certificate</span></span>|<span data-ttu-id="535f9-148">MIME/SMIME 解碼器</span><span class="sxs-lookup"><span data-stu-id="535f9-148">MIME/SMIME decoder</span></span>|<span data-ttu-id="535f9-149">-指定的驗證憑證值**一般名稱**和**指紋**上**憑證**每個頁面**合作對象屬性** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="535f9-149">-   Specify values for the verification certificate **Common Name** and **Thumbprint** on the **Certificates** page of each **Party Properties** dialog box.</span></span><br /><span data-ttu-id="535f9-150">指定管線**解碼**中選項**設定管線** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="535f9-150">-   Specify pipeline **Decode** options in the **Configure Pipeline** dialog box.</span></span> <span data-ttu-id="535f9-151">**設定管線**旁按一下按鈕會顯示對話方塊**接收管線**下拉式清單上的**一般**頁面**接收位置屬性** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="535f9-151">The **Configure Pipeline** dialog box is displayed by clicking the button next to the **Receive pipeline** drop-down list on the **General** page of the **Receive Location Properties** dialog box.</span></span> <span data-ttu-id="535f9-152">**注意：** 組態**解碼**選項必須部署具有 MIME/SMIME 解碼器元件的管線。</span><span class="sxs-lookup"><span data-stu-id="535f9-152">**Note:**      Configuration of the **Decode** option requires that a pipeline with the MIME/SMIME decoder component is deployed.</span></span>|  
|<span data-ttu-id="535f9-153">合作對象解析 (接收)</span><span class="sxs-lookup"><span data-stu-id="535f9-153">Party Resolution (Receiving)</span></span>|<span data-ttu-id="535f9-154">與接收處理常式關聯之主控件執行個體所使用的帳戶</span><span class="sxs-lookup"><span data-stu-id="535f9-154">Account used by the host instance associated with the receive handler</span></span>|<span data-ttu-id="535f9-155">登入[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]電腦從合作對象解析正在設定時，與匯入憑證**本機電腦 \ 其他人**儲存。</span><span class="sxs-lookup"><span data-stu-id="535f9-155">Log on to the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer from which party resolution is being configured, and import the certificate into the **Local Computer \ Other People** store.</span></span>|<span data-ttu-id="535f9-156">交易夥伴公用憑證</span><span class="sxs-lookup"><span data-stu-id="535f9-156">Trading partner public certificate</span></span>|<span data-ttu-id="535f9-157">合作對象解析</span><span class="sxs-lookup"><span data-stu-id="535f9-157">Party resolution</span></span>|<span data-ttu-id="535f9-158">-指定的憑證值**一般名稱**和**指紋**上**憑證**每個頁面**主控件屬性**對話方塊.</span><span class="sxs-lookup"><span data-stu-id="535f9-158">-   Specify values for the certificate **Common Name** and **Thumbprint** on the **Certificates** page of each **Host Properties** dialog box.</span></span><br /><span data-ttu-id="535f9-159">-指定**解析合作對象**中選項**設定管線** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="535f9-159">-   Specify **ResolveParty** options in the **Configure Pipeline** dialog box.</span></span> <span data-ttu-id="535f9-160">**設定管線**旁按一下按鈕會顯示對話方塊**接收管線**下拉式清單上的**一般**頁面**接收位置屬性** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="535f9-160">The **Configure Pipeline** dialog box is displayed by clicking the button next to the **Receive pipeline** drop-down list on the **General** page of the **Receive Location Properties** dialog box.</span></span> <span data-ttu-id="535f9-161">**注意：** 此選項的組態需要使用包含管線**合作對象解析**元件。</span><span class="sxs-lookup"><span data-stu-id="535f9-161">**Note:**      Configuration of this option requires the use of a pipeline that contains the **Party resolution** component.</span></span> <span data-ttu-id="535f9-162">**XMLReceive**管線包含**合作對象解析**元件。</span><span class="sxs-lookup"><span data-stu-id="535f9-162">The **XMLReceive** pipeline contains the **Party resolution** component.</span></span>|  
|<span data-ttu-id="535f9-163">HTTPS (傳送)</span><span class="sxs-lookup"><span data-stu-id="535f9-163">HTTPS (Sending)</span></span>|<span data-ttu-id="535f9-164">與傳送處理常式關聯之主控件執行個體所使用的帳戶</span><span class="sxs-lookup"><span data-stu-id="535f9-164">Account used by the host instance associated with the send handler</span></span>|<span data-ttu-id="535f9-165">SSL 通訊不需要用戶端憑證。</span><span class="sxs-lookup"><span data-stu-id="535f9-165">SSL communication does not require a client certificate.</span></span> <span data-ttu-id="535f9-166">是否需要用戶端憑證是由目的地 Web 伺服器管理員自由決定。</span><span class="sxs-lookup"><span data-stu-id="535f9-166">Whether a client certificate is required is at the discretion of the destination Web server administrator.</span></span> <span data-ttu-id="535f9-167">如果目的地 Web 伺服器需要用戶端憑證，請遵循下列步驟：</span><span class="sxs-lookup"><span data-stu-id="535f9-167">If the destination Web server requires a client certificate then follow these steps:</span></span><br /><br /> <span data-ttu-id="535f9-168">-從交易夥伴取得公用憑證。</span><span class="sxs-lookup"><span data-stu-id="535f9-168">-   Obtain the public certificate from the trading partner.</span></span><br /><span data-ttu-id="535f9-169">-登入執行每一部電腦[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]為相關聯的傳送處理常式的主控件執行個體所使用的帳戶。</span><span class="sxs-lookup"><span data-stu-id="535f9-169">-   Log on to each computer running [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] as the account used by the host instance associated with the send handler.</span></span><br /><span data-ttu-id="535f9-170">匯入憑證**目前使用者 \ 個人**儲存。</span><span class="sxs-lookup"><span data-stu-id="535f9-170">-   Import the certificate into the **Current User \ Personal** store.</span></span><br /><br /> <span data-ttu-id="535f9-171">如需如何使用 Windows Server 2008 憑證服務網頁取得憑證資訊，請參閱[要求憑證透過網頁](http://go.microsoft.com/fwlink/?LinkId=129628)。</span><span class="sxs-lookup"><span data-stu-id="535f9-171">For information about how to obtain a certificate using Windows Server 2008 Certificate Services Web pages, see [Request a Certificate Over the Web](http://go.microsoft.com/fwlink/?LinkId=129628).</span></span>|<span data-ttu-id="535f9-172">交易夥伴公用憑證</span><span class="sxs-lookup"><span data-stu-id="535f9-172">Trading partner public certificate</span></span>|<span data-ttu-id="535f9-173">NA</span><span class="sxs-lookup"><span data-stu-id="535f9-173">NA</span></span>|<span data-ttu-id="535f9-174">-   **HTTP 傳輸**-設定**SSL 用戶端憑證指紋**選項**驗證** 索引標籤**HTTP 傳輸屬性**對話方塊.</span><span class="sxs-lookup"><span data-stu-id="535f9-174">-   **HTTP Transport** - Set the **SSL client certificate thumbprint** option on the **Authentication** tab of the **HTTP Transport Properties** dialog box.</span></span> <span data-ttu-id="535f9-175">**HTTP 傳輸屬性**會顯示對話方塊，即可**設定**按鈕**一般**頁面**傳送埠屬性**  對話方塊。</span><span class="sxs-lookup"><span data-stu-id="535f9-175">The **HTTP Transport Properties** dialog box is displayed by clicking the **Configure** button on the **General** page of the **Send Port Properties** dialog box.</span></span><br /><span data-ttu-id="535f9-176">-   **SOAP 傳輸**-設定**用戶端憑證指紋**選項**一般** 索引標籤**SOAP 傳輸屬性** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="535f9-176">-   **SOAP Transport** - Set the **Client certificate thumbprint** option on the **General** tab of the **SOAP Transport Properties** dialog box.</span></span> <span data-ttu-id="535f9-177">**SOAP 傳輸屬性**會顯示對話方塊，即可**設定**按鈕**一般**頁面**傳送埠屬性**  對話方塊。</span><span class="sxs-lookup"><span data-stu-id="535f9-177">The **SOAP Transport Properties** dialog box is displayed by clicking the **Configure** button on the **General** page of the **Send Port Properties** dialog box.</span></span>|  
  
#### <a name="to-display-the-certificates-management-console-interface-for-local-computer-and-current-user"></a><span data-ttu-id="535f9-178">顯示 [本機電腦] 和 [目前使用者] 的 [憑證管理主控台] 介面</span><span class="sxs-lookup"><span data-stu-id="535f9-178">To display the Certificates Management Console interface for Local Computer and Current User</span></span>  
  
1.  <span data-ttu-id="535f9-179">按一下**啟動**，按一下**執行**，型別**MMC**，按一下**確定**開啟**Microsoft Management Console**.</span><span class="sxs-lookup"><span data-stu-id="535f9-179">Click **Start**, click **Run**, type **MMC**, and click **OK** to open the **Microsoft Management Console**.</span></span>  
  
2.  <span data-ttu-id="535f9-180">按一下**檔案**功能表，然後再按一下**新增/移除嵌入式管理單元**顯示**新增/移除嵌入式管理單元** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="535f9-180">Click the **File** menu, and then click **Add/Remove Snap-in** to display the **Add/Remove Snap-in** dialog box.</span></span>  
  
3.  <span data-ttu-id="535f9-181">選取**憑證**從可用的嵌入式管理單元，然後按一下清單**新增**。</span><span class="sxs-lookup"><span data-stu-id="535f9-181">Select **Certificates** from the list of available snap-ins and click **Add**.</span></span>  
  
4.  <span data-ttu-id="535f9-182">選取**電腦帳戶**，按一下 **下一步**，然後按一下 **完成**。</span><span class="sxs-lookup"><span data-stu-id="535f9-182">Select **Computer account**, click **Next**, and then click **Finish**.</span></span> <span data-ttu-id="535f9-183">這會新增**憑證管理主控台**介面**本機電腦**。</span><span class="sxs-lookup"><span data-stu-id="535f9-183">This will add the **Certificates Management Console** interface for **Local Computer**.</span></span>  
  
5.  <span data-ttu-id="535f9-184">請確認**憑證**仍然有選取的嵌入式管理單元清單，然後按一下 **新增**一次。</span><span class="sxs-lookup"><span data-stu-id="535f9-184">Ensure that **Certificates** is still selected from the list of snap-ins, and then click **Add** again.</span></span>  
  
6.  <span data-ttu-id="535f9-185">選取**我的使用者帳戶**，然後按一下 **完成**。</span><span class="sxs-lookup"><span data-stu-id="535f9-185">Select **My user account** and then click **Finish**.</span></span> <span data-ttu-id="535f9-186">這會新增**憑證管理主控台**介面**目前使用者**。</span><span class="sxs-lookup"><span data-stu-id="535f9-186">This will add the **Certificates Management Console** interface for **Current User**.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="535f9-187">這會顯示**憑證管理主控台**您目前為登入的帳戶。</span><span class="sxs-lookup"><span data-stu-id="535f9-187">This displays the **Certificates Management Console** for the account that you are currently logged on as.</span></span> <span data-ttu-id="535f9-188">如果您需要針對某個服務帳戶將憑證匯入「個人」存放區，您應該先使用該服務帳戶認證來登入。</span><span class="sxs-lookup"><span data-stu-id="535f9-188">If you need to import certificates into the Personal store for a service account then you should log on with the service account credentials first.</span></span>  
  
7.  <span data-ttu-id="535f9-189">按一下**確定**按鈕**新增/移除嵌入式管理單元** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="535f9-189">Click the **OK** button on the **Add/Remove Snap-in** dialog box.</span></span>  
  
## <a name="general-guidelines"></a><span data-ttu-id="535f9-190">一般指導方針</span><span class="sxs-lookup"><span data-stu-id="535f9-190">General Guidelines</span></span>  
  
-   <span data-ttu-id="535f9-191">**確定匯入的憑證用於其預期目的**： 若要這樣做，請連按兩下中的憑證**憑證管理主控台**介面，然後按一下 **詳細資料**  索引標籤**憑證** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="535f9-191">**Ensure that the imported certificate is being used for its intended purpose**: To do this, double-click the certificate in the **Certificates Management Console** interface and then click the **Details** tab of the **Certificate** dialog box.</span></span> <span data-ttu-id="535f9-192">然後按一下 **所有**選項**顯示**下拉式清單，然後按一下以選取**金鑰使用方法**及/或**增強金鑰使用方法**欄位若要驗證的預定的用途。</span><span class="sxs-lookup"><span data-stu-id="535f9-192">Then click the **All** option for the **Show** drop-down list and then click to select the **Key Usage** and/or **Enhanced Key Usage** fields to verify the intended purpose.</span></span> <span data-ttu-id="535f9-193">如果 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 嘗試將憑證用於預期以外的用途，將會發生執行階段錯誤。</span><span class="sxs-lookup"><span data-stu-id="535f9-193">If [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] attempts to use a certificate for other than its intended purpose a runtime error will occur.</span></span>  
  
-   <span data-ttu-id="535f9-194">**測試目標網站的連接**： 如果您使用 SSL，請確定您可以連接到目標網站，使用 Internet Explorer 再嘗試連線到目標網站，使用 HTTP 或 SOAP 傳輸。</span><span class="sxs-lookup"><span data-stu-id="535f9-194">**Test your connection to the target Web site**: If you are using SSL, ensure that you can connect to the target Web site with Internet Explorer before attempting to connect to the target Web site with the HTTP or SOAP transports.</span></span> <span data-ttu-id="535f9-195">請確認當您連接到目標網站時，會在 Internet Explorer 中顯示任何對話方塊。</span><span class="sxs-lookup"><span data-stu-id="535f9-195">Verify that no dialog boxes are displayed in Internet Explorer when you connect to the target Web site.</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="535f9-196">具有與連接到目標網站時，可能會顯示任何對話方塊互動機制。</span><span class="sxs-lookup"><span data-stu-id="535f9-196"> has no mechanism for interfacing with any dialog boxes that might be displayed when connecting to the target web site.</span></span> <span data-ttu-id="535f9-197">對話方塊可能會顯示 Internet explorer，如果目標網站名稱不符合指定的 SSL 憑證中的網站名稱或根憑證授權單位，SSL 憑證不是在適當**受信任的根憑證授權單位**儲存。</span><span class="sxs-lookup"><span data-stu-id="535f9-197">A dialog box may be displayed by Internet Explorer if the target web site name does not match the name specified for the web site in the SSL certificate or if the Root Certificate Authority for the SSL certificate is not in the appropriate **Trusted Root Certification Authorities** store.</span></span>  
  
-   <span data-ttu-id="535f9-198">**使用 SSL 診斷工具分析 SSL 連接問題：** SSL 診斷工具是 IIS Diagnostics Toolkit 的選用元件。</span><span class="sxs-lookup"><span data-stu-id="535f9-198">**Use the SSL Diagnostics tool to analyze SSL connection issues:** The SSL Diagnostics tool is an optional component of the IIS Diagnostics Toolkit.</span></span>  <span data-ttu-id="535f9-199">下載 IIS Diagnostics Toolkit 從[Internet Information Services 診斷工具](http://go.microsoft.com/fwlink/?LinkId=64426)。</span><span class="sxs-lookup"><span data-stu-id="535f9-199">Download the IIS Diagnostics Toolkit from [Internet Information Services Diagnostic Tools](http://go.microsoft.com/fwlink/?LinkId=64426).</span></span>  
  
-   <span data-ttu-id="535f9-200">**請確認憑證有效**。</span><span class="sxs-lookup"><span data-stu-id="535f9-200">**Ensure that the certificate is valid**.</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="535f9-201">不會提示您如果憑證已過期。</span><span class="sxs-lookup"><span data-stu-id="535f9-201"> does not prompt you if the certificate has expired.</span></span> <span data-ttu-id="535f9-202">相反地，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]會擱置該訊息。</span><span class="sxs-lookup"><span data-stu-id="535f9-202">Instead, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will suspend the message.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="535f9-203">請參閱</span><span class="sxs-lookup"><span data-stu-id="535f9-203">See Also</span></span>  
 [<span data-ttu-id="535f9-204">加密和簽章憑證</span><span class="sxs-lookup"><span data-stu-id="535f9-204">Encryption and Signing Certificates</span></span>](../core/encryption-and-signing-certificates.md)