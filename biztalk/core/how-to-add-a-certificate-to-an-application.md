---
title: 如何將憑證新增至應用程式 |Microsoft 文件
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- applications, certificates
- managing [certificates], adding to applications
- certificates, applications
- managing [applications], certificates
- managing [certificates], applications
- managing [resources], certificates
ms.assetid: 7c615002-6627-4134-9c2b-bf1c89d626c2
caps.latest.revision: 15
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 7551e18b1e63f706dfe7e5ff8f951e7aee4f4694
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
ms.locfileid: "22248174"
---
# <a name="how-to-add-a-certificate-to-an-application"></a><span data-ttu-id="0bbf2-102">如何將憑證新增至應用程式</span><span class="sxs-lookup"><span data-stu-id="0bbf2-102">How to Add a Certificate to an Application</span></span>
<span data-ttu-id="0bbf2-103">本主題說明如何使用命令列，將憑證加入至 BizTalk 應用程式。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-103">This topic describes how to use the command line to add a certificate to a BizTalk application.</span></span> <span data-ttu-id="0bbf2-104">BizTalk Server 管理主控台上無法使用這個選項。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-104">This option is not available in the BizTalk Server Administration console.</span></span> <span data-ttu-id="0bbf2-105">您可以將憑證加入至 BizTalk 應用程式，如此就可以將憑證封裝於應用程式中，從一個 BizTalk 群組傳輸到另一個群組。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-105">You add a certificate to a BizTalk application so that you can transport the certificate from one BizTalk group to another, packaged with an application.</span></span> <span data-ttu-id="0bbf2-106">您可以使用憑證，確認識別並建立傳送埠和接收位置的安全連結。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-106">You use certificates to verify identities and to establish secure links for send ports and receive locations.</span></span> <span data-ttu-id="0bbf2-107">如需詳細資訊，請參閱[如何指派憑證給傳送埠](../core/how-to-assign-a-certificate-to-a-send-port.md)和[如何指派憑證給接收位置](../core/how-to-assign-a-certificate-to-a-receive-location.md)。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-107">For more information, see [How to Assign a Certificate to a Send Port](../core/how-to-assign-a-certificate-to-a-send-port.md) and [How to Assign a Certificate to a Receive Location](../core/how-to-assign-a-certificate-to-a-receive-location.md).</span></span>  
  
 <span data-ttu-id="0bbf2-108">當您新增憑證至應用程式時，請牢記下列要點：</span><span class="sxs-lookup"><span data-stu-id="0bbf2-108">When adding a certificate to an application, bear in mind the following important points:</span></span>  
  
-   <span data-ttu-id="0bbf2-109">將憑證加入至應用程式時，憑證會加入至 BizTalk 管理資料庫做為憑證成品。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-109">When you add a certificate to an application, the certificate is added to the BizTalk Management database as a certificate artifact.</span></span> <span data-ttu-id="0bbf2-110">安裝應用程式時，會將憑證匯入至本機電腦上的 [其他人] 憑證存放區，所以您不需要採取其他步驟將它匯入這個存放區，即可將它指派給傳送埠或接收位置。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-110">When you install the application, the certificate is imported into the Other People certificate store on the local computer, so you may not need to take the additional step of importing it into this store before you can assign it to a send port or receive location.</span></span> <span data-ttu-id="0bbf2-111">使用 BTSTask 加入憑證時，憑證必須存在於 [其他人] 憑證存放區，而且您必須指定其指紋。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-111">When you use BTSTask to add the certificate, the certificate must exist in the Other People certificate store, and you must specify its thumbprint.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="0bbf2-112">在匯出憑證時，會移除私密金鑰。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-112">When a certificate is exported, the private key is removed.</span></span> <span data-ttu-id="0bbf2-113">在安裝應用程式時，會將憑證匯入至憑證存放區，但不能用它來解密加密的訊息 (可用來傳送加密訊息)。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-113">When the application is installed, although the certificate is imported into the certificate store, it cannot be used to decrypt an encrypted message, although it can be used to send an encrypted message.</span></span> <span data-ttu-id="0bbf2-114">如果憑證必須用於前面的用途，您應該在裝載使用憑證之傳送埠的電腦上，將它重新安裝在 [其他人] 憑證存放區。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-114">If you need to use the certificate for the former purpose, you should reinstall it in the Other People certificate store on the computer hosting the send port that uses the certificate.</span></span>  
  
-   <span data-ttu-id="0bbf2-115">最佳作法是，如果憑證由兩個以上之應用程式中的傳送埠或接收位置使用，您應該將該憑證部署到個別的應用程式中，然後從需要使用該憑證的應用程式參考此應用程式。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-115">As a best practice, if a certificate will be used by a send port or receive location in two or more applications, you should deploy the certificate in a separate application, and then reference this application from the applications that need to use the certificate.</span></span> <span data-ttu-id="0bbf2-116">這是因為 BizTalk 群組中只能存在一個具有特定指紋的憑證，所以您將無法在兩個不同的應用程式中匯入相同的憑證。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-116">This is because only one certificate having a particular thumbprint can exist in the BizTalk group, so you will not be able to import the same certificate in two different applications.</span></span> <span data-ttu-id="0bbf2-117">如果您嘗試匯入使用相同憑證的兩個應用程式，第一個匯入會成功，第二個匯入則會失敗。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-117">If you attempt to import two applications that each use the same certificate, the first import will succeed, and the second will not.</span></span> <span data-ttu-id="0bbf2-118">在此情況下，使用覆寫匯入選項無法修正此問題，因為您想要覆寫的現有憑證包含在另一個應用程式中。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-118">In this case, using the Overwrite import option does not correct the problem, as the existing certificate that you want to overwrite is contained in another application.</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="0bbf2-119">必要條件</span><span class="sxs-lookup"><span data-stu-id="0bbf2-119">Prerequisites</span></span>  
 <span data-ttu-id="0bbf2-120">若要執行這個主題中的程序，您必須使用「BizTalk Server 系統管理員」群組成員的帳戶登入。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-120">To perform the procedures in this topic, you must be logged on with an account that is a member of the BizTalk Server Administrators group.</span></span> <span data-ttu-id="0bbf2-121">如需詳細的權限的詳細資訊，請參閱[部署及管理 BizTalk 應用程式所需的權限](../core/permissions-required-for-deploying-and-managing-a-biztalk-application.md)。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-121">For more detailed information on permissions, see [Permissions Required for Deploying and Managing a BizTalk Application](../core/permissions-required-for-deploying-and-managing-a-biztalk-application.md).</span></span>  
  
### <a name="to-add-a-certificate-to-an-application"></a><span data-ttu-id="0bbf2-122">若要新增憑證至應用程式</span><span class="sxs-lookup"><span data-stu-id="0bbf2-122">To add a certificate to an application</span></span>  
  
1.  <span data-ttu-id="0bbf2-123">開啟命令提示字元，如下所示： 按一下**啟動**，按一下**執行**，型別`cmd`，然後按一下 **確定**。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-123">Open a command prompt as follows: Click **Start**, click **Run**, type `cmd`, and then click **OK**.</span></span>  
  
2.  <span data-ttu-id="0bbf2-124">輸入下列命令，並以適當的值替代，如下表所述：</span><span class="sxs-lookup"><span data-stu-id="0bbf2-124">Type the following command, substituting the appropriate values, as described in the following table:</span></span>  
  
     <span data-ttu-id="0bbf2-125">**BTSTask AddResource** [**/ApplicationName:***值*] **/Type:System.BizTalk:Certificate** [**/Overwrite**] **/Thumbprint:"***值***"** [**/Server:***值*] [**/Database:***值*]</span><span class="sxs-lookup"><span data-stu-id="0bbf2-125">**BTSTask AddResource** [**/ApplicationName:***value*] **/Type:System.BizTalk:Certificate** [**/Overwrite**] **/Thumbprint:"***value***"** [**/Server:***value*] [**/Database:***value*]</span></span>  
  
     <span data-ttu-id="0bbf2-126">範例：</span><span class="sxs-lookup"><span data-stu-id="0bbf2-126">Example:</span></span>  
  
     <span data-ttu-id="0bbf2-127">**BTSTask AddResource /applicationname: myapplication /Type:System.BizTalk:Certificate /Overwrite /Thumbprint:"04 a2 8e 32 24 f9 36 b9 42 81 12 71 3a d2 ef db c7 9 c 83 dc"/Server:MyDatabaseServer /Database:BizTalkMgmtDb**</span><span class="sxs-lookup"><span data-stu-id="0bbf2-127">**BTSTask AddResource /ApplicationName:MyApplication /Type:System.BizTalk:Certificate /Overwrite /Thumbprint:"04 a2 8e 32 24 f9 36 b9 42 81 12 71 3a d2 ef db c7 9c 83 dc" /Server:MyDatabaseServer /Database:BizTalkMgmtDb**</span></span>  
  
    |<span data-ttu-id="0bbf2-128">參數</span><span class="sxs-lookup"><span data-stu-id="0bbf2-128">Parameter</span></span>|<span data-ttu-id="0bbf2-129">值</span><span class="sxs-lookup"><span data-stu-id="0bbf2-129">Value</span></span>|  
    |---------------|-----------|  
    |<span data-ttu-id="0bbf2-130">**/ 應用程式名稱**</span><span class="sxs-lookup"><span data-stu-id="0bbf2-130">**/ApplicationName**</span></span>|<span data-ttu-id="0bbf2-131">加入憑證的 BizTalk 應用程式的名稱。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-131">Name of the BizTalk application to which to add the certificate.</span></span> <span data-ttu-id="0bbf2-132">若未指定應用程式名稱，將使用群組預設的 BizTalk 應用程式。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-132">If the application name is not specified, the default BizTalk application for the group is used.</span></span> <span data-ttu-id="0bbf2-133">如果名稱包含空格，您必須將它括在雙引號 (") 中。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-133">If the name includes spaces, you must enclose it in double quotation marks (").</span></span>|  
    |<span data-ttu-id="0bbf2-134">**/ 類型**</span><span class="sxs-lookup"><span data-stu-id="0bbf2-134">**/Type**</span></span>|<span data-ttu-id="0bbf2-135">**System.biztalk: certificate** （此值不區分大小寫）。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-135">**System.BizTalk:Certificate** (This value is not case-sensitive.)</span></span>|  
    |<span data-ttu-id="0bbf2-136">**/ 覆寫**</span><span class="sxs-lookup"><span data-stu-id="0bbf2-136">**/Overwrite**</span></span>|<span data-ttu-id="0bbf2-137">此選項指定更新現有的憑證。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-137">Option to update an existing certificate.</span></span> <span data-ttu-id="0bbf2-138">若未指定此選項，且應用程式中現有的憑證其 [指紋] 屬性與所加入的憑證相同，加入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-138">If not specified, and a certificate already exists in the application that has the same Thumbprint property as the certificate being added, the Add operation fails.</span></span> <span data-ttu-id="0bbf2-139">若要查看 [指紋] 屬性，請在 [憑證] 嵌入式管理單元中按兩下憑證，然後按一下 [詳細資料] 索引標籤。如需詳細資訊，請參閱 [憑證] 嵌入式管理單元說明文件中的＜檢視憑證資訊＞。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-139">You can view the Thumbprint property by double-clicking the certificate in the Certificates snap-in and clicking the Details tab. For more information, see "Viewing certificate information" in the documentation for the Certificates snap-in.</span></span>|  
    |<span data-ttu-id="0bbf2-140">**/ 憑證指紋**</span><span class="sxs-lookup"><span data-stu-id="0bbf2-140">**/Thumbprint**</span></span>|<span data-ttu-id="0bbf2-141">憑證指紋屬性 (*指紋*是資料的摘要)。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-141">Thumbprint property of the certificate (a *thumbprint* is a digest of data).</span></span> <span data-ttu-id="0bbf2-142">此值必須括在雙引號 (") 中。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-142">This value must be enclosed in double quotation marks (").</span></span>|  
    |<span data-ttu-id="0bbf2-143">**/ 伺服器**</span><span class="sxs-lookup"><span data-stu-id="0bbf2-143">**/Server**</span></span>|<span data-ttu-id="0bbf2-144">裝載 BizTalk 管理資料庫之 SQL Server 執行個體的名稱，其格式為：伺服器名稱\執行個體名稱,連接埠。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-144">Name of the SQL Server instance hosting the BizTalk Management database, in the form ServerName\InstanceName,Port.</span></span><br /><br /> <span data-ttu-id="0bbf2-145">只有在執行個體名稱和伺服器名稱不同時，才需要執行個體名稱。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-145">Instance name is only required when the instance name is different than the server name.</span></span> <span data-ttu-id="0bbf2-146">只有在 SQL Server 使用預設值 (1433) 以外的連接埠編號時，才需要連接埠。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-146">Port is only required when SQL Server uses a port number other than the default (1433).</span></span><br /><br /> <span data-ttu-id="0bbf2-147">範例:</span><span class="sxs-lookup"><span data-stu-id="0bbf2-147">Examples:</span></span><br /><br /> <span data-ttu-id="0bbf2-148">Server=MyServer</span><span class="sxs-lookup"><span data-stu-id="0bbf2-148">Server=MyServer</span></span><br /><br /> <span data-ttu-id="0bbf2-149">Server=MyServer\MySQLServer,1533</span><span class="sxs-lookup"><span data-stu-id="0bbf2-149">Server=MyServer\MySQLServer,1533</span></span><br /><br /> <span data-ttu-id="0bbf2-150">如果不提供，將會使用在本機電腦上執行的 SQL Server 執行個體的名稱。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-150">If not provided, the name of the SQL Server instance running on the local computer is used.</span></span>|  
    |<span data-ttu-id="0bbf2-151">**/ 資料庫**</span><span class="sxs-lookup"><span data-stu-id="0bbf2-151">**/Database**</span></span>|<span data-ttu-id="0bbf2-152">BizTalk 管理資料庫的名稱。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-152">Name of the BizTalk Management database.</span></span> <span data-ttu-id="0bbf2-153">如果沒有指定，將會使用在 SQL Server 本機執行個體中執行的 BizTalk 管理資料庫。</span><span class="sxs-lookup"><span data-stu-id="0bbf2-153">If not specified, the BizTalk Management database running in the local instance of SQL Server is used.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="0bbf2-154">另請參閱</span><span class="sxs-lookup"><span data-stu-id="0bbf2-154">See Also</span></span>  
 <span data-ttu-id="0bbf2-155">[管理.NET 組件、 憑證和其他資源](../core/managing-net-assemblies-certificates-and-other-resources.md) </span><span class="sxs-lookup"><span data-stu-id="0bbf2-155">[Managing .NET Assemblies, Certificates, and Other Resources](../core/managing-net-assemblies-certificates-and-other-resources.md) </span></span>  
 <span data-ttu-id="0bbf2-156">[AddResource 命令： 憑證](../core/addresource-command-certificate.md) </span><span class="sxs-lookup"><span data-stu-id="0bbf2-156">[AddResource Command: Certificate](../core/addresource-command-certificate.md) </span></span>  
 [<span data-ttu-id="0bbf2-157">建立和修改 BizTalk 應用程式</span><span class="sxs-lookup"><span data-stu-id="0bbf2-157">Creating and Modifying BizTalk Applications</span></span>](../core/creating-and-modifying-biztalk-applications.md)