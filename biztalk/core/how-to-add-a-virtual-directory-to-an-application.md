---
title: 如何將虛擬目錄新增至應用程式 |Microsoft 文件
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- virtual directories
- managing [applications], virtual directories
- applications, virtual directories
- virtual directories, applications
ms.assetid: a5726696-bd65-49d9-8814-a078afe8c067
caps.latest.revision: 12
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 26627387a65b19cef8146cee8b91b2a7a0919059
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
ms.locfileid: "22248878"
---
# <a name="how-to-add-a-virtual-directory-to-an-application"></a><span data-ttu-id="d6330-102">如何將虛擬目錄新增至應用程式</span><span class="sxs-lookup"><span data-stu-id="d6330-102">How to Add a Virtual Directory to an Application</span></span>
<span data-ttu-id="d6330-103">本主題描述如何使用 BTSTask 命令列工具，將虛擬目錄加入到 BizTalk 應用程式。</span><span class="sxs-lookup"><span data-stu-id="d6330-103">This topic describes how to use the BTSTask command-line tool to add a virtual directory to a BizTalk application.</span></span> <span data-ttu-id="d6330-104">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 管理主控台上無法使用這個選項。</span><span class="sxs-lookup"><span data-stu-id="d6330-104">This option is not available in the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span> <span data-ttu-id="d6330-105">如果您已經撰寫自訂 Web 服務或建立 ASP.NET 網站來與 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 互動，而且您想要搭配此應用程式部署虛擬目錄，此時您可能會想要新增虛擬目錄。</span><span class="sxs-lookup"><span data-stu-id="d6330-105">You might want to add a virtual directory if you have written a custom Web service or created an ASP.NET Web site for interfacing with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] and want to deploy the virtual directory with the application.</span></span>  
  
 <span data-ttu-id="d6330-106">中所述，另一種方式新增至應用程式的虛擬目錄是虛擬目錄指定的 SOAP 或 HTTP 接收位置，[如何設定 HTTP 接收位置](../core/how-to-configure-an-http-receive-location.md)。</span><span class="sxs-lookup"><span data-stu-id="d6330-106">Another way to add a virtual directory to an application is by specifying a virtual directory for a SOAP or HTTP receive location, as described in [How to Configure an HTTP Receive Location](../core/how-to-configure-an-http-receive-location.md).</span></span> <span data-ttu-id="d6330-107">在所有情況下，此虛擬目錄都會加入到 BizTalk 管理資料庫。</span><span class="sxs-lookup"><span data-stu-id="d6330-107">In all cases, the virtual directory is added to the BizTalk Management database.</span></span> <span data-ttu-id="d6330-108">當您使用命令列新增虛擬目錄時，它也會顯示[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台 中您要加入它的應用程式的 [資源] 資料夾，以及當您使用應用程式中的成品清單[ListApp 命令](../core/listapp-command.md)。</span><span class="sxs-lookup"><span data-stu-id="d6330-108">When you add a virtual directory by using the command line, it also displays in the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, in the Resources folder of the application to which you added it as well as the list of artifacts in the application when you use the [ListApp Command](../core/listapp-command.md).</span></span> <span data-ttu-id="d6330-109">如果您之後匯出此應用程式，然後將它匯入到另一個 BizTalk 群組，則此虛擬目錄會顯示在 [資源] 資料夾中。</span><span class="sxs-lookup"><span data-stu-id="d6330-109">If you later export the application and then import it into another BizTalk group, the virtual directory displays in the Resources folder.</span></span>  
  
 <span data-ttu-id="d6330-110">當您將虛擬目錄加入到應用程式時，請牢記下列要點：</span><span class="sxs-lookup"><span data-stu-id="d6330-110">When adding a virtual directory to an application, bear in mind the following points:</span></span>  
  
-   <span data-ttu-id="d6330-111">您可以覆寫應用程式中現有的虛擬目錄，只要指定覆寫選項即可。</span><span class="sxs-lookup"><span data-stu-id="d6330-111">You can overwrite a virtual directory that already exists in the application by specifying the overwrite option.</span></span> <span data-ttu-id="d6330-112">只有在現有的虛擬目錄已與您想要加入相同的名稱時，才需要覆寫選項。</span><span class="sxs-lookup"><span data-stu-id="d6330-112">The overwrite option is required only when the existing virtual directory has the same name as the one you want to add.</span></span> <span data-ttu-id="d6330-113">如果未指定，且虛擬目錄已經存在相同名稱做為所新增的應用程式中，新增作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="d6330-113">If not specified, and a virtual directory already exists in the application with the same name as the one being added, the add operation will fail.</span></span>  
  
-   <span data-ttu-id="d6330-114">如果您要加入之虛擬目錄的 URL 包含 https，指定 URL 時必須改用 http 代替 https。</span><span class="sxs-lookup"><span data-stu-id="d6330-114">When you add a virtual directory with a URL that contains https, you must use http in the URL that you specify rather than https.</span></span> <span data-ttu-id="d6330-115">若是使用 https，虛擬目錄加入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="d6330-115">If you use https, the operation to add a virtual directory will fail.</span></span> <span data-ttu-id="d6330-116">雖然您在 URL 中使用 http 來加入，Internet Information Services Metabase 仍會沿用 URL 的 https 設定使之生效，因此虛擬目錄將可正常運作。</span><span class="sxs-lookup"><span data-stu-id="d6330-116">Even though you add it with http in the URL, the https setting for the URL in the Internet Information Services metabase will be in effect, and the virtual directory will function correctly.</span></span>  
  
-   <span data-ttu-id="d6330-117">如果您所加入的虛擬目錄來自 64 位元版的 Web 服務，而您試圖將含有該虛擬目錄的應用程式安裝於 32 位元電腦，屆時將不會安裝該虛擬目錄。</span><span class="sxs-lookup"><span data-stu-id="d6330-117">If you add a virtual directory from a 64-bit version of the Web service, and you attempt to install the application that includes the virtual directory on a 32-bit computer, the virtual directory will not be installed.</span></span> <span data-ttu-id="d6330-118">它必須安裝在 64 位元電腦上。</span><span class="sxs-lookup"><span data-stu-id="d6330-118">It must be installed on a 64-bit computer.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="d6330-119">當您匯入包含虛擬目錄的應用程式時，該虛擬目錄上的安全性設定就是在應用程式匯出期間產生 .msi 檔案時生效的那些安全性設定。</span><span class="sxs-lookup"><span data-stu-id="d6330-119">When you import an application containing a virtual directory, the security settings on the virtual directory are those in effect when the .msi file is generated during application export.</span></span> <span data-ttu-id="d6330-120">如果您將應用程式部署到實際執行環境，則在匯出應用程式之前，應該驗證設定是否符合安全性需求。</span><span class="sxs-lookup"><span data-stu-id="d6330-120">If you are deploying an application into a production environment, before exporting the application, you should verify that the settings meet your security requirements.</span></span>  
>   
>  <span data-ttu-id="d6330-121">如果目的地環境中已經有虛擬目錄存在，則現有虛擬目錄上的安全性設定將會生效。</span><span class="sxs-lookup"><span data-stu-id="d6330-121">If, however, the virtual directory already exists in the destination environment, the security settings on the existing virtual directory will be in effect.</span></span> <span data-ttu-id="d6330-122">這些設定不會為了要與您部署之虛擬目錄上的設定相符而變更。</span><span class="sxs-lookup"><span data-stu-id="d6330-122">They are not changed to match those on the virtual directory you are deploying.</span></span> <span data-ttu-id="d6330-123">在此情況下，您應該驗證現有虛擬目錄上的安全性設定是否符合您的需求。</span><span class="sxs-lookup"><span data-stu-id="d6330-123">In this case, you should verify that the security settings on the existing virtual directory meet your requirements.</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="d6330-124">如果虛擬目錄使用的是 HTTPS (超文字安全傳輸通訊協定) 通訊協定，則在匯出期間不會保留其安全性設定，而且在匯入時，虛擬目錄會繼承根目錄的安全性設定。</span><span class="sxs-lookup"><span data-stu-id="d6330-124">If the virtual directory uses the HTTPS (Hypertext Transfer Protocol over Secure Socket Layer) protocol, its security settings are not preserved during export, and when it is imported, the virtual directory will inherit the security settings of the root.</span></span> <span data-ttu-id="d6330-125">您應該驗證這些安全性設定是否符合您的需求。</span><span class="sxs-lookup"><span data-stu-id="d6330-125">You should verify that the security settings meet your requirements.</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="d6330-126">必要條件</span><span class="sxs-lookup"><span data-stu-id="d6330-126">Prerequisites</span></span>  
 <span data-ttu-id="d6330-127">若要執行這個主題中的程序，您必須使用「[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 系統管理員」群組成員的帳戶登入。</span><span class="sxs-lookup"><span data-stu-id="d6330-127">To perform the procedure in this topic, you must be logged on with an account that is a member of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administrators group.</span></span> <span data-ttu-id="d6330-128">如需詳細的權限的詳細資訊，請參閱[部署及管理 BizTalk 應用程式所需的權限](../core/permissions-required-for-deploying-and-managing-a-biztalk-application.md)。</span><span class="sxs-lookup"><span data-stu-id="d6330-128">For more detailed information on permissions, see [Permissions Required for Deploying and Managing a BizTalk Application](../core/permissions-required-for-deploying-and-managing-a-biztalk-application.md).</span></span>  
  
### <a name="to-add-a-virtual-directory-to-an-application"></a><span data-ttu-id="d6330-129">若要將虛擬目錄加入至應用程式</span><span class="sxs-lookup"><span data-stu-id="d6330-129">To add a virtual directory to an application</span></span>  
  
1.  <span data-ttu-id="d6330-130">開啟命令提示字元，如下所示： 按一下**啟動**，按一下**執行**，型別`cmd`，然後按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="d6330-130">Open a command prompt as follows: Click **Start**, click **Run**, type `cmd`, and then click **OK**.</span></span>  
  
2.  <span data-ttu-id="d6330-131">輸入下列命令，並以適當的值替代，如下表所述：</span><span class="sxs-lookup"><span data-stu-id="d6330-131">Type the following command, substituting the appropriate values, as described in the following table:</span></span>  
  
     <span data-ttu-id="d6330-132">**BTSTask AddResource** [/**ApplicationName:***值*] **/Type:System.BizTalk:WebDirectory**[**/Overwrite**] **/Source:***值*[**/Destination:***值*] [**/Server:** *值*] [**/database:***值*]</span><span class="sxs-lookup"><span data-stu-id="d6330-132">**BTSTask AddResource** [/**ApplicationName:***value*] **/Type:System.BizTalk:WebDirectory**[**/Overwrite**] **/Source:***value* [**/Destination:***value*] [**/Server:***value*] [**/Database:***value*]</span></span>  
  
     <span data-ttu-id="d6330-133">範例：</span><span class="sxs-lookup"><span data-stu-id="d6330-133">Example:</span></span>  
  
     <span data-ttu-id="d6330-134">**BTSTask AddResource /applicationname: myapplication/類型： system.biztalk: webdirectory / 覆寫 /Source:http://Host1:90 / MyVirtualDirectory /Destination:http://Host2:90 / MyVirtualDirectory /Server:MyDatabaseServer/資料庫：BizTalkMgmtDb**</span><span class="sxs-lookup"><span data-stu-id="d6330-134">**BTSTask AddResource /ApplicationName:MyApplication /Type: System.BizTalk:WebDirectory /Overwrite /Source:http://Host1:90/MyVirtualDirectory /Destination:http://Host2:90/MyVirtualDirectory /Server:MyDatabaseServer /Database:BizTalkMgmtDb**</span></span>  
  
    |<span data-ttu-id="d6330-135">參數</span><span class="sxs-lookup"><span data-stu-id="d6330-135">Parameter</span></span>|<span data-ttu-id="d6330-136">值</span><span class="sxs-lookup"><span data-stu-id="d6330-136">Value</span></span>|  
    |---------------|-----------|  
    |<span data-ttu-id="d6330-137">**/ 應用程式名稱**</span><span class="sxs-lookup"><span data-stu-id="d6330-137">**/ApplicationName**</span></span>|<span data-ttu-id="d6330-138">加入虛擬目錄的 BizTalk 應用程式名稱。</span><span class="sxs-lookup"><span data-stu-id="d6330-138">Name of the BizTalk application to which to add the virtual directory.</span></span> <span data-ttu-id="d6330-139">若未指定應用程式名稱，將使用群組預設的 BizTalk 應用程式。</span><span class="sxs-lookup"><span data-stu-id="d6330-139">If the application name is not specified, the default BizTalk application for the group is used.</span></span> <span data-ttu-id="d6330-140">如果名稱包含空格，您必須將它括在雙引號 (") 中。</span><span class="sxs-lookup"><span data-stu-id="d6330-140">If the name includes spaces, you must enclose it in double quotation marks (").</span></span>|  
    |<span data-ttu-id="d6330-141">**/ 類型**</span><span class="sxs-lookup"><span data-stu-id="d6330-141">**/Type**</span></span>|<span data-ttu-id="d6330-142">**System.biztalk: webdirectory** （此值不區分大小寫）。</span><span class="sxs-lookup"><span data-stu-id="d6330-142">**System.BizTalk:WebDirectory** (This value is not case-sensitive.)</span></span>|  
    |<span data-ttu-id="d6330-143">**/ 覆寫**</span><span class="sxs-lookup"><span data-stu-id="d6330-143">**/Overwrite**</span></span>|<span data-ttu-id="d6330-144">更新現有虛擬目錄的選項。</span><span class="sxs-lookup"><span data-stu-id="d6330-144">Option to update an existing virtual directory.</span></span> <span data-ttu-id="d6330-145">若未指定此選項，且應用程式中現有的虛擬目錄與所加入的虛擬目錄同名，AddResources 作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="d6330-145">If not specified, and a virtual directory already exists in the application that has the same name as the virtual directory being added, the AddResources operation fails.</span></span>|  
    |<span data-ttu-id="d6330-146">**/ 來源**</span><span class="sxs-lookup"><span data-stu-id="d6330-146">**/Source**</span></span>|<span data-ttu-id="d6330-147">來源虛擬目錄的 URI。</span><span class="sxs-lookup"><span data-stu-id="d6330-147">URI of the source virtual directory.</span></span>|  
    |<span data-ttu-id="d6330-148">**/ 目的地**</span><span class="sxs-lookup"><span data-stu-id="d6330-148">**/Destination**</span></span>|<span data-ttu-id="d6330-149">從 .msi 檔案安裝應用程式時，指派給虛擬目錄的 URI。</span><span class="sxs-lookup"><span data-stu-id="d6330-149">URI to be assigned to the virtual directory when the application is installed from the .msi file.</span></span> <span data-ttu-id="d6330-150">若未指定此參數，將使用 Source 參數的值並以 localhost 做為主控件。</span><span class="sxs-lookup"><span data-stu-id="d6330-150">If this parameter is not specified, then the value of the Source parameter is used with localhost as the host.</span></span>|  
    |<span data-ttu-id="d6330-151">**/ 伺服器**</span><span class="sxs-lookup"><span data-stu-id="d6330-151">**/Server**</span></span>|<span data-ttu-id="d6330-152">裝載 BizTalk 管理資料庫之 SQL Server 執行個體的名稱，其格式為：伺服器名稱\執行個體名稱,連接埠。</span><span class="sxs-lookup"><span data-stu-id="d6330-152">Name of the SQL Server instance hosting the BizTalk Management database, in the form ServerName\InstanceName,Port.</span></span><br /><br /> <span data-ttu-id="d6330-153">只有在執行個體名稱和伺服器名稱不同時，才需要執行個體名稱。</span><span class="sxs-lookup"><span data-stu-id="d6330-153">Instance name is only required when the instance name is different than the server name.</span></span> <span data-ttu-id="d6330-154">只有在 SQL Server 使用預設值 (1433) 以外的連接埠編號時，才需要連接埠。</span><span class="sxs-lookup"><span data-stu-id="d6330-154">Port is only required when SQL Server uses a port number other than the default (1433).</span></span><br /><br /> <span data-ttu-id="d6330-155">範例:</span><span class="sxs-lookup"><span data-stu-id="d6330-155">Examples:</span></span><br /><br /> <span data-ttu-id="d6330-156">Server=MyServer</span><span class="sxs-lookup"><span data-stu-id="d6330-156">Server=MyServer</span></span><br /><br /> <span data-ttu-id="d6330-157">Server=MyServer\MySQLServer,1533</span><span class="sxs-lookup"><span data-stu-id="d6330-157">Server=MyServer\MySQLServer,1533</span></span><br /><br /> <span data-ttu-id="d6330-158">如果不提供，將會使用在本機電腦上執行的 SQL Server 執行個體的名稱。</span><span class="sxs-lookup"><span data-stu-id="d6330-158">If not provided, the name of the SQL Server instance running on the local computer is used.</span></span>|  
    |<span data-ttu-id="d6330-159">**/ 資料庫**</span><span class="sxs-lookup"><span data-stu-id="d6330-159">**/Database**</span></span>|<span data-ttu-id="d6330-160">BizTalk 管理資料庫的名稱。</span><span class="sxs-lookup"><span data-stu-id="d6330-160">Name of the BizTalk Management database.</span></span> <span data-ttu-id="d6330-161">如果沒有指定，將會使用在 SQL Server 本機執行個體中執行的 BizTalk 管理資料庫。</span><span class="sxs-lookup"><span data-stu-id="d6330-161">If not specified, the BizTalk Management database running in the local instance of SQL Server is used.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="d6330-162">另請參閱</span><span class="sxs-lookup"><span data-stu-id="d6330-162">See Also</span></span>  
 <span data-ttu-id="d6330-163">[管理.NET 組件、 憑證和其他資源](../core/managing-net-assemblies-certificates-and-other-resources.md) </span><span class="sxs-lookup"><span data-stu-id="d6330-163">[Managing .NET Assemblies, Certificates, and Other Resources](../core/managing-net-assemblies-certificates-and-other-resources.md) </span></span>  
 <span data-ttu-id="d6330-164">[AddResource 命令： 虛擬目錄](../core/addresource-command-virtual-directory.md) </span><span class="sxs-lookup"><span data-stu-id="d6330-164">[AddResource Command: Virtual Directory](../core/addresource-command-virtual-directory.md) </span></span>  
 [<span data-ttu-id="d6330-165">建立和修改 BizTalk 應用程式</span><span class="sxs-lookup"><span data-stu-id="d6330-165">Creating and Modifying BizTalk Applications</span></span>](../core/creating-and-modifying-biztalk-applications.md)