---
title: 在 SMTP 標頭使用巨集的限制 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- configuring [SMTP adapters], restrictions
- macros, SMTP headers [SMTP adapters]
- SMTP adapters, macros
- SMTP adapters, restrictions
- configuring [SMTP adapters], SMTP headers
- SMTP adapters, SMTP headers
- configuring [SMTP adapters], macros
- SMTP headers
ms.assetid: ceab0917-cb3c-423b-a15f-63747ab1d8da
caps.latest.revision: 8
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 5162de289f9c9e7798e5a24aa75fa9305763b401
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "36977975"
---
# <a name="restrictions-on-using-macros-in-smtp-headers"></a><span data-ttu-id="2dce9-102">在 SMTP 標頭使用巨集的限制</span><span class="sxs-lookup"><span data-stu-id="2dce9-102">Restrictions on Using Macros in SMTP Headers</span></span>
<span data-ttu-id="2dce9-103">您可以使用預先定義的一組巨集，在 SMTP 訊息標頭上動態形成 **主旨**、 **收件者**、 **寄件者**及 **副本** 屬性。</span><span class="sxs-lookup"><span data-stu-id="2dce9-103">You can form the **Subject**, **To**, **From**, and **CC** properties on an SMTP message header dynamically by using a predefined set of macros.</span></span> <span data-ttu-id="2dce9-104">傳送訊息前，SMTP 傳送處理常式會將標頭中的所有巨集以巨集的值取代。</span><span class="sxs-lookup"><span data-stu-id="2dce9-104">Before sending a message, the SMTP send handler substitutes all the macros in headers with their values.</span></span> <span data-ttu-id="2dce9-105">您可以使用數個不同的巨集來形成一個標頭。</span><span class="sxs-lookup"><span data-stu-id="2dce9-105">You can use several different macros when forming one header.</span></span>  
  
 <span data-ttu-id="2dce9-106">若發生下列任何一種情況，SMTP 傳送處理常式便不會取代 **收件者**、 **寄件者**或 **副本** 標頭中的巨集：</span><span class="sxs-lookup"><span data-stu-id="2dce9-106">The SMTP send handler does not substitute macros in the **To**, **From**, or **CC** header if any of the following are true:</span></span>  
  
- <span data-ttu-id="2dce9-107">未設定對應的系統屬性。</span><span class="sxs-lookup"><span data-stu-id="2dce9-107">The corresponding system property is not set.</span></span>  
  
- <span data-ttu-id="2dce9-108">巨集拼錯。</span><span class="sxs-lookup"><span data-stu-id="2dce9-108">The macro is misspelled.</span></span>  
  
- <span data-ttu-id="2dce9-109">巨集的值包含 SMTP 標頭無效的符號。</span><span class="sxs-lookup"><span data-stu-id="2dce9-109">The value for the macro contains symbols that are not valid for the SMTP headers.</span></span>  
  
  <span data-ttu-id="2dce9-110">如果符合下列任一條件，SMTP 傳送處理常式會保留巨集原樣，比方說， <strong>%sourceparty%@somedomain.com</strong> 或是**Message from %sourceparty%**。</span><span class="sxs-lookup"><span data-stu-id="2dce9-110">If any of these conditions are met, the SMTP send handler leaves the macros as they are, for example, <strong>%SourceParty%@somedomain.com</strong> or **Message from %SourceParty%**.</span></span>  
  
  <span data-ttu-id="2dce9-111">下表列出您可用來建置 **收件者**、 **副本**及 **主旨** 等標頭的巨集。</span><span class="sxs-lookup"><span data-stu-id="2dce9-111">The following table lists the macros you can use to build the **To**, **CC**, and **Subject** headers.</span></span>  
  
|<span data-ttu-id="2dce9-112">巨集</span><span class="sxs-lookup"><span data-stu-id="2dce9-112">Macro</span></span>|<span data-ttu-id="2dce9-113">描述</span><span class="sxs-lookup"><span data-stu-id="2dce9-113">Description</span></span>|<span data-ttu-id="2dce9-114">用於 [寄件者]</span><span class="sxs-lookup"><span data-stu-id="2dce9-114">For use with To</span></span>|<span data-ttu-id="2dce9-115">用於 [副本]</span><span class="sxs-lookup"><span data-stu-id="2dce9-115">For use with CC</span></span>|<span data-ttu-id="2dce9-116">用於 [主旨]</span><span class="sxs-lookup"><span data-stu-id="2dce9-116">For use with Subject</span></span>|  
|-----------|-----------------|---------------------|---------------------|--------------------------|  
|<span data-ttu-id="2dce9-117">%MessageID%</span><span class="sxs-lookup"><span data-stu-id="2dce9-117">%MessageID%</span></span>|<span data-ttu-id="2dce9-118">BizTalk Server 中訊息的全域唯一識別碼 (GUID)。</span><span class="sxs-lookup"><span data-stu-id="2dce9-118">Globally unique identifier (GUID) of the message in BizTalk Server.</span></span> <span data-ttu-id="2dce9-119">這個值來自訊息內容屬性 **BTS.MessageID**。</span><span class="sxs-lookup"><span data-stu-id="2dce9-119">The value comes from the message context property **BTS.MessageID**.</span></span>|<span data-ttu-id="2dce9-120">否</span><span class="sxs-lookup"><span data-stu-id="2dce9-120">No</span></span>|<span data-ttu-id="2dce9-121">否</span><span class="sxs-lookup"><span data-stu-id="2dce9-121">No</span></span>|<span data-ttu-id="2dce9-122">是</span><span class="sxs-lookup"><span data-stu-id="2dce9-122">Yes</span></span>|  
|<span data-ttu-id="2dce9-123">%datetime_bts2000%</span><span class="sxs-lookup"><span data-stu-id="2dce9-123">%datetime_bts2000%</span></span>|<span data-ttu-id="2dce9-124">UTC 日期時間的格式為 YYYYMMDDhhmmsss，其中 sss 表示秒與毫秒 (例如，199707121035234 表示 1997/07/12，10:35:23 與 400 毫秒)。</span><span class="sxs-lookup"><span data-stu-id="2dce9-124">UTC date time in the format YYYYMMDDhhmmsss, where sss means seconds and milliseconds (for example, 199707121035234 means 1997/07/12, 10:35:23 and 400 milliseconds).</span></span>|<span data-ttu-id="2dce9-125">否</span><span class="sxs-lookup"><span data-stu-id="2dce9-125">No</span></span>|<span data-ttu-id="2dce9-126">否</span><span class="sxs-lookup"><span data-stu-id="2dce9-126">No</span></span>|<span data-ttu-id="2dce9-127">是</span><span class="sxs-lookup"><span data-stu-id="2dce9-127">Yes</span></span>|  
|<span data-ttu-id="2dce9-128">%datetime%</span><span class="sxs-lookup"><span data-stu-id="2dce9-128">%datetime%</span></span>|<span data-ttu-id="2dce9-129">UTC 日期時間格式為 YYYY-MM-DDThhmmss (例如，1997-07-12T103508)。</span><span class="sxs-lookup"><span data-stu-id="2dce9-129">UTC date time in the format YYYY-MM-DDThhmmss (for example, 1997-07-12T103508).</span></span>|<span data-ttu-id="2dce9-130">否</span><span class="sxs-lookup"><span data-stu-id="2dce9-130">No</span></span>|<span data-ttu-id="2dce9-131">否</span><span class="sxs-lookup"><span data-stu-id="2dce9-131">No</span></span>|<span data-ttu-id="2dce9-132">是</span><span class="sxs-lookup"><span data-stu-id="2dce9-132">Yes</span></span>|  
|<span data-ttu-id="2dce9-133">%datetime.tz%</span><span class="sxs-lookup"><span data-stu-id="2dce9-133">%datetime.tz%</span></span>|<span data-ttu-id="2dce9-134">本地日期時間加上 GMT 的時區，格式為 YYYY-MM-DDThhmmssTZD (例如，1997-07-12T103508+800)。</span><span class="sxs-lookup"><span data-stu-id="2dce9-134">Local date time plus time zone from GMT in the format YYYY-MM-DDThhmmssTZD, (for example, 1997-07-12T103508+800).</span></span>|<span data-ttu-id="2dce9-135">否</span><span class="sxs-lookup"><span data-stu-id="2dce9-135">No</span></span>|<span data-ttu-id="2dce9-136">否</span><span class="sxs-lookup"><span data-stu-id="2dce9-136">No</span></span>|<span data-ttu-id="2dce9-137">是</span><span class="sxs-lookup"><span data-stu-id="2dce9-137">Yes</span></span>|  
|<span data-ttu-id="2dce9-138">%time%</span><span class="sxs-lookup"><span data-stu-id="2dce9-138">%time%</span></span>|<span data-ttu-id="2dce9-139">UTC 時間的格式為 hhmmss。</span><span class="sxs-lookup"><span data-stu-id="2dce9-139">UTC time in the format hhmmss.</span></span>|<span data-ttu-id="2dce9-140">否</span><span class="sxs-lookup"><span data-stu-id="2dce9-140">No</span></span>|<span data-ttu-id="2dce9-141">否</span><span class="sxs-lookup"><span data-stu-id="2dce9-141">No</span></span>|<span data-ttu-id="2dce9-142">是</span><span class="sxs-lookup"><span data-stu-id="2dce9-142">Yes</span></span>|  
|<span data-ttu-id="2dce9-143">%time.tz%</span><span class="sxs-lookup"><span data-stu-id="2dce9-143">%time.tz%</span></span>|<span data-ttu-id="2dce9-144">本地時間加上 GMT 的時區，格式為 hhmmssTZD (例如，124525+530)。</span><span class="sxs-lookup"><span data-stu-id="2dce9-144">Local time plus time zone from GMT in the format hhmmssTZD (for example, 124525+530).</span></span>|<span data-ttu-id="2dce9-145">否</span><span class="sxs-lookup"><span data-stu-id="2dce9-145">No</span></span>|<span data-ttu-id="2dce9-146">否</span><span class="sxs-lookup"><span data-stu-id="2dce9-146">No</span></span>|<span data-ttu-id="2dce9-147">是</span><span class="sxs-lookup"><span data-stu-id="2dce9-147">Yes</span></span>|  
|<span data-ttu-id="2dce9-148">%SourceParty%</span><span class="sxs-lookup"><span data-stu-id="2dce9-148">%SourceParty%</span></span>|<span data-ttu-id="2dce9-149">FILE 配接器從中接收訊息的來源合作對象名稱。</span><span class="sxs-lookup"><span data-stu-id="2dce9-149">Name of the source party from which the File adapter received the message.</span></span>|<span data-ttu-id="2dce9-150">否</span><span class="sxs-lookup"><span data-stu-id="2dce9-150">No</span></span>|<span data-ttu-id="2dce9-151">否</span><span class="sxs-lookup"><span data-stu-id="2dce9-151">No</span></span>|<span data-ttu-id="2dce9-152">是</span><span class="sxs-lookup"><span data-stu-id="2dce9-152">Yes</span></span>|  
|<span data-ttu-id="2dce9-153">%SourcePartyQualifier%</span><span class="sxs-lookup"><span data-stu-id="2dce9-153">%SourcePartyQualifier%</span></span>|<span data-ttu-id="2dce9-154">FILE 配接器從中接收訊息的來源合作對象辨識符號。</span><span class="sxs-lookup"><span data-stu-id="2dce9-154">Qualifier of the source party from which the File adapter received the message.</span></span>|<span data-ttu-id="2dce9-155">否</span><span class="sxs-lookup"><span data-stu-id="2dce9-155">No</span></span>|<span data-ttu-id="2dce9-156">否</span><span class="sxs-lookup"><span data-stu-id="2dce9-156">No</span></span>|<span data-ttu-id="2dce9-157">是</span><span class="sxs-lookup"><span data-stu-id="2dce9-157">Yes</span></span>|  
|<span data-ttu-id="2dce9-158">%DestinationParty%</span><span class="sxs-lookup"><span data-stu-id="2dce9-158">%DestinationParty%</span></span>|<span data-ttu-id="2dce9-159">目的地合作對象的名稱。</span><span class="sxs-lookup"><span data-stu-id="2dce9-159">Name of the destination party.</span></span> <span data-ttu-id="2dce9-160">這個值來自訊息內容屬性 **BTS.DestinationParty**。</span><span class="sxs-lookup"><span data-stu-id="2dce9-160">The value comes from the message context property **BTS.DestinationParty**.</span></span>|<span data-ttu-id="2dce9-161">是</span><span class="sxs-lookup"><span data-stu-id="2dce9-161">Yes</span></span>|<span data-ttu-id="2dce9-162">是</span><span class="sxs-lookup"><span data-stu-id="2dce9-162">Yes</span></span>|<span data-ttu-id="2dce9-163">是</span><span class="sxs-lookup"><span data-stu-id="2dce9-163">Yes</span></span>|  
|<span data-ttu-id="2dce9-164">%DestinationPartyQualifier%</span><span class="sxs-lookup"><span data-stu-id="2dce9-164">%DestinationPartyQualifier%</span></span>|<span data-ttu-id="2dce9-165">目的地合作對象的辨識符號。</span><span class="sxs-lookup"><span data-stu-id="2dce9-165">Qualifier of the destination party.</span></span> <span data-ttu-id="2dce9-166">這個值來自訊息內容屬性 **BTS.DestinationPartyQualifier**。</span><span class="sxs-lookup"><span data-stu-id="2dce9-166">The value comes from the message context property **BTS.DestinationPartyQualifier**.</span></span>|<span data-ttu-id="2dce9-167">否</span><span class="sxs-lookup"><span data-stu-id="2dce9-167">No</span></span>|<span data-ttu-id="2dce9-168">否</span><span class="sxs-lookup"><span data-stu-id="2dce9-168">No</span></span>|<span data-ttu-id="2dce9-169">是</span><span class="sxs-lookup"><span data-stu-id="2dce9-169">Yes</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="2dce9-170">另請參閱</span><span class="sxs-lookup"><span data-stu-id="2dce9-170">See Also</span></span>  
 [<span data-ttu-id="2dce9-171">設定 SMTP 配接器的限制</span><span class="sxs-lookup"><span data-stu-id="2dce9-171">Restrictions When Configuring the SMTP Adapter</span></span>](../core/restrictions-when-configuring-the-smtp-adapter.md)