---
title: "檔案配接器組態屬性 |Microsoft 文件"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- File adapters, code sample
- receive locations, adapters
- File adapters, send ports
- File adapters, receive locations
- File adapters, properties
- send ports, adapters
ms.assetid: 53f4fd17-95b9-4861-b433-772b619e90c7
caps.latest.revision: "13"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: fe578337d7137f3c9973ec4d57f195ead94ad908
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/28/2017
---
# <a name="file-adapter-configuration-properties"></a><span data-ttu-id="9b386-102">FILE 配接器組態屬性</span><span class="sxs-lookup"><span data-stu-id="9b386-102">File Adapter Configuration Properties</span></span>
<span data-ttu-id="9b386-103">下表列出您可為 FILE 配接器接收位置設定的組態屬性：</span><span class="sxs-lookup"><span data-stu-id="9b386-103">The following table lists the configuration properties that you can set for a File adapter receive location:</span></span>  
  
|<span data-ttu-id="9b386-104">屬性名稱</span><span class="sxs-lookup"><span data-stu-id="9b386-104">Property name</span></span>|<span data-ttu-id="9b386-105">類型</span><span class="sxs-lookup"><span data-stu-id="9b386-105">Type</span></span>|<span data-ttu-id="9b386-106">Description</span><span class="sxs-lookup"><span data-stu-id="9b386-106">Description</span></span>|<span data-ttu-id="9b386-107">限制</span><span class="sxs-lookup"><span data-stu-id="9b386-107">Restrictions</span></span>|<span data-ttu-id="9b386-108">註解</span><span class="sxs-lookup"><span data-stu-id="9b386-108">Comments</span></span>|  
|-------------------|----------|-----------------|------------------|--------------|  
|<span data-ttu-id="9b386-109">RemoveReceivedFileRetryCount</span><span class="sxs-lookup"><span data-stu-id="9b386-109">RemoveReceivedFileRetryCount</span></span>|<span data-ttu-id="9b386-110">VT_UI4</span><span class="sxs-lookup"><span data-stu-id="9b386-110">VT_UI4</span></span>|<span data-ttu-id="9b386-111">指定 FILE 配接器嘗試刪除已讀取並提交至 BizTalk Server 的檔案的次數。</span><span class="sxs-lookup"><span data-stu-id="9b386-111">Specify the number of times that the File adapter will attempt to delete a file that it has read and submitted to BizTalk Server.</span></span>|<span data-ttu-id="9b386-112">有效值介於 0 到 100 之間。</span><span class="sxs-lookup"><span data-stu-id="9b386-112">Valid values are from 0 to 100.</span></span>|<span data-ttu-id="9b386-113">預設值為 5。</span><span class="sxs-lookup"><span data-stu-id="9b386-113">The default value is 5.</span></span>|  
|<span data-ttu-id="9b386-114">RemoveReceivedFileMaxInterval</span><span class="sxs-lookup"><span data-stu-id="9b386-114">RemoveReceivedFileMaxInterval</span></span>|<span data-ttu-id="9b386-115">VT_UI4</span><span class="sxs-lookup"><span data-stu-id="9b386-115">VT_UI4</span></span>|<span data-ttu-id="9b386-116">指定 FILE 配接器在嘗試刪除已讀取並提交至 BizTalk Server 的檔案之前所等待的初始間隔 (以毫秒為單位)。</span><span class="sxs-lookup"><span data-stu-id="9b386-116">Specify the initial interval in milliseconds that the File adapter waits before attempting to delete a file that it has read and submitted to BizTalk Server.</span></span>|<span data-ttu-id="9b386-117">有效值從 1 到 1000 之間。</span><span class="sxs-lookup"><span data-stu-id="9b386-117">Valid values are from 1 to 1000.</span></span>|<span data-ttu-id="9b386-118">預設值是 10。</span><span class="sxs-lookup"><span data-stu-id="9b386-118">The default value is 10.</span></span>|  
|<span data-ttu-id="9b386-119">FileMask</span><span class="sxs-lookup"><span data-stu-id="9b386-119">FileMask</span></span>|<span data-ttu-id="9b386-120">VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="9b386-120">VT_BSTR</span></span>|<span data-ttu-id="9b386-121">指定檔案的遮罩。</span><span class="sxs-lookup"><span data-stu-id="9b386-121">Specify the mask for the files.</span></span>|<span data-ttu-id="9b386-122">無</span><span class="sxs-lookup"><span data-stu-id="9b386-122">None</span></span>|<span data-ttu-id="9b386-123">預設值為 *.xml。</span><span class="sxs-lookup"><span data-stu-id="9b386-123">The default value is *.xml.</span></span>|  
|<span data-ttu-id="9b386-124">BatchSizeInBytes</span><span class="sxs-lookup"><span data-stu-id="9b386-124">BatchSizeInBytes</span></span>|<span data-ttu-id="9b386-125">VT_UI4</span><span class="sxs-lookup"><span data-stu-id="9b386-125">VT_UI4</span></span>|<span data-ttu-id="9b386-126">指定一批檔案傳送到 BizTalk MessageBox 的最大位元組總數。</span><span class="sxs-lookup"><span data-stu-id="9b386-126">Specify the maximum total bytes for a batch of files sent to the BizTalk MessageBox.</span></span>|<span data-ttu-id="9b386-127">有效值從 1024年到 104857600。</span><span class="sxs-lookup"><span data-stu-id="9b386-127">Valid values are from 1024 to 104857600.</span></span>|<span data-ttu-id="9b386-128">預設值為 102400 時。</span><span class="sxs-lookup"><span data-stu-id="9b386-128">The default value is 102400.</span></span>|  
|<span data-ttu-id="9b386-129">PollingInterval</span><span class="sxs-lookup"><span data-stu-id="9b386-129">PollingInterval</span></span>|<span data-ttu-id="9b386-130">VT_UI4</span><span class="sxs-lookup"><span data-stu-id="9b386-130">VT_UI4</span></span>|<span data-ttu-id="9b386-131">指定 FILE 配接器輪詢指定的新檔案位置的間隔 (以毫秒為單位)。</span><span class="sxs-lookup"><span data-stu-id="9b386-131">Specify the interval in milliseconds that the File adapter will poll the specified location for new files.</span></span>|<span data-ttu-id="9b386-132">有效值介於 1000年到 3600000。</span><span class="sxs-lookup"><span data-stu-id="9b386-132">Valid values are from 1000 to 3600000.</span></span>|<span data-ttu-id="9b386-133">設為 1 則停用輪詢。</span><span class="sxs-lookup"><span data-stu-id="9b386-133">Set to 1 to disable polling.</span></span>|  
|<span data-ttu-id="9b386-134">BatchSize</span><span class="sxs-lookup"><span data-stu-id="9b386-134">BatchSize</span></span>|<span data-ttu-id="9b386-135">VT_UI4</span><span class="sxs-lookup"><span data-stu-id="9b386-135">VT_UI4</span></span>|<span data-ttu-id="9b386-136">指定以一個批次提交的訊息數量上限。</span><span class="sxs-lookup"><span data-stu-id="9b386-136">Specify the maximum number of messages to be submitted in a batch.</span></span>|<span data-ttu-id="9b386-137">有效值從 1 到 256。</span><span class="sxs-lookup"><span data-stu-id="9b386-137">Valid values are from 1 to 256.</span></span>|<span data-ttu-id="9b386-138">預設值為 20。</span><span class="sxs-lookup"><span data-stu-id="9b386-138">The default value is 20.</span></span>|  
|<span data-ttu-id="9b386-139">FileNetFailRetryCount</span><span class="sxs-lookup"><span data-stu-id="9b386-139">FileNetFailRetryInt</span></span>|<span data-ttu-id="9b386-140">VT_UI4</span><span class="sxs-lookup"><span data-stu-id="9b386-140">VT_UI4</span></span>|<span data-ttu-id="9b386-141">指定當網路共用上的接收位置暫時無法使用時，嘗試存取該接收位置的重試間隔時間 (以分為單位)。</span><span class="sxs-lookup"><span data-stu-id="9b386-141">Specify the retry interval time (in minutes) between attempts to access the receive location on the network share if it is temporarily unavailable.</span></span>|<span data-ttu-id="9b386-142">有效值介於 0 到 4294967295。</span><span class="sxs-lookup"><span data-stu-id="9b386-142">Valid values are from 0 to 4294967295.</span></span>|<span data-ttu-id="9b386-143">預設值為 5。</span><span class="sxs-lookup"><span data-stu-id="9b386-143">The default value is 5.</span></span>|  
|<span data-ttu-id="9b386-144">RemoveReceivedFileDelay</span><span class="sxs-lookup"><span data-stu-id="9b386-144">RemoveReceivedFileDelay</span></span>|<span data-ttu-id="9b386-145">VT_UI4</span><span class="sxs-lookup"><span data-stu-id="9b386-145">VT_UI4</span></span>|<span data-ttu-id="9b386-146">指定 FILE 配接器在嘗試刪除已讀取並提交至 BizTalk Server 的檔案之前所等待的初始間隔 (以毫秒為單位)。</span><span class="sxs-lookup"><span data-stu-id="9b386-146">Specify the initial interval in milliseconds that the File adapter waits before attempting to delete a file that it has read and submitted to BizTalk Server.</span></span>|<span data-ttu-id="9b386-147">此間隔會在每次重試間隔之後加倍，並以指定的重試間隔值為其上限。</span><span class="sxs-lookup"><span data-stu-id="9b386-147">This interval will double after each retry interval up to the specified maximum retry interval value.</span></span><br /><br /> <span data-ttu-id="9b386-148">有效值從 1 到 1000 之間。</span><span class="sxs-lookup"><span data-stu-id="9b386-148">Valid values are from 1 to 1000.</span></span>|<span data-ttu-id="9b386-149">預設值是 10。</span><span class="sxs-lookup"><span data-stu-id="9b386-149">The default value is 10.</span></span>|  
|<span data-ttu-id="9b386-150">RenameReceivedFiles</span><span class="sxs-lookup"><span data-stu-id="9b386-150">RenameReceivedFiles</span></span>|<span data-ttu-id="9b386-151">VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="9b386-151">VT_BOOL</span></span>|<span data-ttu-id="9b386-152">指定拾取檔案進行處理之前是否重新命名檔案。</span><span class="sxs-lookup"><span data-stu-id="9b386-152">Specify whether to rename files before picking them up for processing.</span></span>|<span data-ttu-id="9b386-153">有效值為：</span><span class="sxs-lookup"><span data-stu-id="9b386-153">Valid values are:</span></span><br /><br /> <span data-ttu-id="9b386-154">--1 (true)</span><span class="sxs-lookup"><span data-stu-id="9b386-154">-   -1 (true)</span></span><br /><span data-ttu-id="9b386-155">-0 (false)</span><span class="sxs-lookup"><span data-stu-id="9b386-155">-   0 (false)</span></span>|<span data-ttu-id="9b386-156">預設值是 0。</span><span class="sxs-lookup"><span data-stu-id="9b386-156">The default value is 0.</span></span>|  
|<span data-ttu-id="9b386-157">FileNetFailRetryCount</span><span class="sxs-lookup"><span data-stu-id="9b386-157">FileNetFailRetryCount</span></span>|<span data-ttu-id="9b386-158">VT_UI4</span><span class="sxs-lookup"><span data-stu-id="9b386-158">VT_UI4</span></span>|<span data-ttu-id="9b386-159">指定當網路共用上的接收位置暫時無法使用時，嘗試存取該接收位置的次數。</span><span class="sxs-lookup"><span data-stu-id="9b386-159">Specify the number of attempts to access the receive location on a network share if it is temporarily unavailable.</span></span>|<span data-ttu-id="9b386-160">有效值介於 0 到 4294967295。</span><span class="sxs-lookup"><span data-stu-id="9b386-160">Valid values are from 0 to 4294967295.</span></span>|<span data-ttu-id="9b386-161">預設值為 5。</span><span class="sxs-lookup"><span data-stu-id="9b386-161">The default value is 5.</span></span>|  
  
 <span data-ttu-id="9b386-162">下列程式碼顯示您用來設定屬性的 XML 字串格式：</span><span class="sxs-lookup"><span data-stu-id="9b386-162">The following code shows the format of the XML string you use to set the properties:</span></span>  
  
```  
<CustomProps>  
<RemoveReceivedFileRetryCount vt="19">5</RemoveReceivedFileRetryCount>  
<RemoveReceivedFileMaxInterval vt="19">300000</RemoveReceivedFileMaxInterval>  
<FileMask vt="8">*.xml</FileMask>  
<BatchSizeInBytes vt="19">102400</BatchSizeInBytes>  
<PollingInterval vt="19">60000</PollingInterval>  
<BatchSize vt="19">20</BatchSize>  
<FileNetFailRetryInt vt="19">5</FileNetFailRetryInt>  
<RemoveReceivedFileDelay vt="19">10</RemoveReceivedFileDelay>  
<RenameReceivedFiles vt="11">0</RenameReceivedFiles>  
<FileNetFailRetryCount vt="19">5</FileNetFailRetryCount>  
</CustomProps>  
```  
  
 <span data-ttu-id="9b386-163">下表列出可為 FILE 配接器傳送埠設定的組態屬性：</span><span class="sxs-lookup"><span data-stu-id="9b386-163">The following table lists the configuration properties that you can set for a File adapter send port:</span></span>  
  
|<span data-ttu-id="9b386-164">屬性名稱</span><span class="sxs-lookup"><span data-stu-id="9b386-164">Property name</span></span>|<span data-ttu-id="9b386-165">類型</span><span class="sxs-lookup"><span data-stu-id="9b386-165">Type</span></span>|<span data-ttu-id="9b386-166">Description</span><span class="sxs-lookup"><span data-stu-id="9b386-166">Description</span></span>|<span data-ttu-id="9b386-167">限制</span><span class="sxs-lookup"><span data-stu-id="9b386-167">Restrictions</span></span>|<span data-ttu-id="9b386-168">註解</span><span class="sxs-lookup"><span data-stu-id="9b386-168">Comments</span></span>|  
|-------------------|----------|-----------------|------------------|--------------|  
|<span data-ttu-id="9b386-169">使用者名稱</span><span class="sxs-lookup"><span data-stu-id="9b386-169">Username</span></span>|<span data-ttu-id="9b386-170">VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="9b386-170">VT_BSTR</span></span>|<span data-ttu-id="9b386-171">指定 FILE 配接器的主控件執行個體沒有網路共用的必要權限時，所使用的替代認證。</span><span class="sxs-lookup"><span data-stu-id="9b386-171">Specify alternative credentials when the host instance for the File adapter does not have the necessary rights to a network share.</span></span>|<span data-ttu-id="9b386-172">無</span><span class="sxs-lookup"><span data-stu-id="9b386-172">None</span></span>|<span data-ttu-id="9b386-173">指定的使用者名稱格式\<網域\>\username。</span><span class="sxs-lookup"><span data-stu-id="9b386-173">Specify the username in the format \<domain\>\username.</span></span>|  
|<span data-ttu-id="9b386-174">UseTempFileOnWrite</span><span class="sxs-lookup"><span data-stu-id="9b386-174">UseTempFileOnWrite</span></span>|<span data-ttu-id="9b386-175">VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="9b386-175">VT_BOOL</span></span>|<span data-ttu-id="9b386-176">指定在寫入目標資料夾時所使用的暫存檔。</span><span class="sxs-lookup"><span data-stu-id="9b386-176">Specifies to use a temporary file when writing to the target folder.</span></span> <span data-ttu-id="9b386-177">一旦完成寫入檔案，檔案會重新命名為 Filename 屬性所指定的值。</span><span class="sxs-lookup"><span data-stu-id="9b386-177">Once file is finished writing it is renamed to the value specified for the Filename property.</span></span>|<span data-ttu-id="9b386-178">只有在 CopyMode 屬性的值設定為 2 (建立新物件) 時，此屬性才能設定為 -1 (true)。</span><span class="sxs-lookup"><span data-stu-id="9b386-178">This property can only be set to -1 (true) if the CopyMode property is set to a value of 2 (Create new).</span></span><br /><br /> <span data-ttu-id="9b386-179">有效值為：</span><span class="sxs-lookup"><span data-stu-id="9b386-179">Valid values are:</span></span><br /><br /> <span data-ttu-id="9b386-180">--1 (true)</span><span class="sxs-lookup"><span data-stu-id="9b386-180">-   -1 (true)</span></span><br /><span data-ttu-id="9b386-181">-0 (false)</span><span class="sxs-lookup"><span data-stu-id="9b386-181">-   0 (false)</span></span>|<span data-ttu-id="9b386-182">預設值為 0 (false)。</span><span class="sxs-lookup"><span data-stu-id="9b386-182">The default value is 0 (false).</span></span>|  
|<span data-ttu-id="9b386-183">CopyMode</span><span class="sxs-lookup"><span data-stu-id="9b386-183">CopyMode</span></span>|<span data-ttu-id="9b386-184">VT_UI4</span><span class="sxs-lookup"><span data-stu-id="9b386-184">VT_UI4</span></span>|<span data-ttu-id="9b386-185">定義將訊息寫入檔案時使用的複製模式。</span><span class="sxs-lookup"><span data-stu-id="9b386-185">Define the copy mode to use when writing a message to a file</span></span>|<span data-ttu-id="9b386-186">有效值為：</span><span class="sxs-lookup"><span data-stu-id="9b386-186">Valid values are:</span></span><br /><br /> <span data-ttu-id="9b386-187">-0 （附加）</span><span class="sxs-lookup"><span data-stu-id="9b386-187">-   0 (Append)</span></span><br /><span data-ttu-id="9b386-188">-1 （覆寫）</span><span class="sxs-lookup"><span data-stu-id="9b386-188">-   1 (Overwrite)</span></span><br /><span data-ttu-id="9b386-189">-2 （建立新物件）</span><span class="sxs-lookup"><span data-stu-id="9b386-189">-   2 (Create new)</span></span>|<span data-ttu-id="9b386-190">預設值為 2 (建立新物件)。</span><span class="sxs-lookup"><span data-stu-id="9b386-190">The default value is 2 (Create new).</span></span>|  
|<span data-ttu-id="9b386-191">FileName</span><span class="sxs-lookup"><span data-stu-id="9b386-191">FileName</span></span>|<span data-ttu-id="9b386-192">VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="9b386-192">VT_BSTR</span></span>|<span data-ttu-id="9b386-193">指定檔案傳送處理常式寫入訊息的檔案名稱。</span><span class="sxs-lookup"><span data-stu-id="9b386-193">Specify the name of the file where the file send handler writes the message.</span></span>|<span data-ttu-id="9b386-194">這個屬性上有關限制的詳細資訊，請參閱[檔案遮罩和檔案名稱屬性的限制](http://msdn.microsoft.com/library/d8f5afd0-a61f-4c9b-8a57-4792e3054769)。</span><span class="sxs-lookup"><span data-stu-id="9b386-194">For information about restrictions on this property, see [Restrictions on the File Mask and File Name Properties](http://msdn.microsoft.com/library/d8f5afd0-a61f-4c9b-8a57-4792e3054769).</span></span>|<span data-ttu-id="9b386-195">預設值為 %MessageID%.xml。</span><span class="sxs-lookup"><span data-stu-id="9b386-195">The default value is %MessageID%.xml.</span></span>|  
|<span data-ttu-id="9b386-196">AllowCacheOnWrite</span><span class="sxs-lookup"><span data-stu-id="9b386-196">AllowCacheOnWrite</span></span>|<span data-ttu-id="9b386-197">VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="9b386-197">VT_BOOL</span></span>|<span data-ttu-id="9b386-198">指定將訊息寫入檔案時是否使用檔案系統快取。</span><span class="sxs-lookup"><span data-stu-id="9b386-198">Specify whether to use file system caching when writing a message to a file.</span></span>|<span data-ttu-id="9b386-199">有效值為：</span><span class="sxs-lookup"><span data-stu-id="9b386-199">Valid values are:</span></span><br /><br /> <span data-ttu-id="9b386-200">-0 （不使用快取）</span><span class="sxs-lookup"><span data-stu-id="9b386-200">-   0 (do not use caching)</span></span><br /><span data-ttu-id="9b386-201">--1 （使用快取）</span><span class="sxs-lookup"><span data-stu-id="9b386-201">-   -1 (use caching)</span></span>|<span data-ttu-id="9b386-202">預設值為 0 (不使用快取)。</span><span class="sxs-lookup"><span data-stu-id="9b386-202">The default value is 0 (do not use caching).</span></span>|  
|<span data-ttu-id="9b386-203">密碼</span><span class="sxs-lookup"><span data-stu-id="9b386-203">Password</span></span>|<span data-ttu-id="9b386-204">VT_NULL</span><span class="sxs-lookup"><span data-stu-id="9b386-204">VT_NULL</span></span>|<span data-ttu-id="9b386-205">指定 FILE 配接器的主控件執行個體沒有網路共用的必要權限時，與 Username 屬性搭配使用的密碼。</span><span class="sxs-lookup"><span data-stu-id="9b386-205">Specify the password used in conjunction with the Username property when the host instance for the File adapter does not have the necessary rights to a network share.</span></span>|<span data-ttu-id="9b386-206">當匯出繫結檔案時，一定會將這個值設定為 Null。</span><span class="sxs-lookup"><span data-stu-id="9b386-206">This value is always set to null when exporting a binding file.</span></span> <span data-ttu-id="9b386-207">將此繫結檔案匯入到目標 BizTalk Server 組態之前，必須手動將密碼填入此欄位。</span><span class="sxs-lookup"><span data-stu-id="9b386-207">This field must be manually populated with the password before importing the binding file into the target BizTalk Server configuration.</span></span>|<span data-ttu-id="9b386-208">無</span><span class="sxs-lookup"><span data-stu-id="9b386-208">None</span></span>|  
  
 <span data-ttu-id="9b386-209">下列程式碼顯示您用來設定屬性的 XML 字串格式：</span><span class="sxs-lookup"><span data-stu-id="9b386-209">The following code shows the format of the XML string you use to set the properties:</span></span>  
  
```  
<CustomProps>  
<Username vt="8">Domainname\User</Username>  
<UseTempFileOnWrite vt="11">-1</UseTempFileOnWrite>  
<CopyMode vt="19">1</CopyMode>  
<FileName vt="8">%MessageID%.xml</FileName>  
<AllowCacheOnWrite vt="11">-1</AllowCacheOnWrite>  
<Password vt="1" />  
</CustomProps>  
```