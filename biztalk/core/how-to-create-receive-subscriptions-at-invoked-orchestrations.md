---
title: 如何建立接收訂用帳戶在叫用的協調流程 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 3423309a-cb5a-40a5-9582-6ee3ac82b538
caps.latest.revision: 9
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: a3ccb4743b2054a02d492b053de21a32a27badaf
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "37010303"
---
# <a name="how-to-create-receive-subscriptions-at-invoked-orchestrations"></a>如何在叫用的協調流程建立接收訂閱
雖然您可以將訊息傳遞做為參數，透過**啟動協調流程**當您啟動協調流程，在某些情況下，您可能想要從呼叫端協調流程傳送訊息至之後叫用的協調流程圖形引動過程。 例如，您可能不知道會在叫用時傳遞何種訊息，或者其他協調流程可能需要動態地將訊息傳送到叫用的協調流程。  
  
 將訊息傳送到叫用之協調流程的方式，就是以相互關聯進行傳遞，讓叫用的協調流程可以建立由相互關聯協助定義的訂閱，然後再使用該訂閱來接收訊息。 然而，您不能只傳入相互關聯便期待叫用的協調流程會根據相互關聯建立訂閱，並可接收訂閱的訊息。 如果您使用該方法，您從呼叫端協調流程傳送到叫用之協調流程的訊息便會造成「無法路由已發佈的訊息，因為找不到訂閱者」錯誤。 這是因為下列各項：  
  
- 在叫用的協調流程中出現競爭條件。  
  
- 叫用的協調流程沒有認可點將訂閱傳送到 MessageBox 資料庫以進行路由，因此無法接收訊息。  
  
  解決此問題的方式之一是執行下列步驟：  
  
1. 在呼叫端協調流程中，擁有啟動接收以接收訊息。 您在呼叫端協調流程收到訊息，初始化相互關聯集，然後將傳遞相互關聯集及自我相互關聯的接收直接繫結連接埠通過之後**啟動協調流程**圖形。 您所傳入的連接埠會成為叫用之協調流程中的傳送埠，而且您將使用該傳送埠傳回訊息，以便與呼叫端協調流程同步。  
  
2. 在叫用的協調流程中，透過自我相互關聯的連接埠，將訊息傳回到呼叫端協調流程。 與呼叫端協調流程達成的同步可避免競爭條件，並能在叫用的協調流程中建立要進行路由之 MessageBox 的接收訂閱時提供認可點。  
  
3. 呼叫端協調流程會透過自我相互關聯的連接埠接收訊息，並與叫用的協調流程同步。 請注意，自我相互關聯的連接埠接收並不需要相互關聯實行項目。 現在，您可以從呼叫端協調流程將訊息安全地傳送到叫用的協調流程，而且叫用的協調流程會根據相互關聯接收訊息。  
  
   儘管先前的方法可以達成目標，更好的方法卻是傳入訊息以初始化您要在其上接收的相互關聯。 當您透過自我相互關聯的連接埠，使呼叫端協調流程與叫用的協調流程同步時，我們建議您永遠傳入初始化相化關聯所需要的訊息。 下列步驟提供最可靠與最高效能的方法：  
  
4. 在呼叫端協調流程中，擁有啟動接收以接收訊息。 您會收到訊息之後，傳遞訊息和自我相互關聯的接收直接繫結連接埠通過**啟動協調流程**圖形。 您所傳入的訊息會在叫用的協調流程中用來初始化相互關聯。 您所傳入的連接埠會成為叫用之協調流程中的傳送埠，而且您將使用該傳送埠傳回訊息，以便與呼叫端協調流程同步。  
  
5. 在叫用的協調流程中，初始化相互關聯，並將訊息傳回到呼叫端協調流程。 與呼叫端協調流程達成的同步可避免競爭條件，並能在叫用的協調流程中建立要進行路由之 MessageBox 的接收訂閱時提供認可點。  
  
6. 呼叫端協調流程會透過自我相互關聯的連接埠接收訊息，並與叫用的協調流程同步。 請注意，自我相互關聯的連接埠接收並不需要相互關聯實行項目。 現在，您可以從呼叫端協調流程將訊息安全地傳送到叫用的協調流程，而且叫用的協調流程會根據相互關聯接收訊息。  
  
## <a name="see-also"></a>另請參閱  
 [協調流程中使用的相互關聯](../core/using-correlations-in-orchestrations.md)   
 [如何使用自我相互關聯直接繫結連接埠](../core/how-to-use-self-correlating-direct-bound-ports.md)