---
title: 如何匯入 BizTalk 應用程式 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- deploying, planning
- planning, importing
- importing, applications
- applications, planning
- planning, deploying
- applications, importing
- importing, planning
ms.assetid: 51169f35-d572-4612-9104-a59908e24874
caps.latest.revision: 70
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 5a524cc61343085bf2db2ac220c5eea886219143
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "37014527"
---
# <a name="how-to-import-a-biztalk-application"></a><span data-ttu-id="565f2-102">如何匯入 BizTalk 應用程式</span><span class="sxs-lookup"><span data-stu-id="565f2-102">How to Import a BizTalk Application</span></span>
<span data-ttu-id="565f2-103">本主題描述如何使用[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台或命令列匯入 BizTalk 應用程式的 BizTalk 群組。</span><span class="sxs-lookup"><span data-stu-id="565f2-103">This topic describes how to use the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console or the command line import a BizTalk application into a BizTalk group.</span></span> <span data-ttu-id="565f2-104">匯入 BizTalk 應用程式會在 BizTalk 管理資料庫中註冊成品，並將成品的資料寫入適當的 BizTalk 資料庫。</span><span class="sxs-lookup"><span data-stu-id="565f2-104">Importing a BizTalk application registers the artifacts in the BizTalk Management database and writes the data of the artifacts to the appropriate BizTalk databases.</span></span> <span data-ttu-id="565f2-105">如需詳細資訊，請參閱 <<c0> [ 項目發生時匯入成品](../core/what-happens-when-artifacts-are-imported.md)。</span><span class="sxs-lookup"><span data-stu-id="565f2-105">For details, see [What Happens When Artifacts Are Imported](../core/what-happens-when-artifacts-are-imported.md).</span></span> <span data-ttu-id="565f2-106">匯入應用程式並不會安裝該應用程式，</span><span class="sxs-lookup"><span data-stu-id="565f2-106">Importing an application does not install the application.</span></span> <span data-ttu-id="565f2-107">您必須先安裝包含檔案架構成品的應用程式，才可以執行該應用程式。</span><span class="sxs-lookup"><span data-stu-id="565f2-107">You must install an application that includes file-based artifacts before it can run.</span></span>  
  
 <span data-ttu-id="565f2-108">當您使用[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]應用程式時，您可以從中啟動 「 匯入 MSI 精靈 」 的位置匯入的管理主控台可讓您決定是否您還可以建立新的應用程式，在此同時，您的成品匯入。</span><span class="sxs-lookup"><span data-stu-id="565f2-108">When you use the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console to import an application, the location from which you start the Import MSI Wizard determines whether or not you can create a new application at the same time that you import the artifacts.</span></span> <span data-ttu-id="565f2-109">如果是使用滑鼠右鍵按一下 BizTalk 群組來啟動精靈，就必須提供應用程式名稱。</span><span class="sxs-lookup"><span data-stu-id="565f2-109">If you start the wizard by right-clicking the BizTalk group, you must provide an application name.</span></span> <span data-ttu-id="565f2-110">如果 BizTalk 群組中具有您指定名稱的現有應用程式，就會將檔案中的成品匯入此應用程式；否則，會建立具有指定名稱的新應用程式，再將成品匯入其中。</span><span class="sxs-lookup"><span data-stu-id="565f2-110">If an existing application in the BizTalk group has the name you specify, the artifacts in the file are imported into this application; otherwise, a new application having the specified name is created, and the artifacts are imported into it.</span></span> <span data-ttu-id="565f2-111">如果是使用滑鼠右鍵按一下應用程式來啟動精靈，就無法指定應用程式名稱，而會將成品匯入目前的應用程式中。</span><span class="sxs-lookup"><span data-stu-id="565f2-111">If you start wizard by right-clicking an application, you cannot specify an application name, and the artifacts are imported into the current application.</span></span>  
  
 <span data-ttu-id="565f2-112">使用 BTSTask 命令列工具匯入 .msi 檔案時，不一定需要提供應用程式名稱。</span><span class="sxs-lookup"><span data-stu-id="565f2-112">When you use the BTSTask command-line tool to import an .msi file, providing an application name is optional.</span></span> <span data-ttu-id="565f2-113">如果沒有提供應用程式名稱，就會將成品匯入預設應用程式中。</span><span class="sxs-lookup"><span data-stu-id="565f2-113">If you do not provide a name, its artifacts are imported into the default application.</span></span>  
  
 <span data-ttu-id="565f2-114">匯入成品之後, 您可以檢視在適當的資料夾中的應用程式的資料夾下它們[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台。</span><span class="sxs-lookup"><span data-stu-id="565f2-114">After importing the artifacts, you can view them in the appropriate folder under the application's folder in the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span> <span data-ttu-id="565f2-115">您也可以檢視成品的清單應用程式中使用 BTSTask，如中所述[ListApp 命令](../core/listapp-command.md)。</span><span class="sxs-lookup"><span data-stu-id="565f2-115">You can also view a list of artifacts in the application by using BTSTask, as described in [ListApp Command](../core/listapp-command.md).</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="565f2-116">必要條件</span><span class="sxs-lookup"><span data-stu-id="565f2-116">Prerequisites</span></span>  
 <span data-ttu-id="565f2-117">若要匯入 BizTalk 應用程式，您必須登入帳戶的成員[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]Administrators 群組。</span><span class="sxs-lookup"><span data-stu-id="565f2-117">To import a BizTalk application, you must be logged on with an account that is a member of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administrators group.</span></span> <span data-ttu-id="565f2-118">若要安裝 BizTalk 應用程式，則也必須具有本機檔案系統的寫入權限。</span><span class="sxs-lookup"><span data-stu-id="565f2-118">To install a BizTalk application, you must also have Write permissions on the local file system.</span></span> <span data-ttu-id="565f2-119">如需詳細的權限的詳細資訊，請參閱[部署和管理 BizTalk 應用程式所需的權限](../core/permissions-required-for-deploying-and-managing-a-biztalk-application.md)。</span><span class="sxs-lookup"><span data-stu-id="565f2-119">For more detailed information on permissions, see [Permissions Required for Deploying and Managing a BizTalk Application](../core/permissions-required-for-deploying-and-managing-a-biztalk-application.md).</span></span>  
  
## <a name="considerations-for-importing-applications"></a><span data-ttu-id="565f2-120">匯入應用程式的考量</span><span class="sxs-lookup"><span data-stu-id="565f2-120">Considerations for importing applications</span></span>  
 <span data-ttu-id="565f2-121">匯入應用程式時，適用下列考量：</span><span class="sxs-lookup"><span data-stu-id="565f2-121">When importing an application, the following considerations may apply:</span></span>  
  
- <span data-ttu-id="565f2-122">**匯入應用程式從舊版的 BizTalk Server**。</span><span class="sxs-lookup"><span data-stu-id="565f2-122">**Importing applications from previous versions of BizTalk Server**.</span></span> <span data-ttu-id="565f2-123">如果您要從 BizTalk Server 2006 R2 或 BizTalk Server 2009 中，匯入應用程式和應用程式包含 EDI/AS2 合作對象資料，應用程式匯入可能會失敗，因為交易夥伴管理模型已大幅變更，BizTalk Server 中。</span><span class="sxs-lookup"><span data-stu-id="565f2-123">If you are importing applications from BizTalk Server 2006 R2 or BizTalk Server 2009, and the applications contain EDI/AS2 party data, the application import might fail because the trading partner management model has changed considerably in BizTalk Server.</span></span> <span data-ttu-id="565f2-124">您必須改用「合作對象移轉工具」，從舊版 BizTalk Server 移轉合作對象資料。</span><span class="sxs-lookup"><span data-stu-id="565f2-124">You must instead use the Party Migration Tool to migrate the party data from previous BizTalk Server versions.</span></span> <span data-ttu-id="565f2-125">如需有關此工具的詳細資訊，請參閱[移轉 EDI 成品從 BizTalk Server 先前版本](http://msdn.microsoft.com/library/b956a97e-03d0-47ea-a2ce-c07a339c0f2c)。</span><span class="sxs-lookup"><span data-stu-id="565f2-125">For more information about the tool, see [Migrating EDI Artifacts from a Previous Version of BizTalk Server](http://msdn.microsoft.com/library/b956a97e-03d0-47ea-a2ce-c07a339c0f2c).</span></span>  
  
- <span data-ttu-id="565f2-126">**匯入繫結永遠會覆寫現有的繫結。**</span><span class="sxs-lookup"><span data-stu-id="565f2-126">**Existing bindings are always overwritten by imported bindings.**</span></span> <span data-ttu-id="565f2-127">在現有應用程式中匯入包含繫結的 .msi 檔案時，現有繫結會遭到具有相同名稱的匯入繫結所覆寫。</span><span class="sxs-lookup"><span data-stu-id="565f2-127">When you import an .msi file that contains bindings into an existing application, the existing bindings are overwritten by imported bindings that have the same name.</span></span> <span data-ttu-id="565f2-128">即使您沒有在匯入 .msi 檔案時選取覆寫現有成品選項也會如此。</span><span class="sxs-lookup"><span data-stu-id="565f2-128">This is the case even when you have not selected the option to overwrite existing artifacts when importing the .msi file.</span></span> <span data-ttu-id="565f2-129">如果不想用匯入的應用程式繫結來覆寫要匯入 .msi 檔案的應用程式的現有繫結，則應該在匯出作業期間選擇不要將繫結檔案做為匯出資源。</span><span class="sxs-lookup"><span data-stu-id="565f2-129">If you do not want the bindings in the application you are exporting to overwrite the bindings in an application into which you are importing the .msi file, then you should not select the binding file as a resource to export during the export operation.</span></span> <span data-ttu-id="565f2-130">如需詳細資訊，請參閱 <<c0> [ 如何匯出 BizTalk 應用程式](../core/how-to-export-a-biztalk-application.md)。</span><span class="sxs-lookup"><span data-stu-id="565f2-130">For more information, see [How to Export a BizTalk Application](../core/how-to-export-a-biztalk-application.md).</span></span>  
  
   <span data-ttu-id="565f2-131">由於繫結是在匯入過程中套用，新的繫結會覆寫先前已套用的同名繫結。</span><span class="sxs-lookup"><span data-stu-id="565f2-131">As bindings are applied during the import process, bindings that have already been applied are overwritten by new bindings that have the same name.</span></span> <span data-ttu-id="565f2-132">也就是說，同名的繫結當中最後套用的繫結將會生效。</span><span class="sxs-lookup"><span data-stu-id="565f2-132">In other words, the last binding of a particular name to be applied takes effect.</span></span> <span data-ttu-id="565f2-133">當您匯入應用程式時，將依下列順序套用繫結：</span><span class="sxs-lookup"><span data-stu-id="565f2-133">When you import an application, bindings are applied in the following order:</span></span>  
  
  1. <span data-ttu-id="565f2-134">所產生的應用程式繫結[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]，未明確新增至應用程式透過繫結檔案，但匯出至應用程式.msi 檔案的使用者已明確選取的。</span><span class="sxs-lookup"><span data-stu-id="565f2-134">Application bindings generated by [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] that were not explicitly added to the application via a binding file, but that were explicitly selected by the user for export into the application .msi file.</span></span>  
  
  2. <span data-ttu-id="565f2-135">已明確加入，但未指定目標部署環境的繫結檔案。</span><span class="sxs-lookup"><span data-stu-id="565f2-135">Binding files that have been explicitly added, and do not have a target deployment environment specified.</span></span> <span data-ttu-id="565f2-136">套用此集合中的繫結時，並無特定順序。</span><span class="sxs-lookup"><span data-stu-id="565f2-136">Bindings in this set are applied in no specific order.</span></span>  
  
  3. <span data-ttu-id="565f2-137">已明確加入，且其相關聯目標部署環境與應用程式匯入所選定的部署環境相符的繫結。</span><span class="sxs-lookup"><span data-stu-id="565f2-137">Bindings that have been explicitly added, and that have an associated target deployment environment that matches the deployment environment selected for application import.</span></span> <span data-ttu-id="565f2-138">套用此集合中的繫結時，並無特定順序。</span><span class="sxs-lookup"><span data-stu-id="565f2-138">Bindings in this set are applied in no specific order.</span></span>  
  
- <span data-ttu-id="565f2-139">**主機必須存在於群組中。**</span><span class="sxs-lookup"><span data-stu-id="565f2-139">**The host must exist in the group.**</span></span> <span data-ttu-id="565f2-140">BizTalk 群組中必須已經有主控件能夠相對於 .msi 檔案所含應用程式繫結中指定的主控件，否則匯入作業將失敗。</span><span class="sxs-lookup"><span data-stu-id="565f2-140">A host corresponding to the host specified in the application bindings contained in the .msi file must already exist in the BizTalk group or the import operation will fail.</span></span> <span data-ttu-id="565f2-141">此外，主控件的信任層級也必須相符合。</span><span class="sxs-lookup"><span data-stu-id="565f2-141">In addition, the host trust level must match.</span></span>  
  
- <span data-ttu-id="565f2-142">**您可能需要加入另一個應用程式的參考。**</span><span class="sxs-lookup"><span data-stu-id="565f2-142">**You may need to add a reference to another application.**</span></span> <span data-ttu-id="565f2-143">如果要匯入的應用程式與另一個應用程式中的成品相依，則必須新增參考至此應用程式。</span><span class="sxs-lookup"><span data-stu-id="565f2-143">If the application you are importing depends on an artifact in another application, you need to add a reference to this application.</span></span> <span data-ttu-id="565f2-144">群組中必須已經有應用程式和必要的成品。</span><span class="sxs-lookup"><span data-stu-id="565f2-144">The application and required artifact must already exist in the group.</span></span> <span data-ttu-id="565f2-145">匯入精靈有提供這個選項。</span><span class="sxs-lookup"><span data-stu-id="565f2-145">The Import Wizard provides this option.</span></span> <span data-ttu-id="565f2-146">如果您使用 BTSTask 的 ImportApp 命令，不過，您必須加入參考至匯入之後，應用程式中所述[如何加入另一個應用程式的參考](../core/how-to-add-a-reference-to-another-application.md)。</span><span class="sxs-lookup"><span data-stu-id="565f2-146">If you are using the ImportApp command of BTSTask, however, you must add the reference to the application after import, as described in [How to Add a Reference to Another Application](../core/how-to-add-a-reference-to-another-application.md).</span></span> <span data-ttu-id="565f2-147">如需背景資訊，請參閱 <<c0> [ 相依性和應用程式部署](../core/dependencies-and-application-deployment.md)。</span><span class="sxs-lookup"><span data-stu-id="565f2-147">For background information, see [Dependencies and Application Deployment](../core/dependencies-and-application-deployment.md).</span></span> <span data-ttu-id="565f2-148">匯入精靈會比對群組中現有應用程式的參考，並讓您選擇要新增參考或變更現有的參考。</span><span class="sxs-lookup"><span data-stu-id="565f2-148">The Import Wizard matches the references to existing applications in the group and gives you the option to add a new reference or change an existing reference.</span></span> <span data-ttu-id="565f2-149">您應該另外確認參考的應用程式是否包含必要的成品。</span><span class="sxs-lookup"><span data-stu-id="565f2-149">You should take the additional step of verifying that the referenced application contains the required artifact.</span></span>  
  
- <span data-ttu-id="565f2-150">**如果匯入作業逾時，應用程式分割成其他.msi 檔案。**</span><span class="sxs-lookup"><span data-stu-id="565f2-150">**If an import operation times out, split the application into additional .msi files.**</span></span> <span data-ttu-id="565f2-151">匯入作業的持續時間一旦超過 3600 秒就會逾時。</span><span class="sxs-lookup"><span data-stu-id="565f2-151">An import operation will time out if it exceeds 3600 seconds in duration.</span></span> <span data-ttu-id="565f2-152">如果您嘗試匯入某個 .msi 檔案而發生作業逾時，請重新匯出應用程式並分批選取所要匯出的部分成品，以將應用程式的內容分成多個 .msi 檔案。</span><span class="sxs-lookup"><span data-stu-id="565f2-152">If you are attempting to import an .msi file, and the operation times out, you should divide the contents of the application into more than one .msi file by re-exporting the application and selecting a subset of artifacts to export.</span></span> <span data-ttu-id="565f2-153">如需詳細資訊，請參閱 <<c0> [ 如何匯出 BizTalk 應用程式](../core/how-to-export-a-biztalk-application.md)。</span><span class="sxs-lookup"><span data-stu-id="565f2-153">For more information, see [How to Export a BizTalk Application](../core/how-to-export-a-biztalk-application.md).</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="565f2-154">基於安全性考量，應用程式匯出期間將從應用程式繫結移除密碼。</span><span class="sxs-lookup"><span data-stu-id="565f2-154">For security reasons, during application export, passwords are removed from application bindings.</span></span> <span data-ttu-id="565f2-155">但是，並不是從新增至應用程式的繫結檔案中移除密碼。</span><span class="sxs-lookup"><span data-stu-id="565f2-155">They are not, however, removed from any binding files that were added to the application.</span></span> <span data-ttu-id="565f2-156">匯入應用程式後，您必須重新設定密碼，應用程式才能正常運作。</span><span class="sxs-lookup"><span data-stu-id="565f2-156">After importing the application, you will need to reconfigure the passwords in order for the application to function.</span></span> <span data-ttu-id="565f2-157">您可以編輯繫結檔案或使用管理主控台，以完成這項作業。</span><span class="sxs-lookup"><span data-stu-id="565f2-157">You can do this by editing the binding file or by using the administration console.</span></span> <span data-ttu-id="565f2-158">如需有關編輯繫結檔案的詳細資訊，請參閱 <<c0> [ 自訂繫結檔案](../core/customizing-binding-files.md)。</span><span class="sxs-lookup"><span data-stu-id="565f2-158">For more information about editing a binding file, see [Customizing Binding Files](../core/customizing-binding-files.md).</span></span> <span data-ttu-id="565f2-159">如需有關如何設定配接器安全性的詳細資訊，請參閱[使用配接器](../core/using-adapters.md)。</span><span class="sxs-lookup"><span data-stu-id="565f2-159">For more information about configuring security for adapters, see [Using Adapters](../core/using-adapters.md).</span></span>  
> 
> [!NOTE]
>  <span data-ttu-id="565f2-160">如果匯入失敗，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]會回復所有匯入作業所自訂的指令碼執行任何動作除外。</span><span class="sxs-lookup"><span data-stu-id="565f2-160">If an import fails, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] rolls back all import operations except for any actions performed by custom scripts.</span></span>  
> 
> [!NOTE]
>  <span data-ttu-id="565f2-161">如果您在一個使用其他應用程式中之屬性結構描述的應用程式內建立傳送埠的篩選，然後再將此應用程式匯入至新的 BizTalk 群組，那麼您在安裝及啟動應用程式時，將不會收到結構描述遺失的警告，並且篩選功能也無法運作。</span><span class="sxs-lookup"><span data-stu-id="565f2-161">If you create a filter for a send port in one application that uses a property schema in another application, and then import the first application into a new BizTalk group, you will not receive a warning that the schema is missing, and filtering will not function when the application is installed and started.</span></span> <span data-ttu-id="565f2-162">在安裝沒有包含結構描述的應用程式之前，您可以先匯入包含結構描述的應用程式來修正問題。</span><span class="sxs-lookup"><span data-stu-id="565f2-162">You can correct the problem by importing the application that contains the schema before you install the application that does not contain the schema.</span></span>  
  
## <a name="to-import-a-biztalk-application"></a><span data-ttu-id="565f2-163">匯入 BizTalk 應用程式</span><span class="sxs-lookup"><span data-stu-id="565f2-163">To import a BizTalk application</span></span>  
  
#### <a name="using-the-biztalk-server-administration-console"></a><span data-ttu-id="565f2-164">使用 BizTalk Server 管理主控台</span><span class="sxs-lookup"><span data-stu-id="565f2-164">Using the BizTalk Server Administration Console</span></span>  
  
1. <span data-ttu-id="565f2-165">按一下 **開始**，按一下**所有程式**，按一下  [!INCLUDE[btsBizTalkServerStartMenuItemui](../includes/btsbiztalkserverstartmenuitemui-md.md)]，然後按一下**BizTalk Server 管理**。</span><span class="sxs-lookup"><span data-stu-id="565f2-165">Click **Start**, click **All Programs**, click [!INCLUDE[btsBizTalkServerStartMenuItemui](../includes/btsbiztalkserverstartmenuitemui-md.md)], and then click **BizTalk Server Administration**.</span></span>  
  
2. <span data-ttu-id="565f2-166">在主控台樹狀目錄中，依序展開[!INCLUDE[btsBizTalkServerAdminConsoleui](../includes/btsbiztalkserveradminconsoleui-md.md)]，展開 BizTalk 群組，然後執行下列其中一項：</span><span class="sxs-lookup"><span data-stu-id="565f2-166">In the console tree, expand [!INCLUDE[btsBizTalkServerAdminConsoleui](../includes/btsbiztalkserveradminconsoleui-md.md)], expand the BizTalk group, and do one of the following:</span></span>  
  
   -   <span data-ttu-id="565f2-167">若要匯入的應用程式和成品到 BizTalk 群組包含在.msi 檔案，以滑鼠右鍵按一下**應用程式**，指向**匯入**，然後按一下**MSI 檔案**。</span><span class="sxs-lookup"><span data-stu-id="565f2-167">To import the application and artifacts contained in the .msi file into the BizTalk group, right-click **Applications**, point to **Import**, and then click **MSI file**.</span></span>  
  
   -   <span data-ttu-id="565f2-168">若要匯入到現有的應用程式.msi 檔案中所包含的成品，請展開**應用程式**，以滑鼠右鍵按一下 應用程式，指向**匯入**，然後按一下  **的MSI檔案**.</span><span class="sxs-lookup"><span data-stu-id="565f2-168">To import the artifacts contained in the .msi file into an existing application, expand **Applications**, right-click the application, point to **Import**, and then click **MSI file**.</span></span>  
  
3. <span data-ttu-id="565f2-169">在歡迎使用匯入 MSI 精靈 頁面中，在**MSI 檔案匯入**，輸入.msi 檔案的路徑，然後按一下**下一步**。</span><span class="sxs-lookup"><span data-stu-id="565f2-169">On the Welcome to the Import MSI Wizard page, in **MSI file to import**, type the path of the .msi file, and then click **Next**.</span></span> <span data-ttu-id="565f2-170">如果有必要，您可以瀏覽.msi 檔案，即可 **...**</span><span class="sxs-lookup"><span data-stu-id="565f2-170">If necessary, you can browse for the .msi file by clicking the **…**</span></span> <span data-ttu-id="565f2-171">按鈕，可選取色彩。</span><span class="sxs-lookup"><span data-stu-id="565f2-171">button.</span></span>  
  
4. <span data-ttu-id="565f2-172">在應用程式設定 頁面中**應用程式名稱**下拉式清單中，選取應用程式名稱，如果有的話。</span><span class="sxs-lookup"><span data-stu-id="565f2-172">On the Application Settings page, in the **Application name** drop-down list, select the application name, if available.</span></span> <span data-ttu-id="565f2-173">當您將應用程式匯入 BizTalk 群組中，就會有此清單。</span><span class="sxs-lookup"><span data-stu-id="565f2-173">The list is available if you are importing the application into the BizTalk group.</span></span>  
  
   > [!NOTE]
   >  <span data-ttu-id="565f2-174">清單中包含 BizTalk 群組中目前的所有應用程式名稱，以及匯出 .msi 檔案的應用程式名稱。</span><span class="sxs-lookup"><span data-stu-id="565f2-174">The list includes the names of all of the applications currently in the BizTalk group as well as the application from which the .msi file was exported.</span></span> <span data-ttu-id="565f2-175">如果您選取後面的應用程式名稱，而 BizTalk 群組中還沒有該應用程式，則匯入精靈會建立新的應用程式。</span><span class="sxs-lookup"><span data-stu-id="565f2-175">If you select the latter application name, and the application does not already exist in this BizTalk group, the Import Wizard creates a new application.</span></span> <span data-ttu-id="565f2-176">如果您選取群組中已經有的應用程式，則匯入精靈會從 .msi 檔案將成品匯入到現有應用程式中。</span><span class="sxs-lookup"><span data-stu-id="565f2-176">If you select an application that already exists in the group, the Import Wizard imports the artifacts from the .msi file into the existing application.</span></span>  
  
5. <span data-ttu-id="565f2-177">在 [**可用的應用程式，將參考加入至**，選取要加入的參考，如果有的話，應用程式，然後按一下**下一步]**。</span><span class="sxs-lookup"><span data-stu-id="565f2-177">In **Available applications to add references to**, select the applications to which to add references, if any, and then click **Next**.</span></span>  
  
6. <span data-ttu-id="565f2-178">如果您要匯入.msi 檔案到現有的應用程式，而且想要覆寫現有的應用程式中的成品，請選取**覆寫資源**。</span><span class="sxs-lookup"><span data-stu-id="565f2-178">If you are importing the .msi file into an existing application and want to overwrite artifacts in the existing application, select **Overwrite resources**.</span></span>  
  
   > [!NOTE]
   >  <span data-ttu-id="565f2-179">如果沒有選取此選項，而包含成品的 .msi 檔案已經在應用程式中，則匯入作業即失敗並會進行回復。</span><span class="sxs-lookup"><span data-stu-id="565f2-179">If you do not select this option, and the .msi file contains an artifact that already exists in the application, the import operation will fail and roll back.</span></span> <span data-ttu-id="565f2-180">BizTalk 應用程式或群組中的某些類型成品必須是唯一的。</span><span class="sxs-lookup"><span data-stu-id="565f2-180">Certain types of artifacts in a BizTalk application or group must be unique.</span></span> <span data-ttu-id="565f2-181">如果新增的成品已經在 BizTalk 群組中，卻不在目前應用程式中，即使您指定了覆寫選項，匯入作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="565f2-181">If you are adding an artifact that already exists in the BizTalk group, but not in the current application, the import operation will fail, even if you specify the overwrite option.</span></span> <span data-ttu-id="565f2-182">如需哪些成品必須是唯一，以及哪些方式它們必須是唯一的詳細資訊，請參閱[成品，必須是唯一的應用程式或群組](../core/artifacts-that-must-be-unique-in-an-application-or-group.md)。</span><span class="sxs-lookup"><span data-stu-id="565f2-182">For more information about which artifacts must be unique and in what ways they must be unique, see [Artifacts That Must Be Unique in an Application or Group](../core/artifacts-that-must-be-unique-in-an-application-or-group.md).</span></span>  
  
7. <span data-ttu-id="565f2-183">在應用程式目標環境設定 頁面上，在**目標執行環境**下拉式清單中，選取這個應用程式的目標環境，然後按一下**下一步**。</span><span class="sxs-lookup"><span data-stu-id="565f2-183">On the Application Target Environment Settings page, in the **Target Staging Environment** drop-down list, select the target environment for this application, and click **Next**.</span></span> <span data-ttu-id="565f2-184">此清單包含針對新增至此應用程式的任何繫結檔案所指定的所有環境。</span><span class="sxs-lookup"><span data-stu-id="565f2-184">This list contains all environments that have been specified for any binding files that have been added to this application.</span></span> <span data-ttu-id="565f2-185">選取 \<預設\>如果您想要套用應用程式，除了具有指定目標環境中的所有繫結。</span><span class="sxs-lookup"><span data-stu-id="565f2-185">Select \<Default\> if you want to apply all bindings in the application except for those that have a target environment specified.</span></span> <span data-ttu-id="565f2-186">如果.msi 檔案不包含您想要明確套用的繫結檔案，您可以將保留\<預設\>選取。</span><span class="sxs-lookup"><span data-stu-id="565f2-186">If the .msi file does not contain a binding file that you want to apply explicitly, you can leave \<Default\> selected.</span></span>  
  
   > [!NOTE]
   >  <span data-ttu-id="565f2-187">當您將繫結檔案新增至應用程式時，可以指定繫結的目標環境。</span><span class="sxs-lookup"><span data-stu-id="565f2-187">You specify the target environment for bindings when you add a binding file to an application.</span></span> <span data-ttu-id="565f2-188">如需背景資訊，請參閱 <<c0> [ 繫結檔案和應用程式部署](../core/binding-files-and-application-deployment.md)。</span><span class="sxs-lookup"><span data-stu-id="565f2-188">For background information, see [Binding Files and Application Deployment](../core/binding-files-and-application-deployment.md).</span></span> <span data-ttu-id="565f2-189">如需新增繫結檔案的指示，請參閱[如何將繫結檔案新增至應用程式](../core/how-to-add-a-binding-file-to-an-application2.md)。</span><span class="sxs-lookup"><span data-stu-id="565f2-189">For instructions on adding binding files, see [How to Add a Binding File to an Application](../core/how-to-add-a-binding-file-to-an-application2.md).</span></span>  
  
8. <span data-ttu-id="565f2-190">在匯入摘要] 頁面上，確認 [摘要資訊是否正確，，然後按一下**匯入**。</span><span class="sxs-lookup"><span data-stu-id="565f2-190">On the Import Summary page, confirm that the summary information is correct, and then click **Import**.</span></span>  
  
9. <span data-ttu-id="565f2-191">在匯入成功 頁面上，如果您想要在本機電腦上安裝應用程式，選取**執行應用程式安裝精靈在本機電腦上安裝應用程式**核取方塊。</span><span class="sxs-lookup"><span data-stu-id="565f2-191">On the Import Succeeded page, if you want to install the application on the local computer, select the **Run the Application Installation Wizard to install the application on the local computer** check box.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="565f2-192">因為目前已在本機電腦上設定這個選項，所以只有在您要執行應用程式時才會需要進行安裝。</span><span class="sxs-lookup"><span data-stu-id="565f2-192">Unless you need to run the application as it is currently configured on the local computer, you do not need to install it.</span></span> <span data-ttu-id="565f2-193">但是，如果應用程式包含檔案架構成品，您必須在將會執行應用程式的所有電腦上安裝應用程式，它才能開始運作，因為匯入應用程式只是將其新增至 BizTalk 管理資料庫中。</span><span class="sxs-lookup"><span data-stu-id="565f2-193">If the application includes file-based artifacts, however, you must install the application on all of the computers that will run it before it can begin functioning, as importing the application only adds it to the BizTalk Management database.</span></span>  
  
10. <span data-ttu-id="565f2-194">按一下 **[完成]**。</span><span class="sxs-lookup"><span data-stu-id="565f2-194">Click **Finish**.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="565f2-195">如果安裝失敗 (例如您沒有本機檔案系統的寫入權限而失敗)，就會回復安裝作業，而非匯入作業。</span><span class="sxs-lookup"><span data-stu-id="565f2-195">If the installation fails, for example because you do not have Write permissions on the local file system, the installation is rolled back, but not the import operation.</span></span>  
  
#### <a name="using-the-command-line"></a><span data-ttu-id="565f2-196">使用命令列</span><span class="sxs-lookup"><span data-stu-id="565f2-196">Using the command line</span></span>  
  
1. <span data-ttu-id="565f2-197">開啟命令提示字元，如下所示： 按一下**開始**，按一下**執行**，型別`cmd`，然後按一下 **確定**。</span><span class="sxs-lookup"><span data-stu-id="565f2-197">Open a command prompt as follows: Click **Start**, click **Run**, type `cmd`, and then click **OK**.</span></span>  
  
2. <span data-ttu-id="565f2-198">輸入下列命令，並以適當的值替代，如下表所述：</span><span class="sxs-lookup"><span data-stu-id="565f2-198">Type the following command, substituting the appropriate values, as described in the following table:</span></span>  
  
    <span data-ttu-id="565f2-199">**BTSTask 的 ImportApp /Package:** *值*[**/Environment:**<em>值</em>] [**/ApplicationName:** <em>值</em>] [**/覆寫**] [**/Server:**<em>值</em>] [**/database:**<em>值</em>]</span><span class="sxs-lookup"><span data-stu-id="565f2-199">**BTSTask ImportApp /Package:** *value* [**/Environment:**<em>value</em>] [**/ApplicationName:**<em>value</em>] [**/Overwrite**] [**/Server:**<em>value</em>] [**/Database:**<em>value</em>]</span></span>  
  
    <span data-ttu-id="565f2-200">範例</span><span class="sxs-lookup"><span data-stu-id="565f2-200">Example:</span></span>  
  
    <span data-ttu-id="565f2-201">**BTSTask 的 ImportApp /Package:"C:\MSI Files\MyApplication.msi"/Environment:Test /applicationname: myapplication / 覆寫**</span><span class="sxs-lookup"><span data-stu-id="565f2-201">**BTSTask ImportApp /Package:"C:\MSI Files\MyApplication.msi"  /Environment:Test /ApplicationName:MyApplication /Overwrite**</span></span>  
  
   |<span data-ttu-id="565f2-202">參數</span><span class="sxs-lookup"><span data-stu-id="565f2-202">Parameter</span></span>|<span data-ttu-id="565f2-203">ReplTest1</span><span class="sxs-lookup"><span data-stu-id="565f2-203">Value</span></span>|  
   |---------------|-----------|  
   |<span data-ttu-id="565f2-204">**/ 套件**</span><span class="sxs-lookup"><span data-stu-id="565f2-204">**/Package**</span></span>|<span data-ttu-id="565f2-205">.msi 檔案的完整路徑。</span><span class="sxs-lookup"><span data-stu-id="565f2-205">Full path of the .msi file.</span></span> <span data-ttu-id="565f2-206">如果路徑包含空格，您必須將它括在引號 (") 中。</span><span class="sxs-lookup"><span data-stu-id="565f2-206">If the path includes spaces, you must enclose it in quotation marks (").</span></span>|  
   |<span data-ttu-id="565f2-207">**/ 環境**</span><span class="sxs-lookup"><span data-stu-id="565f2-207">**/Environment**</span></span>|<span data-ttu-id="565f2-208">所套用之繫結檔案的目標部署環境，例如 Test。</span><span class="sxs-lookup"><span data-stu-id="565f2-208">The target deployment environment of the binding file to apply, such as Test.</span></span> <span data-ttu-id="565f2-209">此值係針對已加入應用程式中的繫結檔案指定其目標部署環境。</span><span class="sxs-lookup"><span data-stu-id="565f2-209">This is the value that was specified for the target deployment environment when the binding file was added to the application.</span></span>|  
   |<span data-ttu-id="565f2-210">**/ 應用程式名稱**</span><span class="sxs-lookup"><span data-stu-id="565f2-210">**/ApplicationName**</span></span>|<span data-ttu-id="565f2-211">要從 .msi 檔案匯入成品的 BizTalk 應用程式的名稱。</span><span class="sxs-lookup"><span data-stu-id="565f2-211">Name of the BizTalk application to which the artifacts in the .msi file are imported.</span></span> <span data-ttu-id="565f2-212">如果沒有指定，將會使用匯入 .msi 檔案時指定的應用程式名稱。</span><span class="sxs-lookup"><span data-stu-id="565f2-212">If not specified, the application name that was specified when exporting the .msi file is used.</span></span> <span data-ttu-id="565f2-213">如果指定的應用程式不存在，則會建立該應用程式。</span><span class="sxs-lookup"><span data-stu-id="565f2-213">If the specified application does not exist, it will be created.</span></span> <span data-ttu-id="565f2-214">包含空格的應用程式名稱必須以雙引號 (") 圍住。</span><span class="sxs-lookup"><span data-stu-id="565f2-214">Application names that include spaces must be enclosed with double quotation marks (").</span></span>|  
   |<span data-ttu-id="565f2-215">**/ 覆寫**</span><span class="sxs-lookup"><span data-stu-id="565f2-215">**/Overwrite**</span></span>|<span data-ttu-id="565f2-216">此選項指定以 .msi 檔案中，本機唯一識別碼 (LUID) 相同的成品覆寫應用程式中的成品。</span><span class="sxs-lookup"><span data-stu-id="565f2-216">Option to overwrite artifacts in the application with artifacts in the .msi file that have the same locally unique identifier (LUID).</span></span> <span data-ttu-id="565f2-217">若未指定此選項，且應用程式中有一或多個成品與 .msi 檔案中的成品具有相同的 LUID，匯入就會失敗。</span><span class="sxs-lookup"><span data-stu-id="565f2-217">If this option is not specified, and there are one or more artifacts in the application that have the same LUID as artifacts in the .msi file, the import fails.</span></span> <span data-ttu-id="565f2-218">您也可以使用應用程式中檢視成品的 Luid [ListApp 命令](../core/listapp-command.md)。</span><span class="sxs-lookup"><span data-stu-id="565f2-218">You can view the LUIDs of the artifacts in an application by using the [ListApp Command](../core/listapp-command.md).</span></span>|  
   |<span data-ttu-id="565f2-219">**/ 伺服器**</span><span class="sxs-lookup"><span data-stu-id="565f2-219">**/Server**</span></span>|<span data-ttu-id="565f2-220">裝載 BizTalk 管理資料庫之 SQL Server 執行個體的名稱，其格式為：伺服器名稱\執行個體名稱,連接埠。</span><span class="sxs-lookup"><span data-stu-id="565f2-220">Name of the SQL Server instance hosting the BizTalk Management database, in the form ServerName\InstanceName,Port.</span></span><br /><br /> <span data-ttu-id="565f2-221">只有在執行個體名稱和伺服器名稱不同時，才需要執行個體名稱。</span><span class="sxs-lookup"><span data-stu-id="565f2-221">Instance name is only required when the instance name is different than the server name.</span></span> <span data-ttu-id="565f2-222">只有在 SQL Server 使用預設值 (1433) 以外的連接埠編號時，才需要連接埠。</span><span class="sxs-lookup"><span data-stu-id="565f2-222">Port is only required when SQL Server uses a port number other than the default (1433).</span></span><br /><br /> <span data-ttu-id="565f2-223">範例:</span><span class="sxs-lookup"><span data-stu-id="565f2-223">Examples:</span></span><br /><br /> <span data-ttu-id="565f2-224">Server=MyServer</span><span class="sxs-lookup"><span data-stu-id="565f2-224">Server=MyServer</span></span><br /><br /> <span data-ttu-id="565f2-225">Server=MyServer\MySQLServer,1533</span><span class="sxs-lookup"><span data-stu-id="565f2-225">Server=MyServer\MySQLServer,1533</span></span><br /><br /> <span data-ttu-id="565f2-226">如果不提供，將會使用在本機電腦上執行的 SQL Server 執行個體的名稱。</span><span class="sxs-lookup"><span data-stu-id="565f2-226">If not provided, the name of the SQL Server instance running on the local computer is used.</span></span>|  
   |<span data-ttu-id="565f2-227">**/ 資料庫**</span><span class="sxs-lookup"><span data-stu-id="565f2-227">**/Database**</span></span>|<span data-ttu-id="565f2-228">BizTalk 管理資料庫的名稱。</span><span class="sxs-lookup"><span data-stu-id="565f2-228">Name of the BizTalk Management database.</span></span> <span data-ttu-id="565f2-229">如果沒有指定，將會使用在 SQL Server 本機執行個體中執行的 BizTalk 管理資料庫。</span><span class="sxs-lookup"><span data-stu-id="565f2-229">If not specified, the BizTalk Management database running in the local instance of SQL Server is used.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="565f2-230">另請參閱</span><span class="sxs-lookup"><span data-stu-id="565f2-230">See Also</span></span>  
 <span data-ttu-id="565f2-231">[匯入 BizTalk 應用程式、 繫結和原則](../core/importing-biztalk-applications-bindings-and-policies.md) </span><span class="sxs-lookup"><span data-stu-id="565f2-231">[Importing BizTalk Applications, Bindings, and Policies](../core/importing-biztalk-applications-bindings-and-policies.md) </span></span>  
 [<span data-ttu-id="565f2-232">ImportApp 命令</span><span class="sxs-lookup"><span data-stu-id="565f2-232">ImportApp Command</span></span>](../core/importapp-command.md)