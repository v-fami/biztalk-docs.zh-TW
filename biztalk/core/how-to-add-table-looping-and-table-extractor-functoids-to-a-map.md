---
title: "如何新增表格迴圈和表格擷取程式運算質至對應 |Microsoft 文件"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 3c837ab8-55db-471a-af26-9fbd0497d7d4
caps.latest.revision: "10"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: e4b7844260b7ac5ab29f204a538e61cb99b0d017
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
---
# <a name="how-to-add-table-looping-and-table-extractor-functoids-to-a-map"></a>如何新增表格迴圈和表格擷取程式運算質至對應
**表格迴圈**和**表格抽選程式**運算質一起使用。 **表格迴圈**運算質有您所設定的內部資料表。 每個輸入記錄或欄位，**表格迴圈**運算質會輸出一次一個資料表的資料列。 **表格抽選程式**運算質從一個資料列擷取所需的項目，並將它傳遞到輸出執行個體訊息。  
  
 如需概念資訊**表格迴圈**和**表格抽選程式**運算質，請參閱[表格迴圈和表格擷取程式運算質](../core/table-looping-and-table-extractor-functoids.md)。  
  
### <a name="to-add-the-table-looping-and-table-extractor-functoids-to-a-map-and-configure-them"></a>新增 「 表格迴圈和表格擷取程式運算質至對應並加以設定  
  
1.  與[!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]工具箱作用中，按一下**進階運算質**索引標籤，選取該運算質類別。  
  
     顯示所選類別中的進階運算質清單。  
  
2.  拖曳**表格迴圈**運算質 (![](../core/media/advtablelooping.gif "advtablelooping")) 從工具箱拖曳至格線頁上的適當位置。  
  
    > [!NOTE]
    >  運算質將放置在顯示的格線頁上。 如果您想要將運算質放置到不同的格線頁，您需要先顯示該格線頁。  
  
    > [!NOTE]
    >  因為輸出**表格迴圈**運算質當做輸入一或多個相關聯**表格抽選程式**運算質，請確定您的右邊預留空間**表格迴圈**運算質**表格抽選程式**運算質。  
  
3.  從來源結構描述拖曳記錄或欄位到新增**表格迴圈**運算質。 第一個輸入參數為**表格迴圈**運算質，此記錄或執行個體訊息中的欄位的發生次數會控制此運算質會產生輸出的次數。 例如，如果迴圈記錄拖曳至運算質，並處理有這個記錄的 10 個執行個體訊息時，已有一列的資料行的資料來源的設定表格格線**表格迴圈**運算質會重複 10 次，產生 10 個輸出資料列所擷取的**表格擷取程式**可輕鬆建構記錄的運算質，並允許 10 個目的地。  
  
    > [!NOTE]
    >  如果您在資料表方格中設定多個資料列，每個這類的資料列會輸出的每個反覆運算**表格迴圈**運算質。 因此，輸入記錄的發生次數乘上表格格線中設定的資料列數會產生可供資料擷取的輸出表格資料列數。  
  
4.  從目的結構描述拖曳記錄或欄位**表格迴圈**運算質。 此連結可確保在目的結構描述中建立節點。  
  
5.  選取新加入**表格迴圈**運算質，然後在**屬性**視窗中，按一下省略符號 (**...**) 相關聯的按鈕及其**輸入參數**屬性。  
  
    > [!NOTE]
    >  或者，您也可以選取運算質，然後按鍵盤的 CTRL+M、CTRL+T。 如需對應工具鍵盤快速鍵請參閱[BizTalk 對應工具鍵盤快速鍵](../core/biztalk-mapper-keyboard-shortcuts.md)。  
  
6.  在**設定表格迴圈運算質**對話方塊中，按一下 ![常數輸入的參數新增至運算質](../core/media/add-input-parameters.gif "Add_input_parameters")按鈕以建立第二個輸入的參數。 輸入代表將可在您要建立這個資料表中的資料行數目的數字**表格迴圈**運算質。  
  
    > [!NOTE]
    >  表格中最大的資料行數為 228。  
  
7.  在**設定表格迴圈運算質**對話方塊中，按一下 ![常數輸入的參數新增至運算質](../core/media/add-input-parameters.gif "Add_input_parameters") ] 按鈕，輸入任何常數會出現在 [設定的表格格線的值。 在對話方塊中建立這些常數的順序並不重要，不過要在輸入參數清單的開頭保留第一個和第二個參數值 (分別代表資料列數目和資料欄數目) 的位置。 完成後，按**確定**。  
  
     **設定表格迴圈運算質**對話框會關閉。  
  
8.  從來源結構描述拖曳零或多個記錄或欄位節點**表格迴圈**最近新增的運算質。 這些記錄和欄位節點每一個都會新增到輸入參數清單的結尾，因此，當後續步驟中設定表格格線時，即可使用這些項目。 如同先前新增的表格資料常數 (不是資料列和資料行計數常數)，新增這些記錄和欄位節點的順序並不相關。  
  
9. 若要標記連結，請依照下列步驟：  
  
    -   在顯示的格線頁中選取連結。  
  
    -   在[!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]屬性 視窗中，提供描述性名稱**標籤**屬性。 比方說，您可能會從名為 「 第二個 Author"欄位的連結提供的名稱，例如"link2ndAuthor"。  
  
10. 選取新加入**表格迴圈**運算質，然後在**屬性**視窗中，按一下省略符號 (**...**) 相關聯的按鈕**表格迴圈格線**與該運算質相關聯的屬性。  
  
     **設定表格迴圈運算質** 對話方塊隨即出現，並**表格迴圈格線**選取的索引標籤。  
  
    > [!NOTE]
    >  或者，您可以以滑鼠右鍵按一下運算質，然後再按一下**設定表格迴圈格線**內容功能表中。 **設定表格迴圈運算質** 對話方塊隨即出現，並**表格迴圈格線**選取的索引標籤。  
  
11. 使用設定至少一個，並可能多、 資料列在方格中的每個表格儲存格相關聯的下拉式清單。 下拉式清單中可用的選項是常數與連結，您已在步驟 6-8 設定做為輸入參數 3 且最高到**表格迴圈**運算質。 (輸入參數 1 和 2 不會顯示在這些下拉式清單中。)完成後，按**確定**。  
  
     **設定表格迴圈運算質**對話框會關閉。  
  
    > [!NOTE]
    >  每個資料列構成輸出結構，組合的發生次數的記錄或欄位指定為第一個輸入參數的一個反覆項目**表格迴圈**運算質。 如需詳細資訊，請參閱步驟 3。  
  
    > [!NOTE]
    >  您必須選取您想要存取使用每個資料行的值**表格抽選程式**運算質。 如果資料行不是由**表格抽選程式**運算質，您應該考慮移除，而不是保留該資料行。  
  
    > [!NOTE]
    >  填寫表格格線的順序不重要。  
  
12. 最大數量拖曳**表格抽選程式**運算質 (![](../core/media/advtableextractor.gif "advtableextractor")) 從工具箱拖曳至顯示的格線頁所需。  
  
    > [!NOTE]
    >  因為這些輸入**表格抽選程式**運算質來自**表格迴圈**運算質加入在先前步驟中，請確定您將**表格抽選程式**運算質的右邊**表格迴圈**顯示的格線頁中運算質。  
  
13. 若要建立第一個輸入的參數的其中一個**表格抽選程式**步驟 9 中新增的運算質拖曳到相關**表格迴圈**運算質的左邊。  
  
14. 若要建立具有相同的第二個輸入的參數**表格抽選程式**運算質，選取的運算質，然後在**屬性**視窗中，按一下省略符號 (**...**) 相關聯的按鈕及其**輸入參數**屬性。  
  
     **設定表格抽選程式運算質** 對話方塊隨即出現。  
  
15. 按一下![常數輸入的參數新增至運算質](../core/media/add-input-parameters.gif "Add_input_parameters")按鈕以建立第二個輸入的參數。 在資料表方格中的對應輸入資料行數目**表格迴圈**運算質，您要從中擷取資料。 按一下 **[確定]**。  
  
     **設定表格抽選程式運算質**對話框會關閉。  
  
    > [!NOTE]
    >  資料行編號從 1 開始。  
  
16. 若要使用的輸出**表格抽選程式**運算質拖曳**表格抽選程式**運算質至目的結構描述或目的結構描述中的記錄或欄位節點拖曳中記錄或欄位節點**表格抽選程式**運算質。 目的執行個體訊息中對應到目的結構描述中的此記錄或欄位節點的項目或屬性值，將會填入表格格線中指定儲存格的值 (若為常數) 或指示的值 (若為連結)。  
  
17. 針對每個重複步驟 12、 13、 14 和 15**表格抽選程式**步驟 11 中新增的運算質。  
  
## <a name="see-also"></a>另請參閱  
 [新增進階運算質至對應](../core/adding-advanced-functoids-to-a-map.md)