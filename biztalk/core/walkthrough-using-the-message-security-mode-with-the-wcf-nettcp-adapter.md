---
title: "逐步解說： 使用 Wcf-nettcp 配接器使用訊息安全性模式 |Microsoft 文件"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: c7f6e892-34ce-4132-8867-54cc3bbfe507
caps.latest.revision: "47"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 850d0ee715984c7465063addd778828c727e0233
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/01/2017
---
# <a name="walkthrough-using-the-message-security-mode-with-the-wcf-nettcp-adapter"></a><span data-ttu-id="0e019-102">逐步解說： 使用訊息安全性模式，Wcf-nettcp 配接器</span><span class="sxs-lookup"><span data-stu-id="0e019-102">Walkthrough: Using the Message Security Mode with the WCF-NetTcp Adapter</span></span>
  
> [!NOTE]
>  <span data-ttu-id="0e019-103">如需配接器的詳細資訊，請參閱[配接器在 BizTalk Server](../core/adapters-in-biztalk-server.md)。</span><span class="sxs-lookup"><span data-stu-id="0e019-103">For more information about adapters, see [Adapters in BizTalk Server](../core/adapters-in-biztalk-server.md).</span></span>  
  
## <a name="introduction"></a><span data-ttu-id="0e019-104">簡介</span><span class="sxs-lookup"><span data-stu-id="0e019-104">Introduction</span></span>
  
 <span data-ttu-id="0e019-105">本逐步解說示範如何設定 Wcf-nettcp 配接器使用[!INCLUDE[firstref_btsWinCommFoundation](../includes/firstref-btswincommfoundation-md.md)]訊息安全性模式，來協助保護訊息傳輸的配接器會使用 Ws-security 規格。</span><span class="sxs-lookup"><span data-stu-id="0e019-105">This walkthrough shows how to configure the WCF-NetTcp adapter to use the [!INCLUDE[firstref_btsWinCommFoundation](../includes/firstref-btswincommfoundation-md.md)] Message security mode, which uses the WS-Security specification to help secure messages that the adapter transmits.</span></span> <span data-ttu-id="0e019-106">此規格說明 SOAP 訊息通訊協定來完成機密性、 完整性和 SOAP 訊息層級驗證的增強功能。</span><span class="sxs-lookup"><span data-stu-id="0e019-106">This specification describes enhancements to the SOAP messaging protocol to accomplish confidentiality, integrity, and authentication at the SOAP message level.</span></span> <span data-ttu-id="0e019-107">訊息安全性模式要求的作業，例如加密/解密和簽章/驗證用途的安全性模式的組合視指定的服務憑證。</span><span class="sxs-lookup"><span data-stu-id="0e019-107">Message security mode requires the service certificate to be specified for operations such as encryption/decryption and signing/verification purposes depending on the security mode combinations.</span></span>  
  
 <span data-ttu-id="0e019-108">Wcf-nettcp 配接器會使用 NetTcpBinding 繫結之間的通訊[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]用戶端和[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]遠端服務。</span><span class="sxs-lookup"><span data-stu-id="0e019-108">The WCF-NetTcp adapter uses the NetTcpBinding binding to communicate between [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] clients and [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] remote services.</span></span> <span data-ttu-id="0e019-109">該配接器可完整存取 SOAP 安全性、可靠性和交易功能。</span><span class="sxs-lookup"><span data-stu-id="0e019-109">It provides full access to SOAP security, reliability, and transaction features.</span></span> <span data-ttu-id="0e019-110">它可讓協調流程和結構描述發行成[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務、 以及也可讓您使用外部 WCF 服務協調流程。</span><span class="sxs-lookup"><span data-stu-id="0e019-110">It allows orchestrations and schemas to be published as [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] services, and also provides the ability for an orchestration to consume external WCF services.</span></span> <span data-ttu-id="0e019-111">此配接器使用 TCP 傳輸，而且訊息具有二進位編碼。</span><span class="sxs-lookup"><span data-stu-id="0e019-111">This adapter uses the TCP transport, and messages have binary encoding.</span></span> <span data-ttu-id="0e019-112">Wcf-nettcp 配接器是由傳送配接器和接收配接器所組成。</span><span class="sxs-lookup"><span data-stu-id="0e019-112">The WCF-NetTcp adapter consists of both a send adapter and a receive adapter.</span></span>  
  
 <span data-ttu-id="0e019-113">本逐步解說示範如何使用 Active Directory 憑證服務建立訊息安全性模式的憑證。</span><span class="sxs-lookup"><span data-stu-id="0e019-113">This walkthrough shows how to create certificates for Message security mode by using the Active Directory Certificate Service.</span></span> <span data-ttu-id="0e019-114">您將建立的伺服器和用戶端憑證，然後設定 Wcf-nettcp 接收位置，以訊息安全性模式中使用的憑證。</span><span class="sxs-lookup"><span data-stu-id="0e019-114">You will create certificates for the server and the client, and then configure a WCF-NetTcp receive location to use the certificates in Message security mode.</span></span> <span data-ttu-id="0e019-115">使用[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]用戶端，您會將訊息傳送至該接收位置在根據 XML 加密語法和處理加密的狀態。</span><span class="sxs-lookup"><span data-stu-id="0e019-115">By using a [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] client, you will send messages to that receive location in an encrypted state according to XML Encryption Syntax and Processing.</span></span>  
  
 <span data-ttu-id="0e019-116">完成此逐步解說之後，您將會瞭解如何執行下列工作：</span><span class="sxs-lookup"><span data-stu-id="0e019-116">After completing this walkthrough, you will understand how to perform the following tasks:</span></span>  
  
-   <span data-ttu-id="0e019-117">使用 Active Directory 憑證服務來建立憑證要求和發行憑證，以完成程序。</span><span class="sxs-lookup"><span data-stu-id="0e019-117">Use the Active Directory Certificate Service to create a certificate request and complete the process by issuing the certificate.</span></span>  
  
-   <span data-ttu-id="0e019-118">從[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]系統管理主控台中，設定 Wcf-nettcp 配接器使用訊息安全性模式。</span><span class="sxs-lookup"><span data-stu-id="0e019-118">From the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, configure the WCF-NetTcp adapter to use the Message security mode.</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="0e019-119">必要條件</span><span class="sxs-lookup"><span data-stu-id="0e019-119">Prerequisites</span></span>  
 <span data-ttu-id="0e019-120">執行此範例中的步驟會確保您的環境會安裝下列必要條件。</span><span class="sxs-lookup"><span data-stu-id="0e019-120">To perform the steps in this sample ensure that your environment installs the following prerequisites;</span></span>  
  
-   <span data-ttu-id="0e019-121">建置組件，並執行部署程序的電腦和執行範例的電腦需要 Microsoft [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)]，Microsoft [!INCLUDE[netfx40_short](../includes/netfx40-short-md.md)]，與 Microsoft BizTalk Server。</span><span class="sxs-lookup"><span data-stu-id="0e019-121">Both the computer that builds the assemblies and runs the deployment process, and the computer that runs the sample, require Microsoft [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)], Microsoft [!INCLUDE[netfx40_short](../includes/netfx40-short-md.md)], and Microsoft BizTalk Server.</span></span>  
  
-   <span data-ttu-id="0e019-122">用來建置組件並執行部署程序的電腦需要 Microsoft Visual Studio。</span><span class="sxs-lookup"><span data-stu-id="0e019-122">The computer used to build the assemblies and run the deployment process requires Microsoft Visual Studio.</span></span>  
  
-   <span data-ttu-id="0e019-123">執行此範例的電腦需要[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]配接器和[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]系統管理工具。</span><span class="sxs-lookup"><span data-stu-id="0e019-123">The computer that runs the sample requires the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] Adapters and the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] Administration Tools.</span></span> <span data-ttu-id="0e019-124">這些是 Microsoft BizTalk Server 安裝期間安裝的選項。</span><span class="sxs-lookup"><span data-stu-id="0e019-124">These are options to install during setup of Microsoft BizTalk Server.</span></span>  
  
-   <span data-ttu-id="0e019-125">在電腦上您用來執行管理工作，您必須以成員的使用者帳戶執行[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]Administrators 群組，才能設定[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]內的應用程式設定[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台。</span><span class="sxs-lookup"><span data-stu-id="0e019-125">On the computers that you use to perform administrative tasks, you must run as a user account that is a member of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administrators group to configure the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] application settings within the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span> <span data-ttu-id="0e019-126">此使用者帳戶也必須為管理主控件執行個體和其他工作可能需要的應用程式部署的本機系統管理員群組的成員。</span><span class="sxs-lookup"><span data-stu-id="0e019-126">This user account must also be a member of the local Administrators group for application deployment, managing host instances, and other tasks that may be required.</span></span>  
  
-   <span data-ttu-id="0e019-127">需要的任何電腦上[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]功能，完成的單次安裝程序[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]範例[http://go.microsoft.com/fwlink/?LinkId=135510](http://go.microsoft.com/fwlink/?LinkId=135510)。</span><span class="sxs-lookup"><span data-stu-id="0e019-127">On any computer that requires [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] capability, complete the one-time setup procedure for the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] samples at [http://go.microsoft.com/fwlink/?LinkId=135510](http://go.microsoft.com/fwlink/?LinkId=135510).</span></span>  
  
-   <span data-ttu-id="0e019-128">執行範例，並匯入繫結或.msi 檔案的電腦上[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]，請確定主機不受信任的主機，或匯入將會失敗。</span><span class="sxs-lookup"><span data-stu-id="0e019-128">On the computer that runs the sample and imports a binding or an .msi file into [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], ensure the host is not a trusted host or the import will fail.</span></span>  
  
-   <span data-ttu-id="0e019-129">在電腦上執行範例，確定已安裝的 Active Directory 憑證服務。</span><span class="sxs-lookup"><span data-stu-id="0e019-129">On the computer that runs the sample ensure that Active Directory Certificate Services is installed.</span></span>  
  
-   <span data-ttu-id="0e019-130">您必須下載的逐步解說程式碼，並將它解壓縮到您的電腦。</span><span class="sxs-lookup"><span data-stu-id="0e019-130">You must download the walkthrough code and extract it to your computer.</span></span>  <span data-ttu-id="0e019-131">這個逐步解說是整個屬於[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]配接器逐步解說 」 套件。</span><span class="sxs-lookup"><span data-stu-id="0e019-131">This walkthrough is a part of the entire [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] Adapter Walkthrough package.</span></span> <span data-ttu-id="0e019-132">您可以下載檔案**WCFAdapterWalkthroughs.exe**從[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]Developer Center [http://go.microsoft.com/fwlink/?LinkId=194140](http://go.microsoft.com/fwlink/?LinkId=194140)。</span><span class="sxs-lookup"><span data-stu-id="0e019-132">You can download the file **WCFAdapterWalkthroughs.exe** from the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Developer Center at [http://go.microsoft.com/fwlink/?LinkId=194140](http://go.microsoft.com/fwlink/?LinkId=194140).</span></span>  
  
## <a name="create-the-certificates-for-this-walkthrough"></a><span data-ttu-id="0e019-133">建立這個逐步解說中的憑證</span><span class="sxs-lookup"><span data-stu-id="0e019-133">Create the certificates for this walkthrough</span></span>  
  
1.  <span data-ttu-id="0e019-134">本節中您將會要求服務和用戶端憑證、 發行憑證，並將它們安裝到適當的儲存區。</span><span class="sxs-lookup"><span data-stu-id="0e019-134">In this section you will request service and client certificates, issue the certificates, and install them into the appropriate stores.</span></span> <span data-ttu-id="0e019-135">Active Directory 憑證服務用來建立具有受信任的憑證鏈結的憑證。</span><span class="sxs-lookup"><span data-stu-id="0e019-135">Active Directory Certificate Services is used to create a certificate with a trusted certificate chain.</span></span> <span data-ttu-id="0e019-136">如果您未遵照必要條件的要求安裝 Active Directory 憑證服務，請將 Active Directory 憑證服務安裝在您的電腦上。</span><span class="sxs-lookup"><span data-stu-id="0e019-136">If you did not install Active Directory Certificate Services as part of the Prerequisites, then install Active Directory Certificate Services on your computer.</span></span> <span data-ttu-id="0e019-137">如果已安裝，請移至步驟 2。</span><span class="sxs-lookup"><span data-stu-id="0e019-137">If it is already installed, go to step 2.</span></span>  
  
    1.  <span data-ttu-id="0e019-138">按一下**啟動**，指向 **系統管理工具**，然後按一下 **伺服器管理員**。</span><span class="sxs-lookup"><span data-stu-id="0e019-138">Click **Start**, point to **Administrative Tools**, and then click **Server Manager**.</span></span>  
  
    2.  <span data-ttu-id="0e019-139">在下**伺服器管理員**] 節點，按一下 [**新增**，然後按一下**角色**。</span><span class="sxs-lookup"><span data-stu-id="0e019-139">Under the **Server Manager** node, click **Add**, and then click **Roles**.</span></span>  
  
    3.  <span data-ttu-id="0e019-140">這會開啟**開始之前**對話方塊**新增角色精靈**。</span><span class="sxs-lookup"><span data-stu-id="0e019-140">This brings up the **Before you begin** dialog for the **Add Roles Wizard**.</span></span> <span data-ttu-id="0e019-141">按一下 **[下一步]**。</span><span class="sxs-lookup"><span data-stu-id="0e019-141">Click **Next**.</span></span>  
  
    4.  <span data-ttu-id="0e019-142">上**選取伺服器角色**頁面上，選取**Active Directory 憑證服務**，按一下**下一步**，然後遵循螢幕指示以完成安裝。</span><span class="sxs-lookup"><span data-stu-id="0e019-142">On the **Select Server Roles** page, select **Active Directory Certificate Services**, click **Next**, and then follow the on-screen instructions to complete the installation.</span></span>  
  
2.  <span data-ttu-id="0e019-143">建立服務驗證的憑證要求，如下所示：</span><span class="sxs-lookup"><span data-stu-id="0e019-143">Create a certificate request for the service authentication as follows:</span></span>  
  
    1.  <span data-ttu-id="0e019-144">在 Internet Explorer 中瀏覽的網站`http://localhost/certsrv`。</span><span class="sxs-lookup"><span data-stu-id="0e019-144">In Internet Explorer, visit the Web site `http://localhost/certsrv`.</span></span> <span data-ttu-id="0e019-145">在**歡迎**頁面上，按一下**要求憑證**，然後按一下 **進階的憑證要求**上**要求憑證**頁面。</span><span class="sxs-lookup"><span data-stu-id="0e019-145">On the **Welcome** page, click **Request a Certificate**, and then click **Advanced certificate request** on the **Request a Certificate** page.</span></span>  
  
        > [!NOTE]
        >  <span data-ttu-id="0e019-146">當使用[!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)]與憑證授權單位要求憑證要求從[!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)]電腦，您可能會收到錯誤**「 為了完成憑證註冊，ca 的網站必須設定為使用 HTTPS驗證 」**。</span><span class="sxs-lookup"><span data-stu-id="0e019-146">When using [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)] as the certificate authority and requesting a certificate request from a [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)] computer, you may get the error **“In order to complete certificate enrollment, the Web site for the CA must be configured to use HTTPS authentication”**.</span></span> <span data-ttu-id="0e019-147">如果發生這個錯誤，就必須設定使用 Web 憑證 (SSL) 註冊網站。</span><span class="sxs-lookup"><span data-stu-id="0e019-147">If this error occurs, the enrollment website needs to be configured with a Web Certificate (SSL).</span></span> <span data-ttu-id="0e019-148">如需完成此工作的詳細資訊，請參閱下列連結：</span><span class="sxs-lookup"><span data-stu-id="0e019-148">Refer to these links for details in accomplishing this task:</span></span>  
        >   
        >  [<span data-ttu-id="0e019-149">AD CS： 網頁註冊</span><span class="sxs-lookup"><span data-stu-id="0e019-149">AD CS: Web Enrollment</span></span>](http://technet.microsoft.com/library/cc732517.aspx)  
        >   
        >  [<span data-ttu-id="0e019-150">IIS 伺服器憑證安裝指示</span><span class="sxs-lookup"><span data-stu-id="0e019-150">IIS Server Certificate Installation Instructions</span></span>](http://msdn.microsoft.com/library/ms751408.aspx)  
  
    2.  <span data-ttu-id="0e019-151">在**進階憑證要求**頁面上，按一下**建立並提交一個要求向這個 CA**。</span><span class="sxs-lookup"><span data-stu-id="0e019-151">On the **Advanced Certificate Request** page, click **Create and submit a request to this CA**.</span></span>  
  
    3.  <span data-ttu-id="0e019-152">在**進階憑證要求**頁面上，輸入`localhost`中**名稱**文字方塊中，選取**伺服器驗證憑證**從**需要的憑證類型**下拉式清單，然後按一下**送出**。</span><span class="sxs-lookup"><span data-stu-id="0e019-152">On the **Advanced Certificate Request** page, type `localhost` in the **Name** text box, select **Server Authentication Certificate** from the **Type of Certificate Needed** drop-down list, and then click **Submit**.</span></span>  
  
3.  <span data-ttu-id="0e019-153">建立用戶端驗證的憑證要求，如下所示：</span><span class="sxs-lookup"><span data-stu-id="0e019-153">Create a certificate request for client authentication as follows:</span></span>  
  
    1.  <span data-ttu-id="0e019-154">在 Internet Explorer 中瀏覽的網站`http://localhost/certsrv`。</span><span class="sxs-lookup"><span data-stu-id="0e019-154">In Internet Explorer, visit the Web site `http://localhost/certsrv`.</span></span> <span data-ttu-id="0e019-155">在**歡迎**頁面上，按一下**要求憑證**，然後按一下 **進階的憑證要求**上**要求憑證**頁面。</span><span class="sxs-lookup"><span data-stu-id="0e019-155">On the **Welcome** page, click **Request a Certificate**, and then click **Advanced certificate request** on the **Request a Certificate** page.</span></span>  
  
    2.  <span data-ttu-id="0e019-156">在**進階憑證要求**頁面上，按一下**建立並提交一個要求向這個 CA**。</span><span class="sxs-lookup"><span data-stu-id="0e019-156">On the **Advanced Certificate Request** page, click **Create and submit a request to this CA**.</span></span>  
  
    3.  <span data-ttu-id="0e019-157">在**進階憑證要求**頁面上，輸入`contoso`中**名稱**文字方塊中，選取**用戶端驗證憑證**從**需要的憑證類型**下拉式清單，然後按一下**送出**。</span><span class="sxs-lookup"><span data-stu-id="0e019-157">On the **Advanced Certificate Request** page, type `contoso` in the **Name** text box, select **Client Authentication Certificate** from the **Type of Certificate Needed** drop-down list, and then click **Submit**.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="0e019-158">如果您網域控制站以外的電腦上執行 BizTalk Server，則會使用用戶端驗證憑證。</span><span class="sxs-lookup"><span data-stu-id="0e019-158">The client authentication certificate is used if you are running BizTalk Server on machine other than the Domain Controller.</span></span> <span data-ttu-id="0e019-159">這將會在配接器的 [屬性] 對話方塊中設定。</span><span class="sxs-lookup"><span data-stu-id="0e019-159">This will be configured in the adapter’s property dialog.</span></span>  
  
4.  <span data-ttu-id="0e019-160">使用 [憑證授權單位] 管理主控台來發出憑證，如下所示：</span><span class="sxs-lookup"><span data-stu-id="0e019-160">Issue the certificates by using the Certification Authority management console as follows:</span></span>  
  
    1.  <span data-ttu-id="0e019-161">按一下**啟動**，指向 **系統管理工具**，然後按一下 **憑證授權單位**。</span><span class="sxs-lookup"><span data-stu-id="0e019-161">Click **Start**, point to **Administrative Tools**, and then click **Certification Authority**.</span></span>  
  
    2.  <span data-ttu-id="0e019-162">在**憑證授權單位**管理主控台中，展開 憑證授權單位的名稱，然後按兩下**擱置要求**。</span><span class="sxs-lookup"><span data-stu-id="0e019-162">In the **Certification Authority** management console, expand your certification authority's name, and then double-click **Pending Request**.</span></span>  
  
    3.  <span data-ttu-id="0e019-163">在右窗格中**憑證授權單位**管理主控台中，以滑鼠右鍵按一下 服務驗證憑證要求，指向**所有工作**，然後按一下 **問題**.</span><span class="sxs-lookup"><span data-stu-id="0e019-163">In the right pane of the **Certification Authority** management console, right-click the request for the service authentication certificate, point to **All Tasks**, and then click **Issue**.</span></span>  
  
    4.  <span data-ttu-id="0e019-164">在右窗格中**憑證授權單位**管理主控台中，以滑鼠右鍵按一下 用戶端驗證憑證要求，指向**所有工作**，然後按一下 **問題**.</span><span class="sxs-lookup"><span data-stu-id="0e019-164">In the right pane of the **Certification Authority** management console, right-click the request for the client authentication certificate, point to **All Tasks**, and then click **Issue**.</span></span>  
  
    5.  <span data-ttu-id="0e019-165">關閉**憑證授權單位**管理主控台。</span><span class="sxs-lookup"><span data-stu-id="0e019-165">Close the **Certification Authority** management console.</span></span>  
  
5.  <span data-ttu-id="0e019-166">在電腦上安裝該發出憑證，如下所示：</span><span class="sxs-lookup"><span data-stu-id="0e019-166">Install the issued certificates on your computer as follows:</span></span>  
  
    1.  <span data-ttu-id="0e019-167">在 Internet Explorer 中瀏覽的網站`http://localhost/certsrv`。</span><span class="sxs-lookup"><span data-stu-id="0e019-167">In Internet Explorer, visit the Web site `http://localhost/certsrv`.</span></span>  
  
    2.  <span data-ttu-id="0e019-168">在**歡迎**頁面上，按一下**檢視擱置的憑證要求狀態**。</span><span class="sxs-lookup"><span data-stu-id="0e019-168">On the **Welcome** page, click **View the status of a pending certificate request**.</span></span>  
  
    3.  <span data-ttu-id="0e019-169">在**檢視擱置憑證要求的狀態**頁面上，按一下 伺服器驗證憑證。</span><span class="sxs-lookup"><span data-stu-id="0e019-169">On the **View the Status of a Pending Certificate Request** page, click the server authentication certificate.</span></span>  
  
    4.  <span data-ttu-id="0e019-170">在**憑證核發**頁面上，按一下**安裝這個憑證**。</span><span class="sxs-lookup"><span data-stu-id="0e019-170">On the **Certificate Issued** page, click **Install this Certificate**.</span></span>  
  
    5.  <span data-ttu-id="0e019-171">在 Internet Explorer 中瀏覽的網站`http://localhost/certsrv`。</span><span class="sxs-lookup"><span data-stu-id="0e019-171">In Internet Explorer, visit the Web site `http://localhost/certsrv`.</span></span>  
  
    6.  <span data-ttu-id="0e019-172">在**歡迎**頁面上，按一下**檢視擱置的憑證要求狀態**。</span><span class="sxs-lookup"><span data-stu-id="0e019-172">On the **Welcome** page, click **View the status of a pending certificate request**.</span></span>  
  
    7.  <span data-ttu-id="0e019-173">在**檢視擱置憑證要求的狀態**頁面上，按一下 用戶端驗證憑證。</span><span class="sxs-lookup"><span data-stu-id="0e019-173">On the **View the Status of a Pending Certificate Request** page, click the client authentication certificate.</span></span>  
  
    8.  <span data-ttu-id="0e019-174">在**憑證核發**頁面上，按一下**安裝這個憑證**。</span><span class="sxs-lookup"><span data-stu-id="0e019-174">On the **Certificate Issued** page, click **Install this Certificate**.</span></span>  
  
6.  <span data-ttu-id="0e019-175">確定發出的憑證已正確安裝，如下所示：</span><span class="sxs-lookup"><span data-stu-id="0e019-175">Make sure that the issued certificates are installed properly as follows:</span></span>  
  
    1.  <span data-ttu-id="0e019-176">開啟 [Microsoft Management Console (MMC)]。</span><span class="sxs-lookup"><span data-stu-id="0e019-176">Open Microsoft Management Console (MMC).</span></span> <span data-ttu-id="0e019-177">若要這樣做，請按一下**啟動**，按一下**執行**，型別`mmc`，然後按一下 **確定**。</span><span class="sxs-lookup"><span data-stu-id="0e019-177">To do so, click **Start**, click **Run**, type `mmc`, and then click **OK**.</span></span>  
  
    2.  <span data-ttu-id="0e019-178">在 MMC 中，在**檔案**功能表上，按一下 **新增/移除嵌入式管理單元**。</span><span class="sxs-lookup"><span data-stu-id="0e019-178">In the MMC, on the **File** menu, click **Add/Remove Snap-in**.</span></span>  
  
    3.  <span data-ttu-id="0e019-179">在 [新增/移除嵌入式管理單元] 對話方塊中，按一下 [新增]。</span><span class="sxs-lookup"><span data-stu-id="0e019-179">In the **Add/Remove Snap-in** dialog box, click **Add**.</span></span>  
  
    4.  <span data-ttu-id="0e019-180">在**新增獨立嵌入式管理單元**對話方塊中，選取**憑證**從**可用的獨立嵌入式管理單元**清單，然後再按**新增**.</span><span class="sxs-lookup"><span data-stu-id="0e019-180">In the **Add Standalone Snap-in** dialog box, select **Certificates** from the **Available standalone snap-in** list, and then click **Add**.</span></span>  
  
    5.  <span data-ttu-id="0e019-181">在**憑證嵌入式管理單元**對話方塊中，選取**我的使用者帳戶**選項，然後再按一下**完成**。</span><span class="sxs-lookup"><span data-stu-id="0e019-181">In the **Certificate snap-in** dialog box, select the **My user account** option, and then click **Finish**.</span></span>  
  
    6.  <span data-ttu-id="0e019-182">關閉所有開啟的對話方塊。</span><span class="sxs-lookup"><span data-stu-id="0e019-182">Close all of the open dialog boxes.</span></span>  
  
    7.  <span data-ttu-id="0e019-183">在 MMC 中，在 主控台根目錄 視窗中，展開 **憑證-目前使用者**，依序展開**個人**，展開**憑證**，並請確定憑證，您安裝在上一個步驟中會顯示。</span><span class="sxs-lookup"><span data-stu-id="0e019-183">In the MMC, in the Console Root window, expand **Certificates - Current User**, expand **Personal**, expand **Certificates**, and then make sure that the certificates that you installed in the previous step are displayed.</span></span>  
  
## <a name="create-the-biztalk-application-for-this-walkthrough"></a><span data-ttu-id="0e019-184">建立這個逐步解說的 BizTalk 應用程式</span><span class="sxs-lookup"><span data-stu-id="0e019-184">Create the BizTalk application for this walkthrough</span></span>  
  
1.  <span data-ttu-id="0e019-185">按一下**啟動**，指向 **所有程式**，指向  [!INCLUDE[btsBizTalkServerStartMenuItemui](../includes/btsbiztalkserverstartmenuitemui-md.md)]，然後按一下  **BizTalk Server 管理**。</span><span class="sxs-lookup"><span data-stu-id="0e019-185">Click **Start**, point to **All Programs**, point to [!INCLUDE[btsBizTalkServerStartMenuItemui](../includes/btsbiztalkserverstartmenuitemui-md.md)], and then click **BizTalk Server Administration**.</span></span>  
  
2.  <span data-ttu-id="0e019-186">在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，展開**BizTalk 群組**，以滑鼠右鍵按一下**應用程式**，指向 **新增**，然後按一下 **應用程式**.</span><span class="sxs-lookup"><span data-stu-id="0e019-186">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, expand **BizTalk Group**, right-click **Applications**, point to **New**, and then click **Application**.</span></span>  
  
3.  <span data-ttu-id="0e019-187">在**應用程式屬性**對話方塊**一般**索引標籤上，輸入`WcfMessageSecurity`，然後按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="0e019-187">In the **Application Properties** dialog box, on the **General** tab, type `WcfMessageSecurity`, and then click **OK**.</span></span>  
  
4.  <span data-ttu-id="0e019-188">使用 WCF-NetTcp 配接器建立 BizTalk 應用程式的接收位置，如下所示：</span><span class="sxs-lookup"><span data-stu-id="0e019-188">Create a receive location using the WCF-NetTcp adapter for the BizTalk application as follows:</span></span>  
  
    1.  <span data-ttu-id="0e019-189">在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，展開**WcfMessageSecurity**，以滑鼠右鍵按一下**接收埠**，指向 **新增**，然後按一下  **單向接收埠。**</span><span class="sxs-lookup"><span data-stu-id="0e019-189">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, expand **WcfMessageSecurity**, right-click **Receive Ports**, point to **New**, and then click **One-way Receive Port.**</span></span>  
  
    2.  <span data-ttu-id="0e019-190">在**接收埠屬性**對話方塊中，於**名稱**文字方塊中，輸入`WcfMessageSecurity.OrderRequest.Receive`，然後按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="0e019-190">In the **Receive Port Properties** dialog box, in the **Name** text box, type `WcfMessageSecurity.OrderRequest.Receive`, and then click **OK**.</span></span> <span data-ttu-id="0e019-191">接收這個名稱是嚴格任意的連接埠，但此名稱的好處邏輯。</span><span class="sxs-lookup"><span data-stu-id="0e019-191">The name of this receive port is strictly arbitrary but this name makes logical sense.</span></span>  
  
    3.  <span data-ttu-id="0e019-192">在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，以滑鼠右鍵按一下**接收位置**，按一下 **新增**，然後按一下 **單向接收位置**。</span><span class="sxs-lookup"><span data-stu-id="0e019-192">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, right-click **Receive Locations**, click **New**, and then click **One-way Receive Location**.</span></span> <span data-ttu-id="0e019-193">[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]用戶端會將[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]訊息至這個接收位置。</span><span class="sxs-lookup"><span data-stu-id="0e019-193">The [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] client will send a [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message to this receive location.</span></span> <span data-ttu-id="0e019-194">選取**WcfMessageSecurity.OrderRequest.Receive**接收埠，然後再按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="0e019-194">Select the **WcfMessageSecurity.OrderRequest.Receive** recive port, and then click **OK**.</span></span>  
  
    4.  <span data-ttu-id="0e019-195">在**接收位置屬性**對話方塊中，於**名稱**文字方塊中，輸入`WcfMessageSecurity.OrderRequest.Receive.NetTcp`。</span><span class="sxs-lookup"><span data-stu-id="0e019-195">In the **Receive Location Properties** dialog box, in the **Name** text box, type `WcfMessageSecurity.OrderRequest.Receive.NetTcp`.</span></span> <span data-ttu-id="0e019-196">這個名稱的接收位置任意嚴格，但此名稱的意義邏輯。</span><span class="sxs-lookup"><span data-stu-id="0e019-196">The name of this receive location is strictly arbitrary but this name makes logical sense.</span></span>  
  
    5.  <span data-ttu-id="0e019-197">在**接收位置屬性**對話方塊中，於**傳輸**區段旁邊**類型**，選取**Wcf-nettcp**從下拉式清單清單，然後再按**設定**。</span><span class="sxs-lookup"><span data-stu-id="0e019-197">In the **Receive Location Properties** dialog box, in the **Transport** section next to **Type**, select **WCF-NetTcp** from the drop-down list, and then click **Configure**.</span></span>  
  
    6.  <span data-ttu-id="0e019-198">在**Wcf-nettcp 傳輸屬性**對話方塊**一般**索引標籤的**位址 (URI)**文字方塊中，輸入`net.tcp://localhost/WcfMessageSecurity`。</span><span class="sxs-lookup"><span data-stu-id="0e019-198">In the **WCF-NetTcp Transport Properties** dialog box, on the **General** tab, in the **Address (URI)** text box, type `net.tcp://localhost/WcfMessageSecurity`.</span></span>  
  
    7.  <span data-ttu-id="0e019-199">在**Wcf-nettcp 傳輸屬性**對話方塊**安全性**索引標籤上，選取**訊息**從**安全性模式**下拉式清單清單，然後再選取**憑證**從**訊息用戶端認證類型**下拉式清單。</span><span class="sxs-lookup"><span data-stu-id="0e019-199">In the **WCF-NetTcp Transport Properties** dialog box, on the **Security** tab, select **Message** from the **Security mode** drop-down list, and then select **Certificate** from the **Message client credential type** drop-down list.</span></span> <span data-ttu-id="0e019-200">這會設定 Wcf-nettcp 配接器使用訊息安全性模式。</span><span class="sxs-lookup"><span data-stu-id="0e019-200">This configures the WCF-NetTcp adapter to use the Message security mode.</span></span>  
  
    8.  <span data-ttu-id="0e019-201">設定用於訊息安全性模式的服務憑證。</span><span class="sxs-lookup"><span data-stu-id="0e019-201">Configure the service certificate to use with Message security mode.</span></span> <span data-ttu-id="0e019-202">在**Wcf-nettcp 傳輸屬性**對話方塊中，於**服務憑證**區段中，按一下**瀏覽**。</span><span class="sxs-lookup"><span data-stu-id="0e019-202">In the **WCF-NetTcp Transport Properties** dialog box, in the **Service certification** section, click **Browse**.</span></span> <span data-ttu-id="0e019-203">在**選取的服務憑證**對話方塊中，選取您在先前程序中安裝的伺服器驗證憑證，然後按一下**確定**以關閉對話方塊並儲存變更。</span><span class="sxs-lookup"><span data-stu-id="0e019-203">In the **Select service certificate** dialog box, select the server authentication certificate you installed in the previous procedure, and then click **OK** to close the dialog box and save the changes.</span></span>  
  
    9. <span data-ttu-id="0e019-204">關閉所有開啟的對話方塊。</span><span class="sxs-lookup"><span data-stu-id="0e019-204">Close all of the open dialog boxes.</span></span>  
  
        > [!NOTE]
        >  <span data-ttu-id="0e019-205">若要驗證用戶端憑證，搭配[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]接收配接器，用戶端憑證的 CA 憑證鏈結必須安裝在執行主控件執行個體之電腦的受信任的根憑證授權單位憑證存放區如[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]配接器。</span><span class="sxs-lookup"><span data-stu-id="0e019-205">To authenticate the client certificates with the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] receive adapters, the CA certificate chain for the client certificates must be installed in the Trusted Root Certification Authorities certificate store of the computer running the host instances for the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] adapters.</span></span> <span data-ttu-id="0e019-206">因為這個逐步解說假設憑證服務已安裝在同一部電腦上[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]用戶端和[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]配接器，您不需要在您的電腦上安裝的 CA 憑證鏈結。</span><span class="sxs-lookup"><span data-stu-id="0e019-206">Because this walkthrough assumes that the certificate service is installed on the same computer as the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] client and the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] adapters, you do not have to install the CA certificate chain on your computer.</span></span>  
  
5.  <span data-ttu-id="0e019-207">建立 BizTalk 應用程式的 FILE 傳送埠。</span><span class="sxs-lookup"><span data-stu-id="0e019-207">Create a FILE send port for the BizTalk application.</span></span> <span data-ttu-id="0e019-208">這是要傳送的協調流程代表訂單要求輸出訊息到位置[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務。</span><span class="sxs-lookup"><span data-stu-id="0e019-208">This is the location where the order request output message will be sent by the orchestration representing the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service.</span></span>  
  
    1.  <span data-ttu-id="0e019-209">在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，展開**WcfMessageSecurity**，以滑鼠右鍵按一下**傳送埠**，指向 **新增**，然後按一下 **靜態單向傳送埠。**</span><span class="sxs-lookup"><span data-stu-id="0e019-209">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, expand **WcfMessageSecurity**, right-click **Send Ports**, point to **New**, and then click **Static One-way Send Port.**</span></span>  
  
    2.  <span data-ttu-id="0e019-210">在**傳送埠屬性**對話方塊**一般**索引標籤的**名稱**文字方塊中，輸入`WcfMessageSecurity.OrderRequest.Send.FILE`。</span><span class="sxs-lookup"><span data-stu-id="0e019-210">In the **Send Port Properties** dialog box, on the **General**  tab, in the **Name** text box, type `WcfMessageSecurity.OrderRequest.Send.FILE`.</span></span>  
  
    3.  <span data-ttu-id="0e019-211">在**傳送埠屬性**對話方塊中，於**傳輸**區段旁邊**類型**，選取**檔案**從下拉式清單中，然後按一下**設定**。</span><span class="sxs-lookup"><span data-stu-id="0e019-211">In the **Send Port Properties** dialog box, in the **Transport** section next to **Type**, select **FILE** from the drop-down list, and then click **Configure**.</span></span>  
  
    4.  <span data-ttu-id="0e019-212">在**FILE 傳輸屬性**對話方塊**一般**索引標籤上，輸入`C:\WCFMessageSecurity\OrderRequestOut`中**目的地資料夾**文字方塊，然後再按一下**[確定]**.</span><span class="sxs-lookup"><span data-stu-id="0e019-212">In the **FILE Transport Properties** dialog box, on the **General**  tab, type `C:\WCFMessageSecurity\OrderRequestOut` in the **Destination folder** text box, and then click **OK**.</span></span>  
  
    5.  <span data-ttu-id="0e019-213">在**傳送埠屬性**對話方塊**篩選**索引標籤上，選取**BTS。ReceivePortName**如**屬性**欄位中，輸入`WcfMessageSecurity.OrderRequest.Receive`如**值**欄位，，然後按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="0e019-213">In the **Send Port Properties** dialog box, on the **Filters** tab, select **BTS.ReceivePortName** for the **Property** field, enter `WcfMessageSecurity.OrderRequest.Receive` for the **Value** field, and then click **OK**.</span></span> <span data-ttu-id="0e019-214">這個篩選條件運算式會路由傳送傳入[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]到用戶端的訊息**WcfMessageSecurity.OrderRequest.Receive**接收這個傳送埠的連接埠。</span><span class="sxs-lookup"><span data-stu-id="0e019-214">This filter expression routes the incoming [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] messages from the client into the **WcfMessageSecurity.OrderRequest.Receive** receive port to this send port.</span></span>  
  
## <a name="test-the-wcf-client-against-the-biztalk-application"></a><span data-ttu-id="0e019-215">測試 WCF 用戶端針對 BizTalk 應用程式</span><span class="sxs-lookup"><span data-stu-id="0e019-215">Test the WCF client against the BizTalk application</span></span>  
  
1.  <span data-ttu-id="0e019-216">在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，以滑鼠右鍵按一下**WcfMessageSecurity**，然後按一下 **啟動**。</span><span class="sxs-lookup"><span data-stu-id="0e019-216">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, right-click **WcfMessageSecurity**, and then click **Start**.</span></span> <span data-ttu-id="0e019-217">在**啟動**對話方塊中，按一下 **啟動**。</span><span class="sxs-lookup"><span data-stu-id="0e019-217">In the **Start** dialog box, click **Start**.</span></span>  
  
2.  <span data-ttu-id="0e019-218">在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，展開**平台設定**，依序展開**主控件執行個體**，以滑鼠右鍵按一下**BizTalkServerApplication**或另一個適當的主控件執行個體，，然後按一下 **重新啟動**。</span><span class="sxs-lookup"><span data-stu-id="0e019-218">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, expand **Platform Settings**, expand **Host Instances**, right-click **BizTalkServerApplication** or another appropriate host instance, and then click **Restart**.</span></span>  
  
3.  <span data-ttu-id="0e019-219">建立名為的資料夾**C:\WCFMessageSecurity**如本逐步解說的工作資料夾。</span><span class="sxs-lookup"><span data-stu-id="0e019-219">Create a folder named **C:\WCFMessageSecurity** for the working folder for this walkthrough.</span></span> <span data-ttu-id="0e019-220">逐步解說將檔案解壓縮至這個資料夾。</span><span class="sxs-lookup"><span data-stu-id="0e019-220">Extract the walkthrough files to this folder.</span></span>  
  
4.  <span data-ttu-id="0e019-221">在[!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]，開啟**Wcfmessagesecurity**檔案**C:\WCFMessageSecurity**資料夾。</span><span class="sxs-lookup"><span data-stu-id="0e019-221">In [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)], open the **WcfMessageSecurity.sln** file in the **C:\WCFMessageSecurity** folder.</span></span>  
  
5.  <span data-ttu-id="0e019-222">在[!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]，在 [方案總管] 中，展開**WcfClient**，然後開啟**Program.cs**檢閱。</span><span class="sxs-lookup"><span data-stu-id="0e019-222">In [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)], in Solution Explorer, expand **WcfClient**, and then open **Program.cs** to review.</span></span>  
  
    -   <span data-ttu-id="0e019-223">用戶端傳送訊息至 Wcf-nettcp 接收位置，您在上一個程序中建立。</span><span class="sxs-lookup"><span data-stu-id="0e019-223">The client sends a message to the WCF-NetTcp receive location that you created in the previous procedure.</span></span>  
  
    -   <span data-ttu-id="0e019-224">用戶端會建立與通道**NetTcpBinding**，並設定要使用憑證進行用戶端認證類型的繫結。</span><span class="sxs-lookup"><span data-stu-id="0e019-224">The client creates a channel with the **NetTcpBinding**, and then configures the binding to use certificates for the client credential type.</span></span>  
  
    -   <span data-ttu-id="0e019-225">用戶端會設定要使用您安裝用戶端驗證之前程序中的用戶端驗證憑證的端點行為。</span><span class="sxs-lookup"><span data-stu-id="0e019-225">The client configures the endpoint behavior to use the client authentication certificate that you installed in the previous procedure for the client authentication.</span></span>  
  
    -   <span data-ttu-id="0e019-226">類別，**程式**，實作**IClientMessageInspector**和**IEndpointBehavior**介面，以顯示傳出[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]從這個訊息在命令提示字元的用戶端。</span><span class="sxs-lookup"><span data-stu-id="0e019-226">The class, **Program**, implements the **IClientMessageInspector** and **IEndpointBehavior** interfaces to display outgoing [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] messages from this client at a command prompt.</span></span>  
  
6.  <span data-ttu-id="0e019-227">在[!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]，在 [方案總管] 中，以滑鼠右鍵按一下**WcfMessageSecurity**解決方案，，然後按一下**重建**。</span><span class="sxs-lookup"><span data-stu-id="0e019-227">In [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)], in Solution Explorer, right-click the **WcfMessageSecurity** solution, and then click **Rebuild**.</span></span>  
  
7.  <span data-ttu-id="0e019-228">在[!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]上**偵錯**功能表上，按一下 **啟動但不偵錯**執行 WcfClient，將傳送訊息至 Wcf-nettcp 接收位置。</span><span class="sxs-lookup"><span data-stu-id="0e019-228">In [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)], on the **Debug** menu, click **Start Without Debugging** to run the WcfClient to send a message to the WCF-NetTcp receive locations.</span></span> <span data-ttu-id="0e019-229">出現的命令提示字元會顯示執行結果。</span><span class="sxs-lookup"><span data-stu-id="0e019-229">A command prompt appears to show the execution result.</span></span>  
  
    1.  <span data-ttu-id="0e019-230">在命令提示字元中，檢視訂單要求訊息。</span><span class="sxs-lookup"><span data-stu-id="0e019-230">At the command prompt, review the order request message.</span></span> <span data-ttu-id="0e019-231">請注意**OrderId**欄位和訊息的結構。</span><span class="sxs-lookup"><span data-stu-id="0e019-231">Pay attention to the **OrderId** field and the structure of the message.</span></span>  
  
    2.  <span data-ttu-id="0e019-232">在命令提示字元中，移至`C:\WCFMessageSecurity\OrderRequestOut`資料夾，然後確定所傳送的訂單要求訊息[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]用戶端會出現。</span><span class="sxs-lookup"><span data-stu-id="0e019-232">At the command prompt, go to the `C:\WCFMessageSecurity\OrderRequestOut` folder, and then make sure the order request message sent by the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] client appears.</span></span>  
  
    3.  <span data-ttu-id="0e019-233">關閉命令提示字元。</span><span class="sxs-lookup"><span data-stu-id="0e019-233">Close the command prompt.</span></span>