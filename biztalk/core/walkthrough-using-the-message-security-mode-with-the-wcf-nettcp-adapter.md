---
title: 逐步解說： 使用訊息安全性模式與 Wcf-nettcp 配接器 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: c7f6e892-34ce-4132-8867-54cc3bbfe507
caps.latest.revision: 47
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: ce117c852cc9ed2993c30f5c915d8ad5e11f73b6
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "36990615"
---
# <a name="walkthrough-using-the-message-security-mode-with-the-wcf-nettcp-adapter"></a><span data-ttu-id="09d69-102">逐步解說： 使用訊息安全性模式與 Wcf-nettcp 配接器</span><span class="sxs-lookup"><span data-stu-id="09d69-102">Walkthrough: Using the Message Security Mode with the WCF-NetTcp Adapter</span></span>

> [!NOTE]
>  <span data-ttu-id="09d69-103">如需有關配接器的詳細資訊，請參閱[BizTalk Server 中的配接器](../core/adapters-in-biztalk-server.md)。</span><span class="sxs-lookup"><span data-stu-id="09d69-103">For more information about adapters, see [Adapters in BizTalk Server](../core/adapters-in-biztalk-server.md).</span></span>  

## <a name="introduction"></a><span data-ttu-id="09d69-104">簡介</span><span class="sxs-lookup"><span data-stu-id="09d69-104">Introduction</span></span>

 <span data-ttu-id="09d69-105">本逐步解說示範如何設定 Wcf-nettcp 配接器使用[!INCLUDE[firstref_btsWinCommFoundation](../includes/firstref-btswincommfoundation-md.md)]訊息安全性模式，來保護訊息的配接器傳輸會使用 Ws-security 規格。</span><span class="sxs-lookup"><span data-stu-id="09d69-105">This walkthrough shows how to configure the WCF-NetTcp adapter to use the [!INCLUDE[firstref_btsWinCommFoundation](../includes/firstref-btswincommfoundation-md.md)] Message security mode, which uses the WS-Security specification to help secure messages that the adapter transmits.</span></span> <span data-ttu-id="09d69-106">此規格說明 SOAP 訊息通訊協定來完成機密性、 完整性和驗證 SOAP 訊息層級的增強功能。</span><span class="sxs-lookup"><span data-stu-id="09d69-106">This specification describes enhancements to the SOAP messaging protocol to accomplish confidentiality, integrity, and authentication at the SOAP message level.</span></span> <span data-ttu-id="09d69-107">訊息安全性模式要求指定的作業，例如根據安全性模式組合的加密/解密和簽署/驗證用途的服務憑證。</span><span class="sxs-lookup"><span data-stu-id="09d69-107">Message security mode requires the service certificate to be specified for operations such as encryption/decryption and signing/verification purposes depending on the security mode combinations.</span></span>  

 <span data-ttu-id="09d69-108">Wcf-nettcp 配接器會使用 NetTcpBinding 繫結之間進行通訊[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]用戶端和[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]遠端服務。</span><span class="sxs-lookup"><span data-stu-id="09d69-108">The WCF-NetTcp adapter uses the NetTcpBinding binding to communicate between [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] clients and [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] remote services.</span></span> <span data-ttu-id="09d69-109">該配接器可完整存取 SOAP 安全性、可靠性和交易功能。</span><span class="sxs-lookup"><span data-stu-id="09d69-109">It provides full access to SOAP security, reliability, and transaction features.</span></span> <span data-ttu-id="09d69-110">它可讓協調流程和結構描述發佈為[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務，而且也提供 協調流程，以使用外部 WCF 服務的能力。</span><span class="sxs-lookup"><span data-stu-id="09d69-110">It allows orchestrations and schemas to be published as [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] services, and also provides the ability for an orchestration to consume external WCF services.</span></span> <span data-ttu-id="09d69-111">此配接器使用 TCP 傳輸，而且訊息具有二進位編碼。</span><span class="sxs-lookup"><span data-stu-id="09d69-111">This adapter uses the TCP transport, and messages have binary encoding.</span></span> <span data-ttu-id="09d69-112">Wcf-nettcp 配接器是由傳送配接器和接收配接器所組成。</span><span class="sxs-lookup"><span data-stu-id="09d69-112">The WCF-NetTcp adapter consists of both a send adapter and a receive adapter.</span></span>  

 <span data-ttu-id="09d69-113">本逐步解說示範如何使用 Active Directory 憑證服務來建立訊息安全性模式的憑證。</span><span class="sxs-lookup"><span data-stu-id="09d69-113">This walkthrough shows how to create certificates for Message security mode by using the Active Directory Certificate Service.</span></span> <span data-ttu-id="09d69-114">您將建立的伺服器和用戶端的憑證，然後設定 Wcf-nettcp 接收位置，以使用訊息安全性模式中的憑證。</span><span class="sxs-lookup"><span data-stu-id="09d69-114">You will create certificates for the server and the client, and then configure a WCF-NetTcp receive location to use the certificates in Message security mode.</span></span> <span data-ttu-id="09d69-115">使用[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]用戶端，您會將訊息傳送的接收位置在根據 XML 加密語法和處理加密的狀態。</span><span class="sxs-lookup"><span data-stu-id="09d69-115">By using a [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] client, you will send messages to that receive location in an encrypted state according to XML Encryption Syntax and Processing.</span></span>  

 <span data-ttu-id="09d69-116">完成此逐步解說之後，您將會瞭解如何執行下列工作：</span><span class="sxs-lookup"><span data-stu-id="09d69-116">After completing this walkthrough, you will understand how to perform the following tasks:</span></span>  

- <span data-ttu-id="09d69-117">您可以使用 Active Directory 憑證服務來建立憑證要求，並發行憑證，以完成程序。</span><span class="sxs-lookup"><span data-stu-id="09d69-117">Use the Active Directory Certificate Service to create a certificate request and complete the process by issuing the certificate.</span></span>  

- <span data-ttu-id="09d69-118">從[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]系統管理主控台中，設定 Wcf-nettcp 配接器使用訊息安全性模式。</span><span class="sxs-lookup"><span data-stu-id="09d69-118">From the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, configure the WCF-NetTcp adapter to use the Message security mode.</span></span>  

## <a name="prerequisites"></a><span data-ttu-id="09d69-119">必要條件</span><span class="sxs-lookup"><span data-stu-id="09d69-119">Prerequisites</span></span>  
 <span data-ttu-id="09d69-120">執行此範例中的步驟會確保您的環境會安裝下列必要條件;</span><span class="sxs-lookup"><span data-stu-id="09d69-120">To perform the steps in this sample ensure that your environment installs the following prerequisites;</span></span>  

- <span data-ttu-id="09d69-121">建置組件，並執行部署程序，在電腦和執行此範例中，電腦需要 Microsoft [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)]，Microsoft [!INCLUDE[netfx40_short](../includes/netfx40-short-md.md)]，與 Microsoft BizTalk Server。</span><span class="sxs-lookup"><span data-stu-id="09d69-121">Both the computer that builds the assemblies and runs the deployment process, and the computer that runs the sample, require Microsoft [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)], Microsoft [!INCLUDE[netfx40_short](../includes/netfx40-short-md.md)], and Microsoft BizTalk Server.</span></span>  

- <span data-ttu-id="09d69-122">用來建置組件，並執行部署程序的電腦需要 Microsoft Visual Studio。</span><span class="sxs-lookup"><span data-stu-id="09d69-122">The computer used to build the assemblies and run the deployment process requires Microsoft Visual Studio.</span></span>  

- <span data-ttu-id="09d69-123">執行範例的電腦需要[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]配接器和[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]管理工具。</span><span class="sxs-lookup"><span data-stu-id="09d69-123">The computer that runs the sample requires the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] Adapters and the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] Administration Tools.</span></span> <span data-ttu-id="09d69-124">這些是 Microsoft BizTalk Server 的安裝期間安裝的選項。</span><span class="sxs-lookup"><span data-stu-id="09d69-124">These are options to install during setup of Microsoft BizTalk Server.</span></span>  

- <span data-ttu-id="09d69-125">在電腦上您用來執行系統管理工作，您必須以成員的使用者帳戶執行[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]若要設定的系統管理員群組[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]內的應用程式設定[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台。</span><span class="sxs-lookup"><span data-stu-id="09d69-125">On the computers that you use to perform administrative tasks, you must run as a user account that is a member of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administrators group to configure the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] application settings within the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span> <span data-ttu-id="09d69-126">此使用者帳戶也必須管理主控件執行個體，以及可能需要其他工作的應用程式部署的本機系統管理員群組成員。</span><span class="sxs-lookup"><span data-stu-id="09d69-126">This user account must also be a member of the local Administrators group for application deployment, managing host instances, and other tasks that may be required.</span></span>  

- <span data-ttu-id="09d69-127">需要的任何電腦上[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]功能，完成單次安裝程序，如[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]在範例[ http://go.microsoft.com/fwlink/?LinkId=135510 ](http://go.microsoft.com/fwlink/?LinkId=135510)。</span><span class="sxs-lookup"><span data-stu-id="09d69-127">On any computer that requires [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] capability, complete the one-time setup procedure for the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] samples at [http://go.microsoft.com/fwlink/?LinkId=135510](http://go.microsoft.com/fwlink/?LinkId=135510).</span></span>  

- <span data-ttu-id="09d69-128">執行範例，並會繫結或將.msi 檔案匯入的電腦上[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]，請確定主機不受信任的主機，或匯入將會失敗。</span><span class="sxs-lookup"><span data-stu-id="09d69-128">On the computer that runs the sample and imports a binding or an .msi file into [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], ensure the host is not a trusted host or the import will fail.</span></span>  

- <span data-ttu-id="09d69-129">在電腦上執行範例，確定已安裝的 Active Directory 憑證服務。</span><span class="sxs-lookup"><span data-stu-id="09d69-129">On the computer that runs the sample ensure that Active Directory Certificate Services is installed.</span></span>  

- <span data-ttu-id="09d69-130">您必須下載逐步解說程式碼，並將它解壓縮到您的電腦。</span><span class="sxs-lookup"><span data-stu-id="09d69-130">You must download the walkthrough code and extract it to your computer.</span></span>  <span data-ttu-id="09d69-131">本逐步解說屬於整個[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]配接器逐步解說 」 套件。</span><span class="sxs-lookup"><span data-stu-id="09d69-131">This walkthrough is a part of the entire [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] Adapter Walkthrough package.</span></span> <span data-ttu-id="09d69-132">您可以下載檔案**WCFAdapterWalkthroughs.exe**從[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]開發人員中心， [ http://go.microsoft.com/fwlink/?LinkId=194140 ](http://go.microsoft.com/fwlink/?LinkId=194140)。</span><span class="sxs-lookup"><span data-stu-id="09d69-132">You can download the file **WCFAdapterWalkthroughs.exe** from the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Developer Center at [http://go.microsoft.com/fwlink/?LinkId=194140](http://go.microsoft.com/fwlink/?LinkId=194140).</span></span>  

## <a name="create-the-certificates-for-this-walkthrough"></a><span data-ttu-id="09d69-133">建立這個逐步解說中的憑證</span><span class="sxs-lookup"><span data-stu-id="09d69-133">Create the certificates for this walkthrough</span></span>  

1. <span data-ttu-id="09d69-134">這一節引導您要求服務和用戶端憑證、 發行憑證，以及將它們安裝到適當的存放區。</span><span class="sxs-lookup"><span data-stu-id="09d69-134">In this section you will request service and client certificates, issue the certificates, and install them into the appropriate stores.</span></span> <span data-ttu-id="09d69-135">Active Directory 憑證服務用來建立包含受信任的憑證鏈結的憑證。</span><span class="sxs-lookup"><span data-stu-id="09d69-135">Active Directory Certificate Services is used to create a certificate with a trusted certificate chain.</span></span> <span data-ttu-id="09d69-136">如果您未遵照必要條件的要求安裝 Active Directory 憑證服務，請將 Active Directory 憑證服務安裝在您的電腦上。</span><span class="sxs-lookup"><span data-stu-id="09d69-136">If you did not install Active Directory Certificate Services as part of the Prerequisites, then install Active Directory Certificate Services on your computer.</span></span> <span data-ttu-id="09d69-137">如果已安裝，請移至步驟 2。</span><span class="sxs-lookup"><span data-stu-id="09d69-137">If it is already installed, go to step 2.</span></span>  

   1.  <span data-ttu-id="09d69-138">按一下 **開始**，指向**系統管理工具**，然後按一下**伺服器管理員**。</span><span class="sxs-lookup"><span data-stu-id="09d69-138">Click **Start**, point to **Administrative Tools**, and then click **Server Manager**.</span></span>  

   2.  <span data-ttu-id="09d69-139">底下**伺服器管理員**節點中，按一下**新增**，然後按一下**角色**。</span><span class="sxs-lookup"><span data-stu-id="09d69-139">Under the **Server Manager** node, click **Add**, and then click **Roles**.</span></span>  

   3.  <span data-ttu-id="09d69-140">這會帶來**在您開始之前** 對話方塊**新增角色精靈**。</span><span class="sxs-lookup"><span data-stu-id="09d69-140">This brings up the **Before you begin** dialog for the **Add Roles Wizard**.</span></span> <span data-ttu-id="09d69-141">按 [下一步] 。</span><span class="sxs-lookup"><span data-stu-id="09d69-141">Click **Next**.</span></span>  

   4.  <span data-ttu-id="09d69-142">上**選取伺服器角色**頁面上，選取**Active Directory 憑證服務**，按一下 [**下一步]**，然後遵循螢幕上指示，完成安裝。</span><span class="sxs-lookup"><span data-stu-id="09d69-142">On the **Select Server Roles** page, select **Active Directory Certificate Services**, click **Next**, and then follow the on-screen instructions to complete the installation.</span></span>  

2. <span data-ttu-id="09d69-143">建立服務驗證的憑證要求，如下所示：</span><span class="sxs-lookup"><span data-stu-id="09d69-143">Create a certificate request for the service authentication as follows:</span></span>  

   1. <span data-ttu-id="09d69-144">在 Internet Explorer 中瀏覽網站`http://localhost/certsrv`。</span><span class="sxs-lookup"><span data-stu-id="09d69-144">In Internet Explorer, visit the Web site `http://localhost/certsrv`.</span></span> <span data-ttu-id="09d69-145">在上**歡迎**頁面上，按一下**要求憑證**，然後按一下 **進階的憑證要求**上**要求憑證**頁面。</span><span class="sxs-lookup"><span data-stu-id="09d69-145">On the **Welcome** page, click **Request a Certificate**, and then click **Advanced certificate request** on the **Request a Certificate** page.</span></span>  

      > [!NOTE]
      >  <span data-ttu-id="09d69-146">使用時[!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)]做為憑證授權單位和要求的憑證要求[!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)]電腦上，您可能會收到錯誤 **「 為了完成憑證註冊，ca 的網站必須設定為使用 HTTPS驗證 」**。</span><span class="sxs-lookup"><span data-stu-id="09d69-146">When using [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)] as the certificate authority and requesting a certificate request from a [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)] computer, you may get the error **“In order to complete certificate enrollment, the Web site for the CA must be configured to use HTTPS authentication”**.</span></span> <span data-ttu-id="09d69-147">如果發生此錯誤，則需要設定為使用 Web 憑證 (SSL) 將註冊網站。</span><span class="sxs-lookup"><span data-stu-id="09d69-147">If this error occurs, the enrollment website needs to be configured with a Web Certificate (SSL).</span></span> <span data-ttu-id="09d69-148">如需完成此工作的詳細資訊，請參閱下列連結：</span><span class="sxs-lookup"><span data-stu-id="09d69-148">Refer to these links for details in accomplishing this task:</span></span>  
      > 
      >  [<span data-ttu-id="09d69-149">AD CS： 網頁註冊</span><span class="sxs-lookup"><span data-stu-id="09d69-149">AD CS: Web Enrollment</span></span>](http://technet.microsoft.com/library/cc732517.aspx)  
      > 
      >  [<span data-ttu-id="09d69-150">IIS 伺服器憑證安裝指示</span><span class="sxs-lookup"><span data-stu-id="09d69-150">IIS Server Certificate Installation Instructions</span></span>](http://msdn.microsoft.com/library/ms751408.aspx)  

   2. <span data-ttu-id="09d69-151">在 **進階憑證要求**頁面上，按一下**建立並提交一個要求，向這個 CA**。</span><span class="sxs-lookup"><span data-stu-id="09d69-151">On the **Advanced Certificate Request** page, click **Create and submit a request to this CA**.</span></span>  

   3. <span data-ttu-id="09d69-152">在 **進階憑證要求**頁面上，輸入`localhost`中**名稱**文字方塊中，選取**伺服器驗證憑證**從**型別所需的憑證**下拉式清單中，然後再按一下**送出**。</span><span class="sxs-lookup"><span data-stu-id="09d69-152">On the **Advanced Certificate Request** page, type `localhost` in the **Name** text box, select **Server Authentication Certificate** from the **Type of Certificate Needed** drop-down list, and then click **Submit**.</span></span>  

3. <span data-ttu-id="09d69-153">建立用戶端驗證的憑證要求，如下所示：</span><span class="sxs-lookup"><span data-stu-id="09d69-153">Create a certificate request for client authentication as follows:</span></span>  

   1.  <span data-ttu-id="09d69-154">在 Internet Explorer 中瀏覽網站`http://localhost/certsrv`。</span><span class="sxs-lookup"><span data-stu-id="09d69-154">In Internet Explorer, visit the Web site `http://localhost/certsrv`.</span></span> <span data-ttu-id="09d69-155">在上**歡迎**頁面上，按一下**要求憑證**，然後按一下 **進階的憑證要求**上**要求憑證**頁面。</span><span class="sxs-lookup"><span data-stu-id="09d69-155">On the **Welcome** page, click **Request a Certificate**, and then click **Advanced certificate request** on the **Request a Certificate** page.</span></span>  

   2.  <span data-ttu-id="09d69-156">在 **進階憑證要求**頁面上，按一下**建立並提交一個要求，向這個 CA**。</span><span class="sxs-lookup"><span data-stu-id="09d69-156">On the **Advanced Certificate Request** page, click **Create and submit a request to this CA**.</span></span>  

   3.  <span data-ttu-id="09d69-157">在 **進階憑證要求**頁面上，輸入`contoso`中**名稱**文字方塊中，選取**用戶端驗證憑證**從**型別所需的憑證**下拉式清單中，然後再按一下**送出**。</span><span class="sxs-lookup"><span data-stu-id="09d69-157">On the **Advanced Certificate Request** page, type `contoso` in the **Name** text box, select **Client Authentication Certificate** from the **Type of Certificate Needed** drop-down list, and then click **Submit**.</span></span>  

   > [!NOTE]
   >  <span data-ttu-id="09d69-158">如果您在網域控制站以外的電腦上執行 BizTalk Server 時，會使用用戶端驗證憑證。</span><span class="sxs-lookup"><span data-stu-id="09d69-158">The client authentication certificate is used if you are running BizTalk Server on machine other than the Domain Controller.</span></span> <span data-ttu-id="09d69-159">這會設定在配接器的 [屬性] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="09d69-159">This will be configured in the adapter’s property dialog.</span></span>  

4. <span data-ttu-id="09d69-160">使用 [憑證授權單位] 管理主控台來發出憑證，如下所示：</span><span class="sxs-lookup"><span data-stu-id="09d69-160">Issue the certificates by using the Certification Authority management console as follows:</span></span>  

   1.  <span data-ttu-id="09d69-161">按一下 **開始**，指向**系統管理工具**，然後按一下**憑證授權單位**。</span><span class="sxs-lookup"><span data-stu-id="09d69-161">Click **Start**, point to **Administrative Tools**, and then click **Certification Authority**.</span></span>  

   2.  <span data-ttu-id="09d69-162">在 **憑證授權單位**管理主控台中，展開 憑證授權單位的名稱，然後按兩下**待決要求**。</span><span class="sxs-lookup"><span data-stu-id="09d69-162">In the **Certification Authority** management console, expand your certification authority's name, and then double-click **Pending Request**.</span></span>  

   3.  <span data-ttu-id="09d69-163">在右窗格中**憑證授權單位**管理主控台中，以滑鼠右鍵按一下 服務驗證憑證要求，指向**所有工作**，然後按一下 **問題**.</span><span class="sxs-lookup"><span data-stu-id="09d69-163">In the right pane of the **Certification Authority** management console, right-click the request for the service authentication certificate, point to **All Tasks**, and then click **Issue**.</span></span>  

   4.  <span data-ttu-id="09d69-164">在右窗格中**憑證授權單位**管理主控台中，以滑鼠右鍵按一下 用戶端驗證憑證的要求，指向**所有工作**，然後按一下 **問題**.</span><span class="sxs-lookup"><span data-stu-id="09d69-164">In the right pane of the **Certification Authority** management console, right-click the request for the client authentication certificate, point to **All Tasks**, and then click **Issue**.</span></span>  

   5.  <span data-ttu-id="09d69-165">關閉**憑證授權單位**管理主控台。</span><span class="sxs-lookup"><span data-stu-id="09d69-165">Close the **Certification Authority** management console.</span></span>  

5. <span data-ttu-id="09d69-166">在電腦上安裝該發出憑證，如下所示：</span><span class="sxs-lookup"><span data-stu-id="09d69-166">Install the issued certificates on your computer as follows:</span></span>  

   1.  <span data-ttu-id="09d69-167">在 Internet Explorer 中瀏覽網站`http://localhost/certsrv`。</span><span class="sxs-lookup"><span data-stu-id="09d69-167">In Internet Explorer, visit the Web site `http://localhost/certsrv`.</span></span>  

   2.  <span data-ttu-id="09d69-168">在 **歡迎**頁面上，按一下**檢視擱置的憑證要求狀態**。</span><span class="sxs-lookup"><span data-stu-id="09d69-168">On the **Welcome** page, click **View the status of a pending certificate request**.</span></span>  

   3.  <span data-ttu-id="09d69-169">在 **檢視的暫止的憑證要求狀態**頁面上，按一下 伺服器驗證憑證。</span><span class="sxs-lookup"><span data-stu-id="09d69-169">On the **View the Status of a Pending Certificate Request** page, click the server authentication certificate.</span></span>  

   4.  <span data-ttu-id="09d69-170">在上**憑證核發**頁面上，按一下**安裝這個憑證**。</span><span class="sxs-lookup"><span data-stu-id="09d69-170">On the **Certificate Issued** page, click **Install this Certificate**.</span></span>  

   5.  <span data-ttu-id="09d69-171">在 Internet Explorer 中瀏覽網站`http://localhost/certsrv`。</span><span class="sxs-lookup"><span data-stu-id="09d69-171">In Internet Explorer, visit the Web site `http://localhost/certsrv`.</span></span>  

   6.  <span data-ttu-id="09d69-172">在 **歡迎**頁面上，按一下**檢視擱置的憑證要求狀態**。</span><span class="sxs-lookup"><span data-stu-id="09d69-172">On the **Welcome** page, click **View the status of a pending certificate request**.</span></span>  

   7.  <span data-ttu-id="09d69-173">在 **檢視的暫止的憑證要求狀態**頁面上，按一下 用戶端驗證憑證。</span><span class="sxs-lookup"><span data-stu-id="09d69-173">On the **View the Status of a Pending Certificate Request** page, click the client authentication certificate.</span></span>  

   8.  <span data-ttu-id="09d69-174">在上**憑證核發**頁面上，按一下**安裝這個憑證**。</span><span class="sxs-lookup"><span data-stu-id="09d69-174">On the **Certificate Issued** page, click **Install this Certificate**.</span></span>  

6. <span data-ttu-id="09d69-175">確定發出的憑證已正確安裝，如下所示：</span><span class="sxs-lookup"><span data-stu-id="09d69-175">Make sure that the issued certificates are installed properly as follows:</span></span>  

   1.  <span data-ttu-id="09d69-176">開啟 [Microsoft Management Console (MMC)]。</span><span class="sxs-lookup"><span data-stu-id="09d69-176">Open Microsoft Management Console (MMC).</span></span> <span data-ttu-id="09d69-177">若要這樣做，請按一下**開始**，按一下**執行**，型別`mmc`，然後按一下 **確定**。</span><span class="sxs-lookup"><span data-stu-id="09d69-177">To do so, click **Start**, click **Run**, type `mmc`, and then click **OK**.</span></span>  

   2.  <span data-ttu-id="09d69-178">在 MMC 中，在**檔案**功能表上，按一下**新增/移除嵌入式管理單元**。</span><span class="sxs-lookup"><span data-stu-id="09d69-178">In the MMC, on the **File** menu, click **Add/Remove Snap-in**.</span></span>  

   3.  <span data-ttu-id="09d69-179">在 [新增/移除嵌入式管理單元] 對話方塊中，按一下 [新增]。</span><span class="sxs-lookup"><span data-stu-id="09d69-179">In the **Add/Remove Snap-in** dialog box, click **Add**.</span></span>  

   4.  <span data-ttu-id="09d69-180">在 **新增獨立嵌入式管理單元**對話方塊中，選取**憑證**從**可用的獨立嵌入式管理單元**清單，然後再按**新增**.</span><span class="sxs-lookup"><span data-stu-id="09d69-180">In the **Add Standalone Snap-in** dialog box, select **Certificates** from the **Available standalone snap-in** list, and then click **Add**.</span></span>  

   5.  <span data-ttu-id="09d69-181">在 **憑證嵌入式管理單元**對話方塊中，選取**我的使用者帳戶**選項，然後再按一下**完成**。</span><span class="sxs-lookup"><span data-stu-id="09d69-181">In the **Certificate snap-in** dialog box, select the **My user account** option, and then click **Finish**.</span></span>  

   6.  <span data-ttu-id="09d69-182">關閉所有開啟的對話方塊。</span><span class="sxs-lookup"><span data-stu-id="09d69-182">Close all of the open dialog boxes.</span></span>  

   7.  <span data-ttu-id="09d69-183">在 MMC 中，在 [主控台根目錄] 視窗中，依序展開**憑證-目前使用者**，展開**個人**，展開**憑證**，並請確定憑證，您安裝在上一個步驟中會顯示。</span><span class="sxs-lookup"><span data-stu-id="09d69-183">In the MMC, in the Console Root window, expand **Certificates - Current User**, expand **Personal**, expand **Certificates**, and then make sure that the certificates that you installed in the previous step are displayed.</span></span>  

## <a name="create-the-biztalk-application-for-this-walkthrough"></a><span data-ttu-id="09d69-184">建立 BizTalk 應用程式，在此逐步解說</span><span class="sxs-lookup"><span data-stu-id="09d69-184">Create the BizTalk application for this walkthrough</span></span>  

1. <span data-ttu-id="09d69-185">按一下 **開始**，指向**所有程式**，指向[!INCLUDE[btsBizTalkServerStartMenuItemui](../includes/btsbiztalkserverstartmenuitemui-md.md)]，然後按一下**BizTalk Server 管理**。</span><span class="sxs-lookup"><span data-stu-id="09d69-185">Click **Start**, point to **All Programs**, point to [!INCLUDE[btsBizTalkServerStartMenuItemui](../includes/btsbiztalkserverstartmenuitemui-md.md)], and then click **BizTalk Server Administration**.</span></span>  

2. <span data-ttu-id="09d69-186">在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，展開**BizTalk 群組**，以滑鼠右鍵按一下**應用程式**，指向**新增**，然後按一下 **應用程式**.</span><span class="sxs-lookup"><span data-stu-id="09d69-186">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, expand **BizTalk Group**, right-click **Applications**, point to **New**, and then click **Application**.</span></span>  

3. <span data-ttu-id="09d69-187">在 **應用程式屬性**對話方塊的 **一般**索引標籤上，輸入`WcfMessageSecurity`，然後按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="09d69-187">In the **Application Properties** dialog box, on the **General** tab, type `WcfMessageSecurity`, and then click **OK**.</span></span>  

4. <span data-ttu-id="09d69-188">使用 WCF-NetTcp 配接器建立 BizTalk 應用程式的接收位置，如下所示：</span><span class="sxs-lookup"><span data-stu-id="09d69-188">Create a receive location using the WCF-NetTcp adapter for the BizTalk application as follows:</span></span>  

   1. <span data-ttu-id="09d69-189">在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，展開**WcfMessageSecurity**，以滑鼠右鍵按一下**接收埠**，指向**新增**，然後按一下  **單向接收埠。**</span><span class="sxs-lookup"><span data-stu-id="09d69-189">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, expand **WcfMessageSecurity**, right-click **Receive Ports**, point to **New**, and then click **One-way Receive Port.**</span></span>  

   2. <span data-ttu-id="09d69-190">在 **接收埠屬性**對話方塊中，於**名稱**文字方塊中，輸入`WcfMessageSecurity.OrderRequest.Receive`，然後按一下  **確定**。</span><span class="sxs-lookup"><span data-stu-id="09d69-190">In the **Receive Port Properties** dialog box, in the **Name** text box, type `WcfMessageSecurity.OrderRequest.Receive`, and then click **OK**.</span></span> <span data-ttu-id="09d69-191">接收這個名稱是完全是任意的連接埠，但此名稱的合理邏輯。</span><span class="sxs-lookup"><span data-stu-id="09d69-191">The name of this receive port is strictly arbitrary but this name makes logical sense.</span></span>  

   3. <span data-ttu-id="09d69-192">在 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，以滑鼠右鍵按一下**接收位置**，按一下**新增**，然後按一下 **單向接收位置**。</span><span class="sxs-lookup"><span data-stu-id="09d69-192">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, right-click **Receive Locations**, click **New**, and then click **One-way Receive Location**.</span></span> <span data-ttu-id="09d69-193">[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]用戶端會傳送[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]至此訊息接收位置。</span><span class="sxs-lookup"><span data-stu-id="09d69-193">The [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] client will send a [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message to this receive location.</span></span> <span data-ttu-id="09d69-194">選取  **WcfMessageSecurity.OrderRequest.Receive**接收的連接埠 和 **確定**。</span><span class="sxs-lookup"><span data-stu-id="09d69-194">Select the **WcfMessageSecurity.OrderRequest.Receive** recive port, and then click **OK**.</span></span>  

   4. <span data-ttu-id="09d69-195">在 **接收位置屬性**對話方塊中，於**名稱**文字方塊中，輸入`WcfMessageSecurity.OrderRequest.Receive.NetTcp`。</span><span class="sxs-lookup"><span data-stu-id="09d69-195">In the **Receive Location Properties** dialog box, in the **Name** text box, type `WcfMessageSecurity.OrderRequest.Receive.NetTcp`.</span></span> <span data-ttu-id="09d69-196">接收這個名稱是完全是任意的位置，但此名稱的合理邏輯。</span><span class="sxs-lookup"><span data-stu-id="09d69-196">The name of this receive location is strictly arbitrary but this name makes logical sense.</span></span>  

   5. <span data-ttu-id="09d69-197">在**接收位置屬性**對話方塊中，於**傳輸**區段旁邊**型別**，選取**Wcf-nettcp**從下拉式清單清單，然後再按**設定**。</span><span class="sxs-lookup"><span data-stu-id="09d69-197">In the **Receive Location Properties** dialog box, in the **Transport** section next to **Type**, select **WCF-NetTcp** from the drop-down list, and then click **Configure**.</span></span>  

   6. <span data-ttu-id="09d69-198">在  **Wcf-nettcp 傳輸屬性**對話方塊的 **一般**索引標籤**位址 (URI)** 文字方塊中，輸入`net.tcp://localhost/WcfMessageSecurity`。</span><span class="sxs-lookup"><span data-stu-id="09d69-198">In the **WCF-NetTcp Transport Properties** dialog box, on the **General** tab, in the **Address (URI)** text box, type `net.tcp://localhost/WcfMessageSecurity`.</span></span>  

   7. <span data-ttu-id="09d69-199">在  **Wcf-nettcp 傳輸屬性**對話方塊的 **安全性**索引標籤上，選取**訊息**從**安全性模式**下拉式清單清單，然後再選取**憑證**從**訊息用戶端認證類型**下拉式清單。</span><span class="sxs-lookup"><span data-stu-id="09d69-199">In the **WCF-NetTcp Transport Properties** dialog box, on the **Security** tab, select **Message** from the **Security mode** drop-down list, and then select **Certificate** from the **Message client credential type** drop-down list.</span></span> <span data-ttu-id="09d69-200">這會設定成使用訊息安全性模式的 Wcf-nettcp 配接器。</span><span class="sxs-lookup"><span data-stu-id="09d69-200">This configures the WCF-NetTcp adapter to use the Message security mode.</span></span>  

   8. <span data-ttu-id="09d69-201">設定服務憑證，以搭配訊息安全性模式。</span><span class="sxs-lookup"><span data-stu-id="09d69-201">Configure the service certificate to use with Message security mode.</span></span> <span data-ttu-id="09d69-202">在  **Wcf-nettcp 傳輸屬性**對話方塊中，於**服務認證**區段中，按一下**瀏覽**。</span><span class="sxs-lookup"><span data-stu-id="09d69-202">In the **WCF-NetTcp Transport Properties** dialog box, in the **Service certification** section, click **Browse**.</span></span> <span data-ttu-id="09d69-203">在 [**選取的服務憑證**] 對話方塊中，選取您在上一個程序中，安裝的伺服器驗證憑證，然後按一下 **[確定]** 以關閉對話方塊並儲存所做的變更。</span><span class="sxs-lookup"><span data-stu-id="09d69-203">In the **Select service certificate** dialog box, select the server authentication certificate you installed in the previous procedure, and then click **OK** to close the dialog box and save the changes.</span></span>  

   9. <span data-ttu-id="09d69-204">關閉所有開啟的對話方塊。</span><span class="sxs-lookup"><span data-stu-id="09d69-204">Close all of the open dialog boxes.</span></span>  

      > [!NOTE]
      >  <span data-ttu-id="09d69-205">若要驗證用戶端憑證，與[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]接收配接器，用戶端憑證的 CA 憑證鏈結必須安裝在執行主控件執行個體之電腦的受信任的根憑證授權單位憑證存放區針對[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]配接器。</span><span class="sxs-lookup"><span data-stu-id="09d69-205">To authenticate the client certificates with the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] receive adapters, the CA certificate chain for the client certificates must be installed in the Trusted Root Certification Authorities certificate store of the computer running the host instances for the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] adapters.</span></span> <span data-ttu-id="09d69-206">因為本逐步解說假設憑證服務在同一部電腦上安裝[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]用戶端和[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]配接器，您不需要在您的電腦上安裝的 CA 憑證鏈結。</span><span class="sxs-lookup"><span data-stu-id="09d69-206">Because this walkthrough assumes that the certificate service is installed on the same computer as the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] client and the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] adapters, you do not have to install the CA certificate chain on your computer.</span></span>  

5. <span data-ttu-id="09d69-207">建立 BizTalk 應用程式的 FILE 傳送埠。</span><span class="sxs-lookup"><span data-stu-id="09d69-207">Create a FILE send port for the BizTalk application.</span></span> <span data-ttu-id="09d69-208">這是所代表的協調流程會接收訂單要求輸出訊息的位置[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務。</span><span class="sxs-lookup"><span data-stu-id="09d69-208">This is the location where the order request output message will be sent by the orchestration representing the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service.</span></span>  

   1. <span data-ttu-id="09d69-209">在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，展開**WcfMessageSecurity**，以滑鼠右鍵按一下**傳送埠**，指向**新增**，然後按一下 **靜態單向傳送埠。**</span><span class="sxs-lookup"><span data-stu-id="09d69-209">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, expand **WcfMessageSecurity**, right-click **Send Ports**, point to **New**, and then click **Static One-way Send Port.**</span></span>  

   2. <span data-ttu-id="09d69-210">在 **傳送埠屬性**對話方塊的 **一般**索引標籤**名稱**文字方塊中，輸入`WcfMessageSecurity.OrderRequest.Send.FILE`。</span><span class="sxs-lookup"><span data-stu-id="09d69-210">In the **Send Port Properties** dialog box, on the **General**  tab, in the **Name** text box, type `WcfMessageSecurity.OrderRequest.Send.FILE`.</span></span>  

   3. <span data-ttu-id="09d69-211">在**傳送埠屬性**對話方塊中，於**傳輸**區段旁邊**類型**，選取**檔案**從下拉式清單中，然後按一下 **設定**。</span><span class="sxs-lookup"><span data-stu-id="09d69-211">In the **Send Port Properties** dialog box, in the **Transport** section next to **Type**, select **FILE** from the drop-down list, and then click **Configure**.</span></span>  

   4. <span data-ttu-id="09d69-212">在  **FILE 傳輸屬性**對話方塊的 **一般**索引標籤上，輸入`C:\WCFMessageSecurity\OrderRequestOut`中**目的地資料夾**文字方塊中，然後按一下  **確定**.</span><span class="sxs-lookup"><span data-stu-id="09d69-212">In the **FILE Transport Properties** dialog box, on the **General**  tab, type `C:\WCFMessageSecurity\OrderRequestOut` in the **Destination folder** text box, and then click **OK**.</span></span>  

   5. <span data-ttu-id="09d69-213">在 **傳送埠屬性**對話方塊的 **篩選**索引標籤上，選取**BTS。ReceivePortName** for**屬性**欄位中，輸入`WcfMessageSecurity.OrderRequest.Receive`for**值**欄位，，然後按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="09d69-213">In the **Send Port Properties** dialog box, on the **Filters** tab, select **BTS.ReceivePortName** for the **Property** field, enter `WcfMessageSecurity.OrderRequest.Receive` for the **Value** field, and then click **OK**.</span></span> <span data-ttu-id="09d69-214">這個篩選條件運算式路由傳入[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]到用戶端的訊息**WcfMessageSecurity.OrderRequest.Receive**接收到此傳送埠的連接埠。</span><span class="sxs-lookup"><span data-stu-id="09d69-214">This filter expression routes the incoming [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] messages from the client into the **WcfMessageSecurity.OrderRequest.Receive** receive port to this send port.</span></span>  

## <a name="test-the-wcf-client-against-the-biztalk-application"></a><span data-ttu-id="09d69-215">測試對 BizTalk 應用程式的 WCF 用戶端</span><span class="sxs-lookup"><span data-stu-id="09d69-215">Test the WCF client against the BizTalk application</span></span>  

1. <span data-ttu-id="09d69-216">在 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，以滑鼠右鍵按一下**WcfMessageSecurity**，然後按一下**啟動**。</span><span class="sxs-lookup"><span data-stu-id="09d69-216">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, right-click **WcfMessageSecurity**, and then click **Start**.</span></span> <span data-ttu-id="09d69-217">在 [**開始**] 對話方塊中，按一下**開始**。</span><span class="sxs-lookup"><span data-stu-id="09d69-217">In the **Start** dialog box, click **Start**.</span></span>  

2. <span data-ttu-id="09d69-218">在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，展開**平台設定**，展開**主控件執行個體**，以滑鼠右鍵按一下**BizTalkServerApplication**或另一個適當的主控件執行個體，然後按一下**重新啟動**。</span><span class="sxs-lookup"><span data-stu-id="09d69-218">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, expand **Platform Settings**, expand **Host Instances**, right-click **BizTalkServerApplication** or another appropriate host instance, and then click **Restart**.</span></span>  

3. <span data-ttu-id="09d69-219">建立名為的資料夾**C:\WCFMessageSecurity**如本逐步解說的工作資料夾。</span><span class="sxs-lookup"><span data-stu-id="09d69-219">Create a folder named **C:\WCFMessageSecurity** for the working folder for this walkthrough.</span></span> <span data-ttu-id="09d69-220">逐步解說將檔案解壓縮至這個資料夾。</span><span class="sxs-lookup"><span data-stu-id="09d69-220">Extract the walkthrough files to this folder.</span></span>  

4. <span data-ttu-id="09d69-221">在  [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]，開啟**Wcfmessagesecurity**中的檔案**C:\WCFMessageSecurity**資料夾。</span><span class="sxs-lookup"><span data-stu-id="09d69-221">In [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)], open the **WcfMessageSecurity.sln** file in the **C:\WCFMessageSecurity** folder.</span></span>  

5. <span data-ttu-id="09d69-222">在[!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]，在 [方案總管] 中，展開**WcfClient**，然後開啟**Program.cs**檢閱。</span><span class="sxs-lookup"><span data-stu-id="09d69-222">In [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)], in Solution Explorer, expand **WcfClient**, and then open **Program.cs** to review.</span></span>  

   - <span data-ttu-id="09d69-223">用戶端傳送訊息至 WCF-NetTcp 接收您在上一個程序中建立的位置。</span><span class="sxs-lookup"><span data-stu-id="09d69-223">The client sends a message to the WCF-NetTcp receive location that you created in the previous procedure.</span></span>  

   - <span data-ttu-id="09d69-224">用戶端會建立與通道**NetTcpBinding**，，然後設定要使用憑證進行用戶端認證類型的繫結。</span><span class="sxs-lookup"><span data-stu-id="09d69-224">The client creates a channel with the **NetTcpBinding**, and then configures the binding to use certificates for the client credential type.</span></span>  

   - <span data-ttu-id="09d69-225">用戶端會設定端點行為，以使用您安裝用戶端驗證的上一個程序中的用戶端驗證憑證。</span><span class="sxs-lookup"><span data-stu-id="09d69-225">The client configures the endpoint behavior to use the client authentication certificate that you installed in the previous procedure for the client authentication.</span></span>  

   - <span data-ttu-id="09d69-226">類別，**計劃**，實作**IClientMessageInspector**並**IEndpointBehavior**介面，以顯示 外寄[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]從這個訊息在命令提示字元中的用戶端。</span><span class="sxs-lookup"><span data-stu-id="09d69-226">The class, **Program**, implements the **IClientMessageInspector** and **IEndpointBehavior** interfaces to display outgoing [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] messages from this client at a command prompt.</span></span>  

6. <span data-ttu-id="09d69-227">在  [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]，在 [方案總管] 中，以滑鼠右鍵按一下**WcfMessageSecurity**解決方案，，然後按一下**重建**。</span><span class="sxs-lookup"><span data-stu-id="09d69-227">In [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)], in Solution Explorer, right-click the **WcfMessageSecurity** solution, and then click **Rebuild**.</span></span>  

7. <span data-ttu-id="09d69-228">在 [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]上**偵錯**功能表上，按一下 **啟動但不偵錯**執行 WcfClient，將傳送訊息至 Wcf-nettcp 接收位置。</span><span class="sxs-lookup"><span data-stu-id="09d69-228">In [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)], on the **Debug** menu, click **Start Without Debugging** to run the WcfClient to send a message to the WCF-NetTcp receive locations.</span></span> <span data-ttu-id="09d69-229">出現的命令提示字元會顯示執行結果。</span><span class="sxs-lookup"><span data-stu-id="09d69-229">A command prompt appears to show the execution result.</span></span>  

   1. <span data-ttu-id="09d69-230">在命令提示字元中，檢視訂單要求訊息。</span><span class="sxs-lookup"><span data-stu-id="09d69-230">At the command prompt, review the order request message.</span></span> <span data-ttu-id="09d69-231">請注意**OrderId**欄位和訊息的結構。</span><span class="sxs-lookup"><span data-stu-id="09d69-231">Pay attention to the **OrderId** field and the structure of the message.</span></span>  

   2. <span data-ttu-id="09d69-232">在命令提示字元中，移至`C:\WCFMessageSecurity\OrderRequestOut`資料夾，然後確定所傳送的訂單要求訊息[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]用戶端會出現。</span><span class="sxs-lookup"><span data-stu-id="09d69-232">At the command prompt, go to the `C:\WCFMessageSecurity\OrderRequestOut` folder, and then make sure the order request message sent by the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] client appears.</span></span>  

   3. <span data-ttu-id="09d69-233">關閉命令提示字元。</span><span class="sxs-lookup"><span data-stu-id="09d69-233">Close the command prompt.</span></span>
