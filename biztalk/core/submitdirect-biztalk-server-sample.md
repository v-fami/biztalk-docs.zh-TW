---
title: "SubmitDirect （BizTalk Server 範例） |Microsoft 文件"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- adapters, receive adapters
- receive adapters, examples
- examples, receive adapters
ms.assetid: 3540368b-cf46-4c83-a87b-94aec9cd1b36
caps.latest.revision: "23"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: d1e355f752241135d781c3425e05f017b0d86d93
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
---
# <a name="submitdirect-biztalk-server-sample"></a><span data-ttu-id="79544-102">SubmitDirect （BizTalk Server 範例）</span><span class="sxs-lookup"><span data-stu-id="79544-102">SubmitDirect (BizTalk Server Sample)</span></span>
<span data-ttu-id="79544-103">SubmitDirect 範例將示範如何從 .NET 架構的應用程式，以程式設計的方式將單向及要求/回應訊息提交至 Microsoft [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="79544-103">The SubmitDirect sample demonstrates how to programmatically submit one-way and request/response messages to Microsoft [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] from .NET-based applications.</span></span> <span data-ttu-id="79544-104">此範例將示範搭配配接器使用 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] API。</span><span class="sxs-lookup"><span data-stu-id="79544-104">The sample demonstrates the use of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] APIs for adapters.</span></span> <span data-ttu-id="79544-105">此外還提供名為 Submit 的接收配接器，可用來提交訊息至 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="79544-105">It also provides a receive adapter, named Submit, that can be used to submit messages to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="79544-106">必要條件</span><span class="sxs-lookup"><span data-stu-id="79544-106">Prerequisites</span></span>  
 <span data-ttu-id="79544-107">在執行此範例之前，請先確認您以屬於 [BizTalk 外掛式主控件使用者] 群組的使用者登入。</span><span class="sxs-lookup"><span data-stu-id="79544-107">Before running this sample, ensure you are logged on as a user who belongs to BizTalk Isolated Host Users group.</span></span>  
  
## <a name="what-this-sample-does"></a><span data-ttu-id="79544-108">此範例的用途</span><span class="sxs-lookup"><span data-stu-id="79544-108">What This Sample Does</span></span>  
 <span data-ttu-id="79544-109">此範例將說明如何執行與 BizTalk 配接器相關的各種不同工作。</span><span class="sxs-lookup"><span data-stu-id="79544-109">This sample shows how to perform various tasks related to BizTalk adapters.</span></span> <span data-ttu-id="79544-110">具體而言，此範例將說明如何：</span><span class="sxs-lookup"><span data-stu-id="79544-110">Specifically, it shows how to:</span></span>  
  
-   <span data-ttu-id="79544-111">使用在 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 處理程序外部執行的外掛式配接器。</span><span class="sxs-lookup"><span data-stu-id="79544-111">Work with isolated adapters that run outside of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] process.</span></span> <span data-ttu-id="79544-112">Submit 配接器是外掛式配接器，因為它是由 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 處理程序外部的處理程序所建立 (啟動方式與 .NET 應用程式相同)。</span><span class="sxs-lookup"><span data-stu-id="79544-112">The Submit adapter is an isolated adapter because it is created by a process external to the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] process (you start it as a .NET application).</span></span>  
  
-   <span data-ttu-id="79544-113">提交訊息批次至 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="79544-113">Submit batches of messages to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="79544-114">Submit 配接器會使用批次訊息提交功能，一次提交數個訊息。</span><span class="sxs-lookup"><span data-stu-id="79544-114">The Submit adapter uses batch message submittal functionality to submit several messages at once.</span></span>  
  
-   <span data-ttu-id="79544-115">使用要求/回應模式同步提交訊息，以及使用單向模式非同步地提交訊息。</span><span class="sxs-lookup"><span data-stu-id="79544-115">Submit messages synchronously using a request/response paradigm, as well as asynchronously using a one-way paradigm.</span></span>  
  
-   <span data-ttu-id="79544-116">向 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 註冊配接器。</span><span class="sxs-lookup"><span data-stu-id="79544-116">Register an adapter with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="79544-117">此範例會說明如何註冊配接器，並且提供註冊可執行檔來自動化配接器註冊。</span><span class="sxs-lookup"><span data-stu-id="79544-117">This sample shows how to register an adapter and provides a registration executable that automates the registration of an adapter.</span></span>  
  
 <span data-ttu-id="79544-118">此範例實際上包含兩個範例，如下所示：</span><span class="sxs-lookup"><span data-stu-id="79544-118">This sample is actually two samples in one, as follows:</span></span>  
  
-   <span data-ttu-id="79544-119">**提交單向訊息批次。**</span><span class="sxs-lookup"><span data-stu-id="79544-119">**Submission of a batch of one-way messages.**</span></span> <span data-ttu-id="79544-120">主控台應用程式 SubmitMessages.exe 會從命令列字串，並提交當做個別訊息公佈到每個[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="79544-120">The console application SubmitMessages.exe takes the strings from its command line and submits each one as a separate message to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="79544-121">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 會在接收位置挑選每一個提交的訊息，透過通過接收和傳送管線傳送，然後寫入文字檔中。</span><span class="sxs-lookup"><span data-stu-id="79544-121">Each of these submitted messages is picked up at the receive location by [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], sent through pass-through receive and send pipelines, and then written to a text file.</span></span>  
  
-   <span data-ttu-id="79544-122">**提交要求/回應訊息。**</span><span class="sxs-lookup"><span data-stu-id="79544-122">**Submission of request/response message.**</span></span> <span data-ttu-id="79544-123">主控台應用程式 SubmitRequest.exe 會採用其命令列上指定的.xml 檔，並將它提交給[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="79544-123">The console application SubmitRequest.exe takes the .xml file specified on its command line and submits it to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="79544-124">此 .xml 檔的結構描述會定義包含兩個整數欄位的元素。</span><span class="sxs-lookup"><span data-stu-id="79544-124">The schema of this .xml file defines elements that contain two integer fields.</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="79544-125">挑選.xml 檔案，並處理以協調流程 （含有一個要求/回應連接埠）。</span><span class="sxs-lookup"><span data-stu-id="79544-125"> picks up the .xml file and processes it with an orchestration (with one request/response port).</span></span> <span data-ttu-id="79544-126">然後使用對應產生傳回整數的 XML 回應訊息，該整數為要求中兩個整數得出的結果。</span><span class="sxs-lookup"><span data-stu-id="79544-126">It uses a map to produce an XML response message that returns an integer that is the product of the two integers in the request.</span></span> <span data-ttu-id="79544-127">當主控台應用程式收到回應時，便會顯示結果。</span><span class="sxs-lookup"><span data-stu-id="79544-127">When the console application receives the response, it displays the result.</span></span>  
  
## <a name="where-to-find-this-sample"></a><span data-ttu-id="79544-128">可在何處找到此範例</span><span class="sxs-lookup"><span data-stu-id="79544-128">Where to Find This Sample</span></span>  
 <span data-ttu-id="79544-129">\<*範例路徑*> \AdaptersDevelopment\SubmitDirect\\</span><span class="sxs-lookup"><span data-stu-id="79544-129">\<*Samples Path*>\AdaptersDevelopment\SubmitDirect\\</span></span>  
  
 <span data-ttu-id="79544-130">下表列出此範例中的檔案，並描述其用途。</span><span class="sxs-lookup"><span data-stu-id="79544-130">The following table lists the files in this sample and describes their purpose.</span></span>  
  
|<span data-ttu-id="79544-131">檔案</span><span class="sxs-lookup"><span data-stu-id="79544-131">File(s)</span></span>|<span data-ttu-id="79544-132">Description</span><span class="sxs-lookup"><span data-stu-id="79544-132">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="79544-133">Cleanup.bat</span><span class="sxs-lookup"><span data-stu-id="79544-133">Cleanup.bat</span></span>|<span data-ttu-id="79544-134">從全域組件快取 (GAC) 解除部署並移除組件；移除傳送和接收埠；視需要移除 Microsoft Internet Information Services (IIS) 虛擬目錄。</span><span class="sxs-lookup"><span data-stu-id="79544-134">Undeploys assemblies and removes them from the global assembly cache (GAC); removes send and receive ports; removes Microsoft Internet Information Services (IIS) virtual directories as needed.</span></span>|  
|<span data-ttu-id="79544-135">Setup.bat</span><span class="sxs-lookup"><span data-stu-id="79544-135">Setup.bat</span></span>|<span data-ttu-id="79544-136">建置並初始化此範例。</span><span class="sxs-lookup"><span data-stu-id="79544-136">Builds and initializes this sample.</span></span>|  
|<span data-ttu-id="79544-137">SubmitDirect.sln</span><span class="sxs-lookup"><span data-stu-id="79544-137">SubmitDirect.sln</span></span>|<span data-ttu-id="79544-138">方案檔，其中 ProcessRequest 資料夾包含 BizTalk 專案，而 Microsoft Visual C# 專案則包含在其他資料夾中。</span><span class="sxs-lookup"><span data-stu-id="79544-138">Solution file that includes the BizTalk project in the ProcessRequest folder and the Microsoft Visual C# projects in the other folders.</span></span>|  
|<span data-ttu-id="79544-139">SubmitMessagesBinding.xml，SubmitRequestBinding.xml</span><span class="sxs-lookup"><span data-stu-id="79544-139">SubmitMessagesBinding.xml, SubmitRequestBinding.xml</span></span>|<span data-ttu-id="79544-140">用於自動化設定，例如連接埠繫結。</span><span class="sxs-lookup"><span data-stu-id="79544-140">Used for automated setup such as port binding.</span></span>|  
|<span data-ttu-id="79544-141">\ProcessRequest 資料夾中：</span><span class="sxs-lookup"><span data-stu-id="79544-141">In the \ProcessRequest folder:</span></span><br /><br /> <span data-ttu-id="79544-142">DocIn.xsd、DocOut.xsd、Multiplier.odx、Multiply.btm、ProcessRequest.btproj</span><span class="sxs-lookup"><span data-stu-id="79544-142">DocIn.xsd, DocOut.xsd, Multiplier.odx, Multiply.btm, ProcessRequest.btproj</span></span>|<span data-ttu-id="79544-143">提供 BizTalk 專案，將要求/回應實例中的整數相乘。</span><span class="sxs-lookup"><span data-stu-id="79544-143">Provides a BizTalk project that performs the multiplication of integers in the request/response scenario.</span></span>|  
|<span data-ttu-id="79544-144">在 \SubmitMessages 資料夾中：</span><span class="sxs-lookup"><span data-stu-id="79544-144">In the \SubmitMessages folder:</span></span><br /><br /> <span data-ttu-id="79544-145">AssemblyInfo.cs、SubmitMessages.cs、SubmitMessages.csproj</span><span class="sxs-lookup"><span data-stu-id="79544-145">AssemblyInfo.cs, SubmitMessages.cs, SubmitMessages.csproj</span></span>|<span data-ttu-id="79544-146">提供 Visual C# 專案給主控台應用程式，該應用程式會將命令列字串參數當做一批單獨訊息傳遞。</span><span class="sxs-lookup"><span data-stu-id="79544-146">Provides a Visual C# project for the console application that passes its command line string parameters as a batch of separate messages.</span></span>|  
|<span data-ttu-id="79544-147">在 \SubmitRequest 資料夾中：</span><span class="sxs-lookup"><span data-stu-id="79544-147">In the \SubmitRequest folder:</span></span><br /><br /> <span data-ttu-id="79544-148">AssemblyInfo.cs、DocInstance.xml、SubmitRequest.cs、SubmitRequest.csproj</span><span class="sxs-lookup"><span data-stu-id="79544-148">AssemblyInfo.cs, DocInstance.xml, SubmitRequest.cs, SubmitRequest.csproj</span></span>|<span data-ttu-id="79544-149">提供 C# 專案給主控台應用程式，該應用程式會傳遞包含兩個要相乘之整數的 .xml 檔 (DocInstance.xml)。</span><span class="sxs-lookup"><span data-stu-id="79544-149">Provides a C# project for the console application that passes an .xml file (DocInstance.xml) containing two integers to be multiplied.</span></span>|  
|<span data-ttu-id="79544-150">在 \TransportProxyUtils 資料夾中：</span><span class="sxs-lookup"><span data-stu-id="79544-150">In the \TransportProxyUtils folder:</span></span><br /><br /> <span data-ttu-id="79544-151">AssemblyInfo.cs、MessageHelper.cs、MessagingAPIInterface.cs、MessagingAPIs.cs、ResponseCallBack.cs、TpBatchAsyncCallback.cs、TpBatchAsyncResult.cs、TpBatchStatus.cs、TransportProxyUtils.csproj</span><span class="sxs-lookup"><span data-stu-id="79544-151">AssemblyInfo.cs, MessageHelper.cs, MessagingAPIInterface.cs, MessagingAPIs.cs, ResponseCallBack.cs, TpBatchAsyncCallback.cs, TpBatchAsyncResult.cs, TpBatchStatus.cs, TransportProxyUtils.csproj</span></span>|<span data-ttu-id="79544-152">提供 C# 專案給 Submit 配接器的執行階段部份，該配接器會實作同步和非同步提交訊息的方法，以及提交批次和單一要求訊息的方法。</span><span class="sxs-lookup"><span data-stu-id="79544-152">Provides a C# project for the run-time portion of the Submit adapter that implements methods for synchronous and asynchronous message submission, and for batch and single request message submission.</span></span>|  
|<span data-ttu-id="79544-153">在 \TransportProxyUtilsReg 資料夾中：</span><span class="sxs-lookup"><span data-stu-id="79544-153">In the \TransportProxyUtilsReg folder:</span></span><br /><br /> <span data-ttu-id="79544-154">AssemblyInfo.cs、RegisterAdapter.cs、TransportProxyUtilsReg.csproj</span><span class="sxs-lookup"><span data-stu-id="79544-154">AssemblyInfo.cs, RegisterAdapter.cs, TransportProxyUtilsReg.csproj</span></span>|<span data-ttu-id="79544-155">提供 Visual C# 專案，示範可用來向 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 註冊配接器的程式碼。</span><span class="sxs-lookup"><span data-stu-id="79544-155">Provides a Visual C# project that demonstrates code that you can use to register adapters with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>|  
|<span data-ttu-id="79544-156">在 \TransportProxyUtilsUI 資料夾中：</span><span class="sxs-lookup"><span data-stu-id="79544-156">In the \TransportProxyUtilsUI folder:</span></span><br /><br /> <span data-ttu-id="79544-157">AssemblyInfo.cs、TransportProxyUtilsMgmt.cs、TransportProxyUtilsUI.csproj</span><span class="sxs-lookup"><span data-stu-id="79544-157">AssemblyInfo.cs, TransportProxyUtilsMgmt.cs, TransportProxyUtilsUI.csproj</span></span>|<span data-ttu-id="79544-158">提供 Visual C# 專案給 Submit 配接器的使用者介面部分。</span><span class="sxs-lookup"><span data-stu-id="79544-158">Provides a Visual C# project for the user interface portion of the Submit adapter.</span></span>|  
  
## <a name="building-and-initializing-the-sample"></a><span data-ttu-id="79544-159">建置和初始化範例</span><span class="sxs-lookup"><span data-stu-id="79544-159">Building and Initializing the Sample</span></span>  
  
#### <a name="to-build-and-initialize-the-submitdirect-sample"></a><span data-ttu-id="79544-160">建置及初始化 SubmitDirect 範例</span><span class="sxs-lookup"><span data-stu-id="79544-160">To build and initialize the SubmitDirect sample</span></span>  
  
1.  <span data-ttu-id="79544-161">在命令視窗中，瀏覽至下列資料夾：</span><span class="sxs-lookup"><span data-stu-id="79544-161">In a command window, navigate to the following folder:</span></span>  
  
     <span data-ttu-id="79544-162">\<*範例路徑*> \AdaptersDevelopment\SubmitDirect</span><span class="sxs-lookup"><span data-stu-id="79544-162">\<*Samples Path*>\AdaptersDevelopment\SubmitDirect</span></span>  
  
2.  <span data-ttu-id="79544-163">執行檔案 Setup.bat，這會執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="79544-163">Run the file Setup.bat, which performs the following actions:</span></span>  
  
    -   <span data-ttu-id="79544-164">針對本範例的批次提交部份建立下列輸出資料夾。</span><span class="sxs-lookup"><span data-stu-id="79544-164">Creates the following output folder for the batch submission portion of this sample.</span></span>  
  
         <span data-ttu-id="79544-165">\<*範例路徑*> \AdaptersDevelopment\SubmitDirect\Out</span><span class="sxs-lookup"><span data-stu-id="79544-165">\<*Samples Path*>\AdaptersDevelopment\SubmitDirect\Out</span></span>  
  
    -   <span data-ttu-id="79544-166">針對此範例編譯各種 [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)] 專案。</span><span class="sxs-lookup"><span data-stu-id="79544-166">Compiles the various [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)] projects for this sample.</span></span>  
  
    -   <span data-ttu-id="79544-167">向 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 註冊 Submit 配接器。</span><span class="sxs-lookup"><span data-stu-id="79544-167">Registers the Submit adapter with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
    -   <span data-ttu-id="79544-168">建立並繫結 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 接收位置，以及傳送埠和接收埠。</span><span class="sxs-lookup"><span data-stu-id="79544-168">Creates and binds the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] receive locations, and the send and receive ports.</span></span>  
  
        > [!NOTE]
        >  <span data-ttu-id="79544-169">此範例會在建立和繫結連接埠時顯示下列警告：</span><span class="sxs-lookup"><span data-stu-id="79544-169">This sample displays the following warnings when creating and binding the ports:</span></span>  
        >   
        >  `Warning: Receive handler not specified for receive location "SubmitDirectRL"; updating with first receive handler with matching transport type.`  
        >   
        >  `Warning: Host not specified for orchestration "Microsoft.Samples.BizTalk.ProcessRequest.Multiplier"; updating with first available host.`  
        >   
        >  <span data-ttu-id="79544-170">您可以安全地忽略這些警告。</span><span class="sxs-lookup"><span data-stu-id="79544-170">You can safely ignore these warnings.</span></span> <span data-ttu-id="79544-171">(繫結檔案已省略主控件名稱與接收處理常式，以配合使用者安裝中可能的命名差異)。</span><span class="sxs-lookup"><span data-stu-id="79544-171">(To accommodate for possible naming differences in user installations, the host name and receive handler have been omitted from the binding file.)</span></span>  
  
    -   <span data-ttu-id="79544-172">啟用接收位置，並啟動傳送埠和協調流程。</span><span class="sxs-lookup"><span data-stu-id="79544-172">Enables the receive locations, and starts the send ports and orchestration.</span></span>  
  
        > [!NOTE]
        >  <span data-ttu-id="79544-173">在嘗試執行此範例之前，您必須確認 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 沒有在建置和初始化的程序中報告任何錯誤。</span><span class="sxs-lookup"><span data-stu-id="79544-173">You should confirm that [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] did not report any errors during the build and initialization process before attempting to run this sample.</span></span>  
  
        > [!NOTE]
        >  <span data-ttu-id="79544-174">若您選擇不執行 Setup.bat 檔案就開啟和建置此範例中的專案，您必須先使用 .NET Framework Strong Name Utility (sn.exe) 建立強式名稱金鑰組。</span><span class="sxs-lookup"><span data-stu-id="79544-174">If you choose to open and build the projects in this sample without running the file Setup.bat, you must first create a strong name key pair using the .NET Framework Strong Name Utility (sn.exe).</span></span> <span data-ttu-id="79544-175">使用此金鑰組簽署所產生的組件。</span><span class="sxs-lookup"><span data-stu-id="79544-175">Use this key pair to sign the resulting assemblies.</span></span>  
  
        > [!NOTE]
        >  <span data-ttu-id="79544-176">若要復原 Setup.bat 所進行的變更，請執行 Cleanup.bat。</span><span class="sxs-lookup"><span data-stu-id="79544-176">To undo changes made by Setup.bat, run Cleanup.bat.</span></span> <span data-ttu-id="79544-177">您必須先執行 Cleanup.bat 才能再度執行 Setup.bat。</span><span class="sxs-lookup"><span data-stu-id="79544-177">You must run Cleanup.bat before running Setup.bat a second time.</span></span>  
  
## <a name="running-the-sample"></a><span data-ttu-id="79544-178">執行範例</span><span class="sxs-lookup"><span data-stu-id="79544-178">Running the Sample</span></span>  
 <span data-ttu-id="79544-179">由於此範例使用 File 配接器，因此 BizTalk 主控件 (BizTalkServerApplication) 必須為執行中。</span><span class="sxs-lookup"><span data-stu-id="79544-179">Because this sample uses File adapter, the BizTalk host (BizTalkServerApplication) must be running.</span></span> <span data-ttu-id="79544-180">請使用下列程序來執行 SubmitDirect 範例。</span><span class="sxs-lookup"><span data-stu-id="79544-180">Use the following procedures to run the SubmitDirect sample.</span></span>  
  
#### <a name="to-run-the-batch-submission-portion-of-the-submitdirect-sample"></a><span data-ttu-id="79544-181">執行 SubmitDirect 範例的批次提交部份</span><span class="sxs-lookup"><span data-stu-id="79544-181">To run the batch submission portion of the SubmitDirect sample</span></span>  
  
1.  <span data-ttu-id="79544-182">在命令視窗中，瀏覽至下列資料夾：</span><span class="sxs-lookup"><span data-stu-id="79544-182">In a command window, navigate to the following folder:</span></span>  
  
     <span data-ttu-id="79544-183">\<*範例路徑*> \AdaptersDevelopment\SubmitDirect\SubmitMessages\bin\Debug</span><span class="sxs-lookup"><span data-stu-id="79544-183">\<*Samples Path*>\AdaptersDevelopment\SubmitDirect\SubmitMessages\bin\Debug</span></span>  
  
2.  <span data-ttu-id="79544-184">執行 SubmitMessages.exe 檔，在命令列上傳遞多個字串。</span><span class="sxs-lookup"><span data-stu-id="79544-184">Run the file SubmitMessages.exe, passing multiple strings on the command line.</span></span>  
  
     <span data-ttu-id="79544-185">範例： SubmitMessages msg1 msg2 msg3</span><span class="sxs-lookup"><span data-stu-id="79544-185">Example: SubmitMessages msg1 msg2 msg3</span></span>  
  
3.  <span data-ttu-id="79544-186">注意在 Out 輸出資料夾中建立的多個文字檔。這些檔案包含命令列上傳遞的字串，每個檔案包含一個字串。</span><span class="sxs-lookup"><span data-stu-id="79544-186">Observe the multiple text files created in the output folder Out. These files contain the strings passed on the command line, one per file.</span></span>  
  
#### <a name="to-run-the-requestresponse-portion-of-the-submitdirect-sample"></a><span data-ttu-id="79544-187">執行 SubmitDirect 範例的要求/回應部份</span><span class="sxs-lookup"><span data-stu-id="79544-187">To run the request/response portion of the SubmitDirect sample</span></span>  
  
1.  <span data-ttu-id="79544-188">在命令視窗中，瀏覽至下列資料夾：</span><span class="sxs-lookup"><span data-stu-id="79544-188">In a command window, navigate to the following folder:</span></span>  
  
     <span data-ttu-id="79544-189">\<*範例路徑*> \AdaptersDevelopment\SubmitDirect\SubmitRequest\bin\Debug</span><span class="sxs-lookup"><span data-stu-id="79544-189">\<*Samples Path*>\AdaptersDevelopment\SubmitDirect\SubmitRequest\bin\Debug</span></span>  
  
2.  <span data-ttu-id="79544-190">執行 SubmitRequest.exe 檔，在命令列上傳遞適當的 .xml 檔案名稱。</span><span class="sxs-lookup"><span data-stu-id="79544-190">Run the file SubmitRequest.exe, passing an appropriate .xml file name on the command line.</span></span>  
  
     <span data-ttu-id="79544-191">範例： SubmitRequest...\\..\DocInstance.xml</span><span class="sxs-lookup"><span data-stu-id="79544-191">Example: SubmitRequest ..\\..\DocInstance.xml</span></span>  
  
3.  <span data-ttu-id="79544-192">觀察包含乘法運算中，顯示在主控台的結果的回應 XML 訊息。</span><span class="sxs-lookup"><span data-stu-id="79544-192">Observe the response XML message, containing the result of the multiplication operation, displayed to the console.</span></span>  
  
## <a name="comments"></a><span data-ttu-id="79544-193">註解</span><span class="sxs-lookup"><span data-stu-id="79544-193">Comments</span></span>  
 <span data-ttu-id="79544-194">您可以在其他應用程式中使用 Submit 配接器。</span><span class="sxs-lookup"><span data-stu-id="79544-194">You can use the Submit adapter in other applications.</span></span> <span data-ttu-id="79544-195">您可以從任何 .NET 架構的程式碼使用該配接器，以程式設計的方式傳遞訊息至您的 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="79544-195">You can use it from any .NET-based code to submit messages to your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] programmatically.</span></span> <span data-ttu-id="79544-196">若要搭配您的程式碼使用此配接器，請執行下列程序。</span><span class="sxs-lookup"><span data-stu-id="79544-196">To use this adapter with your code, use the following procedure.</span></span>  
  
#### <a name="to-use-the-sample-adapter-with-your-code"></a><span data-ttu-id="79544-197">搭配您的程式碼使用範例配接器</span><span class="sxs-lookup"><span data-stu-id="79544-197">To use the sample adapter with your code</span></span>  
  
1.  <span data-ttu-id="79544-198">向 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 註冊 Submit 配接器。</span><span class="sxs-lookup"><span data-stu-id="79544-198">Register the Submit adapter with your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="79544-199">如果您已執行此範例提供的 Setup.bat 檔，則配接器應該已註冊且可立即使用。</span><span class="sxs-lookup"><span data-stu-id="79544-199">If you have run the file Setup.bat provided with this sample, the adapter should be registered and ready to use.</span></span> <span data-ttu-id="79544-200">否則，您可以建置 TransportProxyUtils.csproj、TransportProxyUtilsUI.csproj 和 TransportProxyUtilsReg.csproj 專案，然後執行第三個專案產生的可執行檔 RegisterAdapter.exe，藉此註冊配接器。</span><span class="sxs-lookup"><span data-stu-id="79544-200">Otherwise, you can register it by building the projects TransportProxyUtils.csproj, TransportProxyUtilsUI.csproj, and TransportProxyUtilsReg.csproj, and then running the executable produced by the latter project, RegisterAdapter.exe.</span></span>  
  
    > [!IMPORTANT]
    >  <span data-ttu-id="79544-201">如果您在 64 位元電腦上安裝 BizTalk，所有 HKEY_CLASSES_ROOT\CLSID\ 登錄項目執行個體中都變更為 HKEY_CLASSES_ROOT\Wow6432Node\CLSID\ **RegisterAdapter.cs**檔案。</span><span class="sxs-lookup"><span data-stu-id="79544-201">If you install BizTalk on a 64 bit machine, change all instances of the HKEY_CLASSES_ROOT\CLSID\ registry entry to HKEY_CLASSES_ROOT\Wow6432Node\CLSID\ in the **RegisterAdapter.cs** file.</span></span>  
  
2.  <span data-ttu-id="79544-202">建立接收位置使用 Submit 配接器的接收埠。</span><span class="sxs-lookup"><span data-stu-id="79544-202">Create a receive port with a receive location that uses the Submit adapter.</span></span> <span data-ttu-id="79544-203">指定接收位置的位址。</span><span class="sxs-lookup"><span data-stu-id="79544-203">Specify the address of the receive location.</span></span> <span data-ttu-id="79544-204">此位址可以是使用此配接器的接收位置內，任何未使用過的唯一字串。</span><span class="sxs-lookup"><span data-stu-id="79544-204">The address can be any string that is unique within the receive locations that use this adapter.</span></span>  
  
3.  <span data-ttu-id="79544-205">參考您 [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)] 專案中的組件 Microsoft.BizTalk.SDKSamples.AdaptersDevelopment.TransportProxyUtils.dll。</span><span class="sxs-lookup"><span data-stu-id="79544-205">Reference the assembly Microsoft.BizTalk.SDKSamples.AdaptersDevelopment.TransportProxyUtils.dll in your [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)] project.</span></span>  
  
4.  <span data-ttu-id="79544-206">使用此組件提供的下列一或多個方法提交訊息至 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="79544-206">Submit messages to your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] by using one or more of the following methods provided by this assembly.</span></span>  
  
    |<span data-ttu-id="79544-207">方法</span><span class="sxs-lookup"><span data-stu-id="79544-207">Method(s)</span></span>|<span data-ttu-id="79544-208">Description</span><span class="sxs-lookup"><span data-stu-id="79544-208">Description</span></span>|  
    |-----------------|-----------------|  
    |<span data-ttu-id="79544-209">**Submitmessage**</span><span class="sxs-lookup"><span data-stu-id="79544-209">**SubmitMessage()**</span></span><br /><br /> <span data-ttu-id="79544-210">**BeginSubmitMessage()**</span><span class="sxs-lookup"><span data-stu-id="79544-210">**BeginSubmitMessage()**</span></span><br /><br /> <span data-ttu-id="79544-211">**EndSubmitMessage()**</span><span class="sxs-lookup"><span data-stu-id="79544-211">**EndSubmitMessage()**</span></span>|<span data-ttu-id="79544-212">提交單向訊息至 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 的同步和非同步方法。</span><span class="sxs-lookup"><span data-stu-id="79544-212">Synchronous and asynchronous methods to submit a one-way message to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="79544-213">訊息內容中必須設定訊息將提交至其中的接收位置位址。</span><span class="sxs-lookup"><span data-stu-id="79544-213">The address of the receive location where the message is submitted must be set on the message context.</span></span><br /><br /> <span data-ttu-id="79544-214">表示已傳回提交狀態 (成功/失敗) 的布林值。</span><span class="sxs-lookup"><span data-stu-id="79544-214">A Boolean value indicating the status of submission (success/failure) is returned.</span></span>|  
    |<span data-ttu-id="79544-215">**SubmitMessages()**</span><span class="sxs-lookup"><span data-stu-id="79544-215">**SubmitMessages()**</span></span><br /><br /> <span data-ttu-id="79544-216">**BeginSubmitMessages()**</span><span class="sxs-lookup"><span data-stu-id="79544-216">**BeginSubmitMessages()**</span></span><br /><br /> <span data-ttu-id="79544-217">**EndSubmitMessages()**</span><span class="sxs-lookup"><span data-stu-id="79544-217">**EndSubmitMessages()**</span></span>|<span data-ttu-id="79544-218">提交單向訊息陣列至 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 的同步和非同步方法。</span><span class="sxs-lookup"><span data-stu-id="79544-218">Synchronous and asynchronous methods to submit an array of one-way messages to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="79544-219">訊息內容中應設定訊息將提交至其中的接收位置位址。</span><span class="sxs-lookup"><span data-stu-id="79544-219">The addresses of the receive locations where the messages are submitted should be set on the context of the messages.</span></span><br /><br /> <span data-ttu-id="79544-220">表示已傳回提交狀態 (成功/失敗) 的布林值。</span><span class="sxs-lookup"><span data-stu-id="79544-220">A Boolean value indicating the status of submission (success/failure) is returned.</span></span>|  
    |<span data-ttu-id="79544-221">**SubmitSyncMessage()**</span><span class="sxs-lookup"><span data-stu-id="79544-221">**SubmitSyncMessage()**</span></span><br /><br /> <span data-ttu-id="79544-222">**BeginSubmitSyncMessage()**</span><span class="sxs-lookup"><span data-stu-id="79544-222">**BeginSubmitSyncMessage()**</span></span><br /><br /> <span data-ttu-id="79544-223">**EndSubmitSyncMessage()**</span><span class="sxs-lookup"><span data-stu-id="79544-223">**EndSubmitSyncMessage()**</span></span>|<span data-ttu-id="79544-224">提交要求訊息至 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 的同步和非同步方法。</span><span class="sxs-lookup"><span data-stu-id="79544-224">Synchronous and asynchronous methods to submit a request message to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="79544-225">訊息內容中應設定訊息將提交至其中的接收位置位址。</span><span class="sxs-lookup"><span data-stu-id="79544-225">The address of the receive location where the message is submitted should be set on the message context.</span></span><br /><br /> <span data-ttu-id="79544-226">傳回回應訊息。</span><span class="sxs-lookup"><span data-stu-id="79544-226">The response message is returned.</span></span>|  
    |<span data-ttu-id="79544-227">**CreateMessageFromString()**</span><span class="sxs-lookup"><span data-stu-id="79544-227">**CreateMessageFromString()**</span></span>|<span data-ttu-id="79544-228">從字串建立 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 訊息物件，並且在訊息內容中設定接收位置位址屬性。</span><span class="sxs-lookup"><span data-stu-id="79544-228">Creates a [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] message object from a string and sets the receive location address property on the message context.</span></span><br /><br /> <span data-ttu-id="79544-229">傳回 BizTalk 訊息物件。</span><span class="sxs-lookup"><span data-stu-id="79544-229">Returns a BizTalk message object.</span></span>|  
    |<span data-ttu-id="79544-230">**CreateMessageFromStream()**</span><span class="sxs-lookup"><span data-stu-id="79544-230">**CreateMessageFromStream()**</span></span>|<span data-ttu-id="79544-231">從資料流建立 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 訊息物件，並在訊息內容中設定接收位置位址屬性。</span><span class="sxs-lookup"><span data-stu-id="79544-231">Creates a [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] message object from a stream and sets the receive location address property on the message context.</span></span><br /><br /> <span data-ttu-id="79544-232">傳回 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 訊息物件。</span><span class="sxs-lookup"><span data-stu-id="79544-232">Returns a [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] message object.</span></span>|  
  
     <span data-ttu-id="79544-233">如需這些方法的參數和傳回類型的詳細資訊，請參閱 TransportProxyUtils 資料夾中的 MessagingAPIInterface.cs 檔。</span><span class="sxs-lookup"><span data-stu-id="79544-233">For details about the parameter and return types for these methods, see the file MessagingAPIInterface.cs in the TransportProxyUtils folder.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="79544-234">另請參閱</span><span class="sxs-lookup"><span data-stu-id="79544-234">See Also</span></span>  
 <span data-ttu-id="79544-235">[配接器範例-開發](../core/adapter-samples-development.md) </span><span class="sxs-lookup"><span data-stu-id="79544-235">[Adapter Samples - Development](../core/adapter-samples-development.md) </span></span>  
 [<span data-ttu-id="79544-236">註冊配接器</span><span class="sxs-lookup"><span data-stu-id="79544-236">Registering an Adapter</span></span>](../core/registering-an-adapter.md)