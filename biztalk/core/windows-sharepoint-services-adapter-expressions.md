---
title: Windows SharePoint Services 配接器運算式 |Microsoft 文件
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- macros, Windows SharePoint Services adapters
- configuring [Windows SharePoint Services adapters], supported macros
- configuring [Windows SharePoint Services adapters], expressions
- Windows SharePoint Services adapters, expressions
ms.assetid: 15e3afb2-0ef8-41b4-b3ec-de84af738c12
caps.latest.revision: 22
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 377859a1b2c28774342c6ff9dc5cc312c9fd82d9
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/28/2017
ms.locfileid: "25973884"
---
# <a name="windows-sharepoint-services-adapter-expressions"></a><span data-ttu-id="9f3f3-102">Windows Sharepoint Services 配接器運算式</span><span class="sxs-lookup"><span data-stu-id="9f3f3-102">Windows SharePoint Services Adapter Expressions</span></span>
<span data-ttu-id="9f3f3-103">本主題說明格式與意義可以指定為值的字串**檔案 NameProperty 來源**Windows SharePoint Services 配接器的屬性。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-103">This topic describes the format and the meaning of the strings that can be specified as values for the **File NameProperty Source** properties of the Windows SharePoint Services adapter.</span></span> <span data-ttu-id="9f3f3-104">它也會描述相關的內容屬性， **WSS。檔名**和**WSS。ConfigPropertiesXml**。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-104">It also describes the related context properties, **WSS.Filename** and **WSS.ConfigPropertiesXml**.</span></span> <span data-ttu-id="9f3f3-105">這些運算式可讓您根據常值與從訊息或 BizTalk 系統擷取的值，輕鬆地定義檔案名稱值或是自訂的 Windows SharePoint Service 資料行值。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-105">These expressions allow you to easily define the file name value, or custom Windows SharePoint Service column value, based on literals as well as values extracted from the message or the BizTalk system.</span></span>  
  
 <span data-ttu-id="9f3f3-106">運算式可以包含常值與巨集。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-106">The expressions can contain literals and macros.</span></span> <span data-ttu-id="9f3f3-107">常值將依照您的輸入出現在檔案名稱中。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-107">The literals will show up in the file name exactly as you type them.</span></span> <span data-ttu-id="9f3f3-108">巨集必須放置在 '%' 字元之間。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-108">Macros must be placed between '%' characters.</span></span> <span data-ttu-id="9f3f3-109">巨集的範例是 `%MessageID%`，執行階段中會將這個巨集取代成訊息的 GUID。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-109">An example of a macro is `%MessageID%` which at runtime will be replaced with the GUID of the message.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="9f3f3-110">使用 %字元時為常值或是用於 XPATH 中，則必須逸出如下\\%。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-110">When the % character is used as a literal or within an XPATH, it must be escaped like this \\%.</span></span> <span data-ttu-id="9f3f3-111">單一 %將會視為巨集分隔符號，其中\\於執行階段由單一 %取代 %。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-111">A single % will be considered a macro delimiter, where a \\% will be replaced at runtime by a single %.</span></span> <span data-ttu-id="9f3f3-112">\ 必須逸出字元，就像這樣\\ \\。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-112">The \ character must be escaped like this \\\\.</span></span>  
  
## <a name="expression-examples"></a><span data-ttu-id="9f3f3-113">運算式範例</span><span class="sxs-lookup"><span data-stu-id="9f3f3-113">Expression examples</span></span>  
  
|<span data-ttu-id="9f3f3-114">設計階段值</span><span class="sxs-lookup"><span data-stu-id="9f3f3-114">Design time value</span></span>|<span data-ttu-id="9f3f3-115">執行階段值</span><span class="sxs-lookup"><span data-stu-id="9f3f3-115">Runtime value</span></span>|  
|-----------------------|-------------------|  
|<span data-ttu-id="9f3f3-116">XYZ</span><span class="sxs-lookup"><span data-stu-id="9f3f3-116">XYZ</span></span>|<span data-ttu-id="9f3f3-117">XYZ</span><span class="sxs-lookup"><span data-stu-id="9f3f3-117">XYZ</span></span>|  
|<span data-ttu-id="9f3f3-118">PurchaseOrder</span><span class="sxs-lookup"><span data-stu-id="9f3f3-118">PurchaseOrder</span></span>|<span data-ttu-id="9f3f3-119">PurchaseOrder</span><span class="sxs-lookup"><span data-stu-id="9f3f3-119">PurchaseOrder</span></span>|  
|<span data-ttu-id="9f3f3-120">%MessageID%</span><span class="sxs-lookup"><span data-stu-id="9f3f3-120">%MessageID%</span></span>|<span data-ttu-id="9f3f3-121">55B93F27-7455-4066-ABE1-B4EBE6839A1A</span><span class="sxs-lookup"><span data-stu-id="9f3f3-121">55B93F27-7455-4066-ABE1-B4EBE6839A1A</span></span>|  
|<span data-ttu-id="9f3f3-122">PurchaseOrder - %MessageID%</span><span class="sxs-lookup"><span data-stu-id="9f3f3-122">PurchaseOrder - %MessageID%</span></span>|<span data-ttu-id="9f3f3-123">PurchaseOrder - 55B93F27-7455-4066-ABE1-B4EBE6839A1A</span><span class="sxs-lookup"><span data-stu-id="9f3f3-123">PurchaseOrder - 55B93F27-7455-4066-ABE1-B4EBE6839A1A</span></span>|  
|<span data-ttu-id="9f3f3-124">折扣\\%10</span><span class="sxs-lookup"><span data-stu-id="9f3f3-124">Discount \\%10</span></span>|<span data-ttu-id="9f3f3-125">Discount %10</span><span class="sxs-lookup"><span data-stu-id="9f3f3-125">Discount %10</span></span>|  
|<span data-ttu-id="9f3f3-126">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:ID%</span><span class="sxs-lookup"><span data-stu-id="9f3f3-126">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:ID%</span></span>|<span data-ttu-id="9f3f3-127">PurchaseOrder – 10001</span><span class="sxs-lookup"><span data-stu-id="9f3f3-127">PurchaseOrder – 10001</span></span>|  
|<span data-ttu-id="9f3f3-128">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:PartnerName%-%XPATH=//ns0:PurchaseOrder/ns0:ID%</span><span class="sxs-lookup"><span data-stu-id="9f3f3-128">PurchaseOrder - %XPATH=//ns0:PurchaseOrder/ns0:PartnerName%-%XPATH=//ns0:PurchaseOrder/ns0:ID%</span></span>|<span data-ttu-id="9f3f3-129">PurchaseOrder – Contoso-10001</span><span class="sxs-lookup"><span data-stu-id="9f3f3-129">PurchaseOrder – Contoso-10001</span></span>|  
  
## <a name="supported-macros"></a><span data-ttu-id="9f3f3-130">支援的巨集</span><span class="sxs-lookup"><span data-stu-id="9f3f3-130">Supported macros</span></span>  
  
|<span data-ttu-id="9f3f3-131">設計階段值</span><span class="sxs-lookup"><span data-stu-id="9f3f3-131">Design time value</span></span>|<span data-ttu-id="9f3f3-132">執行階段值</span><span class="sxs-lookup"><span data-stu-id="9f3f3-132">Runtime value</span></span>|  
|-----------------------|-------------------|  
|<span data-ttu-id="9f3f3-133">%MessageID%</span><span class="sxs-lookup"><span data-stu-id="9f3f3-133">%MessageID%</span></span>|<span data-ttu-id="9f3f3-134">BizTalk 訊息識別碼是唯一的 GUID。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-134">The BizTalk message ID which is a unique GUID.</span></span>|  
|<span data-ttu-id="9f3f3-135">%SendingOrchestrationID%</span><span class="sxs-lookup"><span data-stu-id="9f3f3-135">%SendingOrchestrationID%</span></span>|<span data-ttu-id="9f3f3-136">產生訊息的協調流程執行個體之 BizTalk 識別碼。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-136">The BizTalk ID of the orchestration instance where the message originated.</span></span>|  
|<span data-ttu-id="9f3f3-137">%SendingOrchestrationType%</span><span class="sxs-lookup"><span data-stu-id="9f3f3-137">%SendingOrchestrationType%</span></span>|<span data-ttu-id="9f3f3-138">產生訊息的協調流程類型名稱。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-138">The type name of the orchestration where the message originated.</span></span>|  
|<span data-ttu-id="9f3f3-139">%Xpath =\<xpath\>%</span><span class="sxs-lookup"><span data-stu-id="9f3f3-139">%XPATH=\<xpath\>%</span></span>|<span data-ttu-id="9f3f3-140">允許指定要用來擷取訊息值的 XPATH。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-140">Allows specifying an XPATH to be used for extracting the value from the message.</span></span> <span data-ttu-id="9f3f3-141">「\<xpath\>"必須取代有效的 XPATH 運算式。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-141">“\<xpath\>” must be replaced with a valid XPATH expression.</span></span> <span data-ttu-id="9f3f3-142">**注意：** 命名空間別名必須定義在 ' Namespace Aliases' 或 WSS 運算式外。ConfigNamespaceAliases 欄位。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-142">**Note:**  The namespace alias must be defined outside the expression in the 'Namespace Aliases' or WSS.ConfigNamespaceAliases field.</span></span>|  
|<span data-ttu-id="9f3f3-143">%Filename%</span><span class="sxs-lookup"><span data-stu-id="9f3f3-143">%Filename%</span></span>|<span data-ttu-id="9f3f3-144">取代成從訊息內容屬性 WSS.Filename 擷取的檔案名稱值。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-144">Replaced with the filename value extracted from the message context property WSS.Filename.</span></span> <span data-ttu-id="9f3f3-145">從 SharePoint 接收的訊息會將 WSS.Filename 內容屬性設定為 SharePoint 檔案的名稱。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-145">Messages received from SharePoint have the WSS.Filename context property value set to the name of the SharePoint file.</span></span> <span data-ttu-id="9f3f3-146">傳回的值是使用 Path.GetFilenameWithoutExtension 來預先處理。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-146">The returned value is preprocessed using Path.GetFilenameWithoutExtension.</span></span> <span data-ttu-id="9f3f3-147">**注意：** 這個巨集不能用於在 WSS。Config \* 內容屬性 （從協調流程）。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-147">**Note:**  This macro cannot be used in WSS.Config\* context properties (from orchestration).</span></span>|  
|<span data-ttu-id="9f3f3-148">%Extension%</span><span class="sxs-lookup"><span data-stu-id="9f3f3-148">%Extension%</span></span>|<span data-ttu-id="9f3f3-149">取代成從訊息內容屬性 WSS.Filename 擷取的副檔名值。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-149">Replaced with the file extension value extracted from the message context property WSS.Filename.</span></span> <span data-ttu-id="9f3f3-150">從 SharePoint 接收的訊息會將 WSS.Filename 內容屬性設定為 SharePoint 檔案的名稱。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-150">Messages received from SharePoint have the WSS.Filename context property value set to the name of the SharePoint file.</span></span> <span data-ttu-id="9f3f3-151">傳回值會使用 Path.GetExtension 進行前置處理。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-151">The returned value is preprocessed using Path.GetExtension.</span></span> <span data-ttu-id="9f3f3-152">傳回的值不會包含 "."。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-152">The returned value will not contain ".".</span></span> <span data-ttu-id="9f3f3-153">**注意：** 這個巨集不能用於在 WSS。Config \* 內容屬性 （從協調流程）。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-153">**Note:**  This macro cannot be used in WSS.Config\* context properties (from orchestration).</span></span>|  
  
 <span data-ttu-id="9f3f3-154">屬性升級支援的任何有效運算式都是有效的設計階段檔案名稱。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-154">Any valid expression supported by property promotion is a valid design time file name.</span></span> <span data-ttu-id="9f3f3-155">此設計階段檔案名稱將在執行階段擴充成 Windows SharePoint Services 檔案名稱。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-155">The design time file name will be expanded at runtime into Windows SharePoint Services file names.</span></span> <span data-ttu-id="9f3f3-156">此 Windows SharePoint Services 檔案名稱有一些其他的限制，如下所述：</span><span class="sxs-lookup"><span data-stu-id="9f3f3-156">This Windows SharePoint Services file name has some additional limitations, which are described as follows:</span></span>  
  
-   <span data-ttu-id="9f3f3-157">有效的 Windows 檔案名稱可以包含任何 Unicode 字元，但下列字元除外：/  \  :  \*  ?</span><span class="sxs-lookup"><span data-stu-id="9f3f3-157">Valid Windows file names can contain any Unicode characters with the exception of the following: /  \  :  \*  ?</span></span>  <span data-ttu-id="9f3f3-158">< > &#124; "# {} %& ~ 或定位字元和多個句號。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-158"><  >  &#124;  "  #  {  }  %  &  ~ or tab characters and multiple periods.</span></span>  
  
-   <span data-ttu-id="9f3f3-159">檔案名稱不能超過 256 個字元，而且整個 URL 必須少於或等於 256 個字元。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-159">The file name cannot be longer than 256 characters and the entire URL must be less than or equal to 256 characters.</span></span>  
  
-   <span data-ttu-id="9f3f3-160">若擴充的 Windows SharePoint Services 檔案名稱包含無效的字元，或是若擴充的檔案名稱或 URL 太長，則會在應用程式事件日誌中記錄錯誤，並且擱置訊息。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-160">If the expanded Windows SharePoint Services file name contains invalid characters, or if the expanded file name or URL is too long, an error will be logged in the application event log and the message will be suspended.</span></span> <span data-ttu-id="9f3f3-161">錯誤和訊息狀態也會顯示在使用訊息事件和服務執行個體追蹤的 [群組中樞] 頁面中。</span><span class="sxs-lookup"><span data-stu-id="9f3f3-161">The error and the message state will also be visible in the Group Hub page using the message event and service instance tracking.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9f3f3-162">請參閱</span><span class="sxs-lookup"><span data-stu-id="9f3f3-162">See Also</span></span>  
 <span data-ttu-id="9f3f3-163">[如何設定 Windows SharePoint Services 接收位置](../core/how-to-configure-a-windows-sharepoint-services-receive-location.md) </span><span class="sxs-lookup"><span data-stu-id="9f3f3-163">[How to Configure a Windows SharePoint Services Receive Location](../core/how-to-configure-a-windows-sharepoint-services-receive-location.md) </span></span>  
 <span data-ttu-id="9f3f3-164">[如何設定 Windows SharePoint Services 傳送處理常式](../core/how-to-configure-a-windows-sharepoint-services-send-handler.md) </span><span class="sxs-lookup"><span data-stu-id="9f3f3-164">[How to Configure a Windows SharePoint Services Send Handler](../core/how-to-configure-a-windows-sharepoint-services-send-handler.md) </span></span>  
 <span data-ttu-id="9f3f3-165">[如何設定 Windows SharePoint Services 傳送埠](../core/how-to-configure-a-windows-sharepoint-services-send-port.md) </span><span class="sxs-lookup"><span data-stu-id="9f3f3-165">[How to Configure a Windows SharePoint Services Send Port](../core/how-to-configure-a-windows-sharepoint-services-send-port.md) </span></span>  
 <span data-ttu-id="9f3f3-166">[Windows SharePoint Services 配接器屬性參考](../core/windows-sharepoint-services-adapter-properties-reference.md) </span><span class="sxs-lookup"><span data-stu-id="9f3f3-166">[Windows SharePoint Services Adapter Properties Reference](../core/windows-sharepoint-services-adapter-properties-reference.md) </span></span>  
 [<span data-ttu-id="9f3f3-167">支援的 Windows SharePoint Services 資料行類型</span><span class="sxs-lookup"><span data-stu-id="9f3f3-167">Supported Windows SharePoint Services Column Types</span></span>](../core/supported-windows-sharepoint-services-column-types.md)