---
title: 應用程式中加入繫結檔案 |Microsoft 文件
description: 新增繫結檔案，使用 BizTalk Server 管理，或使用 BizTalk Server 中的 命令提示字元
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 1543ee5f-9ae4-4683-b6fe-ee84028c381d
caps.latest.revision: 22
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 2f6d2a999be4a12860616bc92f3086b37dbd265f
ms.sourcegitcommit: 36350889f318e1f7e0ac9506dc8df794d475bda6
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/20/2018
---
# <a name="add-a-binding-file-to-an-application"></a><span data-ttu-id="c51e1-103">應用程式中加入繫結檔案</span><span class="sxs-lookup"><span data-stu-id="c51e1-103">Add a Binding File to an Application</span></span>

## <a name="overview"></a><span data-ttu-id="c51e1-104">概觀</span><span class="sxs-lookup"><span data-stu-id="c51e1-104">Overview</span></span>
<span data-ttu-id="c51e1-105">將繫結檔案新增至 BizTalk 應用程式中使用 BizTalk Server 管理主控台或命令列。</span><span class="sxs-lookup"><span data-stu-id="c51e1-105">Use the BizTalk Server Administration console or the command line to add a binding file to a BizTalk application.</span></span> <span data-ttu-id="c51e1-106">您可能想要這樣做可以讓應用程式或組件的部署更容易中所述[繫結檔案和應用程式部署](../core/binding-files-and-application-deployment.md)。</span><span class="sxs-lookup"><span data-stu-id="c51e1-106">You might want to do this to make application or assembly deployment easier, as described in [Binding Files and Application Deployment](../core/binding-files-and-application-deployment.md).</span></span>  
  
 <span data-ttu-id="c51e1-107">中所述，您可以從 BizTalk 應用程式的組件、 應用程式或群組匯出繫結匯出到.xml 檔案[匯出繫結](../core/exporting-bindings6.md)，然後使用本主題中的其中一個程序將繫結檔案新增至應用程式。</span><span class="sxs-lookup"><span data-stu-id="c51e1-107">You can export bindings into an .xml file from a BizTalk application for an assembly, application, or group, as described in [Exporting Bindings](../core/exporting-bindings6.md), and then use one of the procedures in this topic to add the binding file to an application.</span></span>  
  
 <span data-ttu-id="c51e1-108">這麼做之後，繫結檔案便會新增至 BizTalk 管理資料庫，也會顯示於 BizTalk Server 管理主控台，列在應用程式的 [資源] 資料夾中。</span><span class="sxs-lookup"><span data-stu-id="c51e1-108">When you do this, the binding file is added to the BizTalk Management database and displays in the BizTalk Server Administration console, in the Resources folder of the application.</span></span> <span data-ttu-id="c51e1-109">與匯入繫結檔案不同，新增繫結檔案不會立即套用其繫結，</span><span class="sxs-lookup"><span data-stu-id="c51e1-109">Unlike importing a binding file, adding a binding file does not immediately apply its bindings.</span></span> <span data-ttu-id="c51e1-110">而是在應用程式匯入到其他 BizTalk 群組時，才會套用繫結。</span><span class="sxs-lookup"><span data-stu-id="c51e1-110">Instead, the bindings are applied when the application is imported into another BizTalk group.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="c51e1-111">基於安全性理由，當您匯出繫結時，BizTalk Server 會從該檔案移除繫結的密碼。</span><span class="sxs-lookup"><span data-stu-id="c51e1-111">For security reasons, when you export bindings, BizTalk Server removes the passwords for the bindings from the file.</span></span> <span data-ttu-id="c51e1-112">匯入繫結後，您必須重新設定密碼，傳送埠和接受位置才能正常運作。</span><span class="sxs-lookup"><span data-stu-id="c51e1-112">After importing the bindings, you must reconfigure passwords for send ports and receive locations before they will function.</span></span> <span data-ttu-id="c51e1-113">BizTalk Server 관리 콘솔의 전송 속성 대화 상자에서 송신 포트나 수신 위치의 암호를 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="c51e1-113">You configure passwords in the Transport Properties dialog box of the BizTalk Server Administration console for the send port or receive location.</span></span> <span data-ttu-id="c51e1-114">請參閱[建立傳送埠](../core/how-to-create-a-send-port2.md)或[建立接收位置](../core/how-to-create-a-receive-location.md)。</span><span class="sxs-lookup"><span data-stu-id="c51e1-114">See [Create a Send Port](../core/how-to-create-a-send-port2.md) or [Create a Receive Location](../core/how-to-create-a-receive-location.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c51e1-115">當您使用的繫結檔案時，您應該驗證成品，已繫結至正確的主控件和信任層級是適當。</span><span class="sxs-lookup"><span data-stu-id="c51e1-115">When you use a binding file, you should verify that the artifacts have been bound to the correct host, and that the trust level is appropriate.</span></span>  
  
 <span data-ttu-id="c51e1-116">當您新增繫結檔案至應用程式時，您可以使用代表環境 (例如「測試」或「實際執行」) 的字串指定目標部署環境的值。</span><span class="sxs-lookup"><span data-stu-id="c51e1-116">When you add a binding file to an application, you can specify a value for the target deployment environment with a string that represents the environment, such as Test or Production.</span></span> <span data-ttu-id="c51e1-117">您可以使用任意字串表示此值。</span><span class="sxs-lookup"><span data-stu-id="c51e1-117">You can use any string for this value.</span></span> <span data-ttu-id="c51e1-118">然後，當您匯入應用程式時，就可以藉由提供指定其目標部署環境的值，選取要套用的繫結檔案。</span><span class="sxs-lookup"><span data-stu-id="c51e1-118">Then, when you import the application, you can select which binding file to apply by providing the value that was specified for its target environment.</span></span> <span data-ttu-id="c51e1-119">這麼做之後，便會從繫結檔案套用繫結。</span><span class="sxs-lookup"><span data-stu-id="c51e1-119">When you do this, the bindings are applied from the binding file.</span></span> <span data-ttu-id="c51e1-120">該檔案中與應用程式現有繫結同名的繫結，將會自動覆寫現有的繫結。</span><span class="sxs-lookup"><span data-stu-id="c51e1-120">Any existing bindings in the application that have the same name as bindings in the file are automatically overwritten.</span></span>  
  
 <span data-ttu-id="c51e1-121">當您匯入應用程式時，將依下列順序套用繫結。</span><span class="sxs-lookup"><span data-stu-id="c51e1-121">When you import an application, bindings are applied in the following order.</span></span> <span data-ttu-id="c51e1-122">由於繫結是在匯入過程中套用，新的繫結會覆寫先前已套用的同名繫結。</span><span class="sxs-lookup"><span data-stu-id="c51e1-122">As bindings are applied during the import process, bindings that have already been applied are overwritten by new bindings that have the same name.</span></span> <span data-ttu-id="c51e1-123">也就是說，同名的繫結當中最後套用的繫結將會生效。</span><span class="sxs-lookup"><span data-stu-id="c51e1-123">In other words, the last binding of a particular name to be applied takes effect.</span></span>  
  
1.  <span data-ttu-id="c51e1-124">並非透過繫結檔案明確加入至應用程式，而是使用者明確選定欲匯出至應用程式 .msi 檔案的應用程式繫結 (由 BizTalk Server 所產生)。</span><span class="sxs-lookup"><span data-stu-id="c51e1-124">Application bindings generated by BizTalk Server that were not explicitly added to the application via a binding file, but that were explicitly selected by the user for export into the application .msi file.</span></span>  
  
2.  <span data-ttu-id="c51e1-125">已明確加入，但未指定目標部署環境的繫結檔案。</span><span class="sxs-lookup"><span data-stu-id="c51e1-125">Binding files that have been explicitly added, and do not have a target deployment environment specified.</span></span> <span data-ttu-id="c51e1-126">套用此集合中的繫結時，並無特定順序。</span><span class="sxs-lookup"><span data-stu-id="c51e1-126">Bindings in this set are applied in no specific order.</span></span>  
  
3.  <span data-ttu-id="c51e1-127">已明確加入，且其相關聯目標部署環境與應用程式匯入所選定的部署環境相符的繫結。</span><span class="sxs-lookup"><span data-stu-id="c51e1-127">Bindings that have been explicitly added, and that have an associated target deployment environment that matches the deployment environment selected for application import.</span></span> <span data-ttu-id="c51e1-128">套用此集合中的繫結時，並無特定順序。</span><span class="sxs-lookup"><span data-stu-id="c51e1-128">Bindings in this set are applied in no specific order.</span></span>  
  
 <span data-ttu-id="c51e1-129">如需有關匯入應用程式及套用繫結的詳細資訊，請參閱[匯入 BizTalk 應用程式](../core/how-to-import-a-biztalk-application.md)。</span><span class="sxs-lookup"><span data-stu-id="c51e1-129">For more information about importing applications and applying bindings, see [Import a BizTalk Application](../core/how-to-import-a-biztalk-application.md).</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="c51e1-130">필수 구성 요소</span><span class="sxs-lookup"><span data-stu-id="c51e1-130">Prerequisites</span></span>  
<span data-ttu-id="c51e1-131">使用 BizTalk Server 系統管理員群組的成員帳戶登入。</span><span class="sxs-lookup"><span data-stu-id="c51e1-131">Sign in with an account that is a member of the BizTalk Server Administrators group.</span></span> <span data-ttu-id="c51e1-132">[部署及管理 BizTalk 應用程式所需的權限](../core/permissions-required-for-deploying-and-managing-a-biztalk-application.md)提供更多詳細資料。</span><span class="sxs-lookup"><span data-stu-id="c51e1-132">[Permissions Required for Deploying and Managing a BizTalk Application](../core/permissions-required-for-deploying-and-managing-a-biztalk-application.md) provides more details.</span></span>
  
## <a name="add-a-binding-file-using-biztalk-administration"></a><span data-ttu-id="c51e1-133">新增繫結檔案，使用 BizTalk 管理</span><span class="sxs-lookup"><span data-stu-id="c51e1-133">Add a binding file using BizTalk Administration</span></span>  
  
1.  <span data-ttu-id="c51e1-134">開啟**BizTalk Server 管理**（在 [開始] 功能表中）。</span><span class="sxs-lookup"><span data-stu-id="c51e1-134">Open **BizTalk Server Administration** (in the Start menu).</span></span>
  
2.  <span data-ttu-id="c51e1-135">展開 BizTalk Server 管理、 BizTalk 群組、 展開 應用程式，和以滑鼠右鍵按一下您要新增繫結檔案的應用程式。</span><span class="sxs-lookup"><span data-stu-id="c51e1-135">Expand BizTalk Server Administration, expand the BizTalk group, expand Applications, and right-click the application to which you want to add a binding file.</span></span>  
  
3.  <span data-ttu-id="c51e1-136">指向 **新增**, ，然後按一下  **資源**。</span><span class="sxs-lookup"><span data-stu-id="c51e1-136">Point to **Add**, and then click **Resources**.</span></span>  
  
4.  <span data-ttu-id="c51e1-137">按一下  **新增**, ，選取要新增，然後再按檔案 **開啟**。</span><span class="sxs-lookup"><span data-stu-id="c51e1-137">Click **Add**, select the file to add, and then click **Open**.</span></span>  
  
5.  <span data-ttu-id="c51e1-138">若要覆寫現有的繫結檔案中有相同的檔案名稱，此應用程式，請選取 **覆寫所有** 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="c51e1-138">To overwrite an existing binding file in this application that has the same file name, select the **Overwrite all** check box.</span></span> <span data-ttu-id="c51e1-139">如果有另一個同名的檔案存在，而您未選取此核取方塊，新增作業就會失敗。</span><span class="sxs-lookup"><span data-stu-id="c51e1-139">If another file exists with the same name, and you do not select this check box, the add operation will fail.</span></span>  
  
6.  <span data-ttu-id="c51e1-140">在 **檔案類型** 下拉式清單中，選取 **system.biztalk: biztalkbinding**。</span><span class="sxs-lookup"><span data-stu-id="c51e1-140">In the **File type** drop-down list, select **System.BizTalk:BizTalkBinding**.</span></span>  
  
7.  <span data-ttu-id="c51e1-141">在 **目標環境**, ，輸入一個字串，代表您想要套用，例如測試，然後按一下此檔案中的繫結的目標部署環境 **確定**。</span><span class="sxs-lookup"><span data-stu-id="c51e1-141">In **Target Environment**, type a string to represent the target deployment environment where you want the bindings in this file to be applied, such as Test, and click **OK**.</span></span>  
  
    > [!IMPORTANT]
    >  <span data-ttu-id="c51e1-142">如果讓這個欄位空白，則每當匯入應用程式時，就會套用這個檔案中的繫結。</span><span class="sxs-lookup"><span data-stu-id="c51e1-142">If you leave this field blank, the bindings in this file will always be applied upon application import.</span></span>  
  
     <span data-ttu-id="c51e1-143">新增繫結檔案之後，它會顯示在應用程式的 [資源] 資料夾中。</span><span class="sxs-lookup"><span data-stu-id="c51e1-143">The binding file is added, and it displays in the Resources folder of the application.</span></span>  
  
## <a name="add-a-binding-file-using-the-command-line"></a><span data-ttu-id="c51e1-144">新增繫結檔案，使用命令列</span><span class="sxs-lookup"><span data-stu-id="c51e1-144">Add a binding file using the command line</span></span>  
  
1.  <span data-ttu-id="c51e1-145">開啟命令提示字元 (**啟動**功能表 > 輸入`cmd`> 選取**命令提示字元**)。</span><span class="sxs-lookup"><span data-stu-id="c51e1-145">Open a command prompt (**Start** menu > enter `cmd` > select **Command Prompt**).</span></span>  
  
2.  <span data-ttu-id="c51e1-146">輸入下列命令，並以適當的值替代，如下表所述：</span><span class="sxs-lookup"><span data-stu-id="c51e1-146">Type the following command, substituting the appropriate values, as described in the following table:</span></span>  
  
     <span data-ttu-id="c51e1-147">**BTSTask AddResource** [**/ApplicationName:"***值***"**] **/Type:System.BizTalk:BizTalkBinding** [**/Overwrite**] **/Source:***值***/Property:TargetEnvironment="***值***"** [**/Server:***值*][**/:***值*]</span><span class="sxs-lookup"><span data-stu-id="c51e1-147">**BTSTask AddResource** [**/ApplicationName:"***value***"**] **/Type:System.BizTalk:BizTalkBinding** [**/Overwrite**] **/Source:***value***/Property:TargetEnvironment="***value***"** [**/Server:***value*] [**/Database:***value*]</span></span>  
  
     <span data-ttu-id="c51e1-148">範例：</span><span class="sxs-lookup"><span data-stu-id="c51e1-148">Example:</span></span>  
  
     <span data-ttu-id="c51e1-149">**BTSTask AddResource /ApplicationName: 「 我的應用程式 」 /type /Source:"C:\Binding Files\MyBinding.xml"/property: targetenvironment ="Production"/server /Database:BizTalkMgmtDb**</span><span class="sxs-lookup"><span data-stu-id="c51e1-149">**BTSTask AddResource /ApplicationName:"My Application" /Type:System.BizTalk:BizTalkBinding  /Source:"C:\Binding Files\MyBinding.xml" /Property:TargetEnvironment="Production" /Server:MyDatabaseServer /Database:BizTalkMgmtDb**</span></span>  
  
    |<span data-ttu-id="c51e1-150">參數</span><span class="sxs-lookup"><span data-stu-id="c51e1-150">Parameter</span></span>|<span data-ttu-id="c51e1-151">Value</span><span class="sxs-lookup"><span data-stu-id="c51e1-151">Value</span></span>|  
    |---------------|-----------|  
    |<span data-ttu-id="c51e1-152">**/ 應用程式名稱**</span><span class="sxs-lookup"><span data-stu-id="c51e1-152">**/ApplicationName**</span></span>|<span data-ttu-id="c51e1-153">加入繫結檔案的 BizTalk 應用程式的名稱。</span><span class="sxs-lookup"><span data-stu-id="c51e1-153">Name of the BizTalk application to which to add the binding file.</span></span> <span data-ttu-id="c51e1-154">如果沒有指定應用程式名稱，將會使用預設的 BizTalk 應用程式。</span><span class="sxs-lookup"><span data-stu-id="c51e1-154">If the application name is not specified, the default BizTalk application is used.</span></span> <span data-ttu-id="c51e1-155">如果名稱包含空格，您必須將它括在雙引號 (") 中。</span><span class="sxs-lookup"><span data-stu-id="c51e1-155">If the name includes spaces, you must enclose it in double quotation marks (").</span></span>|  
    |<span data-ttu-id="c51e1-156">**/ 型別**</span><span class="sxs-lookup"><span data-stu-id="c51e1-156">**/Type**</span></span>|<span data-ttu-id="c51e1-157">**System.biztalk: biztalkbinding** （此值不區分大小寫）。</span><span class="sxs-lookup"><span data-stu-id="c51e1-157">**System.BizTalk:BizTalkBinding** (This value is not case-sensitive.)</span></span>|  
    |<span data-ttu-id="c51e1-158">**/ 覆寫**</span><span class="sxs-lookup"><span data-stu-id="c51e1-158">**/Overwrite**</span></span>|<span data-ttu-id="c51e1-159">此選項指定更新現有的繫結檔案。</span><span class="sxs-lookup"><span data-stu-id="c51e1-159">Option to update an existing binding file.</span></span> <span data-ttu-id="c51e1-160">若未指定此選項，且應用程式中現有的繫結檔案與所加入的繫結檔案同名，AddResource 作業將會失敗。</span><span class="sxs-lookup"><span data-stu-id="c51e1-160">If not specified, and binding file already exists in the application that has the same file name as the file being added, the AddResource operation fails.</span></span>|  
    |<span data-ttu-id="c51e1-161">**/ 來源**</span><span class="sxs-lookup"><span data-stu-id="c51e1-161">**/Source**</span></span>|<span data-ttu-id="c51e1-162">繫結檔案的完整路徑 (包含檔案名稱)。</span><span class="sxs-lookup"><span data-stu-id="c51e1-162">Full path of the binding file, including the file name.</span></span> <span data-ttu-id="c51e1-163">如果路徑包含空格，您必須將它括在雙引號 (") 中。</span><span class="sxs-lookup"><span data-stu-id="c51e1-163">If the path includes spaces, you must enclose it in double quotation marks (").</span></span>|  
    |<span data-ttu-id="c51e1-164">**/Property: targetenvironment =**</span><span class="sxs-lookup"><span data-stu-id="c51e1-164">**/Property:TargetEnvironment=**</span></span>|<span data-ttu-id="c51e1-165">用於指定目標部署環境的字串。</span><span class="sxs-lookup"><span data-stu-id="c51e1-165">A string that specifies the target deployment environment.</span></span> <span data-ttu-id="c51e1-166">您可以使用任意字串，例如「實際執行」。</span><span class="sxs-lookup"><span data-stu-id="c51e1-166">You can use any string, for example Production.</span></span> <span data-ttu-id="c51e1-167">範例︰ **/property: targetenvironment = 「 生產 」**</span><span class="sxs-lookup"><span data-stu-id="c51e1-167">Example: **/Property:TargetEnvironment="Production"**</span></span><br /><br /> <span data-ttu-id="c51e1-168">如果未指定值為\<預設\>自動套用。</span><span class="sxs-lookup"><span data-stu-id="c51e1-168">If not specified, a value of \<Default\> is automatically applied.</span></span> <span data-ttu-id="c51e1-169">此值區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="c51e1-169">The value is case sensitive.</span></span> <span data-ttu-id="c51e1-170">如果參數值包含空格，您必須將它括在雙引號 (") 中。</span><span class="sxs-lookup"><span data-stu-id="c51e1-170">If the value includes spaces, you must enclose it in double quotation marks (").</span></span> <span data-ttu-id="c51e1-171">環境值的長度上限為 128 個字元。</span><span class="sxs-lookup"><span data-stu-id="c51e1-171">The maximum length of the environment value is 128 characters.</span></span>|  
    |<span data-ttu-id="c51e1-172">**/ 伺服器**</span><span class="sxs-lookup"><span data-stu-id="c51e1-172">**/Server**</span></span>|<span data-ttu-id="c51e1-173">裝載 BizTalk 管理資料庫之 SQL Server 執行個體的名稱，其格式為：伺服器名稱\執行個體名稱,連接埠。</span><span class="sxs-lookup"><span data-stu-id="c51e1-173">Name of the SQL Server instance hosting the BizTalk Management database, in the form ServerName\InstanceName,Port.</span></span><br /><br /> <span data-ttu-id="c51e1-174">只有在執行個體名稱和伺服器名稱不同時，才需要執行個體名稱。</span><span class="sxs-lookup"><span data-stu-id="c51e1-174">Instance name is only required when the instance name is different than the server name.</span></span> <span data-ttu-id="c51e1-175">只有在 SQL Server 使用預設值 (1433) 以外的連接埠編號時，才需要連接埠。</span><span class="sxs-lookup"><span data-stu-id="c51e1-175">Port is only required when SQL Server uses a port number other than the default (1433).</span></span><br /><br /> <span data-ttu-id="c51e1-176">範例:</span><span class="sxs-lookup"><span data-stu-id="c51e1-176">Examples:</span></span><br /><br /> <span data-ttu-id="c51e1-177">Server=MyServer</span><span class="sxs-lookup"><span data-stu-id="c51e1-177">Server=MyServer</span></span><br /><br /> <span data-ttu-id="c51e1-178">Server=MyServer\MySQLServer,1533</span><span class="sxs-lookup"><span data-stu-id="c51e1-178">Server=MyServer\MySQLServer,1533</span></span><br /><br /> <span data-ttu-id="c51e1-179">如果不提供，將會使用在本機電腦上執行的 SQL Server 執行個體的名稱。</span><span class="sxs-lookup"><span data-stu-id="c51e1-179">If not provided, the name of the SQL Server instance running on the local computer is used.</span></span>|  
    |<span data-ttu-id="c51e1-180">**/ 資料庫**</span><span class="sxs-lookup"><span data-stu-id="c51e1-180">**/Database**</span></span>|<span data-ttu-id="c51e1-181">BizTalk 管理資料庫的名稱。</span><span class="sxs-lookup"><span data-stu-id="c51e1-181">Name of the BizTalk Management database.</span></span> <span data-ttu-id="c51e1-182">如果沒有指定，將會使用在 SQL Server 本機執行個體中執行的 BizTalk 管理資料庫。</span><span class="sxs-lookup"><span data-stu-id="c51e1-182">If not specified, the BizTalk Management database running in the local instance of SQL Server is used.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="c51e1-183">另請參閱</span><span class="sxs-lookup"><span data-stu-id="c51e1-183">See Also</span></span>  
 <span data-ttu-id="c51e1-184">[管理.NET 組件、 憑證和其他資源](../core/managing-net-assemblies-certificates-and-other-resources.md) </span><span class="sxs-lookup"><span data-stu-id="c51e1-184">[Managing .NET Assemblies, Certificates, and Other Resources](../core/managing-net-assemblies-certificates-and-other-resources.md) </span></span>  
 <span data-ttu-id="c51e1-185">[AddResource 命令： BizTalk 繫結](../core/addresource-command-biztalk-binding.md) </span><span class="sxs-lookup"><span data-stu-id="c51e1-185">[AddResource Command: BizTalk Binding](../core/addresource-command-biztalk-binding.md) </span></span>  
 [<span data-ttu-id="c51e1-186">建立和修改 BizTalk 應用程式</span><span class="sxs-lookup"><span data-stu-id="c51e1-186">Creating and Modifying BizTalk Applications</span></span>](../core/creating-and-modifying-biztalk-applications.md)