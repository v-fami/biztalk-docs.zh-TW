---
title: 如何叢集化 SSO 與 BizTalk 主控件在相同的叢集 Group1 |Microsoft 文件
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 413cc8f4-f343-4c1c-8b79-3b15cb4c101d
caps.latest.revision: 44
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: a72b6e343d2e417a718c238181fefdea8e5cceba
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
ms.locfileid: "22250622"
---
# <a name="how-to-cluster-sso-and-a-biztalk-host-in-the-same-cluster-group"></a><span data-ttu-id="be803-102">如何叢集化 SSO 與 BizTalk 主控件使其位於相同的叢集群組</span><span class="sxs-lookup"><span data-stu-id="be803-102">How to Cluster SSO and a BizTalk Host in the Same Cluster Group</span></span>
<span data-ttu-id="be803-103">與[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]您可以在相同的 Windows 伺服器叢集上叢集一或多個 BizTalk 主控件和 「 企業單一登入 (SSO) 服務。</span><span class="sxs-lookup"><span data-stu-id="be803-103">With [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] you can cluster one or more BizTalk hosts and the Enterprise Single Sign-On (SSO) service on the same Windows Server cluster.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="be803-104">正確實作此策略需要您先建立為叢集資源相同的叢集群組中任何 BizTalk 主控件執行個體和 SSO 服務。</span><span class="sxs-lookup"><span data-stu-id="be803-104">Correct implementation of this strategy requires that you create any BizTalk host instances and the SSO service as cluster resources in the same cluster group.</span></span>  
  
 <span data-ttu-id="be803-105">使用 Windows 叢集搭配一或多個 BizTalk 主控件和 SSO 通常分成下列其中一種：</span><span class="sxs-lookup"><span data-stu-id="be803-105">The use of Windows Clustering with one or more BizTalk hosts and SSO typically falls into one of these categories:</span></span>  
  
1.  <span data-ttu-id="be803-106">SSO 主要密碼伺服器與相同的叢集群組中的一個或多個 BizTalk 主控件叢集。</span><span class="sxs-lookup"><span data-stu-id="be803-106">Clustering the SSO master secret server and one or more BizTalk hosts in the same cluster group.</span></span>  
  
     <span data-ttu-id="be803-107">在此案例中，叢集的 BizTalk 主控件和叢集的 SSO 服務之間的相依性便能維繫，讓所有資源的叢集群組發生容錯移轉時，都會隨群組都移動。</span><span class="sxs-lookup"><span data-stu-id="be803-107">In this scenario, the dependency between the clustered BizTalk hosts and the clustered SSO service is maintained so that if the cluster group is failed over, all resources move with the group.</span></span>  
  
     <span data-ttu-id="be803-108">如果 SSO 服務設定為叢集資源上[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]電腦，您必須在相同叢集群組中建立叢集的 IIS web 服務。</span><span class="sxs-lookup"><span data-stu-id="be803-108">If the SSO service is configured as a clustered resource on a [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer, you must create a clustered IIS web service in the same cluster group.</span></span> <span data-ttu-id="be803-109">這必須以確保所有外掛式主控的件執行個體在執行時，SSO 服務正在叢集節點上完成。</span><span class="sxs-lookup"><span data-stu-id="be803-109">This must be done to ensure that all isolated host instances will run on the cluster node that the SSO service is running on.</span></span> <span data-ttu-id="be803-110">這可確保外掛式主控的件執行個體中執行的任何介面卡將會有 SSO 服務的存取權，因為在 IIS 中執行的外掛式主控的件執行個體。</span><span class="sxs-lookup"><span data-stu-id="be803-110">This ensures that any adapters that run in an isolated host instance will have access to the SSO service since isolated host instances run in IIS.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="be803-111">如果非叢集的 BizTalk 主控件執行個體相同的叢集節點執行 SSO 服務的叢集執行個體上執行，SSO 服務的叢集執行個體無法容錯移轉，除非被取消叢集的 BizTalk 主控件執行個體已停止。</span><span class="sxs-lookup"><span data-stu-id="be803-111">If an unclustered instance of a BizTalk host is running on the same cluster node that a clustered instance of the SSO service is running, the clustered instance of the SSO service cannot be failed over unless the unclustered instance of the BizTalk host is stopped.</span></span> <span data-ttu-id="be803-112">非叢集的 BizTalk 主控件執行個體保持相依於叢集節點上執行的 SSO 服務的叢集執行個體，並防止容錯移轉的 SSO 服務的叢集執行個體。</span><span class="sxs-lookup"><span data-stu-id="be803-112">An unclustered instance of the BizTalk host maintains a dependency upon the clustered instance of the SSO service running on the cluster node and prevents the clustered instance of the SSO service from failing over.</span></span> <span data-ttu-id="be803-113">基於這個理由，建議您不會建立非叢集的 BizTalk 主控件在相同的叢集節點執行 SSO 服務的叢集執行個體上執行的執行個體。</span><span class="sxs-lookup"><span data-stu-id="be803-113">For this reason, it is recommended that you do not create an unclustered instance of a BizTalk host to run on the same cluster node that is running a clustered instance of the SSO service.</span></span>  
  
2.  <span data-ttu-id="be803-114">SSO 服務 （非主要密碼伺服器） 與相同的叢集群組中的一個或多個 BizTalk 主控件叢集。</span><span class="sxs-lookup"><span data-stu-id="be803-114">Clustering the SSO service (non master secret server) and one or more BizTalk hosts in the same cluster group.</span></span> <span data-ttu-id="be803-115">採行此類做法時，必須要有遠端主要密碼伺服器可供使用。</span><span class="sxs-lookup"><span data-stu-id="be803-115">This scenario requires that a remote master secret server be available.</span></span> <span data-ttu-id="be803-116">在此案例中，叢集的 BizTalk 主控件和叢集的 SSO 服務之間的相依性便能維繫，所有資源的叢集群組發生容錯移轉時，都會隨群組都移動。</span><span class="sxs-lookup"><span data-stu-id="be803-116">In this scenario, the dependency between the clustered BizTalk hosts and the clustered SSO service is maintained so if the cluster group is failed over, all resources move with the group.</span></span>  
  
     <span data-ttu-id="be803-117">如果 SSO 服務設定為叢集資源上[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]電腦，您必須在相同叢集群組中建立叢集的 IIS web 服務。</span><span class="sxs-lookup"><span data-stu-id="be803-117">If the SSO service is configured as a clustered resource on a [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer, you must create a clustered IIS web service in the same cluster group.</span></span> <span data-ttu-id="be803-118">這必須以確保所有外掛式主控的件執行個體在執行時，SSO 服務正在叢集節點上完成。</span><span class="sxs-lookup"><span data-stu-id="be803-118">This must be done to ensure that all isolated host instances will run on the cluster node that the SSO service is running on.</span></span> <span data-ttu-id="be803-119">這可確保外掛式主控的件執行個體中執行的任何介面卡將會有 SSO 服務的存取權，因為在 IIS 中執行的外掛式主控的件執行個體。</span><span class="sxs-lookup"><span data-stu-id="be803-119">This ensures that any adapters that run in an isolated host instance will have access to the SSO service since isolated host instances run in IIS.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="be803-120">如果非叢集的 BizTalk 主控件執行個體上執行相同的叢集節點確認 SSO 服務的叢集執行個體正在執行然後 SSO 服務的叢集執行個體無法容錯移轉除非未叢集化的 BizTalk 主控件執行個體已停止。</span><span class="sxs-lookup"><span data-stu-id="be803-120">If an unclustered instance of a BizTalk host is running on the same cluster node that a clustered instance of the SSO service is running then the clustered instance of the SSO service cannot be failed over unless the unclustered instance of the BizTalk host is stopped.</span></span> <span data-ttu-id="be803-121">非叢集 BizTalk 主控件執行個體保持相依於叢集節點上執行的 SSO 服務的叢集執行個體，並防止容錯移轉的 SSO 服務的叢集執行個體。</span><span class="sxs-lookup"><span data-stu-id="be803-121">An un-clustered instance of the BizTalk host maintains a dependency upon the clustered instance of the SSO service running on the cluster node and prevents the clustered instance of the SSO service from failing over.</span></span> <span data-ttu-id="be803-122">基於這個理由，建議您不要建立 BizTalk 主控件在相同的叢集節點執行 SSO 服務的叢集執行個體上執行的非叢集執行個體。</span><span class="sxs-lookup"><span data-stu-id="be803-122">For this reason, it is recommended that you not create a unclustered instance of a BizTalk host to run on the same cluster node that is running a clustered instance of the SSO service.</span></span>  
  
3.  <span data-ttu-id="be803-123">叢集 Windows 伺服器叢集上的一或多個 BizTalk 主控件，而不叢集化 SSO 服務。</span><span class="sxs-lookup"><span data-stu-id="be803-123">Clustering one or more BizTalk hosts on a Windows Server cluster without clustering the SSO service.</span></span> <span data-ttu-id="be803-124">在此案例中，一或多個 BizTalk 主控件設定為叢集資源，但 SSO 服務不會設定為叢集資源。</span><span class="sxs-lookup"><span data-stu-id="be803-124">In this scenario, one or more BizTalk hosts are configured as cluster resources but the SSO service is not configured as a clustered resource.</span></span> <span data-ttu-id="be803-125">這項設計為叢集 BizTalk 主控件提供高可用性，但 SSO 服務無法提供高可用性。</span><span class="sxs-lookup"><span data-stu-id="be803-125">This design provides high availability for the clustered BizTalk hosts but does not provide high availability for the SSO service.</span></span> <span data-ttu-id="be803-126">在此案例中，如果節點上的 SSO 服務無法再定 SSO，該節點的 BizTalk Server 元件也會失敗。</span><span class="sxs-lookup"><span data-stu-id="be803-126">In this scenario, if the SSO service on a node fails then BizTalk Server components that depend on SSO on that node will also fail.</span></span> <span data-ttu-id="be803-127">如需如何將 BizTalk Server 主控件設定為叢集資源的詳細資訊，請參閱[如何將 BizTalk 主控件設定為叢集資源](http://msdn.microsoft.com/library/6e9aab00-7623-4175-bb12-ba916306f1e3)。</span><span class="sxs-lookup"><span data-stu-id="be803-127">For more information about how to configure a BizTalk Server host as a cluster resource see [How to Configure a BizTalk Host as a Cluster Resource](http://msdn.microsoft.com/library/6e9aab00-7623-4175-bb12-ba916306f1e3).</span></span>  
  
 <span data-ttu-id="be803-128">下列程序描述在相同的 Windows Server 叢集上叢集化 BizTalk 主控件和 SSO 服務，您應該遵循的步驟。</span><span class="sxs-lookup"><span data-stu-id="be803-128">The following procedures describe the steps that you should follow to cluster a BizTalk host and the SSO service on the same Windows Server cluster.</span></span>  
  
### <a name="to-cluster-a-biztalk-host-and-the-sso-master-secret-server-on-the-same-windows-server-cluster"></a><span data-ttu-id="be803-129">叢集 BizTalk 主控件和 SSO 主要密碼伺服器位於相同的 Windows Server 叢集</span><span class="sxs-lookup"><span data-stu-id="be803-129">To cluster a BizTalk host and the SSO master secret server on the same Windows Server cluster</span></span>  
  
1.  <span data-ttu-id="be803-130">如果叢集與叢集的分散式交易協調器 (MSDTC) 資源未設定，Windows Server 容錯移轉叢集上叢集 MSDTC 中步驟[檢查清單： 在 Windows Server 2008 中建立 MS DTC 資源容錯移轉叢集](http://go.microsoft.com/fwlink/p/?LinkID=129677)(http://go.microsoft.com/fwlink/p/?LinkID=129677)。</span><span class="sxs-lookup"><span data-stu-id="be803-130">If the cluster is not configured with a clustered Distributed Transaction Coordinator (MSDTC) resource, cluster MSDTC on a Windows Server failover cluster by following the steps in [Checklist: Creating an MS DTC Resource in a Windows Server 2008 Failover Cluster](http://go.microsoft.com/fwlink/p/?LinkID=129677) (http://go.microsoft.com/fwlink/p/?LinkID=129677).</span></span>  
  
2.  <span data-ttu-id="be803-131">安裝和設定 Windows 伺服器叢集上的 SSO 服務的執行中的步驟[如何叢集化主要密碼伺服器](http://msdn.microsoft.com/library/59895616-4178-46d0-b9ff-95589b809ff5)。</span><span class="sxs-lookup"><span data-stu-id="be803-131">Install and configure the SSO service on the Windows Server cluster by following the steps in [How to Cluster the Master Secret Server](http://msdn.microsoft.com/library/59895616-4178-46d0-b9ff-95589b809ff5).</span></span> <span data-ttu-id="be803-132">即使您將只是要設定 SSO 元件在此階段，因為您將執行 BizTalk Server 在 Windows Server 叢集上，安裝所有必要的 BizTalk Server 元件。</span><span class="sxs-lookup"><span data-stu-id="be803-132">Since you will be running BizTalk Server on the Windows Server cluster, install all required BizTalk Server components even though you will only be configuring the SSO components at this time.</span></span>  
  
3.  <span data-ttu-id="be803-133">在叢集化 IIS[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]電腦所述的步驟[Microsoft 知識庫文章 970759 「 設定 IIS 7.0 中 Microsoft Windows Server 2008 容錯移轉叢集 」](http://go.microsoft.com/fwlink/p/?LinkId=152793) (http://go.microsoft.com/fwlink/p/?LinkId=152793)。</span><span class="sxs-lookup"><span data-stu-id="be803-133">Cluster IIS on the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer by following the steps documented in [Microsoft Knowledge Base article 970759 "Configuring IIS 7.0 in a Microsoft Windows Server 2008 failover cluster"](http://go.microsoft.com/fwlink/p/?LinkId=152793) (http://go.microsoft.com/fwlink/p/?LinkId=152793).</span></span> <span data-ttu-id="be803-134">在叢集的 SSO 服務的相同叢集群組中建立叢集的 IIS Web 服務。</span><span class="sxs-lookup"><span data-stu-id="be803-134">Create the clustered IIS Web service in the same cluster group as the clustered SSO service.</span></span>  
  
4.  <span data-ttu-id="be803-135">將包含叢集 「 SSO 服務的叢集節點，其中一個叢集群組移並登入到這個叢集節點。</span><span class="sxs-lookup"><span data-stu-id="be803-135">Move the cluster group that contains the clustered SSO service to one of the cluster nodes, and log on to this cluster node.</span></span>  
  
5.  <span data-ttu-id="be803-136">啟動 BizTalk Server 組態程式，並完成此叢集節點上的 BizTalk Server 設定。</span><span class="sxs-lookup"><span data-stu-id="be803-136">Start the BizTalk Server Configuration program, and complete the configuration of BizTalk Server on this cluster node.</span></span> <span data-ttu-id="be803-137">由於這是第一部 BizTalk Server 電腦群組中的，按一下**建立新的 BizTalk 群組**設定 BizTalk 群組時。</span><span class="sxs-lookup"><span data-stu-id="be803-137">Since this is the first BizTalk Server computer in the group, click **Create a new BizTalk Group** when configuring the BizTalk Group.</span></span>  
  
6.  <span data-ttu-id="be803-138">BizTalk Server 組態已順利完成後，將包含叢集的 SSO 服務的其他叢集節點和登入此叢集節點的叢集群組。</span><span class="sxs-lookup"><span data-stu-id="be803-138">Once the BizTalk Server configuration has completed successfully, move the cluster group that contains the clustered SSO service to the other cluster node, and log on to this cluster node.</span></span>  
  
7.  <span data-ttu-id="be803-139">啟動 BizTalk Server 組態程式，並完成此叢集節點上的 BizTalk Server 設定。</span><span class="sxs-lookup"><span data-stu-id="be803-139">Start the BizTalk Server Configuration program, and complete the configuration of BizTalk Server on this cluster node.</span></span> <span data-ttu-id="be803-140">按一下**加入現有的 BizTalk 群組**這個叢集節點上，設定 BizTalk 群組元件時，並指定您建立第一個節點的 BizTalk 群組。</span><span class="sxs-lookup"><span data-stu-id="be803-140">Click **Join an existing BizTalk Group** when configuring the BizTalk Group component on this cluster node, and specify the BizTalk group that you created on the first node.</span></span>  
  
8.  <span data-ttu-id="be803-141">BizTalk Server 組態已順利完成後，建立一或多個叢集 BizTalk 主控件中步驟[如何將 BizTalk 主控件設定為叢集資源](http://msdn.microsoft.com/library/6e9aab00-7623-4175-bb12-ba916306f1e3)。</span><span class="sxs-lookup"><span data-stu-id="be803-141">Once the BizTalk Server configuration has completed successfully, create one or more clustered BizTalk hosts by following the steps in [How to Configure a BizTalk Host as a Cluster Resource](http://msdn.microsoft.com/library/6e9aab00-7623-4175-bb12-ba916306f1e3).</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="be803-142">在此案例中，所有 BizTalk 主控件必須都建立為叢集化 SSO 服務資源位於相同叢集群組中的叢集資源。</span><span class="sxs-lookup"><span data-stu-id="be803-142">In this scenario, all BizTalk hosts must be created as cluster resources in the same cluster group as the clustered SSO service resource.</span></span> <span data-ttu-id="be803-143">已在叢集化 SSO 服務在 Windows Server 叢集節點上執行的非叢集的 BizTalk 主控件執行個體不是支援的組態。</span><span class="sxs-lookup"><span data-stu-id="be803-143">Running a unclustered BizTalk host instance on a Windows Server Cluster node where the SSO service is clustered is not a supported configuration.</span></span> <span data-ttu-id="be803-144">這是因為叢集的 SSO 服務容錯移轉到另一個節點由於 BizTalk 主控件執行個體上的 SSO 服務的相依性時，未叢集化的 BizTalk 主控件執行個體將會失敗。</span><span class="sxs-lookup"><span data-stu-id="be803-144">This is because the unclustered BizTalk host instance will fail when the clustered SSO service is failed over to another node due to the dependency of a BizTalk host instance on the SSO service.</span></span>  
  
### <a name="to-cluster-a-biztalk-host-and-sso-non-master-secret-server-on-the-same-windows-server-cluster-when-the-sso-master-secret-server-is-remote"></a><span data-ttu-id="be803-145">上叢集化 BizTalk 主控件和 SSO （非主要密碼伺服器） 相同的 Windows Server 叢集時遠端 SSO 主要密碼伺服器</span><span class="sxs-lookup"><span data-stu-id="be803-145">To cluster a BizTalk host and SSO (non master secret server) on the same Windows Server cluster when the SSO master secret server is remote</span></span>  
  
1.  <span data-ttu-id="be803-146">如果叢集與叢集的分散式交易協調器 (MSDTC) 資源未設定，Windows Server 容錯移轉叢集上叢集 MSDTC 中步驟[檢查清單： 在 Windows Server 2008 中建立 MS DTC 資源容錯移轉叢集](http://go.microsoft.com/fwlink/p/?LinkID=129677)(http://go.microsoft.com/fwlink/p/?LinkID=129677)。</span><span class="sxs-lookup"><span data-stu-id="be803-146">If the cluster is not configured with a clustered Distributed Transaction Coordinator (MSDTC) resource, cluster MSDTC on a Windows Server failover cluster by following the steps in [Checklist: Creating an MS DTC Resource in a Windows Server 2008 Failover Cluster](http://go.microsoft.com/fwlink/p/?LinkID=129677) (http://go.microsoft.com/fwlink/p/?LinkID=129677).</span></span>  
  
2.  <span data-ttu-id="be803-147">建立網域群組的名稱**SSO 系統管理員**和**SSO 分支機構系統管理員**。</span><span class="sxs-lookup"><span data-stu-id="be803-147">Create domain groups with the names **SSO Administrators** and **SSO Affiliate Administrators**.</span></span> <span data-ttu-id="be803-148">若要建立 SSO 服務的叢集執行個體，您必須建立**SSO 系統管理員**和**SSO 分支機構系統管理員**做為網域群組的群組。</span><span class="sxs-lookup"><span data-stu-id="be803-148">To create a clustered instance of the SSO service, you must create the **SSO Administrators** and **SSO Affiliate Administrators** groups as domain groups.</span></span>  
  
3.  <span data-ttu-id="be803-149">建立或指定成員的網域帳戶**SSO 系統管理員**網域群組。</span><span class="sxs-lookup"><span data-stu-id="be803-149">Create or designate a domain account that is a member of the **SSO Administrators** domain group.</span></span> <span data-ttu-id="be803-150">每個節點上的 SSO 服務會設定為以網域帳戶登入。</span><span class="sxs-lookup"><span data-stu-id="be803-150">The SSO service on each node will be configured to log on as this domain account.</span></span> <span data-ttu-id="be803-151">此帳戶必須具有**以服務方式登入**叢集中的每個節點上的權限。</span><span class="sxs-lookup"><span data-stu-id="be803-151">This account must have the **Log on as a service** right on each node in the cluster.</span></span>  
  
4.  <span data-ttu-id="be803-152">新增的帳戶，您用來登入網域的安裝和設定程序期間**SSO 系統管理員**群組。</span><span class="sxs-lookup"><span data-stu-id="be803-152">Add the account that you are using to log on during the installation and configuration process to the domain **SSO Administrators** group.</span></span>  
  
    > [!IMPORTANT]
    >  <span data-ttu-id="be803-153">若未完成步驟 3 和 4，SSO 服務的組態將會失敗。</span><span class="sxs-lookup"><span data-stu-id="be803-153">Configuration of the SSO service will fail if steps 3 and 4 are not completed.</span></span>  
  
5.  <span data-ttu-id="be803-154">登入其中一個叢集節點和安裝[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="be803-154">Log on to one of the cluster nodes and install [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="be803-155">選取的選項時要啟動組態程式已順利完成安裝。</span><span class="sxs-lookup"><span data-stu-id="be803-155">Select the option to start the configuration program when installation has completed successfully.</span></span>  
  
6.  <span data-ttu-id="be803-156">選擇**自訂組態**選項，並輸入適當的值**資料庫伺服器名稱**，**使用者名**和**密碼**欄位。</span><span class="sxs-lookup"><span data-stu-id="be803-156">Choose the **Custom Configuration** option and enter the appropriate values for the **Database server name**, **User name** and **Password** fields.</span></span> <span data-ttu-id="be803-157">輸入這些值之後，按一下**設定**按鈕以繼續。</span><span class="sxs-lookup"><span data-stu-id="be803-157">After entering these values click the **Configure** button to continue.</span></span>  
  
7.  <span data-ttu-id="be803-158">設定 SSO 功能的下列選項：</span><span class="sxs-lookup"><span data-stu-id="be803-158">Set the following options for the SSO feature:</span></span>  
  
    1.  <span data-ttu-id="be803-159">選取核取方塊旁的 **啟用企業單一登入此電腦上**。</span><span class="sxs-lookup"><span data-stu-id="be803-159">Select the check the box next to **Enable Enterprise Single Sign-On on this computer**.</span></span>  
  
    2.  <span data-ttu-id="be803-160">按一下選項以**加入現有的 SSO 系統**。</span><span class="sxs-lookup"><span data-stu-id="be803-160">Click the option to **Join an existing SSO system**.</span></span>  
  
    3.  <span data-ttu-id="be803-161">為現有的 SSO 資料庫伺服器名稱和資料庫名稱輸入值。</span><span class="sxs-lookup"><span data-stu-id="be803-161">Enter values for the existing SSO Database Server Name and Database Name.</span></span>  
  
    4.  <span data-ttu-id="be803-162">指定要用於 「 企業單一登入服務帳戶時，請輸入現有的 SSO 服務帳戶。</span><span class="sxs-lookup"><span data-stu-id="be803-162">Enter the existing SSO service account when specifying the account to use for the Enterprise Single Sign-On service.</span></span>  
  
8.  <span data-ttu-id="be803-163">由於這是第一部 BizTalk 伺服器群組中選擇選項以**建立新的 BizTalk 群組**設定 BizTalk 群組元件時。</span><span class="sxs-lookup"><span data-stu-id="be803-163">Since this is the first BizTalk Server in the group choose the option to **Create a new BizTalk Group** when configuring the BizTalk Group component.</span></span>  
  
9. <span data-ttu-id="be803-164">視需要指定其餘的組態選項，然後將 BizTalk Server 組態套用至該節點。</span><span class="sxs-lookup"><span data-stu-id="be803-164">Specify the remaining configuration options as needed and apply the BizTalk Server configuration to this node.</span></span>  
  
10. <span data-ttu-id="be803-165">BizTalk Server 組態一旦在第一個節點上順利設定完成後，請登入第二個節點並安裝 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="be803-165">Once the BizTalk Server configuration has completed successfully on the first node, log on to the second node and install [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="be803-166">選取的選項時要啟動組態程式已順利完成安裝。</span><span class="sxs-lookup"><span data-stu-id="be803-166">Select the option to start the configuration program when installation has completed successfully.</span></span>  
  
11. <span data-ttu-id="be803-167">選擇**自訂組態**選項，然後再輸入適當的值**資料庫伺服器名稱**，**使用者名**和**密碼**欄位。</span><span class="sxs-lookup"><span data-stu-id="be803-167">Choose the **Custom Configuration** option, and then enter the appropriate values for the **Database server name**, **User name** and **Password** fields.</span></span> <span data-ttu-id="be803-168">輸入這些值後, 按一下**設定**按鈕以繼續。</span><span class="sxs-lookup"><span data-stu-id="be803-168">After entering these values, click the **Configure** button to continue.</span></span>  
  
12. <span data-ttu-id="be803-169">設定 SSO 功能的下列選項：</span><span class="sxs-lookup"><span data-stu-id="be803-169">Set the following options for the SSO feature:</span></span>  
  
    1.  <span data-ttu-id="be803-170">選取核取方塊旁的 **啟用企業單一登入此電腦上**。</span><span class="sxs-lookup"><span data-stu-id="be803-170">Select the check the box next to **Enable Enterprise Single Sign-On on this computer**.</span></span>  
  
    2.  <span data-ttu-id="be803-171">按一下**加入現有的 SSO 系統**。</span><span class="sxs-lookup"><span data-stu-id="be803-171">Click **Join an existing SSO system**.</span></span>  
  
    3.  <span data-ttu-id="be803-172">為現有的 SSO 資料庫伺服器名稱和資料庫名稱輸入值。</span><span class="sxs-lookup"><span data-stu-id="be803-172">Enter values for the existing SSO Database Server Name and Database Name.</span></span>  
  
    4.  <span data-ttu-id="be803-173">指定要用於 「 企業單一登入服務帳戶時，請輸入現有的 SSO 服務帳戶。</span><span class="sxs-lookup"><span data-stu-id="be803-173">Enter the existing SSO service account when specifying the account to use for the Enterprise Single Sign-On service.</span></span>  
  
13. <span data-ttu-id="be803-174">選擇選項以**加入現有的 BizTalk 群組**這個叢集節點上，設定 BizTalk 群組元件時，並指定您建立第一個節點的 BizTalk 群組。</span><span class="sxs-lookup"><span data-stu-id="be803-174">Choose the option to **Join an existing BizTalk Group** when configuring the BizTalk Group component on this cluster node, and specify the BizTalk group that you created on the first node.</span></span>  
  
14. <span data-ttu-id="be803-175">視需要指定其餘的組態選項，然後將 BizTalk Server 組態套用至該節點。</span><span class="sxs-lookup"><span data-stu-id="be803-175">Specify the remaining configuration options as needed and apply the BizTalk Server configuration to this node.</span></span>  
  
15. <span data-ttu-id="be803-176">BizTalk Server 組態已順利完成之後，請依照下列步驟來叢集化 SSO 服務：</span><span class="sxs-lookup"><span data-stu-id="be803-176">After the BizTalk Server configuration has completed successfully, follow these steps to cluster the SSO service:</span></span>  
  
    1.  <span data-ttu-id="be803-177">輸入下列命令，從命令，每個叢集節點上停止 SSO 服務：</span><span class="sxs-lookup"><span data-stu-id="be803-177">Stop the SSO service on each of the cluster nodes by typing the following command from a command:</span></span>  
  
        ```  
        net stop entsso  
        ```  
  
    2.  <span data-ttu-id="be803-178">在容錯移轉叢集管理，將所有的叢集群組移到其中一個節點，並登入此節點。</span><span class="sxs-lookup"><span data-stu-id="be803-178">In Failover Cluster Management, move all cluster groups to one node and log on to this node.</span></span>  
  
    3.  <span data-ttu-id="be803-179">在左窗格中，按一下以選取叢集的服務或應用程式中包含 IP 位址與網路名稱資源。</span><span class="sxs-lookup"><span data-stu-id="be803-179">In the left hand pane click to select a clustered service or application that contains an IP Address and Network Name resource.</span></span> <span data-ttu-id="be803-180">此叢集的服務或應用程式將會包含叢集的 SSO 服務和叢集的 BizTalk 主控件。</span><span class="sxs-lookup"><span data-stu-id="be803-180">This clustered service or application will contain the clustered SSO service and the clustered BizTalk host.</span></span>  
  
        > [!NOTE]
        >  <span data-ttu-id="be803-181">叢集的 SSO 服務不會明確要求相同群組中的叢集實體磁碟資源的使用。</span><span class="sxs-lookup"><span data-stu-id="be803-181">A clustered SSO service does not explicitly require the use of a clustered Physical Disk resource in the same group.</span></span>  
  
    4.  <span data-ttu-id="be803-182">叢集的服務或應用程式上按一下滑鼠右鍵，指向**將資源加入**，然後按一下**泛型服務**顯示**新增資源精靈** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="be803-182">Right-click the clustered service or application, point to **Add a resource**, and click **Generic Service** to display the **New Resource Wizard** dialog box.</span></span>  
  
    5.  <span data-ttu-id="be803-183">在**選取服務**頁面**新增資源精靈**，選取**企業單一登入服務**，然後按一下 **下一步**。</span><span class="sxs-lookup"><span data-stu-id="be803-183">On the **Select Service** page of the **New Resource Wizard**, select **Enterprise Single Sign-On Service**, and then click **Next**.</span></span>  
  
    6.  <span data-ttu-id="be803-184">在**確認**頁面上，按一下**下一步**。</span><span class="sxs-lookup"><span data-stu-id="be803-184">On the **Confirmation** page click **Next**.</span></span>  
  
    7.  <span data-ttu-id="be803-185">在**摘要**頁面上，按一下**完成**。</span><span class="sxs-lookup"><span data-stu-id="be803-185">On the **Summary** page click **Finish**.</span></span> <span data-ttu-id="be803-186">「 企業單一登入服務的叢集執行個體將會出現在**其他資源**在中央窗格中**容錯移轉叢集管理**介面。</span><span class="sxs-lookup"><span data-stu-id="be803-186">A clustered instance of the Enterprise Single Sign-On Service will appear under **Other Resources** in the center pane of the **Failover Cluster Management** interface.</span></span>  
  
    8.  <span data-ttu-id="be803-187">以滑鼠右鍵按一下 「 企業單一登入服務的叢集執行個體，然後選取**屬性**顯示**企業單一登入服務內容** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="be803-187">Right-click the clustered instance of the Enterprise Single Sign-On Service and select **Properties** to display the **Enterprise Single Sign-On Service Properties** dialog box.</span></span>  
  
    9. <span data-ttu-id="be803-188">按一下**相依性** 索引標籤的內容 對話方塊中，然後按一下**插入**。</span><span class="sxs-lookup"><span data-stu-id="be803-188">Click the **Dependencies** tab of the properties dialog box and click **Insert**.</span></span>  
  
    10. <span data-ttu-id="be803-189">按一下下拉式方塊底下**資源**，選取**名稱：** 資源，然後按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="be803-189">Click the drop down box under **Resource**, select the **Name:** resource and click **OK**.</span></span>  
  
        > [!IMPORTANT]
        >  <span data-ttu-id="be803-190">如果您不會加入至相依性**名稱：** 資源，當使用者嘗試連絡 SSO 服務的這個叢集執行個體 SSO 用戶端電腦會產生類似下面的錯誤：</span><span class="sxs-lookup"><span data-stu-id="be803-190">If you do not add the dependency to the **Name:** resource, SSO client computers will generate an error similar to the following when they try to contact this clustered instance of the SSO service:</span></span>  
        >   
        >  <span data-ttu-id="be803-191">無法擷取主要密碼。</span><span class="sxs-lookup"><span data-stu-id="be803-191">Failed to retrieve master secrets.</span></span>  
        >   
        >  <span data-ttu-id="be803-192">確認主要密碼伺服器名稱是否正確以及是否可用。</span><span class="sxs-lookup"><span data-stu-id="be803-192">Verify that the master secret server name is correct and that it is available.</span></span> <span data-ttu-id="be803-193">密碼伺服器名稱： ENTSSO 錯誤碼： 0x800706D9，沒有可從端點對應程式的多個端點。</span><span class="sxs-lookup"><span data-stu-id="be803-193">Secret Server Name: ENTSSO Error Code: 0x800706D9, there are no more endpoints available from the endpoint mapper.</span></span>  
  
16. <span data-ttu-id="be803-194">在叢集化 IIS[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]電腦所述的步驟[Microsoft 知識庫文章 970759 「 設定 IIS 7.0 中 Microsoft Windows Server 2008 容錯移轉叢集 」](http://go.microsoft.com/fwlink/p/?LinkId=152793) (http://go.microsoft.com/fwlink/p/?LinkId=152793)。</span><span class="sxs-lookup"><span data-stu-id="be803-194">Cluster IIS on the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer by following the steps documented in [Microsoft Knowledge Base article 970759 "Configuring IIS 7.0 in a Microsoft Windows Server 2008 failover cluster"](http://go.microsoft.com/fwlink/p/?LinkId=152793) (http://go.microsoft.com/fwlink/p/?LinkId=152793).</span></span> <span data-ttu-id="be803-195">在叢集的 SSO 服務的相同叢集群組中建立叢集的 IIS web 服務。</span><span class="sxs-lookup"><span data-stu-id="be803-195">Create the clustered IIS web service in the same cluster group as the clustered SSO service.</span></span>  
  
17. <span data-ttu-id="be803-196">在容錯移轉叢集管理，以滑鼠右鍵按一下叢集的服務或應用程式中包含叢集 「 企業單一登入 」 服務，然後按一下**將此服務或應用程式上線**以啟動所有中的資源叢集的服務或應用程式。</span><span class="sxs-lookup"><span data-stu-id="be803-196">In Failover Cluster Management, right click the clustered service or application that contains the clustered Enterprise Single Sign-On service and then click **Bring this service or application online** to start all of the resources in the clustered service or application.</span></span>  
  
18. <span data-ttu-id="be803-197">叢集的服務或應用程式上按一下滑鼠右鍵，指向**將此服務或應用程式到另一個節點移動**，然後按一下第二個節點。</span><span class="sxs-lookup"><span data-stu-id="be803-197">Right-click the clustered service or application, point to **Move this service or application to another node**, and click the second node.</span></span> <span data-ttu-id="be803-198">這個步驟會將移動叢集的服務或應用程式中包含叢集的企業單一登入服務的第一個節點從第二個節點。</span><span class="sxs-lookup"><span data-stu-id="be803-198">This step moves the clustered service or application that contains the clustered Enterprise Single Sign-On service from the first node to the second node.</span></span>  
  
19. <span data-ttu-id="be803-199">以滑鼠右鍵按一下叢集 「 企業單一登入 」 服務，然後按一下**讓此服務或應用程式離線**，SSO 服務的叢集執行個體上按一下滑鼠右鍵，然後按一下 **讓此服務或應用程式上線**。</span><span class="sxs-lookup"><span data-stu-id="be803-199">Right-click the clustered Enterprise Single Sign-On service and click **Take this service or application offline**, then right-click the clustered instance of the SSO service and click **Bring this service or application online**.</span></span>  
  
20. <span data-ttu-id="be803-200">設定使用 ssomanage 命令列公用程式在叢集的 SSO 服務的所有使用者的 SSO 伺服器名稱。</span><span class="sxs-lookup"><span data-stu-id="be803-200">Set the SSO server name for all users to the clustered SSO service with the ssomanage command line utility.</span></span> <span data-ttu-id="be803-201">每個 BizTalk server 群組中，應該從 SSO 安裝資料夾執行此命令。</span><span class="sxs-lookup"><span data-stu-id="be803-201">This command should be run from the SSO installation folder on each BizTalk server in the group.</span></span> <span data-ttu-id="be803-202">比方說，下列的命令列將設定為叢集的 SSO 服務的所有使用者的 SSO 伺服器名稱：</span><span class="sxs-lookup"><span data-stu-id="be803-202">For example, the following command line will set the SSO server name for all users to the clustered SSO service:</span></span>  
  
    ```  
    ssomanage -serverall SSOCLUSTER  
    ```  
  
    > [!NOTE]
    >  <span data-ttu-id="be803-203">*SSOCLUSTER*是建立包含叢集 「 SSO 服務的叢集群組中的實際網路名稱資源的預留位置。</span><span class="sxs-lookup"><span data-stu-id="be803-203">*SSOCLUSTER* is a placeholder for the actual network name resource that is created in the cluster group that contains the clustered SSO service.</span></span>  
  
21. <span data-ttu-id="be803-204">更新的 SSO 伺服器名稱，在中存取**BizTalk 群組屬性**頁面，即可參考叢集的 SSO 服務。</span><span class="sxs-lookup"><span data-stu-id="be803-204">Update the SSO Server name accessible in the **BizTalk Group Properties** page to reference the clustered SSO service.</span></span> <span data-ttu-id="be803-205">開啟**BizTalk Server 管理**、 以滑鼠右鍵按一下 BizTalk 群組中，選取**屬性**功能表項目，更新 SSO 伺服器名稱的項目，然後按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="be803-205">Open **BizTalk Server Administration**, right-click the BizTalk Group, select the **Properties** menu item, update the entry for SSO Server name, and then click **OK**.</span></span>  
  
22. <span data-ttu-id="be803-206">請依照[如何將 BizTalk 主控件設定為叢集資源](http://msdn.microsoft.com/library/6e9aab00-7623-4175-bb12-ba916306f1e3)在您已建立叢集的 SSO 服務的相同叢集群組中建立一或多個叢集的 BizTalk 主控件執行個體。</span><span class="sxs-lookup"><span data-stu-id="be803-206">Follow the steps in [How to Configure a BizTalk Host as a Cluster Resource](http://msdn.microsoft.com/library/6e9aab00-7623-4175-bb12-ba916306f1e3) to create one or more clustered BizTalk host instances in the same cluster group that you have created the clustered SSO service.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="be803-207">在此案例中，所有 BizTalk 主控件必須都建立為叢集化 SSO 服務資源位於相同叢集群組中的叢集資源。</span><span class="sxs-lookup"><span data-stu-id="be803-207">In this scenario, all BizTalk hosts must be created as cluster resources in the same cluster group as the clustered SSO service resource.</span></span> <span data-ttu-id="be803-208">已在叢集化 SSO 服務在 Windows Server 叢集節點上執行非叢集的 BizTalk 主控件執行個體不是支援的組態。</span><span class="sxs-lookup"><span data-stu-id="be803-208">Running an unclustered BizTalk host instance on a Windows Server Cluster node where the SSO service is clustered is not a supported configuration.</span></span> <span data-ttu-id="be803-209">這是因為叢集的 SSO 服務容錯移轉到另一個節點由於 BizTalk 主控件執行個體上的 SSO 服務的相依性時，未叢集化的 BizTalk 主控件執行個體將會失敗。</span><span class="sxs-lookup"><span data-stu-id="be803-209">This is because the unclustered BizTalk host instance will fail when the clustered SSO service is failed over to another node due to the dependency of a BizTalk host instance on the SSO service.</span></span>