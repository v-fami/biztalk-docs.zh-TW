---
title: "交易式訊息批次 |Microsoft 文件"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: b1790c05-e3f7-4667-8a9e-f6f208e55e40
caps.latest.revision: "9"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 28be423aa500ba8950b5b2100ce68dba7743bd79
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
---
# <a name="transactional-message-batches"></a><span data-ttu-id="c9bc8-102">交易式訊息批次</span><span class="sxs-lookup"><span data-stu-id="c9bc8-102">Transactional Message Batches</span></span>
<span data-ttu-id="c9bc8-103">某些配接器必須協調外部交易與內部 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 交易。</span><span class="sxs-lookup"><span data-stu-id="c9bc8-103">Some adapters must coordinate an external transaction with an internal [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] transaction.</span></span> <span data-ttu-id="c9bc8-104">例如，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 提供的 SQL 配接器必須協調 [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] 交易與 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 交易。</span><span class="sxs-lookup"><span data-stu-id="c9bc8-104">For example, the SQL adapter supplied with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] must coordinate a [!INCLUDE[btsSQLServerNoVersion](../includes/btssqlservernoversion-md.md)] transaction with a [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] transaction.</span></span> <span data-ttu-id="c9bc8-105">若要這樣做，此配接器必須存取 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 交易物件。</span><span class="sxs-lookup"><span data-stu-id="c9bc8-105">To do this, the adapter needs access to the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] transaction object.</span></span> <span data-ttu-id="c9bc8-106">將批次提交給 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 之前，要明確建立交易物件並讓它與此批次產生關聯。</span><span class="sxs-lookup"><span data-stu-id="c9bc8-106">A transaction object is explicitly created and associated with the batch before the batch is submitted to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="c9bc8-107">具有關聯交易物件的批次稱為交易式批次。</span><span class="sxs-lookup"><span data-stu-id="c9bc8-107">A batch that has an associated transaction object is called a transactional batch.</span></span> <span data-ttu-id="c9bc8-108">您可以藉由提供您自己的 Microsoft Distributed Transaction Coordinator (MSDTC) 交易物件，與 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 之間達成「只有一次保證」的資料往來傳遞。</span><span class="sxs-lookup"><span data-stu-id="c9bc8-108">By supplying your own Microsoft Distributed Transaction Coordinator (MSDTC) transaction object, you can achieve the "guaranteed, once and once only", delivery of data into and out of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
 <span data-ttu-id="c9bc8-109">由於批次中使用單一交易，所以類似 SQL 配接器的交易式資料庫配接器在外部資料庫中可能會有死結。</span><span class="sxs-lookup"><span data-stu-id="c9bc8-109">Transactional database adapters like the SQL adapter have the potential for deadlocks in the external database because of the single transaction used for the batch.</span></span> <span data-ttu-id="c9bc8-110">這就是將 SQL 配接器的批次大小以硬式編碼方式編寫成一的原因。</span><span class="sxs-lookup"><span data-stu-id="c9bc8-110">This is why the batch size for the SQL adapter is hard-coded to one.</span></span>  
  
 <span data-ttu-id="c9bc8-111">萬一配接器需要在該交易範圍內登錄其他資源管理員 (如另一個資料庫或 MSMQ) 時，它必須建立明確外部交易，並將此交易傳遞給傳訊引擎。</span><span class="sxs-lookup"><span data-stu-id="c9bc8-111">Should the adapter need to enlist additional resource managers, such as another database or MSMQ, within the scope of that transaction, it must create and pass to the Messaging Engine an explicit external transaction.</span></span> <span data-ttu-id="c9bc8-112">建立外部交易並讓它與批次產生關聯稱為交易式批次。</span><span class="sxs-lookup"><span data-stu-id="c9bc8-112">Creating an external transaction and associating it with a batch is a called a transactional batch.</span></span> <span data-ttu-id="c9bc8-113">交易式配接器是透過明確建立外部 Microsoft Distributed Transaction Coordinator (MSDTC) 交易來利用交易式批次的配接器。</span><span class="sxs-lookup"><span data-stu-id="c9bc8-113">A transactional adapter is an adapter that makes use of transactional batches by explicitly creating an external Microsoft Distributed Transaction Coordinator (MSDTC) transaction.</span></span>  
  
 <span data-ttu-id="c9bc8-114">配接器為 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 提供交易的其中一個原因，是要確保 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 或外部系統具有資料的記錄。</span><span class="sxs-lookup"><span data-stu-id="c9bc8-114">One of the reasons an adapter provides [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] with a transaction is to ensure that either [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] or the external system has a record of the data.</span></span> <span data-ttu-id="c9bc8-115">這項記錄可確保此訊息只會傳遞一次。</span><span class="sxs-lookup"><span data-stu-id="c9bc8-115">This record ensures the message is delivered once and only once.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c9bc8-116">如需 MSDTC 的詳細資訊，請參閱在分散式交易協調器文件： [http://go.microsoft.com/fwlink/?LinkId=44297](http://go.microsoft.com/fwlink/?LinkId=44297)。</span><span class="sxs-lookup"><span data-stu-id="c9bc8-116">For more information about MSDTC, see the documentation for the Distributed Transaction Coordinator at: [http://go.microsoft.com/fwlink/?LinkId=44297](http://go.microsoft.com/fwlink/?LinkId=44297).</span></span>  
  
 <span data-ttu-id="c9bc8-117">檔案配接器是不需要存取交易的一個配接器範例，因為它所管理的外部檔案作業不是交易式。</span><span class="sxs-lookup"><span data-stu-id="c9bc8-117">The File adapter is an example of an adapter that does not require access to the transaction because the external file operations it manages are not transactional.</span></span> <span data-ttu-id="c9bc8-118">在此情況下，此配接器不會提供交易物件給 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="c9bc8-118">In this case, the adapter does not provide a transaction object to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="c9bc8-119">另一方面，SQL 配接器會與 SQL 資料庫互動，而且在它的 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 訊息互動之外可能會有其他的作業。</span><span class="sxs-lookup"><span data-stu-id="c9bc8-119">The SQL adapter, on the other hand, interacts with an SQL database and may have additional operations outside of its [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] message interactions.</span></span> <span data-ttu-id="c9bc8-120">在此情況下，此配接器將外部 MSDTC 交易傳遞給 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 可能是一件合理的事情。</span><span class="sxs-lookup"><span data-stu-id="c9bc8-120">An external MSDTC transaction in this case may make sense for the adapter to pass to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="c9bc8-121">本節內容</span><span class="sxs-lookup"><span data-stu-id="c9bc8-121">In This Section</span></span>  
  
-   [<span data-ttu-id="c9bc8-122">處理交易</span><span class="sxs-lookup"><span data-stu-id="c9bc8-122">Handling Transactions</span></span>](../core/handling-transactions.md)