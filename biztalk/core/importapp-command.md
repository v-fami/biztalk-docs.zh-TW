---
title: ImportApp 命令 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: e8ee5a78-1e8f-4290-b70a-36f2f888a1d6
caps.latest.revision: 28
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: c32407364cad49b4024b40384d4c50bb250632fd
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "36976000"
---
# <a name="importapp-command"></a><span data-ttu-id="fd98a-102">ImportApp 命令</span><span class="sxs-lookup"><span data-stu-id="fd98a-102">ImportApp Command</span></span>
<span data-ttu-id="fd98a-103">將 .msi 檔案中所包含的成品匯入 BizTalk 應用程式中。</span><span class="sxs-lookup"><span data-stu-id="fd98a-103">Imports the artifacts contained in an .msi file into a BizTalk application.</span></span> <span data-ttu-id="fd98a-104">如果應用程式不存在，會予以建立。</span><span class="sxs-lookup"><span data-stu-id="fd98a-104">If the application does not already exist, it is created.</span></span>  
  
 <span data-ttu-id="fd98a-105">若您曾在應用程式中加入繫結檔案，以針對特定的部署環境進行自訂，則匯入應用程式時即可使用 /Environment 參數指定應用程式的目標部署環境。</span><span class="sxs-lookup"><span data-stu-id="fd98a-105">When you import an application, you can use the /Environment parameter to specify the target deployment environment for the application, if you have added binding files to this application that are customized for a particular deployment environment.</span></span> <span data-ttu-id="fd98a-106">如需背景資訊，請參閱 <<c0> [ 繫結檔案和應用程式部署](../core/binding-files-and-application-deployment.md)。</span><span class="sxs-lookup"><span data-stu-id="fd98a-106">For background information, see [Binding Files and Application Deployment](../core/binding-files-and-application-deployment.md).</span></span> <span data-ttu-id="fd98a-107">如需新增繫結檔案的指示，請參閱[AddResource 命令： BizTalk 繫結](../core/addresource-command-biztalk-binding.md)。</span><span class="sxs-lookup"><span data-stu-id="fd98a-107">For instructions on adding binding files, see [AddResource Command: BizTalk Binding](../core/addresource-command-biztalk-binding.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="fd98a-108">匯入作業的持續時間一旦超過 3600 秒就會逾時。</span><span class="sxs-lookup"><span data-stu-id="fd98a-108">An import operation will time out if it exceeds 3600 seconds in duration.</span></span> <span data-ttu-id="fd98a-109">如果您嘗試匯入某個 .msi 檔案而發生作業逾時，請重新匯出應用程式並分批選取所要匯出的部分成品，以將應用程式的內容分成多個 .msi 檔案。</span><span class="sxs-lookup"><span data-stu-id="fd98a-109">If you are attempting to import an .msi file, and the operation times out, you should divide the contents of the application into more than one .msi file by re-exporting the application and selecting a subset of artifacts to export.</span></span> <span data-ttu-id="fd98a-110">如需詳細資訊，請參閱 <<c0> [ 如何匯出 BizTalk 應用程式](../core/how-to-export-a-biztalk-application.md)。</span><span class="sxs-lookup"><span data-stu-id="fd98a-110">For more information, see [How to Export a BizTalk Application](../core/how-to-export-a-biztalk-application.md).</span></span>  
  
 <span data-ttu-id="fd98a-111">如果匯入失敗，BTSTask 就會傳回顯示錯誤數目。</span><span class="sxs-lookup"><span data-stu-id="fd98a-111">If the import fails, BTSTask returns displaying the number of errors.</span></span> <span data-ttu-id="fd98a-112">作業期間執行的大多數動作都會回復，唯獨下列情況例外：</span><span class="sxs-lookup"><span data-stu-id="fd98a-112">Most of the actions taken during the operation are rolled back, except the following:</span></span>  
  
- <span data-ttu-id="fd98a-113">自訂指令碼執行的動作不會回復。</span><span class="sxs-lookup"><span data-stu-id="fd98a-113">Actions taken by custom scripts are not rolled back.</span></span> <span data-ttu-id="fd98a-114">您可以使用 Delete 環境變數撰寫可回復動作的指令碼。</span><span class="sxs-lookup"><span data-stu-id="fd98a-114">You can write your scripts so that they roll back by using the Delete environment variable.</span></span>  
  
- <span data-ttu-id="fd98a-115">安裝在全域組件快取 (GAC) 中的組件不會被移除。</span><span class="sxs-lookup"><span data-stu-id="fd98a-115">If assemblies were installed in the global assembly cache (GAC), they are not removed.</span></span>  
  
- <span data-ttu-id="fd98a-116">Windows 登錄中的增修項目不會被移除。</span><span class="sxs-lookup"><span data-stu-id="fd98a-116">Entries make in the Windows registry are not removed.</span></span>  
  
  <span data-ttu-id="fd98a-117">如果匯入成功時，BTSTask 就會傳回"0"。</span><span class="sxs-lookup"><span data-stu-id="fd98a-117">If the import is successful, BTSTask returns "0".</span></span>  
  
## <a name="usage"></a><span data-ttu-id="fd98a-118">使用方式</span><span class="sxs-lookup"><span data-stu-id="fd98a-118">Usage</span></span>  
 <span data-ttu-id="fd98a-119">**BTSTask 的 ImportApp /Package:** *值*[**/Environment:**<em>值</em>] [**/ApplicationName:** <em>值</em>] [**/覆寫**] [**/Server:**<em>值</em>] [**/database:**<em>值</em>]</span><span class="sxs-lookup"><span data-stu-id="fd98a-119">**BTSTask ImportApp /Package:** *value* [**/Environment:**<em>value</em>] [**/ApplicationName:**<em>value</em>] [**/Overwrite**] [**/Server:**<em>value</em>] [**/Database:**<em>value</em>]</span></span>  
  
## <a name="parameters"></a><span data-ttu-id="fd98a-120">參數</span><span class="sxs-lookup"><span data-stu-id="fd98a-120">Parameters</span></span>  
  
|<span data-ttu-id="fd98a-121">參數</span><span class="sxs-lookup"><span data-stu-id="fd98a-121">Parameter</span></span>|<span data-ttu-id="fd98a-122">必要項</span><span class="sxs-lookup"><span data-stu-id="fd98a-122">Required</span></span>|<span data-ttu-id="fd98a-123">ReplTest1</span><span class="sxs-lookup"><span data-stu-id="fd98a-123">Value</span></span>|  
|---------------|--------------|-----------|  
|<span data-ttu-id="fd98a-124">**/ 封裝**(或 **/P**，請參閱 < 備註 >)</span><span class="sxs-lookup"><span data-stu-id="fd98a-124">**/Package** (or **/P**, see Remarks)</span></span>|<span data-ttu-id="fd98a-125">是</span><span class="sxs-lookup"><span data-stu-id="fd98a-125">Yes</span></span>|<span data-ttu-id="fd98a-126">.msi 檔案的完整路徑。</span><span class="sxs-lookup"><span data-stu-id="fd98a-126">Full path of the .msi file.</span></span> <span data-ttu-id="fd98a-127">如果路徑包含空格，您必須將它括在雙引號 (") 中。</span><span class="sxs-lookup"><span data-stu-id="fd98a-127">If the path includes spaces, you must enclose it in double quotation marks (").</span></span> <span data-ttu-id="fd98a-128">範例："C:\My MSI Files\MyApplication.msi"</span><span class="sxs-lookup"><span data-stu-id="fd98a-128">Example: "C:\My MSI Files\MyApplication.msi"</span></span>|  
|<span data-ttu-id="fd98a-129">**/ 環境**(或 **/E**，請參閱 < 備註 >)</span><span class="sxs-lookup"><span data-stu-id="fd98a-129">**/Environment** (or **/E**, see Remarks)</span></span>|<span data-ttu-id="fd98a-130">否</span><span class="sxs-lookup"><span data-stu-id="fd98a-130">No</span></span>|<span data-ttu-id="fd98a-131">所套用之繫結檔案的目標部署環境，例如 Test。</span><span class="sxs-lookup"><span data-stu-id="fd98a-131">The target deployment environment of the binding file to apply, such as Test.</span></span> <span data-ttu-id="fd98a-132">此值係針對已加入應用程式中的繫結檔案指定其目標部署環境。</span><span class="sxs-lookup"><span data-stu-id="fd98a-132">This is the value that was specified for the target deployment environment when the binding file was added to the application.</span></span> <span data-ttu-id="fd98a-133">如果沒有指定，將會套用所有未指定部署環境的繫結。</span><span class="sxs-lookup"><span data-stu-id="fd98a-133">When not specified, all bindings that do not have an environment specified are applied.</span></span>|  
|<span data-ttu-id="fd98a-134">**/ ApplicationName** (或 **/A**，請參閱 < 備註 >)</span><span class="sxs-lookup"><span data-stu-id="fd98a-134">**/ApplicationName** (or **/A**, see Remarks)</span></span>|<span data-ttu-id="fd98a-135">否</span><span class="sxs-lookup"><span data-stu-id="fd98a-135">No</span></span>|<span data-ttu-id="fd98a-136">要從 .msi 檔案匯入成品的 BizTalk 應用程式的名稱。</span><span class="sxs-lookup"><span data-stu-id="fd98a-136">Name of the BizTalk application to which the artifacts in the .msi file are imported.</span></span> <span data-ttu-id="fd98a-137">如果名稱包含空格，您必須將它括在雙引號 (") 中。</span><span class="sxs-lookup"><span data-stu-id="fd98a-137">If the name includes spaces, you must enclose it with double quotation marks (").</span></span> <span data-ttu-id="fd98a-138">如果沒有指定，將會使用預設的應用程式。</span><span class="sxs-lookup"><span data-stu-id="fd98a-138">If not specified, the default application is used.</span></span> <span data-ttu-id="fd98a-139">如果指定的應用程式不存在，會自動建立應用程式。</span><span class="sxs-lookup"><span data-stu-id="fd98a-139">If the specified application does not exist, the application is created.</span></span>|  
|<span data-ttu-id="fd98a-140">**/ 覆寫**(或 **/O**，請參閱 < 備註 >)</span><span class="sxs-lookup"><span data-stu-id="fd98a-140">**/Overwrite** (or **/O**, see Remarks)</span></span>|<span data-ttu-id="fd98a-141">否</span><span class="sxs-lookup"><span data-stu-id="fd98a-141">No</span></span>|<span data-ttu-id="fd98a-142">此選項指定以 .msi 檔案中，本機唯一識別碼 (LUID) 相同的成品覆寫應用程式中的成品。</span><span class="sxs-lookup"><span data-stu-id="fd98a-142">Option to overwrite artifacts in the application with artifacts in the .msi file that have the same locally unique identifier (LUID).</span></span> <span data-ttu-id="fd98a-143">您也可以使用應用程式中檢視成品的 Luid [ListApp 命令](../core/listapp-command.md)。</span><span class="sxs-lookup"><span data-stu-id="fd98a-143">You can view the LUIDs of the artifacts in an application by using the [ListApp Command](../core/listapp-command.md).</span></span> <span data-ttu-id="fd98a-144">若未指定此選項，且應用程式中有一或多個成品與 .msi 檔案中的成品具有相同的 LUID，匯入就會失敗。</span><span class="sxs-lookup"><span data-stu-id="fd98a-144">If this option is not specified, and there are one or more artifacts in the application that have the same LUID as artifacts in the .msi file, the import fails.</span></span>|  
|<span data-ttu-id="fd98a-145">**/Server** (或 **/S**，請參閱 < 備註 >)</span><span class="sxs-lookup"><span data-stu-id="fd98a-145">**/Server** (or **/S**, see Remarks)</span></span>|<span data-ttu-id="fd98a-146">否</span><span class="sxs-lookup"><span data-stu-id="fd98a-146">No</span></span>|<span data-ttu-id="fd98a-147">裝載 BizTalk 管理資料庫之 SQL Server 執行個體的名稱，其格式為：伺服器名稱\執行個體名稱,連接埠。</span><span class="sxs-lookup"><span data-stu-id="fd98a-147">Name of the SQL Server instance hosting the BizTalk Management database, in the form ServerName\InstanceName,Port.</span></span><br /><br /> <span data-ttu-id="fd98a-148">只有在執行個體名稱和伺服器名稱不同時，才需要執行個體名稱。</span><span class="sxs-lookup"><span data-stu-id="fd98a-148">Instance name is only required when the instance name is different than the server name.</span></span> <span data-ttu-id="fd98a-149">只有在 SQL Server 使用預設值 (1433) 以外的連接埠編號時，才需要連接埠。</span><span class="sxs-lookup"><span data-stu-id="fd98a-149">Port is only required when SQL Server uses a port number other than the default (1433).</span></span><br /><br /> <span data-ttu-id="fd98a-150">範例:</span><span class="sxs-lookup"><span data-stu-id="fd98a-150">Examples:</span></span><br /><br /> <span data-ttu-id="fd98a-151">Server=MyServer</span><span class="sxs-lookup"><span data-stu-id="fd98a-151">Server=MyServer</span></span><br /><br /> <span data-ttu-id="fd98a-152">Server=MyServer\MySQLServer,1533</span><span class="sxs-lookup"><span data-stu-id="fd98a-152">Server=MyServer\MySQLServer,1533</span></span><br /><br /> <span data-ttu-id="fd98a-153">如果不提供，將會使用在本機電腦上執行的 SQL Server 執行個體的名稱。</span><span class="sxs-lookup"><span data-stu-id="fd98a-153">If not provided, the name of the SQL Server instance running on the local computer is used.</span></span>|  
|<span data-ttu-id="fd98a-154">**/ 資料庫**(或 **/D**，請參閱 < 備註 >)</span><span class="sxs-lookup"><span data-stu-id="fd98a-154">**/Database** (or **/D**, see Remarks)</span></span>|<span data-ttu-id="fd98a-155">否</span><span class="sxs-lookup"><span data-stu-id="fd98a-155">No</span></span>|<span data-ttu-id="fd98a-156">BizTalk 管理資料庫的名稱。</span><span class="sxs-lookup"><span data-stu-id="fd98a-156">Name of the BizTalk Management database.</span></span> <span data-ttu-id="fd98a-157">如果沒有指定，將會使用在 SQL Server 本機執行個體中執行的 BizTalk 管理資料庫。</span><span class="sxs-lookup"><span data-stu-id="fd98a-157">If not specified, the BizTalk Management database running in the local instance of SQL Server is used.</span></span>|  
  
## <a name="sample"></a><span data-ttu-id="fd98a-158">範例</span><span class="sxs-lookup"><span data-stu-id="fd98a-158">Sample</span></span>  
 <span data-ttu-id="fd98a-159">**BTSTask 的 ImportApp /Package:C:\MSI\MyApplication.msi /Environment:Test /applicationname: myapplication / 覆寫**</span><span class="sxs-lookup"><span data-stu-id="fd98a-159">**BTSTask ImportApp /Package:C:\MSI\MyApplication.msi /Environment:Test /ApplicationName:MyApplication /Overwrite**</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="fd98a-160">備註</span><span class="sxs-lookup"><span data-stu-id="fd98a-160">Remarks</span></span>  
 <span data-ttu-id="fd98a-161">參數不區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="fd98a-161">Parameters are not case-sensitive.</span></span> <span data-ttu-id="fd98a-162">您不需要輸入整個參數名稱來指定它；您可以輸入參數名稱的前幾個字母，只要能明確識別就好了。</span><span class="sxs-lookup"><span data-stu-id="fd98a-162">You do not need to type the entire parameter name to specify it; you can type the first few letters of the parameter name that identify it unambiguously.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="fd98a-163">另請參閱</span><span class="sxs-lookup"><span data-stu-id="fd98a-163">See Also</span></span>  
 <span data-ttu-id="fd98a-164">[BTSTask 命令列參考](../core/btstask-command-line-reference.md) </span><span class="sxs-lookup"><span data-stu-id="fd98a-164">[BTSTask Command-Line Reference](../core/btstask-command-line-reference.md) </span></span>  
 [<span data-ttu-id="fd98a-165">如何匯入 BizTalk 應用程式</span><span class="sxs-lookup"><span data-stu-id="fd98a-165">How to Import a BizTalk Application</span></span>](../core/how-to-import-a-biztalk-application.md)