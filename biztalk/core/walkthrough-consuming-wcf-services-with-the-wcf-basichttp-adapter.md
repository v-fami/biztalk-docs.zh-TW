---
title: "逐步解說： 使用 Wcf-basichttp 配接器的 WCF 服務 |Microsoft 文件"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 2d280198-ba55-4937-91c9-19d6d0ed3194
caps.latest.revision: "49"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: c54646d106abe1824ce39de5a550f5f591bae882
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
---
# <a name="walkthrough-consuming-wcf-services-with-the-wcf-basichttp-adapter"></a><span data-ttu-id="d0b8e-102">逐步解說： 使用 Wcf-basichttp 配接器的 WCF 服務</span><span class="sxs-lookup"><span data-stu-id="d0b8e-102">Walkthrough: Consuming WCF Services with the WCF-BasicHttp Adapter</span></span>
  
> [!NOTE]
>  <span data-ttu-id="d0b8e-103">如需配接器的詳細資訊，請參閱[配接器在 BizTalk Server](../core/adapters-in-biztalk-server.md)。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-103">For more information about adapters, see [Adapters in BizTalk Server](../core/adapters-in-biztalk-server.md).</span></span>  
  
## <a name="introduction"></a><span data-ttu-id="d0b8e-104">簡介</span><span class="sxs-lookup"><span data-stu-id="d0b8e-104">Introduction</span></span>
  
 <span data-ttu-id="d0b8e-105">在本逐步解說，您將使用[!INCLUDE[firstref_btsWinCommFoundation](../includes/firstref-btswincommfoundation-md.md)]服務裝載在網際網路資訊服務 (IIS) 使用 BizTalk 傳訊和 Wcf-basichttp 傳送配接器。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-105">In this walkthrough, you will consume a [!INCLUDE[firstref_btsWinCommFoundation](../includes/firstref-btswincommfoundation-md.md)] service hosted inside Internet Information Services (IIS) using BizTalk messaging and the WCF-BasicHttp send adapter.</span></span> <span data-ttu-id="d0b8e-106">此配接器使用**BasicHttpBinding**繫結，以提供與 Web 服務，做為 Microsoft 之間的橋接器的舊版本相容的傳輸/通訊協定堆疊實作[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]和[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]這項功能。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-106">This adapter uses the **BasicHttpBinding** binding to provide a transport/protocol stack implementation compatible with earlier versions of Web services to serve as a bridge between Microsoft [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] and [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] functionality.</span></span> <span data-ttu-id="d0b8e-107">協調流程可以繫結至傳送埠使用[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]配接器呼叫[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務，並且使用其功能，其邏輯商務程序內。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-107">An orchestration can bind to a send port that uses a [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] adapter to call a [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service and leverage its functionality within its logical business processing.</span></span>  
  
 <span data-ttu-id="d0b8e-108">Wcf-basichttp 配接器是由傳送配接器和接收配接器所組成。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-108">The WCF-BasicHttp adapter consists of both a send adapter and a receive adapter.</span></span> <span data-ttu-id="d0b8e-109">在此範例會使用僅此配接器的傳送端進行透過 HTTP 通訊協定的 WCF 服務要求[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-109">In this sample you will use only the send side of this adapter to make WCF service requests through the HTTP protocol to a [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service.</span></span>  <span data-ttu-id="d0b8e-110">請求-回應傳送埠，傳送配接器傳送給[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務，並收到傳回的結果回應。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-110">For a Solicit-Response send port, the send adapter sends to a [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service and receives back a result response.</span></span>  <span data-ttu-id="d0b8e-111">相反地，[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]接收配接器可以讓[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]要發行和從外部呼叫的協調流程[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]用戶端應用程式。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-111">Conversely, a [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] receive adapter allows a [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] orchestration to be published and called externally by a [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] client application.</span></span> <span data-ttu-id="d0b8e-112">請參閱[發佈 WCF 服務](../core/publishing-wcf-services.md)如需詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-112">Refer to the [Publishing WCF Services](../core/publishing-wcf-services.md) for additional information.</span></span>  
  
 <span data-ttu-id="d0b8e-113">完成此逐步解說之後，您將會瞭解如何執行下列工作：</span><span class="sxs-lookup"><span data-stu-id="d0b8e-113">After completing this walkthrough, you will understand how to perform the following tasks:</span></span>  
  
-   <span data-ttu-id="d0b8e-114">從[!INCLUDE[btsCoName](../includes/btsconame-md.md)] [!INCLUDE[vs2010](../includes/vs2010-md.md)]，使用**部署**命令來部署組件包含[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]方案和[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務的本機執行個體[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-114">From within [!INCLUDE[btsCoName](../includes/btsconame-md.md)][!INCLUDE[vs2010](../includes/vs2010-md.md)], use the **Deploy** command to deploy the assemblies containing the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] solution and the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service to a local instance of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="d0b8e-115">這樣會建立有組件填入其中的 BizTalk 應用程式。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-115">This creates a BizTalk application that is populated with the assemblies.</span></span>  
  
-   <span data-ttu-id="d0b8e-116">從[!INCLUDE[vs2010](../includes/vs2010-md.md)]，使用**BizTalk WCF 服務使用精靈**產生[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]結構描述和類型使用時所需要[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-116">From within [!INCLUDE[vs2010](../includes/vs2010-md.md)], use the **BizTalk WCF Service Consuming Wizard** to generate the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] schemas and types necessary to consume the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service.</span></span> <span data-ttu-id="d0b8e-117">您可以使用，並繫結至邏輯連接埠，就會一併產生空白的協調流程。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-117">An empty orchestration is generated as well that you can use and bind to a logical port.</span></span> <span data-ttu-id="d0b8e-118">此協調流程會編譯和部署以及結構描述和類型。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-118">This orchestration is complied and deployed along with schemas and types.</span></span> <span data-ttu-id="d0b8e-119">但協調流程的工作流程處理是空白這裡，未在此範例中使用，因為這是只單純[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]傳訊實例。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-119">But the orchestration workflow processing is empty here and not used in this sample as this is merely a pure [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] messaging scenario.</span></span>  
  
-   <span data-ttu-id="d0b8e-120">從[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]系統管理主控台中，設定使用 Wcf-basichttp 傳送埠以內容為基礎的路由。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-120">From the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, configure content-based routing by using the WCF-BasicHttp send port.</span></span> <span data-ttu-id="d0b8e-121">您將設定**SOAPAction**標頭的目標[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務預期收到。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-121">You will configure the **SOAPAction** header that the target [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service expects to receive.</span></span>  
  
-   <span data-ttu-id="d0b8e-122">從[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]系統管理主控台中，設定篩選條件運算式傳送任何 SOAP 錯誤訊息[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務可傳送到輸出資料夾。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-122">From the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, configure the filter expression to route any SOAP fault messages that a [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service can send to an output folder.</span></span>  
  
-   <span data-ttu-id="d0b8e-123">從網際網路資訊服務 (IIS) 管理員中設定 Web 應用程式裝載[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務來公開它的中繼資料。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-123">From within Internet Information Services (IIS) Manager, configure the Web application hosting the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service to expose its metadata.</span></span> <span data-ttu-id="d0b8e-124">啟用之後， **BizTalk WCF 服務使用精靈**可以取得此中繼資料來產生型別和結構描述存取[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-124">After it is enabled, the **BizTalk WCF Service Consuming Wizard** can obtain this metadata to generate types and schemas to access the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service.</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="d0b8e-125">必要條件</span><span class="sxs-lookup"><span data-stu-id="d0b8e-125">Prerequisites</span></span>  
 <span data-ttu-id="d0b8e-126">若要執行此範例中的步驟會確認您的環境會安裝下列先決條件：</span><span class="sxs-lookup"><span data-stu-id="d0b8e-126">To perform the steps in this sample ensure that your environment installs the following prerequisites:</span></span>  
  
-   <span data-ttu-id="d0b8e-127">建置組件，並執行部署程序的電腦和執行範例的電腦需要 Microsoft [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)]，Microsoft [!INCLUDE[netfx40_short](../includes/netfx40-short-md.md)]，與 Microsoft [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-127">Both the computer that builds the assemblies and runs the deployment process, and the computer that runs the sample, require Microsoft [!INCLUDE[btsWinSvr2k8](../includes/btswinsvr2k8-md.md)], Microsoft [!INCLUDE[netfx40_short](../includes/netfx40-short-md.md)], and Microsoft [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)].</span></span>  
  
-   <span data-ttu-id="d0b8e-128">用來建置組件並執行部署程序的電腦需要 Microsoft [!INCLUDE[vs2010](../includes/vs2010-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-128">The computer used to build the assemblies and run the deployment process requires Microsoft [!INCLUDE[vs2010](../includes/vs2010-md.md)].</span></span>  
  
-   <span data-ttu-id="d0b8e-129">執行此範例的電腦需要[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]配接器和[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]系統管理工具。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-129">The computer that runs the sample requires the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] Adapters and the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] Administration Tools.</span></span> <span data-ttu-id="d0b8e-130">這些是 Microsoft 的安裝期間安裝的選項[!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-130">These are options to install during setup of Microsoft [!INCLUDE[btsBizTalkServer2006r3](../includes/btsbiztalkserver2006r3-md.md)].</span></span>  
  
-   <span data-ttu-id="d0b8e-131">在電腦上您用來執行管理工作，您必須以成員的使用者帳戶執行[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]Administrators 群組，才能設定[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]內的應用程式設定[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-131">On the computers that you use to perform administrative tasks, you must run as a user account that is a member of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administrators group to configure the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] application settings within the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span> <span data-ttu-id="d0b8e-132">此使用者帳戶也必須為管理主控件執行個體和其他工作可能需要的應用程式部署的本機系統管理員群組的成員。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-132">This user account must also be a member of the local Administrators group for application deployment, managing host instances, and other tasks that may be required.</span></span>  
  
-   <span data-ttu-id="d0b8e-133">需要的任何電腦上[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]功能，完成的單次安裝程序[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]範例[http://go.microsoft.com/fwlink/?LinkId=135510](http://go.microsoft.com/fwlink/?LinkId=135510)。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-133">On any computer that requires [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] capability, complete the one-time setup procedure for the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] samples at [http://go.microsoft.com/fwlink/?LinkId=135510](http://go.microsoft.com/fwlink/?LinkId=135510).</span></span>  
  
-   <span data-ttu-id="d0b8e-134">執行範例，並匯入繫結或.msi 檔案的電腦上[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]，請確定主機不受信任的主機，或匯入將會失敗。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-134">On the computer that runs the sample and imports a binding or an .msi file into [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], ensure the host is not a trusted host or the import will fail.</span></span>  
  
-   <span data-ttu-id="d0b8e-135">您必須下載的逐步解說程式碼，並將它解壓縮到您的電腦。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-135">You must download the walkthrough code and extract it to your computer.</span></span>  <span data-ttu-id="d0b8e-136">這個逐步解說是整個屬於[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]配接器逐步解說 」 套件。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-136">This walkthrough is a part of the entire [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] Adapter Walkthrough package.</span></span> <span data-ttu-id="d0b8e-137">您可以下載檔案**WCFAdapterWalkthroughs.exe**從[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]Developer Center[http://go.microsoft.com/fwlink/?LinkId=194140](http://go.microsoft.com/fwlink/?LinkId=194140)。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-137">You can download the file **WCFAdapterWalkthroughs.exe** from the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Developer Center at[http://go.microsoft.com/fwlink/?LinkId=194140](http://go.microsoft.com/fwlink/?LinkId=194140).</span></span>  
  
## <a name="deploy-the-sample-wcf-service"></a><span data-ttu-id="d0b8e-138">部署範例 WCF 服務</span><span class="sxs-lookup"><span data-stu-id="d0b8e-138">Deploy the sample WCF service</span></span>  
  
1.  <span data-ttu-id="d0b8e-139">執行自動解壓縮**WCFBasicHttpSendAdapter.exe**檔案，並將檔案解壓縮到**C:\WCFBasicHttpSendAdapter**資料夾。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-139">Run the self-extracting **WCFBasicHttpSendAdapter.exe** file and extract the files into the **C:\WCFBasicHttpSendAdapter** folder.</span></span>  
  
2.  <span data-ttu-id="d0b8e-140">開啟**C:\WCFBasicHttpSendAdapter\WCFBasicHttpSendAdapter.sln**中[!INCLUDE[vs2010](../includes/vs2010-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-140">Open the **C:\WCFBasicHttpSendAdapter\WCFBasicHttpSendAdapter.sln** in [!INCLUDE[vs2010](../includes/vs2010-md.md)].</span></span>  
  
3.  <span data-ttu-id="d0b8e-141">在 [方案總管] 中，展開**BasicHttpWCFServiceConsuming**專案。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-141">In Solution Explorer, expand the **BasicHttpWCFServiceConsuming** project.</span></span> <span data-ttu-id="d0b8e-142">這個專案是[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]將傳送埠所呼叫的服務。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-142">This project is the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service that will be called by the send port.</span></span> <span data-ttu-id="d0b8e-143">它會在受管理的主機環境中使用 Internet Information Services (IIS) 裝載。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-143">It will be hosted in a managed host environment using Internet Information Services (IIS).</span></span> <span data-ttu-id="d0b8e-144">在 IIS 中裝載使用訊息型啟用來管理啟用和服務的存留期。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-144">Hosting in IIS uses message-based activation to manage the activation and lifetime of the service.</span></span> <span data-ttu-id="d0b8e-145">展開**App_Code**，然後開啟**OrderProcess.cs**檢閱。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-145">Expand **App_Code**, and then open **OrderProcess.cs** to review.</span></span> <span data-ttu-id="d0b8e-146">這[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務接收訂單要求訊息，透過**OrderRequest**方法。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-146">This [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service receives order request messages through the **OrderRequest** method.</span></span> <span data-ttu-id="d0b8e-147">OrderProcess.cs 檔案包含的介面 defition 和實作[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-147">The OrderProcess.cs file contains the interface defition and implementation of the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service.</span></span> <span data-ttu-id="d0b8e-148">它只會傳回訂單回應訊息，透過**OrderResponse**方法。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-148">It simply returns order response messages through the **OrderResponse** method.</span></span>  
  
4.  <span data-ttu-id="d0b8e-149">檢閱 [orderprocess.svc] 檔案。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-149">Review the OrderProcess.svc file.</span></span> <span data-ttu-id="d0b8e-150">它只包含一個線條用來告知 IIS 以啟用用戶端應用程式的服務。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-150">It contains only one line which is used to tell IIS to activate the service for a client application.</span></span> <span data-ttu-id="d0b8e-151"> **@ServiceHost** 屬性會用來裝載服務是中的擴充點[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]程式設計模型。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-151">The **@ServiceHost** attribute used to host the service is a point of extensibility within the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] programming model.</span></span> <span data-ttu-id="d0b8e-152">使用處理站模式**ServiceHostFactory**建立的執行個體**ServiceHost**與執行個體[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]處理傳入要求的服務。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-152">A factory pattern uses **ServiceHostFactory** to create an instance of **ServiceHost** with an instance of the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service to handle incoming requests.</span></span> <span data-ttu-id="d0b8e-153">具現化這個執行個體根據**ServiceBehaviorAttribute.ConcurrencyMode**屬性，決定服務是否支援單一執行緒、 多重執行緒或可重新進入的呼叫。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-153">Instantiation of this instance is based upon the **ServiceBehaviorAttribute.ConcurrencyMode** property, which determines whether a service supports one thread, multiple threads, or reentrant calls.</span></span> <span data-ttu-id="d0b8e-154">具現化也由**ServiceBehavior.InstanceMode**屬性，決定如果只有一個執行個體將提供所有呼叫端 (singleton)，如果一個執行個體將會建立每個呼叫 （無狀態），或一個執行個體將會建立每個工作階段 （可設定狀態）。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-154">Instantiation is also determined by the **ServiceBehavior.InstanceMode** property, which determines if a only one instance will serve all callers (singleton), if one instance will be created per call (stateless), or if one instance will be created for each session (stateful).</span></span>  
  
    ```  
    <%@ServiceHost language=c# Debug="true" Service="Microsoft.Samples.BizTalk.WCF.BasicHttpSendAdapter.BasicHttpWcfServiceConsuming.OrderProcessServiceType" %>  
    ```  
  
5.  <span data-ttu-id="d0b8e-155">在[!INCLUDE[vs2010](../includes/vs2010-md.md)]，在 [方案總管] 中，開啟**Web.config**檢閱。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-155">In [!INCLUDE[vs2010](../includes/vs2010-md.md)], in Solution Explorer, open **Web.config** to review.</span></span> <span data-ttu-id="d0b8e-156">在 IIS 中裝載時[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]裝載於主控台應用程式時，使用 Web.config 檔案而不做為 app.config 檔案設定服務。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-156">When hosted in IIS, a [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service is configured using a Web.config file instead of an app.config file as when hosted in a console application.</span></span>  
  
    -   <span data-ttu-id="d0b8e-157">請確定**httpGetEnabled**屬性\< **serviceMetaData**> 元素會設定為`true`以便**BizTalk WCF 服務使用精靈**可以取用的服務中繼資料。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-157">Make sure that the **httpGetEnabled** attribute of the \<**serviceMetaData**> element is set to `true` so that the **BizTalk WCF Service Consuming Wizard** can consume the metadata for the service.</span></span>  
  
    -   <span data-ttu-id="d0b8e-158">請確定**模式**屬性\<**安全性**> 元素會設定為**無**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-158">Make sure that the **mode** attribute of the \<**security**> element is set to **None**.</span></span> <span data-ttu-id="d0b8e-159">因為本逐步解說使用**無**安全性模式中，Web 應用程式裝載此服務必須設定為允許匿名存取。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-159">Because this walkthrough uses the **None** security mode, the Web application hosting this service must be configured to allow anonymous access.</span></span>  
  
6.  <span data-ttu-id="d0b8e-160">因為**Microsoft.Samples.BizTalk.WCF.BasicHttpSendAdapter.BasicHttpWcfServiceConsuming**該組件必須安裝在 GAC 中，它將需要強式名稱金鑰檔案，以完成部署程序。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-160">Because the **Microsoft.Samples.BizTalk.WCF.BasicHttpSendAdapter.BasicHttpWcfServiceConsuming** assembly must be installed in the GAC, it will need a strong name key file to complete the deployment process.</span></span> <span data-ttu-id="d0b8e-161">以滑鼠右鍵按一下**BasicHttpWcfServiceConsuming**專案，然後再按一下**屬性**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-161">Right-click the **BasicHttpWcfServiceConsuming** project, and then click **Properties**.</span></span> <span data-ttu-id="d0b8e-162">在**屬性**頁面上，按一下**簽署**，然後選取**簽署組件**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-162">On the **Properties** page, click **Signing**, and select **Sign the assembly**.</span></span> <span data-ttu-id="d0b8e-163">按一下向下的箭號，在**選擇強式名稱金鑰檔**下拉式清單中，按一下  **\<新增 >**，並輸入`keyfile.snk`中**金鑰檔名稱**文字方塊.</span><span class="sxs-lookup"><span data-stu-id="d0b8e-163">Click the down arrow in the **Choose a strong name key file** drop-down list, click **\<New>**, and enter `keyfile.snk` in the **key file name** textbox.</span></span>  <span data-ttu-id="d0b8e-164">取消核取**保護我的密碼金鑰檔**，然後按一下 **確定**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-164">Uncheck **Protect my key file with a password**, and then click **OK**.</span></span>  
  
7.  <span data-ttu-id="d0b8e-165">在 方案總管 中，以滑鼠右鍵按一下**BasicHttpWcfServiceConsuming**，然後按一下 **重建**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-165">In Solution Explorer, right-click **BasicHttpWcfServiceConsuming**, and then click **Rebuild**.</span></span>  
  
8.  <span data-ttu-id="d0b8e-166">使用 Windows 檔案總管 中，將複製的內容**C:\WCFBasicHttpSendAdapter\BasicHttpWCFServiceConsuming**至**C:\InetPub\wwwroot**資料夾。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-166">Using Windows Explorer, copy the contents of **C:\WCFBasicHttpSendAdapter\BasicHttpWCFServiceConsuming** to the **C:\InetPub\wwwroot** folder.</span></span>  
  
9. <span data-ttu-id="d0b8e-167">將 Web 應用程式設定為裝載 [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] 服務，如下所示：</span><span class="sxs-lookup"><span data-stu-id="d0b8e-167">Configure the Web application to host the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service as follows:</span></span>  
  
    1.  <span data-ttu-id="d0b8e-168">按一下**啟動**，指向 **系統管理工具**，然後按一下 **網際網路資訊服務 (IIS) 管理員**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-168">Click **Start**, point to **Administrator Tools**, and then click **Internet Information Services (IIS) Manager**.</span></span>  
  
    2.  <span data-ttu-id="d0b8e-169">建立此服務會在其中執行的應用程式集區。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-169">Create an application pool within which this service will run.</span></span> <span data-ttu-id="d0b8e-170">以滑鼠右鍵按一下**應用程式集區**，按一下 **新增應用程式集區...**，輸入應用程式集區的名稱，然後按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-170">Right-click **Application Pools**, click **Add Application Pool…**, enter a name for the application pool, and then click **OK**.</span></span>  
  
    3.  <span data-ttu-id="d0b8e-171">展開**應用程式集區**，以滑鼠右鍵按一下您剛在應用程式集區建立，並選取**進階設定**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-171">Expand **Application Pools**, right-click the application pool you just created, and then select **Advanced Settings**.</span></span> <span data-ttu-id="d0b8e-172">在下**處理序模型**區段中，輸入擁有存取權的帳戶[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]資料庫下**識別**欄位。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-172">Under **Process Model** section, enter the account which has access to the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases under the **Identity** field.</span></span>  
  
    4.  <span data-ttu-id="d0b8e-173">展開**網站**，依序展開**Default Web Site**，以滑鼠右鍵按一下**BasicHttpWCFServiceConsuming**，然後按一下 **轉換成應用程式**建立此 Web 應用程式[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-173">Expand **Sites**, expand **Default Web Site**, right-click **BasicHttpWCFServiceConsuming**, and then click **Convert to Application** to create a Web application for this [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service.</span></span>  
  
    5.  <span data-ttu-id="d0b8e-174">在**轉換成應用程式**對話方塊中，按一下 **選取**要選取稍早建立的應用程式集區，然後按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-174">In the **Convert to Application** dialog box, click **Select** to select the application pool created earlier, and then click **OK**.</span></span>  
  
    6.  <span data-ttu-id="d0b8e-175">在 [功能檢視] 中按一下**驗證**圖示，並確定**匿名驗證**選項**啟用**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-175">In Features View, click the **Authentication** icon and ensure that the **Anonymous Authentication** option is **enabled**.</span></span> <span data-ttu-id="d0b8e-176">這種情況支援[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務使用**無**安全性模式。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-176">This supports [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] services with the **None** security mode.</span></span>  
  
10. <span data-ttu-id="d0b8e-177">測試已發佈[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務，如下所示：</span><span class="sxs-lookup"><span data-stu-id="d0b8e-177">Test the published [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service as follows:</span></span>  
  
    1.  <span data-ttu-id="d0b8e-178">在 [IIS 管理員] 中，展開**網站**，然後展開**BasicHttpWCFServiceConsuming**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-178">In IIS Manager, expand **Web Sites**, and then expand **BasicHttpWCFServiceConsuming**.</span></span>  
  
    2.  <span data-ttu-id="d0b8e-179">在 IIS 管理員 中，在右窗格中，以滑鼠右鍵按一下**orderprocess.svc**，然後按一下 **瀏覽**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-179">In IIS Manager, in the right pane, right-click **OrderProcess.svc**, and then click **Browse**.</span></span> <span data-ttu-id="d0b8e-180">這會開啟 Internet Explorer 顯示**OrderProcessServiceType 服務**頁面，表示您已成功建立執行[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-180">This opens Internet Explorer to display the **OrderProcessServiceType Service** page that indicates you have successfully created a running [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service.</span></span> <span data-ttu-id="d0b8e-181">此頁面還包含完整的 WSDL 位址，可讓您複製和搭配服務中繼資料工具 (svcutil.exe) 用來建立 Proxy 程式碼，以及一個組態檔，可用來開發服務的用戶端應用程式。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-181">The page also includes a full WSDL address that you can copy and use with the Service Metadata Tool (svcutil.exe) to create proxy code and a configuration file that can be used to develop a client application for the service.</span></span>  
  
    3.  <span data-ttu-id="d0b8e-182">將系統的完整 WSDL 位址複製到剪貼簿。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-182">Copy the full WSDL address to the system Clipboard.</span></span> <span data-ttu-id="d0b8e-183">請勿複製**"svcutil.exe"**部分： **http://localhost/BasicHttpWcfServiceConsuming/OrderProcess.svc?wsdl**</span><span class="sxs-lookup"><span data-stu-id="d0b8e-183">Do not copy the **“svcutil.exe”** part: **http://localhost/BasicHttpWcfServiceConsuming/OrderProcess.svc?wsdl**</span></span>  
  
## <a name="add-the-schemas-and-types-for-the-wcf-basichttp-adapter-to-the-sample-biztalk-application"></a><span data-ttu-id="d0b8e-184">將結構描述和 Wcf-basichttp 配接器的類型加入至範例 BizTalk 應用程式</span><span class="sxs-lookup"><span data-stu-id="d0b8e-184">Add the schemas and types for the WCF-BasicHttp adapter to the sample BizTalk application</span></span>  
  
1.  <span data-ttu-id="d0b8e-185">因為配接器會呼叫[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務的方法需要從結構描述和類型如何呼叫該服務使用中繼資料的資訊。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-185">Since the adapter will call the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service it needs information from schemas and types about how to make that call to that service using the metadata.</span></span> <span data-ttu-id="d0b8e-186">**[Biztalkapp]**提供要使用的成品[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-186">**BizTalkApp** provides the artifacts to consume the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service.</span></span> <span data-ttu-id="d0b8e-187">在[!INCLUDE[vs2010](../includes/vs2010-md.md)]，在 [方案總管] 中，以滑鼠右鍵按一下**[biztalkapp]**，按一下**新增**，然後按一下 **新增產生的項目**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-187">In [!INCLUDE[vs2010](../includes/vs2010-md.md)], in Solution Explorer, right-click **BizTalkApp**, click **Add**, and then click **Add Generated Items**.</span></span>  
  
2.  <span data-ttu-id="d0b8e-188">在**新增產生的項目**對話方塊中，於**範本**區段中，選取**取用 WCF 服務**，然後按一下 **新增**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-188">In the **Add Generated Items** dialog box, in the **Templates** section, select **Consume WCF Service**, and then click **Add**.</span></span>  
  
3.  <span data-ttu-id="d0b8e-189">在**歡迎使用 BizTalk WCF 服務使用精靈**頁面上，按一下**下一步**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-189">On the **Welcome to the BizTalk WCF Service Consuming Wizard** page, click **Next**.</span></span> <span data-ttu-id="d0b8e-190">此精靈將讀取中繼資料，並建立結構描述和類型。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-190">This wizard will read the metadata and create schemas and types.</span></span>  
  
4.  <span data-ttu-id="d0b8e-191">在**中繼資料來源**頁面上，選取**中繼資料交換 (MEX) 端點**選項來取用中繼資料從 URL 已複製到剪貼簿中的上一個程序，然後按一下  **下一步**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-191">On the **Metadata source** page, select the **Metadata Exchange (MEX) endpoint** option to consume metadata from the URL that you copied to the Clipboard in the previous procedure, and then click **Next**.</span></span>  
  
5.  <span data-ttu-id="d0b8e-192">在**中繼資料端點**頁面上，您在前述程序中複製的完整 WSDL 位址貼上**中繼資料位址**下拉式清單，然後按一下**取得**取得中繼資料文件中的範例[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-192">On the **Metadata Endpoint** page, paste the full WSDL address that you copied in the previous procedure to the **Metadata Address** drop-down list, and then click **Get** to get the metadata document for the sample [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service.</span></span> <span data-ttu-id="d0b8e-193">取得中繼資料可讓**下一步** 按鈕。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-193">Obtaining the metadata enables the **Next** button.</span></span> <span data-ttu-id="d0b8e-194">按 **[下一步]** ，繼續進行。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-194">Click **Next** to continue.</span></span>  
  
6.  <span data-ttu-id="d0b8e-195">在**匯入 WCF 服務中繼資料摘要**頁面上，檢閱您的設定。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-195">On the **Import WCF Service Metadata Summary** page, review your settings.</span></span> <span data-ttu-id="d0b8e-196">此對話方塊會顯示要匯入之中繼資料的命名空間、XSD 和 WSDL 摘要。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-196">This dialog box shows the namespace, XSD, and WSDL summaries of the metadata to be imported.</span></span> <span data-ttu-id="d0b8e-197">它也會顯示協調流程 (.odx)、 繫結 (.xml)，以及結構描述 (.xsd) 檔案將寫入其中的匯入程序。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-197">It also shows where orchestration (.odx), bindings (.xml), and schema (.xsd) files will be written during the import process.</span></span> <span data-ttu-id="d0b8e-198">按一下**匯入**建立 BizTalk 成品和使用範例使用的型別[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-198">Click **Import** to create the BizTalk artifacts and types to be used for consuming the sample [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service.</span></span>  
  
7.  <span data-ttu-id="d0b8e-199">在**完成 BizTalk WCF 服務使用精靈**頁面上，按一下**完成**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-199">On the **Completing the BizTalk WCF Service Consuming Wizard** page, click **Finish**.</span></span>  
  
8.  <span data-ttu-id="d0b8e-200">在[!INCLUDE[vs2010](../includes/vs2010-md.md)]，在 方案總管**BizTalk WCF 服務使用精靈**會產生下列檔案：</span><span class="sxs-lookup"><span data-stu-id="d0b8e-200">In [!INCLUDE[vs2010](../includes/vs2010-md.md)], in Solution Explorer, the **BizTalk WCF Service Consuming Wizard** generates the following files:</span></span>  
  
    -   <span data-ttu-id="d0b8e-201">協調流程檔案**OrderProcessServiceType.odx**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-201">An orchestration file **OrderProcessServiceType.odx**.</span></span> <span data-ttu-id="d0b8e-202">在此協調流程中有任何工作流程階段。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-202">There are no workflow stages in this orchestration.</span></span> <span data-ttu-id="d0b8e-203">不過，無法新增到它，然後將它繫結至邏輯連接埠取用[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-203">However, you could add to it and bind it to logical ports to consume the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service.</span></span> <span data-ttu-id="d0b8e-204">它包含重要的 BizTalk 類型，例如連接埠類型和多部分訊息類型，此範例中使用。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-204">It does contain the important BizTalk types such as port types and multipart message types, which are used in this sample.</span></span> <span data-ttu-id="d0b8e-205">若要檢視這項資訊，請按兩下**OrderProcessServiceType.odx**協調流程。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-205">To view this information, double-click the **OrderProcessServiceType.odx** orchestration.</span></span> <span data-ttu-id="d0b8e-206">按一下**檢視**，按一下 **其他視窗**，然後按一下**協調流程檢視**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-206">Click **View**, click **Other Windows**, and click **Orchestration View**.</span></span> <span data-ttu-id="d0b8e-207">展開**類型**，依序展開**連接埠類型**，然後展開**IOrderProcess**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-207">Expand **Types**, expand **Port Types**, and then expand **IOrderProcess**.</span></span> <span data-ttu-id="d0b8e-208">您會看到**送出**方法。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-208">You will see the **Submit** method.</span></span> <span data-ttu-id="d0b8e-209">展開該方法，您會看到**OrderRequest**和**OrderResponse**連接埠類型。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-209">Expand that method and you will see the **OrderRequest** and **OrderResponse** port types.</span></span> <span data-ttu-id="d0b8e-210">按一下每個連接埠類型並檢視其**描述**屬性瀏覽器和不同的 WSDL，請參閱中的欄位輸入和輸出訊息。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-210">Click each port type and view their **Description** fields in the property browser and see the different WSDL input and output messages.</span></span> <span data-ttu-id="d0b8e-211">按一下**多部分訊息類型**並檢視**OrderRequest**和**OrderResponse**多部分訊息類型。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-211">Click **Multi-Part Message Types** and view the **OrderRequest** and **OrderResponse** multi-part message types.</span></span> <span data-ttu-id="d0b8e-212">按一下其**描述**欄位，並檢視其 WDSL 訊息的每個訊息類型的名稱。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-212">Click their **Description** fields and view the WDSL message names for each message type.</span></span>  
  
    -   <span data-ttu-id="d0b8e-213">會產生兩個結構描述檔案。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-213">Two schema files are generated.</span></span> <span data-ttu-id="d0b8e-214">第一個結構描述檔案 (**OrderProcessServiceType_biztalk_WCF_basichttpsendadapter_basichttpWCFserviceconsuming.xsd**) 定義的訊息類型範例[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務所使用。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-214">The first schema file (**OrderProcessServiceType_biztalk_WCF_basichttpsendadapter_basichttpWCFserviceconsuming.xsd**) defines the message types that the sample [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service uses.</span></span> <span data-ttu-id="d0b8e-215">它會使用**OrderID**欄位中都**OrderRequest**和**OrderResponse**呼叫。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-215">It uses the **OrderID** field in both **OrderRequest** and **OrderResponse** calls.</span></span>  
  
    -   <span data-ttu-id="d0b8e-216">第二個結構描述檔案 (**OrderProcessServiceType_schemas_microsoft_com_2003_10_Serialization.xsd**) 會匯出[DataContractSerializer](http://go.microsoft.com/fwlink/?LinkId=81722)類型、 元素和屬性命名空間、 http://schemas.microsoft.com/2003/10/Serialization/。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-216">The second schema file (**OrderProcessServiceType_schemas_microsoft_com_2003_10_Serialization.xsd**) is exported by [DataContractSerializer](http://go.microsoft.com/fwlink/?LinkId=81722) for the types, elements, and attributes from the namespace, http://schemas.microsoft.com/2003/10/Serialization/.</span></span>  
  
    -   <span data-ttu-id="d0b8e-217">產生兩個繫結檔案，這將會稍後可用於建立 BizTalk 應用程式： **OrderProcessServiceType.BindingInfo.xml**和**orderprocessservicetype_custom.bindinginfo.xml 這**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-217">Two binding files are generated, which will be used later to create the BizTalk application: **OrderProcessServiceType.BindingInfo.xml** and **OrderProcessServiceType_Custom.BindingInfo.xml**.</span></span> <span data-ttu-id="d0b8e-218">在一般情況下，您通常會使用非自訂繫結檔案。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-218">In the general case you will typically use the non-custom binding file.</span></span> <span data-ttu-id="d0b8e-219">但在某些罕見的情況下，您有使用自訂繫結檔案的自訂繫結項目。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-219">But in some rare situations where you have a custom binding element use the custom binding file.</span></span> <span data-ttu-id="d0b8e-220">自訂繫結項目會建立傳送埠的應用程式。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-220">The custom binding element creates send ports for the applications.</span></span> <span data-ttu-id="d0b8e-221">按兩下**OrderProcessServiceType.BindingInfo.xml**檔案，並搜尋**SendPort**定義行，以及檢閱檔案將會建立，當您匯入此繫結的傳送埠[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]:</span><span class="sxs-lookup"><span data-stu-id="d0b8e-221">Double-click the **OrderProcessServiceType.BindingInfo.xml** file and search for the **SendPort** definition line, and review the send port that will be created when you import this binding file into [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]:</span></span>  
  
        ```  
        <SendPort Name="WCFSendPort_OrderProcessServiceType_ServiceEndpoint" …  >  
        ```  
  
    -   <span data-ttu-id="d0b8e-222">這些檔案來進行傳送連接埠使用[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]配接器使用範例[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務中繼資料中所述。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-222">These files are used for the send port using the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] adapter to consume the sample [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service described in the metadata.</span></span>  
  
## <a name="deploy-the-sample-biztalk-solution-biztalkapp"></a><span data-ttu-id="d0b8e-223">部署範例 BizTalk 方案 BizTalkApp</span><span class="sxs-lookup"><span data-stu-id="d0b8e-223">Deploy the sample BizTalk solution, BizTalkApp</span></span>  
  
1.  <span data-ttu-id="d0b8e-224">部署 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 應用程式，如下所示：</span><span class="sxs-lookup"><span data-stu-id="d0b8e-224">Deploy the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] application as follows:</span></span>  
  
    1.  <span data-ttu-id="d0b8e-225">在[!INCLUDE[vs2010](../includes/vs2010-md.md)]，在 [方案總管] 中，以滑鼠右鍵按一下**[biztalkapp]**，然後按一下 **屬性**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-225">In [!INCLUDE[vs2010](../includes/vs2010-md.md)], in Solution Explorer, right-click **BizTalkApp**, and then click **Properties** .</span></span>  
  
    2.  <span data-ttu-id="d0b8e-226">在**專案設計工具**視窗中，按一下 **部署**索引標籤，然後再變更**伺服器**屬性，如果您使用不同的資料庫伺服器的[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理資料庫。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-226">In the **Project Designer** window, click **Deployment** tab, and then change the **Server** property if you use a different database server for the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Management database.</span></span> <span data-ttu-id="d0b8e-227">請確認應用程式的名稱**WCFBasicHttpSendAdapter**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-227">Ensure the application name is **WCFBasicHttpSendAdapter**.</span></span>  
  
    3.  <span data-ttu-id="d0b8e-228">在[!INCLUDE[vs2010](../includes/vs2010-md.md)]，在 [方案總管] 中，以滑鼠右鍵按一下**[biztalkapp]**，然後按一下 **重建**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-228">In [!INCLUDE[vs2010](../includes/vs2010-md.md)], in Solution Explorer, right-click **BizTalkApp**, and then click **Rebuild**.</span></span>  
  
    4.  <span data-ttu-id="d0b8e-229">在[!INCLUDE[vs2010](../includes/vs2010-md.md)]，在 [方案總管] 中，以滑鼠右鍵按一下**[biztalkapp]**，然後按一下 **部署**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-229">In [!INCLUDE[vs2010](../includes/vs2010-md.md)], in Solution Explorer, right-click **BizTalkApp**, and then click **Deploy**.</span></span>  <span data-ttu-id="d0b8e-230">這會將 Microsoft.Samples.BizTalk.WCF.BasicHttpSendAdapter.BizTalkApp 組件部署至 GAC 中，並要成品[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]名為應用程式**WCFBasicHttpSendAdapter**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-230">This deploys the Microsoft.Samples.BizTalk.WCF.BasicHttpSendAdapter.BizTalkApp assembly to the GAC, and the artifacts to the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] application named **WCFBasicHttpSendAdapter**.</span></span>  
  
2.  <span data-ttu-id="d0b8e-231">依照下列說明設定 BizTalk 應用程式中的 WCF-BasicHttp 傳送埠：</span><span class="sxs-lookup"><span data-stu-id="d0b8e-231">Configure a WCF-BasicHttp send port in the BizTalk application as follows:</span></span>  
  
    1.  <span data-ttu-id="d0b8e-232">按一下**啟動**，指向 **所有程式**，指向  [!INCLUDE[btsBizTalkServerStartMenuItemui](../includes/btsbiztalkserverstartmenuitemui-md.md)]，然後按一下  **BizTalk Server 管理**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-232">Click **Start**, point to **All Programs**, point to [!INCLUDE[btsBizTalkServerStartMenuItemui](../includes/btsbiztalkserverstartmenuitemui-md.md)], and then click **BizTalk Server Administration**.</span></span>  
  
    2.  <span data-ttu-id="d0b8e-233">在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]系統管理主控台中，展開**BizTalk 群組**，依序展開**應用程式**，以滑鼠右鍵按一下**WCFBasicHttpSendAdapter**，指向**匯入**，然後按一下 **繫結**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-233">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, expand **BizTalk Group**, expand **Applications**, right-click **WCFBasicHttpSendAdapter**, point to **Import**, and then click **Bindings**.</span></span>  
  
    3.  <span data-ttu-id="d0b8e-234">在**匯入繫結**對話方塊中，移至**C:\WCFBasicHttpSendAdapter\BizTalkApp**資料夾中，選取**OrderProcessServiceType.BindingInfo.xml**，然後按一下**開啟**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-234">In the **Import Bindings** dialog box, go to the **C:\WCFBasicHttpSendAdapter\BizTalkApp** folder, select **OrderProcessServiceType.BindingInfo.xml**, and then click **Open**.</span></span> <span data-ttu-id="d0b8e-235">這是其中一個所建立的繫結檔案**BizTalk WCF 服務使用精靈**之前。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-235">This is one of the binding files created by the **BizTalk WCF Service Consuming Wizard** previously.</span></span> <span data-ttu-id="d0b8e-236">這會建立**WCFSendPort_OrderProcessServiceType_ServiceEndpoint**傳送埠。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-236">This creates the **WCFSendPort_OrderProcessServiceType_ServiceEndpoint** send port.</span></span>  
  
    4.  <span data-ttu-id="d0b8e-237">在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]系統管理主控台中，展開**WCFBasicHttpSendAdapter**，然後按一下 **傳送埠**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-237">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, expand **WCFBasicHttpSendAdapter**, and then click **Send Ports**.</span></span>  
  
    5.  <span data-ttu-id="d0b8e-238">在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中的，在右窗格中，按兩下**WCFSendPort_OrderProcessServiceType_ServiceEndpoint**，這是藉由匯入繫結檔案[Orderprocessservicetype.bindinginfo.xml]。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-238">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, in the right pane, double-click **WCFSendPort_OrderProcessServiceType_ServiceEndpoint**, which was created by importing the binding file OrderProcessServiceType.BindingInfo.xml.</span></span> <span data-ttu-id="d0b8e-239">這會開啟**傳送埠屬性** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-239">This brings up the **Send Port Properties** dialog box.</span></span>  
  
    6.  <span data-ttu-id="d0b8e-240">在**傳送埠屬性**對話方塊中，按一下 **設定**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-240">In the **Send Port Properties** dialog box, click **Configure**.</span></span>  
  
    7.  <span data-ttu-id="d0b8e-241">在**一般**索引標籤上檢閱**Address(URI)**欄位**http://localhost/BasicHttpWcfServiceConsuming/OrderProcess.svc**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-241">On the **General** tab review the **Address(URI)** field of **http://localhost/BasicHttpWcfServiceConsuming/OrderProcess.svc**.</span></span> <span data-ttu-id="d0b8e-242">這是位址[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]Wcf-basichttp 配接器會呼叫的 IIS 中裝載的服務。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-242">This is the address of the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service hosted in IIS that the WCF-BasicHttp adapter will call.</span></span>  
  
    8.  <span data-ttu-id="d0b8e-243">檢閱的內容**SOAP 動作標頭/動作**文字方塊：</span><span class="sxs-lookup"><span data-stu-id="d0b8e-243">Review the contents of the **SOAP Action header/Action** text box:</span></span>  
  
        ```  
        <BtsActionMapping xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">  
          <Operation Name="Submit" Action="http://Microsoft.Samples.BizTalk.WCF.BasicHttpSendAdapter.BasicHttpWcfServiceConsuming/IOrderProcess/Submit" />  
        </BtsActionMapping>  
        ```  
  
         <span data-ttu-id="d0b8e-244">此欄位指出傳出的 SOAP HTTP 要求訊息的目的。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-244">This field indicates the intent of the outgoing SOAP HTTP request message.</span></span> <span data-ttu-id="d0b8e-245">這裡會送出在呼叫作業 IOrderProcess 介面 Microsoft.Samples.BizTalk.WCF.BasicHttpSendAdapter.BasicHttpWcfServiceConsuming 命名空間中。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-245">Here it is to call the Submit operation on the IOrderProcess interface from the Microsoft.Samples.BizTalk.WCF.BasicHttpSendAdapter.BasicHttpWcfServiceConsuming namespace.</span></span>  
  
        > [!NOTE]
        >  <span data-ttu-id="d0b8e-246">繫結檔**BizTalk WCF 服務使用精靈**會使用產生的動作對應格式**StaticAction**屬性。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-246">The binding file that the **BizTalk WCF Service Consuming Wizard** generates uses the action mapping format for the **StaticAction** property.</span></span> <span data-ttu-id="d0b8e-247">使用時針對 WCF 傳送配接器傳送訊息至 WCF 服務內容架構路由，您需要設定**BTS。作業**動作對應格式用於內容為基礎的路由之欄位的管線元件中的屬性。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-247">When using content-based routing for the WCF send adapters to send messages to WCF services, you need to set the **BTS.Operation** property in pipeline components for the action mapping format as the field to be used for content-based routing.</span></span> <span data-ttu-id="d0b8e-248">或者，您可以針對以內容為基礎的路由使用單一動作格式。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-248">Alternatively, you can use the single action format for content-based routing.</span></span> <span data-ttu-id="d0b8e-249">在本逐步解說，您可以使用單一動作格式。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-249">In this walkthrough, you use the single action format.</span></span> <span data-ttu-id="d0b8e-250">如需單一動作格式和動作對應格式的詳細資訊，請參閱**Wcf-basichttp 傳輸屬性對話方塊、 傳送、 一般** 索引標籤[!INCLUDE[ui-guidance-developers-reference](../includes/ui-guidance-developers-reference.md)]。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-250">For more information about the single action format and the action mapping format, see the **WCF-BasicHttp Transport Properties Dialog Box, Send, General** tab [!INCLUDE[ui-guidance-developers-reference](../includes/ui-guidance-developers-reference.md)].</span></span>  
  
    9. <span data-ttu-id="d0b8e-251">按一下**確定**兩次以返回[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-251">Click **OK** twice to return to the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span>  
  
3.  <span data-ttu-id="d0b8e-252">建立靜態單向接收埠和接收位置的檔案。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-252">Create a one-way static receive port and a FILE receive location.</span></span> <span data-ttu-id="d0b8e-253">接收埠是一或多個接收位置的邏輯容器。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-253">A receive port is a logical container for one or more receive locations.</span></span> <span data-ttu-id="d0b8e-254">這是您將放置範例[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]訊息，將會收取的 File 配接器，並再傳送至[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-254">This is where you will drop a sample [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] message that will be picked up by the File adapter, and then sent to the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service.</span></span>  
  
    1.  <span data-ttu-id="d0b8e-255">在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，展開**WCFBasicHttpSendAdapter**，以滑鼠右鍵按一下**接收埠**，指向 **新增**，然後按一下  **單向接收埠**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-255">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, expand **WCFBasicHttpSendAdapter**, right-click **Receive Ports**, point to **New**, and then click **One-way Receive Port**.</span></span>  
  
    2.  <span data-ttu-id="d0b8e-256">在**接收埠屬性**對話方塊中，於**名稱**文字方塊中，輸入`WCFBasicSendAdapter.ReceivePurchaseOrder`，然後按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-256">In the **Receive Port Properties** dialog box, in the **Name** text box, type `WCFBasicSendAdapter.ReceivePurchaseOrder`, and then click **OK**.</span></span>  
  
    3.  <span data-ttu-id="d0b8e-257">在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，以滑鼠右鍵按一下**WCFBasicHttpSendAdapter.ReceivePurchaseOrder**，指向 **新增**，然後按一下 **接收位置**.</span><span class="sxs-lookup"><span data-stu-id="d0b8e-257">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, right-click **WCFBasicHttpSendAdapter.ReceivePurchaseOrder**, point to **New**, and then click **Receive Location**.</span></span>  
  
    4.  <span data-ttu-id="d0b8e-258">在**接收位置屬性**對話方塊中，於**名稱**文字方塊中，輸入`WCFBasicSendAdapter.ReceivePurchaseOrder.FILE`。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-258">In the **Receive Location Properties** dialog box, in the **Name** text box, type `WCFBasicSendAdapter.ReceivePurchaseOrder.FILE`.</span></span>  
  
    5.  <span data-ttu-id="d0b8e-259">在**接收位置屬性**對話方塊中，於**傳輸**區段旁邊**類型**，選取**檔案**從下拉式清單中，然後按一下 **設定**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-259">In the **Receive Location Properties** dialog box, in the **Transport** section next to **Type**, select **FILE** from the drop-down list, and then click **Configure**.</span></span>  
  
    6.  <span data-ttu-id="d0b8e-260">在**FILE 傳輸屬性**對話方塊**一般**索引標籤的**接收資料夾**文字方塊中，輸入`C:\WCFBasicHttpSendAdapter\OrderRequestIn`，然後按一下 **確定**.</span><span class="sxs-lookup"><span data-stu-id="d0b8e-260">In the **FILE Transport Properties** dialog box, on the **General**  tab, in the **Receive folder** text box, type `C:\WCFBasicHttpSendAdapter\OrderRequestIn`, and then click **OK**.</span></span>  
  
    7.  <span data-ttu-id="d0b8e-261">在**接收位置屬性**對話方塊中，按一下 **確定**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-261">In the **Receive Location Properties** dialog box, click **OK**.</span></span>  
  
4.  <span data-ttu-id="d0b8e-262">建立篩選器將訊息路由至 Wcf-basichttp 傳送檔案中的連接埠會接收您在上一個步驟中建立的位置。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-262">Create a filter to route messages to the WCF-BasicHttp send port from the FILE receive location that you created in the previous step.</span></span> <span data-ttu-id="d0b8e-263">連接埠相關聯的篩選條件就像是 SQL"where"子句中，如果評估為 true，訊息會指定該通訊埠。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-263">A filter associated with a port acts like a SQL “where” clause in that if it evaluates to true the message will be given to that port.</span></span>  
  
    1.  <span data-ttu-id="d0b8e-264">在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]系統管理主控台中，展開**WCFBasicHttpSendAdapter**，按一下 **傳送埠**，然後按兩下**WCFSendPort_OrderProcessServiceType_ServiceEndpoint**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-264">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, expand **WCFBasicHttpSendAdapter**, click **Send Ports**, and then double-click **WCFSendPort_OrderProcessServiceType_ServiceEndpoint**.</span></span>  
  
    2.  <span data-ttu-id="d0b8e-265">在**傳送埠屬性**對話方塊**篩選**索引標籤上，選取**BTS。ReceivePortName**中**屬性**欄位中，輸入`WCFBasicSendAdapter.ReceivePurchaseOrder`中**值**欄位，，然後按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-265">In the **Send Port Properties** dialog box, on the **Filters** tab, select **BTS.ReceivePortName** in the **Property** field, type `WCFBasicSendAdapter.ReceivePurchaseOrder` in the **Value** field, and then click **OK**.</span></span> <span data-ttu-id="d0b8e-266">這個篩選條件運算式會路由傳送內送訊息從 WCFBasicSendAdapter.ReceivePurchaseOrder 接收這個 Wcf-basichttp 傳送埠的連接埠。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-266">This filter expression routes incoming messages from the WCFBasicSendAdapter.ReceivePurchaseOrder receive port to this WCF-BasicHttp send port.</span></span>  
  
5.  <span data-ttu-id="d0b8e-267">建立範例應用程式的兩個檔案傳送埠。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-267">Create two FILE send ports for the sample application.</span></span> <span data-ttu-id="d0b8e-268">第一個傳送埠將訊息檔案的連接埠的輸出回應[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-268">The first send port sends output response messages to the FILE port from the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service.</span></span> <span data-ttu-id="d0b8e-269">第二個傳送埠用來處理錯誤訊息從傳送[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務針對用戶端。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-269">The second send port is used to handle fault messages sent from the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service destined for the client.</span></span>  
  
    1.  <span data-ttu-id="d0b8e-270">在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，展開**WCFBasicHttpSendAdapter**，以滑鼠右鍵按一下**傳送埠**，指向 **新增**，然後按一下  **靜態單向傳送埠**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-270">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, expand **WCFBasicHttpSendAdapter**, right-click **Send Ports**, point to **New**, and then click **Static One-way Send Port**.</span></span>  
  
    2.  <span data-ttu-id="d0b8e-271">在**傳送埠屬性**對話方塊中，於**名稱**文字方塊中，輸入`WCFBasicSendAdapter.SendPurchaseOrder.FILE`。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-271">In the **Send Port Properties** dialog box, in the **Name** text box, type `WCFBasicSendAdapter.SendPurchaseOrder.FILE`.</span></span>  
  
    3.  <span data-ttu-id="d0b8e-272">在**傳送埠屬性**對話方塊中，於**傳輸**區段類型，選取旁的**檔案**從下拉式清單，然後按一下**設定**.</span><span class="sxs-lookup"><span data-stu-id="d0b8e-272">In the **Send Port Properties** dialog box, in the **Transport** section next to Type, select **FILE** from the drop-down list, and then click **Configure**.</span></span>  
  
    4.  <span data-ttu-id="d0b8e-273">在**FILE 傳輸屬性**對話方塊**一般**索引標籤的**目的地資料夾**文字方塊中，輸入`C:\WCFBasicHttpSendAdapter\OrderResponseOut`，然後按一下  **確定**.</span><span class="sxs-lookup"><span data-stu-id="d0b8e-273">In the **FILE Transport Properties** dialog box, on the **General** tab, in the **Destination folder** text box, type `C:\WCFBasicHttpSendAdapter\OrderResponseOut`, and then click **OK**.</span></span>  
  
    5.  <span data-ttu-id="d0b8e-274">在**傳送埠屬性**對話方塊**篩選**索引標籤上，選取**BTS。MessageType**中**屬性**欄位中，輸入`http://Microsoft.Samples.BizTalk.WCF.BasicHttpSendAdapter.BasicHttpWCFServiceConsuming#OrderResponse`中**值**欄位來指定從範例回應訊息類型[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務，以及然後按一下 **確定**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-274">In the **Send Port Properties** dialog box, on the **Filters** tab, select **BTS.MessageType** in the **Property** field, type `http://Microsoft.Samples.BizTalk.WCF.BasicHttpSendAdapter.BasicHttpWCFServiceConsuming#OrderResponse` in the **Value** field to specify the response message type from the sample [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service, and then click **OK**.</span></span> <span data-ttu-id="d0b8e-275">這個篩選條件運算式會從範例回應訊息路由傳送[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務，此檔案傳送埠。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-275">This filter expression routes response messages from the sample [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service to this FILE send port.</span></span> <span data-ttu-id="d0b8e-276">傳送埠訂閱 OrderResponse 類型的訊息篩選條件屬性中指定該型別。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-276">The send port subscribes to messages of the OrderResponse type by specifying that type in the filter property.</span></span> <span data-ttu-id="d0b8e-277">這是從回應訊息的訊息類型[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-277">This is the message type of the response message from the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service.</span></span>  
  
    6.  <span data-ttu-id="d0b8e-278">在**傳送埠屬性**對話方塊中，按一下 **確定**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-278">In the **Send Port Properties** dialog box, click **OK**.</span></span>  
  
    7.  <span data-ttu-id="d0b8e-279">在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，展開**WCFBasicHttpSendAdapter**，以滑鼠右鍵按一下**傳送埠**，指向 **新增**，然後按一下  **靜態單向傳送埠**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-279">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, expand **WCFBasicHttpSendAdapter**, right-click **Send Ports**, point to **New**, and then click **Static One-way Send Port**.</span></span>  
  
    8.  <span data-ttu-id="d0b8e-280">在**傳送埠屬性**對話方塊中，於**名稱**文字方塊中，輸入`WCFAdapterErrorSend.FILE`。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-280">In the **Send Port Properties** dialog box, in the **Name** text box, type `WCFAdapterErrorSend.FILE`.</span></span>  
  
    9. <span data-ttu-id="d0b8e-281">在**傳送埠屬性**對話方塊中，於**傳輸**區段旁邊**類型**，選取**檔案**從下拉式清單中，然後按一下**設定**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-281">In the **Send Port Properties** dialog box, in the **Transport** section next to **Type**, select **FILE** from the drop-down list, and then click **Configure**.</span></span>  
  
    10. <span data-ttu-id="d0b8e-282">在**FILE 傳輸屬性**對話方塊**一般**索引標籤的**目的地資料夾**文字方塊中，輸入`C:\WCFBasicHttpSendAdapter\WCFAdapterErrorOut\`，然後按一下  **確定**.</span><span class="sxs-lookup"><span data-stu-id="d0b8e-282">In the **FILE Transport Properties** dialog box, on the **General** tab, in the **Destination folder** text box, type `C:\WCFBasicHttpSendAdapter\WCFAdapterErrorOut\`, and then click **OK**.</span></span>  
  
    11. <span data-ttu-id="d0b8e-283">在**傳送埠屬性**對話方塊**篩選**索引標籤上，選取**WCF。IsFault**中**屬性**欄位中，輸入`True`中**值**欄位，，然後按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-283">In the **Send Port Properties** dialog box, on the **Filters** tab, select **WCF.IsFault** in the **Property** field, type `True` in the **Value** field, and then click **OK**.</span></span> <span data-ttu-id="d0b8e-284">應用程式中發生例外狀況或錯誤可以偵測檢查**WCF。IsFault**回呼叫端所傳送之訊息的屬性。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-284">Within an application an exception or fault can be detected by checking the **WCF.IsFault** property of the message sent back to the caller.</span></span> <span data-ttu-id="d0b8e-285">這個屬性會設定為**True**如果所傳送訊息的 SOAP 錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-285">This property will be set to **True** if the message being sent is a SOAP fault message.</span></span> <span data-ttu-id="d0b8e-286">這個篩選條件運算式會路由傳送來自範例錯誤訊息[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務，此檔案傳送埠。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-286">This filter expression routes fault messages from the sample [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service to this FILE send port.</span></span>  
  
6.  <span data-ttu-id="d0b8e-287">指定範例應用程式的主控件名稱和繫結，如下所示：</span><span class="sxs-lookup"><span data-stu-id="d0b8e-287">Specify the host name and bindings for the sample application as follows:</span></span>  
  
     <span data-ttu-id="d0b8e-288">在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]系統管理主控台中，展開**WCFBasicHttpSendAdapter**，依序展開**協調流程**，以滑鼠右鍵按一下**Microsoft.Samples.BizTalk.WCF.BasicHttpSendAdapter.BizTalkApp.OrderProcessServiceTypeClient**協調流程中，按一下 **屬性**，按一下 **繫結**，設定**主機**至**[biztalkserverapplication]**，然後按一下 **確定**儲存設定。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-288">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, expand **WCFBasicHttpSendAdapter**, expand **Orchestrations**, right-click the **Microsoft.Samples.BizTalk.WCF.BasicHttpSendAdapter.BizTalkApp.OrderProcessServiceTypeClient** orchestration, click **Properties**, click **Bindings**, set **Host** to **BizTalkServerApplication**, and then click **OK** to save the configuration.</span></span>  
  
## <a name="test-the-sample-solution-with-the-wcf-basichttp-send-adapter"></a><span data-ttu-id="d0b8e-289">測試範例解決方案使用 Wcf-basichttp 傳送配接器</span><span class="sxs-lookup"><span data-stu-id="d0b8e-289">Test the sample solution with the WCF-BasicHttp send adapter</span></span>  
  
1.  <span data-ttu-id="d0b8e-290">在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，以滑鼠右鍵按一下**WCFBasicHttpSendAdapter**，然後按一下 **啟動**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-290">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, right-click **WCFBasicHttpSendAdapter**, and then click **Start**.</span></span>  
  
2.  <span data-ttu-id="d0b8e-291">在**啟動**對話方塊中，按一下 **啟動**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-291">In the **Start** dialog box, click **Start**.</span></span>  
  
3.  <span data-ttu-id="d0b8e-292">在[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，展開**平台設定**，依序展開**主控件執行個體**，以滑鼠右鍵按一下**BizTalkServerApplication**或另一個適當的主控件執行個體，，然後按一下 **重新啟動**。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-292">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, expand **Platform Settings**, expand **Host Instances**, right-click **BizTalkServerApplication** or another appropriate host instance, and then click **Restart**.</span></span>  
  
4.  <span data-ttu-id="d0b8e-293">開啟命令提示字元，輸入**iisreset**回收 IIS 及其相依的服務，然後按下 ENTER。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-293">Open a command prompt, type **iisreset** to recycle IIS and its dependent services, and then press ENTER.</span></span>  
  
5.  <span data-ttu-id="d0b8e-294">在命令提示字元中，複製**C:\WCFBasicHttpSendAdapter\TestData\WCFBasicSendAdapter.OrderRequest.Sample.xml**至**C:\WCFBasicHttpSendAdapter\OrderRequestIn**資料夾。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-294">At the command prompt, copy **C:\WCFBasicHttpSendAdapter\TestData\WCFBasicSendAdapter.OrderRequest.Sample.xml** to the **C:\WCFBasicHttpSendAdapter\OrderRequestIn** folder.</span></span> <span data-ttu-id="d0b8e-295">此訊息會路由至雙向**WcfSendPort_OrderProcessServiceType_ServiceEndpoint**靜態請求-回應傳送埠。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-295">This message is routed to the two-way **WcfSendPort_OrderProcessServiceType_ServiceEndpoint** static Solicit-Response send port.</span></span>  <span data-ttu-id="d0b8e-296">傳送端的此雙向傳送埠呼叫**送出**方法[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]IIS 中裝載的服務。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-296">The send side of this two-way send port calls **Submit** method on the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service hosted in IIS.</span></span> <span data-ttu-id="d0b8e-297">結果會傳回到回應連接埠的**WcfSendPort_OrderProcessServiceType_ServiceEndpoint**傳送埠。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-297">The result is returned to the response port of the **WcfSendPort_OrderProcessServiceType_ServiceEndpoint** send port.</span></span>  <span data-ttu-id="d0b8e-298">**WCFBasicSendAdapter.SendPurchaseOrder.FILE**傳送連接埠的訊息類型時，將會觸發的訂閱**http://Microsoft.Samples.BizTalk.WCF.BasicHttpSendAdapter.BasicHttpWCFServiceConsuming#OrderResponse**。它會取得已成功處理的訊息，並寫出至**C:\WCFBasicHttpSendAdapter\OrderResponseOut**資料夾。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-298">The **WCFBasicSendAdapter.SendPurchaseOrder.FILE** send port has a subscription that will be triggered when the type of the message is **http://Microsoft.Samples.BizTalk.WCF.BasicHttpSendAdapter.BasicHttpWCFServiceConsuming#OrderResponse**.It will get the successfully processed message and write it out to the **C:\WCFBasicHttpSendAdapter\OrderResponseOut** folder.</span></span>  
  
6.  <span data-ttu-id="d0b8e-299">請檢查**C:\WCFBasicHttpSendAdapter\OrderResponseOut**來自回應訊息的資料夾[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-299">Check the **C:\WCFBasicHttpSendAdapter\OrderResponseOut** folder for a response message from the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service.</span></span>  
  
7.  <span data-ttu-id="d0b8e-300">在命令提示字元中， **C:\WCFBasicHttpSendAdapter\TestData\WCFBasicSendAdapter.OrderRequest.Invalid.xml**至**C:\WCFBasicHttpSendAdapter\OrderRequestIn**資料夾。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-300">At the command prompt, **C:\WCFBasicHttpSendAdapter\TestData\WCFBasicSendAdapter.OrderRequest.Invalid.xml** to the **C:\WCFBasicHttpSendAdapter\OrderRequestIn** folder.</span></span> <span data-ttu-id="d0b8e-301">此訊息包含無效的命名空間，因此 [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] 服務會傳回錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-301">This message contains an invalid namespace so that the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service returns a fault message.</span></span>  
  
8.  <span data-ttu-id="d0b8e-302">請檢查**C:\WCFBasicHttpSendAdapter\WCFAdapterErrorOut**包含錯誤訊息，從 XML 檔案的資料夾[!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)]服務。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-302">Check the **C:\WCFBasicHttpSendAdapter\WCFAdapterErrorOut** folder for an XML file containing the fault message from the [!INCLUDE[nextref_btsWinCommFoundation](../includes/nextref-btswincommfoundation-md.md)] service.</span></span> <span data-ttu-id="d0b8e-303">查看\< **g**> 欄位顯示為無效的訊息本文的錯誤訊息的原因。</span><span class="sxs-lookup"><span data-stu-id="d0b8e-303">Look at the \<**faultstring**> field showing the cause of the fault message to be an invalid message body.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d0b8e-304">另請參閱</span><span class="sxs-lookup"><span data-stu-id="d0b8e-304">See Also</span></span>  
 <span data-ttu-id="d0b8e-305">[逐步解說： 使用發佈 WCF 服務 Wcf-basichttp 配接器](../core/walkthrough-publishing-wcf-services-with-the-wcf-basichttp-adapter.md) </span><span class="sxs-lookup"><span data-stu-id="d0b8e-305">[Walkthrough: Publishing WCF Services with the WCF-BasicHttp Adapter](../core/walkthrough-publishing-wcf-services-with-the-wcf-basichttp-adapter.md) </span></span>  
 <span data-ttu-id="d0b8e-306">[如何使用 BizTalk WCF 服務使用精靈來取用 WCF 服務](../core/how-to-use-the-biztalk-wcf-service-consuming-wizard-to-consume-a-wcf-service.md) </span><span class="sxs-lookup"><span data-stu-id="d0b8e-306">[How to Use the BizTalk WCF Service Consuming Wizard to Consume a WCF Service](../core/how-to-use-the-biztalk-wcf-service-consuming-wizard-to-consume-a-wcf-service.md) </span></span>  
 [<span data-ttu-id="d0b8e-307">指定訊息本文為 WCF 配接器</span><span class="sxs-lookup"><span data-stu-id="d0b8e-307">Specifying the Message Body for the WCF Adapters</span></span>](../core/specifying-the-message-body-for-the-wcf-adapters.md)