---
title: "EDI 類型 （資料元素） 驗證 |Microsoft 文件"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: cd53685f-a49c-41c8-813e-29700fc0b62b
caps.latest.revision: "19"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 88a71a44c305e1eabbcdb9aede32b44439f6b03c
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
---
# <a name="edi-type-data-element-validation"></a>EDI 類型 (資料元素) 驗證
EDI 接收管線和 EDI 傳送管線，可以對交易集資料元素執行 EDI 驗證。 這項驗證來自或通往特定合作對象，透過該合作對象的協議屬性的所有訊息上設定**驗證**頁面 (在**交易集設定**任一 X12 區段或 EDIFACT 協議）。 如果**EDI 類型驗證**屬性中未選取**驗證**頁面上，將不會執行驗證，本主題所描述的資料。  
  
 EDI 類型驗證已啟用內送與外寄訊息的選取**EDI 類型驗證**屬性**驗證**中雙向協議索引標籤頁面**協議屬性** 對話方塊。 對於內送和外寄訊息，這個屬性預設會選取，因此預設會啟用 EDI 驗證。  
  
## <a name="validation-checks"></a>驗證檢查  
 EDI 接收管線或 EDI 傳送管線在執行 EDI 驗證時，會驗證下列項目：  
  
-   由結構描述之 EDI 屬性所定義的資料型別  
  
-   長度限制  
  
-   空白資料元素和尾端分隔符號  
  
    > [!NOTE]
    >  這項驗證不會檢查程式碼集合 (列舉) 或 Min Occurs 或 Max Occurs。  
  
 **字元集**  
  
 若要執行 EDI 資料元素驗證，EDI 接收和傳送管線會要求依下列方式來建立此字元集：  
  
-   對於 EDIFACT，資料元素中建立字元集**UNB1**的**字元集和分隔符號**單向協議索引標籤的頁面**協議屬性**對話方塊或**EDIFACT 後援設定**對話方塊 （若已建立協議）。  
  
-   對於 KEDIFACT，字元在資料元素中建立**UNB1**的**字元集和分隔符號**單向協議索引標籤的頁面**協議屬性**對話方塊方塊中，EDIFACT 一樣。 值**UNB1.1**元素必須設定為`KECA`。  
  
-   對於 X12，要在管線屬性中建立訊息的字元集。  
  
    > [!NOTE]
    >  當 BizTalk 執行階段對訊息執行 EDI 驗證時，它會使用已在管線屬性中選取的 X12 字元集。 不過，屬性的驗證輸入的頁面中**協議屬性**對話方塊使用的字元集中已選取執行**字元集和分隔符號**該對話方塊的頁面。 在執行階段，管線會忽略此值的 x12 字元集屬性**字元集和分隔符號**頁面**協議屬性** 對話方塊。 如果這兩項設定不相同 (也就是，X12 字元集屬性**協議屬性**對話方塊設**擴充**而管線屬性中的字元屬性設定為 X12**基本**)，可能會造成驗證錯誤訊息。  
  
 **資料型別驗證**  
  
 對於 X12，結構描述中會標註下列 EDI 資料型別，應由接收管線或傳送管線中的解譯器/組合器元件進行驗證：Numeric、Decimal、Identifier、String、Date、Time、Binary 和 Composite。  
  
 對於 EDIFACT，結構描述中會標註下列 EDI 資料型別，應由接收管線或傳送管線中的解譯器/組合器元件進行驗證：Alphabetic、Numeric、Identifier、String 和 Composite。  
  
 **長度限制**  
  
 對於 X12 和 EDIFACT，元素或子元素都必須通過長度 (最小值和最大值) 需求的驗證。 長度定義為所使用的字元位置數目。 長度不包括正負號和小數點標記。  
  
> [!NOTE]
>  如果是 X12_AN 字串資料型別，則會保留前置空格，而且允許任何區段中使用尾端空格以滿足最小長度需求。  
  
 對於 KECA，長度是解譯為位元組數目。 例如，如果長度定義為三，則元素或子元素可以包含三個單一位元組字元，或是一個雙位元組字元和一個單一位元組字元的組合。  
  
 **空白資料元素和尾端分隔符號驗證**  
  
 對於 X12，如果區段出現不可空白執行個體中標示為必要的資料元素。 若是複合資料元素，至少必須要有一個元件資料元素有設定值。  
  
 對於 EDIFACT，可以排除非值和條件式資料元素 (和子元件)，不過分隔符號會加以保留。  
  
 尾端分隔符號對 X12 或 EDIFACT 來說都不是必要項，但建議使用它。  
  
## <a name="when-edi-type-validation-is-disabled"></a>當 EDI 類型驗證停用時  
 如果您停用 EDI 類型驗證，則 EDI 接收管線或 EDI 傳送管線會處理由 EDI 類型驗證檢查出有錯誤的資料元素，而不會擱置要進行處理的訊息。  
  
> [!NOTE]
>  即使 EDI 類型驗證已停用，則會執行 EDI 結構驗證。 未通過基本結構驗證的交換將遭擱置，即使 EDI 類型驗證已停用。  
  
 下面是一些會被處理而不會造成訊息擱置的錯誤：  
  
-   未預期/未定義的交易集  
  
-   位在區段/迴圈和資料元素層級的未預期/未定義的資料  
  
-   位在區段/迴圈和資料元素層級的選用性 (Min Occurs 和 Max Occurs)  
  
-   資料元素層級的長度 (最小值/最大值) 違規 (資料長度超過最大層級或低於最小層級)  
  
-   資料元素層級位置的資料型別不符 (除了有專屬控制項的識別碼資料型別之外)  
  
-   資料元素層級位置的無效列舉清單  
  
 如果 EDI 類型驗證在接收端已停用，但在傳送端上是啟用狀態，則當 XML 檔案包含錯誤時，EDI 傳送管線就無法將接收管線所產生的 XML 重新處理成有效的 EDI 檔案。 因此傳送管線就會發生錯誤。  
  
 如果 EDI 類型驗證已停用，EDI 接收管線或傳送管線將依照下列方式處理錯誤：  
  
|||  
|-|-|  
|未預期的資料|動作|  
|未預期/未定義的交易集|EDI 接收或傳送管線會接受交易集，即使其結構描述尚未部署|  
|未預期的區段/記錄|接收管線會產生具有適當的前置詞的標記： \<UnexpectedSegment_ %segmentid%>。<br /><br /> 傳送管線會將 XML 標記名稱的前三個字元做為區段名稱。|  
|未預期的簡單資料元素|接收管線會使用前置詞、區段識別項，以及表示區段中資料元素位置的索引，來產生 XML 標記：<UnexpectedDataElement_%FieldName%。|  
|未預期的複合資料元素|接收管線會使用前置詞、區段識別項，以及表示區段中資料元素位置的索引，來產生 XML 標記：<UnexpectedCompositeDataElement_%FieldName%。|  
|遺失必要的資料|管線會將該資料視為選擇性。|  
|資料元素長度違規|管線會將無效的資料元素長度視為有效 (最小值 = 0、最大值 = 無限制)。|  
|執行個體中的無效列舉值 (適用於識別碼資料型別)|管線會忽略該錯誤並繼續處理。|  
|執行個體中出現「最大」重複違規|管線會將這類重複資料視為有效 (Min Occurs = 0、Max Occurs = 無限制)。|  
  
 **錯誤報告**  
  
 當 EDI 類型驗證關閉時，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 不會在 [事件檢視器] 中報告錯誤，而是報告警告。 此外，通知會向來源合作對象回報「接受」，其方法是將 AK501 和 AK901 設定為 "E" (對於 X12 997)，而將 UCI.4、UCM.3 和 UCF.4 設定為 "7" (對於 EDIFACT CONTRL)。 如此一來，未來傳輸中就沒有任何修正的機會。 不過，訊息接收者有機會透過手動處理來搶救文件，而不放任訊息遭拒絕或擱置。 此外，當 EDI 接收管線遇到上述任何一種錯誤時，`Edi.ErrorsInTransactionSet` 內容屬性也會進行升級。 如果遇到 EDI 或擴充驗證錯誤，這個屬性會升級為 "True"。 如果未遇到錯誤，則這個屬性將升級為 "False"。  
  
 如果接收或傳送管線遇到未預期的資料，它會在父層級報告錯誤並忽略子層級錯誤，如下所示：  
  
|||  
|-|-|  
|未預期的資料|動作|  
|未預期的交易集|通知會報告這個錯誤，並忽略區段/迴圈和資料元素層級位置的後續錯誤|  
|未預期的區段/迴圈|通知會報告這個錯誤，並忽略資料元素層級的錯誤。|  
|未預期的資料元素|通知會報告這個錯誤，並忽略與屬性 (如識別碼、長度、相符項目等) 相關的複合錯誤，以及與複合資料元素欄位相關的錯誤 (如果有的話)。|  
  
## <a name="see-also"></a>另請參閱  
 [EDI 訊息驗證](../core/edi-message-validation.md)   
 [擴充 (BTS-XSD) 驗證](../core/extended-bts-xsd-validation.md)