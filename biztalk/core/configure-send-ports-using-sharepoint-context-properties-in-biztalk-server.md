---
title: "如何設定傳送埠使用 Windows Sharepoint Services 內容屬性 |Microsoft 文件"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- Windows SharePoint Services adapters, InfoPath forms
- configuring [Windows SharePoint Services adapters], InfoPath forms
- Windows SharePoint Services adapters, Windows SharePoint Services
- InfoPath forms, Windows SharePoint Services adapters
- configuring [Windows SharePoint Services adapters], Windows SharePoint Services
- Windows SharePoint Services adapters, send ports
- configuring [Windows SharePoint Services adapters], send ports
- send ports, Windows SharePoint Services adapters
- Windows SharePoint Services, Windows SharePoint Services adapters
ms.assetid: 1ff50fb8-7ba0-47b8-9476-d57413989346
caps.latest.revision: "16"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: e766272f33bf23166ba412a76498e4240ab3343b
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/28/2017
---
# <a name="how-to-configure-send-ports-using-windows-sharepoint-services-context-properties"></a><span data-ttu-id="71912-102">如何使用 Windows Sharepoint Services 內容屬性設定傳送埠</span><span class="sxs-lookup"><span data-stu-id="71912-102">How to Configure Send Ports Using Windows Sharepoint Services Context Properties</span></span>
<span data-ttu-id="71912-103">本主題說明如何在執行階段從 BizTalk 協調流程使用 Windows Sharepoint Services 內容屬性設定 Windows SharePoint Services 傳送埠。</span><span class="sxs-lookup"><span data-stu-id="71912-103">This topic describes how to configure Windows SharePoint Services send ports at runtime using Windows Sharepoint Services context properties from a BizTalk orchestration.</span></span> <span data-ttu-id="71912-104">相同的機制可以用來設定 Windows SharePoint Services 動態和晚期繫結傳送埠。</span><span class="sxs-lookup"><span data-stu-id="71912-104">The same mechanism can be used to configure Windows SharePoint Services dynamic and late-bound send ports.</span></span> <span data-ttu-id="71912-105">動態傳送埠的組態屬性需於執行階段時在協調流程中設定。</span><span class="sxs-lookup"><span data-stu-id="71912-105">The configuration properties for a dynamic send port are set in an orchestration at runtime.</span></span> <span data-ttu-id="71912-106">配接器屬性中公開的**Windows SharePoint Services 傳輸屬性**對話方塊也可以套用至動態或晚期繫結的傳送埠。</span><span class="sxs-lookup"><span data-stu-id="71912-106">Adapter properties that are exposed in the **Windows SharePoint Services Transport Properties** dialog box can also be applied to a dynamic or late bound send port.</span></span> <span data-ttu-id="71912-107">若要使用 Windows Sharepoint Services 配接器內容屬性設定動態或晚期繫結傳送埠的組態屬性，請依照下列步驟執行：</span><span class="sxs-lookup"><span data-stu-id="71912-107">To set configuration properties for a dynamic or late bound send port using the Windows Sharepoint Services adapter context properties follow these steps:</span></span>  
  
### <a name="to-set-configuration-properties-for-a-send-port-using-windows-sharepoint-services-adapter-context-properties"></a><span data-ttu-id="71912-108">若要使用 Windows Sharepoint Services 配接器內容屬性設定傳送埠的組態屬性</span><span class="sxs-lookup"><span data-stu-id="71912-108">To set configuration properties for a send port using Windows Sharepoint Services adapter context properties</span></span>  
  
1.  <span data-ttu-id="71912-109">針對動態傳送埠，若要建立動態單向傳送埠，請依照下列主題中的步驟[如何建立傳送埠](../core/how-to-create-a-send-port2.md)。</span><span class="sxs-lookup"><span data-stu-id="71912-109">For dynamic send ports, to create a Dynamic One-way send port, follow the steps in the topic [How to Create a Send Port](../core/how-to-create-a-send-port2.md).</span></span>  
  
2.  <span data-ttu-id="71912-110">使用**訊息指派**圖形內**建構訊息**中設定組態屬性的傳出訊息的協調流程圖形。</span><span class="sxs-lookup"><span data-stu-id="71912-110">Use a **Message Assignment** shape within a **Construct Message** shape in an orchestration to set the configuration properties for the outbound message.</span></span> <span data-ttu-id="71912-111">如需如何設定輸出訊息的組態屬性的範例，請參閱[逐步解說： 模組 3-從協調流程存取 SharePoint 屬性](../core/walkthrough-module-3-accessing-sharepoint-properties-from-an-orchestration.md)。</span><span class="sxs-lookup"><span data-stu-id="71912-111">For an example of how to set the configuration properties for an outbound message see [Walkthrough: Module 3 - Accessing SharePoint Properties from an Orchestration](../core/walkthrough-module-3-accessing-sharepoint-properties-from-an-orchestration.md).</span></span> <span data-ttu-id="71912-112">**建構新訊息**本主題的章節將說明如何設定傳出訊息的組態屬性。</span><span class="sxs-lookup"><span data-stu-id="71912-112">The **Construct a new message** section of this topic illustrates how to set configuration properties of an outbound message.</span></span> <span data-ttu-id="71912-113">可以在中設定之屬性相互關聯的配接器內容屬性**Windows SharePoint Services 傳輸屬性** 對話方塊會列在下表中：</span><span class="sxs-lookup"><span data-stu-id="71912-113">The adapter context properties that correlate to the properties that can be set in the **Windows SharePoint Services Transport Properties** dialog box are listed in the table below:</span></span>  
  
    |<span data-ttu-id="71912-114">傳輸屬性</span><span class="sxs-lookup"><span data-stu-id="71912-114">Transport Property</span></span>|<span data-ttu-id="71912-115">配接器內容屬性</span><span class="sxs-lookup"><span data-stu-id="71912-115">Adapter Context Property</span></span>|<span data-ttu-id="71912-116">資料類型</span><span class="sxs-lookup"><span data-stu-id="71912-116">Data Type</span></span>|<span data-ttu-id="71912-117">註解</span><span class="sxs-lookup"><span data-stu-id="71912-117">Comments</span></span>|  
    |------------------------|------------------------------|---------------|--------------|  
    |<span data-ttu-id="71912-118">配接器 Web 服務連接埠</span><span class="sxs-lookup"><span data-stu-id="71912-118">Adapter Web Service Port</span></span>|<span data-ttu-id="71912-119">WSS.ConfigAdapterWSPort</span><span class="sxs-lookup"><span data-stu-id="71912-119">WSS.ConfigAdapterWSPort</span></span>|<span data-ttu-id="71912-120">int</span><span class="sxs-lookup"><span data-stu-id="71912-120">Int</span></span>|<span data-ttu-id="71912-121">有效值從 1 到 65535 之間</span><span class="sxs-lookup"><span data-stu-id="71912-121">Valid values are from 1 to 65535</span></span><br /><br /> <span data-ttu-id="71912-122">預設值為 80</span><span class="sxs-lookup"><span data-stu-id="71912-122">The default value is 80</span></span>|  
    |<span data-ttu-id="71912-123">逾時</span><span class="sxs-lookup"><span data-stu-id="71912-123">Timeout</span></span>|<span data-ttu-id="71912-124">WSS.ConfigTimeout</span><span class="sxs-lookup"><span data-stu-id="71912-124">WSS.ConfigTimeout</span></span>|<span data-ttu-id="71912-125">int</span><span class="sxs-lookup"><span data-stu-id="71912-125">Int</span></span>|<span data-ttu-id="71912-126">有效值介於 1000年到 2147483647</span><span class="sxs-lookup"><span data-stu-id="71912-126">Valid values are from 1000 to 2147483647</span></span><br /><br /> <span data-ttu-id="71912-127">預設值為 100000</span><span class="sxs-lookup"><span data-stu-id="71912-127">The default value is 100000</span></span><br /><br /> <span data-ttu-id="71912-128">指定 0 值表示無限的逾時。</span><span class="sxs-lookup"><span data-stu-id="71912-128">Specify a value of 0 to indicate an infinite timeout.</span></span>|  
    |<span data-ttu-id="71912-129">目的資料夾 URL</span><span class="sxs-lookup"><span data-stu-id="71912-129">Destination Folder URL</span></span>|<span data-ttu-id="71912-130">NA</span><span class="sxs-lookup"><span data-stu-id="71912-130">NA</span></span>|<span data-ttu-id="71912-131">NA</span><span class="sxs-lookup"><span data-stu-id="71912-131">NA</span></span>|<span data-ttu-id="71912-132">動態通訊埠，這個設定是間接設定**Microsoft.XLANGs.BaseTypes.Address**屬性具有運算式圖形的協調流程中的動態通訊埠。</span><span class="sxs-lookup"><span data-stu-id="71912-132">For dynamic ports, this is set indirectly by setting the **Microsoft.XLANGs.BaseTypes.Address** property of the dynamic port with an expression shape in an orchestration.</span></span> <span data-ttu-id="71912-133">晚期繫結連接埠的這個屬性不能在執行階段設定，因為實體傳送埠的值一定會覆寫它。</span><span class="sxs-lookup"><span data-stu-id="71912-133">For late-bound ports this property cannot be set at runtime since it is always overridden by the physical send port value.</span></span>|  
    |<span data-ttu-id="71912-134">檔名</span><span class="sxs-lookup"><span data-stu-id="71912-134">Filename</span></span>|<span data-ttu-id="71912-135">WSS.Filename</span><span class="sxs-lookup"><span data-stu-id="71912-135">WSS.Filename</span></span>|<span data-ttu-id="71912-136">字串</span><span class="sxs-lookup"><span data-stu-id="71912-136">String</span></span>|<span data-ttu-id="71912-137">除了的傳輸屬性中支援的所有可用的檔名巨集使用**%filename%**和**%extension%**巨集。</span><span class="sxs-lookup"><span data-stu-id="71912-137">Supports the use of all filename macros that can be used in the transport properties except for the **%Filename%** and **%Extension%** macros.</span></span>|  
    |<span data-ttu-id="71912-138">命名空間別名</span><span class="sxs-lookup"><span data-stu-id="71912-138">Namespaces Aliases</span></span>|<span data-ttu-id="71912-139">WSS.ConfigNamespaceAliases</span><span class="sxs-lookup"><span data-stu-id="71912-139">WSS.ConfigNamespaceAliases</span></span>|<span data-ttu-id="71912-140">字串</span><span class="sxs-lookup"><span data-stu-id="71912-140">String</span></span>|<span data-ttu-id="71912-141">如果執行階段中為訊息設定的命名空間別名與訊息傳送目標的傳送埠設定的命名空間別名完全相符，則會合併命名空間，而且會發生傳送錯誤。</span><span class="sxs-lookup"><span data-stu-id="71912-141">If a namespace alias set for a message at runtime exactly matches the namespace alias set for the send port that the message is routed to then the namespaces are merged and a routing error occurs.</span></span> <span data-ttu-id="71912-142">為了避免發生這個問題，請務必指定不同的命名空間別名。</span><span class="sxs-lookup"><span data-stu-id="71912-142">To prevent this problem ensure that the specified namespace aliases are not identical.</span></span> <span data-ttu-id="71912-143">例如，如果在協調流程中使用下列運算式設定訊息的命名空間別名：</span><span class="sxs-lookup"><span data-stu-id="71912-143">For example if the following expression is used in an orchestration to set the namespace alias for a message:</span></span><br /><br /> `Message_Task(WSS.ConfigNamespaceAliases)= "orchns='http://OrderProcess.PurchaseOrder'";`<br /><br /> <span data-ttu-id="71912-144">如果此訊息會路由至傳送埠會指定下列值**命名空間別名**屬性：</span><span class="sxs-lookup"><span data-stu-id="71912-144">and if this message is routed to a send port that specifies the following value for the **Namespace Aliases** property:</span></span><br /><br /> <span data-ttu-id="71912-145">orchns='http://OrderProcess.PurchaseOrder'</span><span class="sxs-lookup"><span data-stu-id="71912-145">orchns='http://OrderProcess.PurchaseOrder'</span></span><br /><br /> <span data-ttu-id="71912-146">則當 BizTalk Server 嘗試將訊息傳送到這個傳送埠時，就會發生錯誤。</span><span class="sxs-lookup"><span data-stu-id="71912-146">then an error will occur when BizTalk Server attempts to route the message to this send port.</span></span> <span data-ttu-id="71912-147">若要解決此問題，您可以指定下列值**命名空間別名**傳送埠的屬性：</span><span class="sxs-lookup"><span data-stu-id="71912-147">To resolve this problem you could specify the following value for the **Namespace Aliases** property of the send port:</span></span><br /><br /> <span data-ttu-id="71912-148">**orchns2**= 'http://OrderProcess.PurchaseOrder'</span><span class="sxs-lookup"><span data-stu-id="71912-148">**orchns2**='http://OrderProcess.PurchaseOrder'</span></span>|  
    |<span data-ttu-id="71912-149">Overwrite</span><span class="sxs-lookup"><span data-stu-id="71912-149">Overwrite</span></span>|<span data-ttu-id="71912-150">WSS.ConfigOverwrite</span><span class="sxs-lookup"><span data-stu-id="71912-150">WSS.ConfigOverwrite</span></span>|<span data-ttu-id="71912-151">字串</span><span class="sxs-lookup"><span data-stu-id="71912-151">String</span></span>|<span data-ttu-id="71912-152">有效值為：</span><span class="sxs-lookup"><span data-stu-id="71912-152">Valid values are:</span></span><br /><br /> <span data-ttu-id="71912-153">-[是]</span><span class="sxs-lookup"><span data-stu-id="71912-153">- "yes"</span></span><br /><br /> <span data-ttu-id="71912-154">-[否]</span><span class="sxs-lookup"><span data-stu-id="71912-154">- "no"</span></span><br /><br /> <span data-ttu-id="71912-155">-"rename"</span><span class="sxs-lookup"><span data-stu-id="71912-155">- "rename"</span></span>|  
    |<span data-ttu-id="71912-156">SharePoint 網站 URL</span><span class="sxs-lookup"><span data-stu-id="71912-156">SharePoint Site URL</span></span>|<span data-ttu-id="71912-157">WSS.InListUrl</span><span class="sxs-lookup"><span data-stu-id="71912-157">WSS.InListUrl</span></span>|<span data-ttu-id="71912-158">字串</span><span class="sxs-lookup"><span data-stu-id="71912-158">String</span></span>|<span data-ttu-id="71912-159">動態通訊埠，這個設定是間接設定**Microsoft.XLANGs.BaseTypes.Address**屬性具有運算式圖形的協調流程中的動態通訊埠。</span><span class="sxs-lookup"><span data-stu-id="71912-159">For dynamic ports, this is set indirectly by setting the **Microsoft.XLANGs.BaseTypes.Address** property of the dynamic port with an expression shape in an orchestration.</span></span> <span data-ttu-id="71912-160">晚期繫結連接埠的這個屬性不能在執行階段設定，因為實體傳送埠的值一定會覆寫它。</span><span class="sxs-lookup"><span data-stu-id="71912-160">For late-bound ports this property cannot be set at runtime since it is always overridden by the physical send port value.</span></span>|  
    |<span data-ttu-id="71912-161">Microsoft Office 整合</span><span class="sxs-lookup"><span data-stu-id="71912-161">Microsoft Office Integration</span></span>|<span data-ttu-id="71912-162">WSS.ConfigOfficeIntegration</span><span class="sxs-lookup"><span data-stu-id="71912-162">WSS.ConfigOfficeIntegration</span></span>|<span data-ttu-id="71912-163">字串</span><span class="sxs-lookup"><span data-stu-id="71912-163">String</span></span>|<span data-ttu-id="71912-164">有效值為：</span><span class="sxs-lookup"><span data-stu-id="71912-164">Valid values are:</span></span><br /><br /> <span data-ttu-id="71912-165">-[是]</span><span class="sxs-lookup"><span data-stu-id="71912-165">- "yes"</span></span><br /><br /> <span data-ttu-id="71912-166">-[否]</span><span class="sxs-lookup"><span data-stu-id="71912-166">- "no"</span></span><br /><br /> <span data-ttu-id="71912-167">-「 yesformlibrary"</span><span class="sxs-lookup"><span data-stu-id="71912-167">- "yesformlibrary"</span></span><br /><br /> <span data-ttu-id="71912-168">-「 選用 」</span><span class="sxs-lookup"><span data-stu-id="71912-168">- "optional"</span></span>|  
    |<span data-ttu-id="71912-169">範本文件庫</span><span class="sxs-lookup"><span data-stu-id="71912-169">Templates Document Library</span></span>|<span data-ttu-id="71912-170">WSS.ConfigTemplatesDocLib</span><span class="sxs-lookup"><span data-stu-id="71912-170">WSS.ConfigTemplatesDocLib</span></span>|<span data-ttu-id="71912-171">字串</span><span class="sxs-lookup"><span data-stu-id="71912-171">String</span></span>|<span data-ttu-id="71912-172">無</span><span class="sxs-lookup"><span data-stu-id="71912-172">None</span></span>|  
    |<span data-ttu-id="71912-173">範本後援文件庫</span><span class="sxs-lookup"><span data-stu-id="71912-173">Templates Fallback Document Library</span></span>|<span data-ttu-id="71912-174">WSS.ConfigCustomTemplatesDocLib</span><span class="sxs-lookup"><span data-stu-id="71912-174">WSS.ConfigCustomTemplatesDocLib</span></span>|<span data-ttu-id="71912-175">字串</span><span class="sxs-lookup"><span data-stu-id="71912-175">String</span></span>|<span data-ttu-id="71912-176">無</span><span class="sxs-lookup"><span data-stu-id="71912-176">None</span></span>|  
    |<span data-ttu-id="71912-177">範本後援命名空間資料行</span><span class="sxs-lookup"><span data-stu-id="71912-177">Templates Fallback Namespace Column</span></span>|<span data-ttu-id="71912-178">WSS.ConfigCustomTemplatesNamespaceCol</span><span class="sxs-lookup"><span data-stu-id="71912-178">WSS.ConfigCustomTemplatesNamespaceCol</span></span>|<span data-ttu-id="71912-179">字串</span><span class="sxs-lookup"><span data-stu-id="71912-179">String</span></span>|<span data-ttu-id="71912-180">無</span><span class="sxs-lookup"><span data-stu-id="71912-180">None</span></span>|  
    |<span data-ttu-id="71912-181">範本命名空間資料行</span><span class="sxs-lookup"><span data-stu-id="71912-181">Templates Namespace Column</span></span>|<span data-ttu-id="71912-182">WSS.ConfigTemplatesNamespaceCol</span><span class="sxs-lookup"><span data-stu-id="71912-182">WSS.ConfigTemplatesNamespaceCol</span></span>|<span data-ttu-id="71912-183">字串</span><span class="sxs-lookup"><span data-stu-id="71912-183">String</span></span>|<span data-ttu-id="71912-184">無</span><span class="sxs-lookup"><span data-stu-id="71912-184">None</span></span>|  
    |<span data-ttu-id="71912-185">資料行 `n`</span><span class="sxs-lookup"><span data-stu-id="71912-185">Column `n`</span></span>|<span data-ttu-id="71912-186">WSS.ConfigPropertiesXml</span><span class="sxs-lookup"><span data-stu-id="71912-186">WSS.ConfigPropertiesXml</span></span><br /><br /> <span data-ttu-id="71912-187">設定資料行名稱\<PropertyName*x*\>*columnname*\</ PropertyName*x* \>欄位。</span><span class="sxs-lookup"><span data-stu-id="71912-187">Column name is set in \<PropertyName*x*\>*columnname*\</ PropertyName*x*\> field.</span></span>|<span data-ttu-id="71912-188">字串</span><span class="sxs-lookup"><span data-stu-id="71912-188">String</span></span>|<span data-ttu-id="71912-189">無</span><span class="sxs-lookup"><span data-stu-id="71912-189">None</span></span>|  
    |<span data-ttu-id="71912-190">資料行 `n` 值</span><span class="sxs-lookup"><span data-stu-id="71912-190">Column `n` Value</span></span>|<span data-ttu-id="71912-191">WSS.ConfigPropertiesXml</span><span class="sxs-lookup"><span data-stu-id="71912-191">WSS.ConfigPropertiesXml</span></span><br /><br /> <span data-ttu-id="71912-192">資料行值是否以設定\<PropertySource*x*\>*columnvalue*\</ PropertySource*x* \>欄位。</span><span class="sxs-lookup"><span data-stu-id="71912-192">Column value is set in \<PropertySource*x*\>*columnvalue*\</ PropertySource*x*\> field.</span></span>|<span data-ttu-id="71912-193">字串</span><span class="sxs-lookup"><span data-stu-id="71912-193">String</span></span>|<span data-ttu-id="71912-194">除了的傳輸屬性中支援的所有可用的檔名巨集使用**%filename%**和**%extension%**巨集。</span><span class="sxs-lookup"><span data-stu-id="71912-194">Supports the use of all filename macros that can be used in the transport properties except for the **%Filename%** and **%Extension%** macros.</span></span>|  
  
    > [!NOTE]
    >  <span data-ttu-id="71912-195">提供給內容屬性的值需區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="71912-195">The values supplied for context properties are case sensitive.</span></span> <span data-ttu-id="71912-196">使用內容屬性設定動態連接埠的值時，請務必您使用適當的大小寫，否則當 BizTalk 嘗試將文件傳送到指定的傳送埠時，將會發生錯誤。</span><span class="sxs-lookup"><span data-stu-id="71912-196">When setting configuration values for a dynamic port with context properties ensure that you use the proper case or an error will occur when BizTalk attempts to route the document to the designated send port.</span></span>  
  
3.  <span data-ttu-id="71912-197">使用 「 運算式 」 圖形的協調流程中設定**Microsoft.XLANGs.BaseTypes.Address**屬性動態傳送埠。</span><span class="sxs-lookup"><span data-stu-id="71912-197">Use an expression shape in an orchestration to set the **Microsoft.XLANGs.BaseTypes.Address** property for the dynamic send port.</span></span> <span data-ttu-id="71912-198">這個屬性可用來指定動態傳送埠傳送訊息的目標 URI。</span><span class="sxs-lookup"><span data-stu-id="71912-198">This property is used to specify the URI that the dynamic send port routes the message to.</span></span> <span data-ttu-id="71912-199">如需如何設定的範例**Microsoft.XLANGs.BaseTypes.Address**動態傳送埠屬性查看**建立運算式**主題的章節[逐步解說： 模組 3-從協調流程存取 SharePoint 屬性](../core/walkthrough-module-3-accessing-sharepoint-properties-from-an-orchestration.md)。</span><span class="sxs-lookup"><span data-stu-id="71912-199">For an example of how to set the **Microsoft.XLANGs.BaseTypes.Address** property for a dynamic send port see the **Create an expression** section of the topic [Walkthrough: Module 3 - Accessing SharePoint Properties from an Orchestration](../core/walkthrough-module-3-accessing-sharepoint-properties-from-an-orchestration.md).</span></span> <span data-ttu-id="71912-200">如需 Windows Sharepoint Services 配接器內容屬性的詳細資訊，請參閱[Windows SharePoint Services 配接器屬性參考](../core/windows-sharepoint-services-adapter-properties-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="71912-200">For more information about the Windows Sharepoint Services adapter context properties see [Windows SharePoint Services Adapter Properties Reference](../core/windows-sharepoint-services-adapter-properties-reference.md).</span></span>  
  
     <span data-ttu-id="71912-201">您也可以在協調流程中動態設定晚期繫結 Windows Sharepoint Services 傳送埠的某些屬性。</span><span class="sxs-lookup"><span data-stu-id="71912-201">It is also possible to dynamically set certain properties of a late bound Windows Sharepoint Services send port in an orchestration.</span></span> <span data-ttu-id="71912-202">如果完成這項設定，Windows SharePoint Services 連接埠會設定兩次，一次是透過 Windows SharePoint Services 內容屬性，另一次則是透過 [Windows SharePoint Services 傳輸屬性] 對話方塊設定。</span><span class="sxs-lookup"><span data-stu-id="71912-202">If this is done, the Windows SharePoint Services port will be configured twice, once through the Windows SharePoint Services context properties and once through the Windows SharePoint Services Transport Properties dialog box.</span></span> <span data-ttu-id="71912-203">根據預設，在 [Windows SharePoint Services 傳輸屬性] 對話方塊中指定之組態的優先順序高於內容屬性中指定的組態屬性。</span><span class="sxs-lookup"><span data-stu-id="71912-203">By default, the configuration specified in the Windows SharePoint Services Transport Properties dialog box takes precedence over the configuration properties specified in the context properties.</span></span> <span data-ttu-id="71912-204">為了使用內容屬性中指定的組態，請依照下列步驟執行：</span><span class="sxs-lookup"><span data-stu-id="71912-204">In order to use the configuration specified in the context properties follow these steps:</span></span>  
  
    1.  <span data-ttu-id="71912-205">若要建立靜態單向傳送埠，請遵循本主題中的步驟[如何建立傳送埠](../core/how-to-create-a-send-port2.md)。</span><span class="sxs-lookup"><span data-stu-id="71912-205">To create a Static One-way send port, follow the steps in the topic [How to Create a Send Port](../core/how-to-create-a-send-port2.md).</span></span>  
  
    2.  <span data-ttu-id="71912-206">設定傳送埠屬性時，請輸入適當的值定義傳送埠的 URI **Sharepoint 網站 URL**和**目的資料夾 URL**屬性。</span><span class="sxs-lookup"><span data-stu-id="71912-206">When setting the properties for the send port, define the URI for the send port by entering the appropriate values for the **Sharepoint Site URL** and **Destination Folder URL** properties.</span></span>  
  
    3.  <span data-ttu-id="71912-207">值設定**覆寫**屬性**協調流程**如果您想要使用內容屬性所定義的值**WSS。ConfigOverwrite**協調流程中。</span><span class="sxs-lookup"><span data-stu-id="71912-207">Set the value of the **Overwrite** property to **Orchestration** if you want to use the value defined by the context property **WSS.ConfigOverwrite** in an orchestration.</span></span>  
  
    4.  <span data-ttu-id="71912-208">設定**Microsoft Office 整合**屬性**協調流程**如果您想要使用內容屬性所定義的值**WSS。ConfigOfficeIntegration**協調流程中。</span><span class="sxs-lookup"><span data-stu-id="71912-208">Set the **Microsoft Office Integration** property to **Orchestration** if you want to use the value defined by the context property **WSS.ConfigOfficeIntegration** in an orchestration.</span></span>  
  
    5.  <span data-ttu-id="71912-209">輸入值為**-1**的任何傳送埠屬性使用整數資料類型，如果您想要在協調流程中設定這些內容屬性的值。</span><span class="sxs-lookup"><span data-stu-id="71912-209">Enter a value of **-1** for any send port properties that use the integer data type if you want to set those values with a context property in an orchestration.</span></span>  
  
    6.  <span data-ttu-id="71912-210">如果您要使用協調流程中的內容屬性來設定使用字串資料型別之任何傳送埠屬性的值，請將這些屬性保留空白。</span><span class="sxs-lookup"><span data-stu-id="71912-210">Leave blank any send port properties that use the string data type if you want to set those values with a context property in an orchestration.</span></span> <span data-ttu-id="71912-211">這不適用於**Sharepoint 網站 URL**和**目的資料夾 URL**屬性。</span><span class="sxs-lookup"><span data-stu-id="71912-211">This does not apply to the **Sharepoint Site URL** and **Destination Folder URL** properties.</span></span> <span data-ttu-id="71912-212">這些屬性必須指定**Windows Sharepoint Services 傳輸屬性** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="71912-212">These properties must be specified in the **Windows Sharepoint Services Transport Properties** dialog box.</span></span>  
  
    7.  <span data-ttu-id="71912-213">使用**訊息指派**圖形內**建構訊息**中設定組態屬性的傳出訊息的協調流程圖形。</span><span class="sxs-lookup"><span data-stu-id="71912-213">Use a **Message Assignment** shape within a **Construct Message** shape in an orchestration to set the configuration properties for the outbound message.</span></span> <span data-ttu-id="71912-214">如需如何設定輸出訊息的組態屬性的範例，請參閱[逐步解說： 模組 3-從協調流程存取 SharePoint 屬性](../core/walkthrough-module-3-accessing-sharepoint-properties-from-an-orchestration.md)。</span><span class="sxs-lookup"><span data-stu-id="71912-214">For an example of how to set the configuration properties for an outbound message see [Walkthrough: Module 3 - Accessing SharePoint Properties from an Orchestration](../core/walkthrough-module-3-accessing-sharepoint-properties-from-an-orchestration.md).</span></span> <span data-ttu-id="71912-215">**建構新訊息**本主題的章節將說明如何設定傳出訊息的組態屬性。</span><span class="sxs-lookup"><span data-stu-id="71912-215">The **Construct a new message** section of this topic illustrates how to set configuration properties of an outbound message.</span></span>  
  
    8.  <span data-ttu-id="71912-216">設定值為 -1 (使用整數資料型別的屬性)、[協調流程] (下拉式列舉型別屬性) 或保留空白 (使用字串資料型別的屬性) 的任何傳送埠屬性都將在執行階段由協調流程中指定的內容屬性進行設定。</span><span class="sxs-lookup"><span data-stu-id="71912-216">Any send port properties that are configured with a value of -1 (for properties that use the integer data type), "Orchestration" (for drop-down enumeration properties) or are left blank (for properties that use the string data type) will be set at run time with the context property that was specified in the orchestration.</span></span>  
  
 <span data-ttu-id="71912-217">如果您使用 Windows SharePoint Services 配接器來接收具有內嵌附件的 InfoPath 表單，然後再將 InfoPath 表單傳送到 SharePoint 文件庫，請完成下列步驟，以保留表單中的任何 InfoPath 處理指示：</span><span class="sxs-lookup"><span data-stu-id="71912-217">If you use the Windows SharePoint Services adapter to receive InfoPath forms with embedded attachments and then send the InfoPath forms to a SharePoint document library, complete the following steps to preserve any InfoPath processing instructions that are in the form:</span></span>  
  
### <a name="to-preserve-infopath-processing-instructions-for-infopath-forms-with-embedded-attachments-processed-by-biztalk-server"></a><span data-ttu-id="71912-218">若要為具有 BizTalk Server 所處理之內嵌附件的 InfoPath 表單保留 InfoPath 處理指示</span><span class="sxs-lookup"><span data-stu-id="71912-218">To preserve InfoPath processing instructions for InfoPath forms with embedded attachments processed by BizTalk Server</span></span>  
  
1.  <span data-ttu-id="71912-219">如果您協調流程中使用的對應，對應至另一個的 InfoPath 表單從一份 InfoPath 表單資料，請確定您已設定**複製處理指示 (Pi)**屬性的對應中**是**。</span><span class="sxs-lookup"><span data-stu-id="71912-219">If you are using a map in the orchestration to map data from one InfoPath form to another InfoPath form, ensure that you have set the **Copy Processing Instructions (PIs)** property in the map to **Yes**.</span></span> <span data-ttu-id="71912-220">這個參數設定下**自訂標頭**區段**格線屬性**地圖的頁面。</span><span class="sxs-lookup"><span data-stu-id="71912-220">This parameter is set under the **Custom Header** section of the **Grid Properties** page for the map.</span></span>  
  
2.  <span data-ttu-id="71912-221">如果您不要使用協調流程中的對應，請使用訊息指派圖形中的下列運算式來更新輸出訊息：</span><span class="sxs-lookup"><span data-stu-id="71912-221">If you are not using a map in the orchestration, update the output message using the following expression in a message assignment shape:</span></span>  
  
    ```  
    NewMessage(XMLNORM.ProcessingInstructionOption) = 1;  
    NewMessage(XMLNORM.ProcessingInstruction) = "<?mso-infoPath-file-attachment-present?>"  
    ```  
  
     <span data-ttu-id="71912-222">上述運算式中*NewMessage*是您要新增處理指示的輸出訊息。</span><span class="sxs-lookup"><span data-stu-id="71912-222">In the expression above, *NewMessage* is the output message that you are adding the processing instructions to.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="71912-223">請參閱</span><span class="sxs-lookup"><span data-stu-id="71912-223">See Also</span></span>  
 [<span data-ttu-id="71912-224">如何建立傳送埠</span><span class="sxs-lookup"><span data-stu-id="71912-224">How to Create a Send Port</span></span>](../core/how-to-create-a-send-port2.md)