---
title: 程式碼清單管理 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: a924c814-d077-4aea-bacb-bf2e8a3dee01
caps.latest.revision: 6
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 6a28126d7acdb7e5d97b6aaa9924cea455c5fad1
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "37010727"
---
# <a name="code-list-management"></a><span data-ttu-id="ee34d-102">程式碼清單管理</span><span class="sxs-lookup"><span data-stu-id="ee34d-102">Code List Management</span></span>

## <a name="overview"></a><span data-ttu-id="ee34d-103">概觀</span><span class="sxs-lookup"><span data-stu-id="ee34d-103">Overview</span></span>
<span data-ttu-id="ee34d-104">您可以使用 XSD 指定對項目或屬性有效的一組特定值。</span><span class="sxs-lookup"><span data-stu-id="ee34d-104">You use XSD to specify a specific set of values that are valid for an element or attribute.</span></span> <span data-ttu-id="ee34d-105">這項功能是可透過**列舉型別**項目。</span><span class="sxs-lookup"><span data-stu-id="ee34d-105">This functionality is available using the **enumeration** element.</span></span> <span data-ttu-id="ee34d-106">當您衍生的資料類型**欄位項目**或是**欄位屬性**由限制，其中會變成可供您在 [屬性] 節點**限制**類別是**列舉型別**屬性。</span><span class="sxs-lookup"><span data-stu-id="ee34d-106">When you derive a data type for a **Field Element** or **Field Attribute** node by restriction, one of the properties that becomes available to you in the **Restriction** category is the **Enumeration** property.</span></span> <span data-ttu-id="ee34d-107">使用這個屬性，您可以開啟**列舉型別編輯器**對話方塊中，您可以在其中輸入應該被視為有效的相對應的項目或執行個體訊息中的屬性的值。</span><span class="sxs-lookup"><span data-stu-id="ee34d-107">Using this property, you can open the **Enumeration Editor** dialog box in which you can enter the values that should be considered valid for the corresponding element or attribute in instance messages.</span></span>  

 <span data-ttu-id="ee34d-108">Microsoft BizTalk Server 提供一種替代且更有效率的方式，來管理您結構描述中的列舉，稱之為程式碼清單。</span><span class="sxs-lookup"><span data-stu-id="ee34d-108">Microsoft BizTalk Server provides an alternative, richer way to manage enumerations in your schemas, known as code lists.</span></span> <span data-ttu-id="ee34d-109">程式碼清單使用 Microsoft Access 資料庫儲存您各種列舉的選擇，可讓您以更集中的方式管理它們。</span><span class="sxs-lookup"><span data-stu-id="ee34d-109">Code lists use a Microsoft Access database to store the choices for your various enumerations, which allows you to manage them in a more centralized way.</span></span> <span data-ttu-id="ee34d-110">此外，如果您要使用的列舉值包含非直覺式數值代碼，必須在該表單使用輸入**列舉型別**屬性中，您在程式碼清單使用 Access 資料庫中建立的資料表功能包括這些數值的文字描述。</span><span class="sxs-lookup"><span data-stu-id="ee34d-110">Further, if the enumeration values you need to use consist of non-intuitive numeric codes, which would need to be entered in that form using the **Enumeration** property, the tables you create in an Access database to use with the code list functionality include textual descriptions of these numeric values.</span></span> <span data-ttu-id="ee34d-111">文字描述會用於**CodeList**  對話方塊中，而不是與其等同的模糊數值項目。</span><span class="sxs-lookup"><span data-stu-id="ee34d-111">The textual descriptions are used in the **CodeList** dialog box rather than their more obscure numeric equivalents.</span></span>  

## <a name="use-the-code-list"></a><span data-ttu-id="ee34d-112">使用程式碼清單</span><span class="sxs-lookup"><span data-stu-id="ee34d-112">Use the code list</span></span>  
 <span data-ttu-id="ee34d-113">若要使用程式碼清單功能，您必須執行數個不同的步驟，包括：</span><span class="sxs-lookup"><span data-stu-id="ee34d-113">You must perform several different steps to use the code list feature, including:</span></span>  

- <span data-ttu-id="ee34d-114">您必須建立含有適當具名資料表 (含有所需的資料行) 的 Access 資料庫，並且在其中填入值。</span><span class="sxs-lookup"><span data-stu-id="ee34d-114">You must create an Access database with an appropriately named table, with the expected columns, and populate it with values.</span></span>  

  - <span data-ttu-id="ee34d-115">資料表的名稱是組成**標準**並**標準版本**的屬性**結構描述**節點，以底線 (_) 字元分隔。</span><span class="sxs-lookup"><span data-stu-id="ee34d-115">The name of the table is a combination of the **Standard** and **Standard Version** properties of the **Schema** node, separated by an underscore (_) character.</span></span> <span data-ttu-id="ee34d-116">比方說，如果您已設定**標準**屬性**結構描述**節點，以 XML 和**標準版本**屬性設為 MyVersion1，所指定的 Access 資料庫**程式碼清單資料庫**屬性必須具有名為 XML_MyVersion1 的資料表。</span><span class="sxs-lookup"><span data-stu-id="ee34d-116">For example, if you have set the **Standard** property of the **Schema** node to XML and the **Standard Version** property to MyVersion1, the Access database specified by the **CodeList Database** property must have a table named XML_MyVersion1.</span></span>  

    <span data-ttu-id="ee34d-117">這些屬性的更多有關[!INCLUDE[ui-guidance-developers-reference](../includes/ui-guidance-developers-reference.md)]。</span><span class="sxs-lookup"><span data-stu-id="ee34d-117">More details on these properties [!INCLUDE[ui-guidance-developers-reference](../includes/ui-guidance-developers-reference.md)].</span></span>

  - <span data-ttu-id="ee34d-118">此資料表必須有三個資料行，一般命名為 [Code]、[Value] 及 [Desc]。第一個資料行可以識別彼此相關，提供可能對應至所選的資料允許的列舉型別選擇每個這類的資料列的資料列**欄位項目**或**欄位屬性**節點。</span><span class="sxs-lookup"><span data-stu-id="ee34d-118">This table must have three columns, typically named Code, Value, and Desc. The first column identifies rows that are related to one another, where each such row provides one of the enumeration choices that may potentially be allowed for the data that corresponds to the selected **Field Element** or **Field Attribute** node.</span></span> <span data-ttu-id="ee34d-119">第一個資料行中值相同的所有資料列會構成一個群組。</span><span class="sxs-lookup"><span data-stu-id="ee34d-119">All rows with the same value in the first column form a group.</span></span> <span data-ttu-id="ee34d-120">這些值通常是整數，但也可以是不含空格的任意字串。</span><span class="sxs-lookup"><span data-stu-id="ee34d-120">These values are typically integers, but can be any string that does not contain spaces.</span></span>  

     <span data-ttu-id="ee34d-121">資料表中每個資料列的第二和第三個資料行，必須分別設為包含每個可能之列舉值的對應值和文字表示法。</span><span class="sxs-lookup"><span data-stu-id="ee34d-121">The second and third columns of each row in the table must be configured to contain the corresponding value and textual representation of each possible enumeration value, respectively.</span></span>  

     <span data-ttu-id="ee34d-122">例如，下列要和 [程式碼清單] 功能搭配使用的 Access 資料庫資料表表示法，包含兩組三個相關的列舉值。</span><span class="sxs-lookup"><span data-stu-id="ee34d-122">For example, the following representation of an Access database table for use with the Code List feature contains two sets of three related enumeration values.</span></span> <span data-ttu-id="ee34d-123">第一個資料行中的特定值是任意值，並用來和相關資料列建立關聯。</span><span class="sxs-lookup"><span data-stu-id="ee34d-123">The specific values in the first column are arbitrary and are used to associate related rows.</span></span>  


    | <span data-ttu-id="ee34d-124">程式碼</span><span class="sxs-lookup"><span data-stu-id="ee34d-124">Code</span></span> | <span data-ttu-id="ee34d-125">ReplTest1</span><span class="sxs-lookup"><span data-stu-id="ee34d-125">Value</span></span> |  <span data-ttu-id="ee34d-126">Desc</span><span class="sxs-lookup"><span data-stu-id="ee34d-126">Desc</span></span>  |
    |------|-------|--------|
    |  <span data-ttu-id="ee34d-127">@shouldalert</span><span class="sxs-lookup"><span data-stu-id="ee34d-127">1</span></span>   |  <span data-ttu-id="ee34d-128">13</span><span class="sxs-lookup"><span data-stu-id="ee34d-128">13</span></span>   |  <span data-ttu-id="ee34d-129">紅色</span><span class="sxs-lookup"><span data-stu-id="ee34d-129">Red</span></span>   |
    |  <span data-ttu-id="ee34d-130">@shouldalert</span><span class="sxs-lookup"><span data-stu-id="ee34d-130">1</span></span>   |  <span data-ttu-id="ee34d-131">16</span><span class="sxs-lookup"><span data-stu-id="ee34d-131">16</span></span>   | <span data-ttu-id="ee34d-132">綠色</span><span class="sxs-lookup"><span data-stu-id="ee34d-132">Green</span></span>  |
    |  <span data-ttu-id="ee34d-133">@shouldalert</span><span class="sxs-lookup"><span data-stu-id="ee34d-133">1</span></span>   |  <span data-ttu-id="ee34d-134">19</span><span class="sxs-lookup"><span data-stu-id="ee34d-134">19</span></span>   |  <span data-ttu-id="ee34d-135">藍色</span><span class="sxs-lookup"><span data-stu-id="ee34d-135">Blue</span></span>  |
    |  <span data-ttu-id="ee34d-136">2</span><span class="sxs-lookup"><span data-stu-id="ee34d-136">2</span></span>   |   <span data-ttu-id="ee34d-137">@shouldalert</span><span class="sxs-lookup"><span data-stu-id="ee34d-137">1</span></span>   | <span data-ttu-id="ee34d-138">Small</span><span class="sxs-lookup"><span data-stu-id="ee34d-138">Small</span></span>  |
    |  <span data-ttu-id="ee34d-139">2</span><span class="sxs-lookup"><span data-stu-id="ee34d-139">2</span></span>   |   <span data-ttu-id="ee34d-140">2</span><span class="sxs-lookup"><span data-stu-id="ee34d-140">2</span></span>   | <span data-ttu-id="ee34d-141">中</span><span class="sxs-lookup"><span data-stu-id="ee34d-141">Medium</span></span> |
    |  <span data-ttu-id="ee34d-142">2</span><span class="sxs-lookup"><span data-stu-id="ee34d-142">2</span></span>   |   <span data-ttu-id="ee34d-143">3</span><span class="sxs-lookup"><span data-stu-id="ee34d-143">3</span></span>   | <span data-ttu-id="ee34d-144">Large</span><span class="sxs-lookup"><span data-stu-id="ee34d-144">Large</span></span>  |


- <span data-ttu-id="ee34d-145">您必須正確設定的三個屬性**結構描述**節點：</span><span class="sxs-lookup"><span data-stu-id="ee34d-145">You must properly configure three properties of the **Schema** node:</span></span>  

  -   <span data-ttu-id="ee34d-146">**程式碼清單資料庫**屬性必須設定為您建立之 Access 資料庫的名稱。</span><span class="sxs-lookup"><span data-stu-id="ee34d-146">The **CodeList Database** property must be set to the name of the Access database you have created.</span></span>  

  -   <span data-ttu-id="ee34d-147">**標準**並**標準版本**必須設定屬性，使它們以分隔的底線 (_) 字元結合，形成內指定適當的資料表名稱Access 資料庫。</span><span class="sxs-lookup"><span data-stu-id="ee34d-147">The **Standard** and **Standard Version** properties must be set such that when they are combined with a separating underscore (_) character, they form the name of the appropriate table within the specified Access database.</span></span>  

- <span data-ttu-id="ee34d-148">若要真正進行的 Access 資料庫中的值用於選取特定**欄位項目**或**Field 屬性** 節點，您必須設定其兩個屬性：</span><span class="sxs-lookup"><span data-stu-id="ee34d-148">To actually make use of the values in the Access database for a particular selected **Field Element** or **Field Attribute** node, you must configure two of its properties:</span></span>  

  -   <span data-ttu-id="ee34d-149">您必須設定其**Derived By**屬性設**限制**。</span><span class="sxs-lookup"><span data-stu-id="ee34d-149">You must set its **Derived By** property to **Restriction**.</span></span> <span data-ttu-id="ee34d-150">若要設定，您需要的其他屬性**CodeList**，直到您執行此步驟會啟用。</span><span class="sxs-lookup"><span data-stu-id="ee34d-150">The other property you need to configure, **CodeList**, will not be enabled until you perform this step.</span></span>  

  -   <span data-ttu-id="ee34d-151">您必須輸入新的值**CodeList**對應至第一個資料行中值的屬性 (**程式碼**資料行) 的一或多個指定的 Access 資料庫中的資料列。</span><span class="sxs-lookup"><span data-stu-id="ee34d-151">You must type a value into the **CodeList** property that corresponds to the value in the first column (the **Code** column) of one or more rows in the specified Access database.</span></span> <span data-ttu-id="ee34d-152">此動作會識別您要對應至所選的列舉值的集合**欄位項目**或是**Field 屬性**節點。</span><span class="sxs-lookup"><span data-stu-id="ee34d-152">This action identifies the set of enumeration values that you intend to have correspond to the selected **Field Element** or **Field Attribute** node.</span></span>  

       <span data-ttu-id="ee34d-153">然後您必須按一下省略符號 (**...**) 按鈕位於右邊**CodeList**屬性值欄位，以開啟**CodeList**  對話方塊。</span><span class="sxs-lookup"><span data-stu-id="ee34d-153">Then you must click the ellipsis (**...**) button located to the right of the **CodeList** property value field to open the **CodeList** dialog box.</span></span> <span data-ttu-id="ee34d-154">使用核取方塊，在此對話方塊中，選取您想要允許做為合法值對應至所選的執行個體訊息資料的值**欄位項目**或是**Field 屬性**節點。</span><span class="sxs-lookup"><span data-stu-id="ee34d-154">Using the check boxes in this dialog box, select the values that you want to allow as legal values for the instance message data that corresponds to the selected **Field Element** or **Field Attribute** node.</span></span> <span data-ttu-id="ee34d-155">您只能選取可用值的子集。</span><span class="sxs-lookup"><span data-stu-id="ee34d-155">You are allowed to select only a subset of the available values.</span></span> <span data-ttu-id="ee34d-156">例如，以前述資料表為例，如果您輸入值 1 **CodeList**屬性，**程式碼清單**對話方塊將包含紅色、 綠色及藍色的選項。</span><span class="sxs-lookup"><span data-stu-id="ee34d-156">For example, using the preceding table example, if you type the value 1 into the **CodeList** property, the **CodeList** dialog box will contain the choices Red, Green, and Blue.</span></span> <span data-ttu-id="ee34d-157">如果您選取紅色和綠色的核取方塊，並請勿選取核取方塊，藍色，只有前兩個色彩會在 XSD 中顯示為有效的值，為所選**欄位項目**或是**Field 屬性**節點。</span><span class="sxs-lookup"><span data-stu-id="ee34d-157">If you select the check boxes for Red and Green, and do not select the check box for Blue, only the former colors will appear in the XSD as valid values for the selected **Field Element** or **Field Attribute** node.</span></span>  

> [!NOTE]
>  <span data-ttu-id="ee34d-158">**CodeList**並**程式碼清單資料庫**屬性只能在設計階段使用和保存在 XSD 做為對應的設定，如**列舉型別**屬性。</span><span class="sxs-lookup"><span data-stu-id="ee34d-158">The **CodeList** and **CodeList Database** properties are used at design time only and are persisted in the XSD as corresponding settings for the **Enumeration** property.</span></span> <span data-ttu-id="ee34d-159">在執行階段，針對驗證所有的值**列舉型別**只顯示屬性。</span><span class="sxs-lookup"><span data-stu-id="ee34d-159">At run time, all values are verified against the **Enumeration** property only.</span></span>  

> [!CAUTION]
>  <span data-ttu-id="ee34d-160">針對給定**欄位項目**或**欄位屬性**節點，兩者都使用**列舉型別**屬性和**CodeList**屬性。</span><span class="sxs-lookup"><span data-stu-id="ee34d-160">For a given **Field Element** or **Field Attribute** node, do not use both the **Enumeration** property and the **CodeList** property.</span></span> <span data-ttu-id="ee34d-161">使用後一種屬性可能導致以前一種屬性輸入的值遭到覆寫。</span><span class="sxs-lookup"><span data-stu-id="ee34d-161">Using the latter property can result in values entered using the former property to be overwritten.</span></span>  

## <a name="see-also"></a><span data-ttu-id="ee34d-162">另請參閱</span><span class="sxs-lookup"><span data-stu-id="ee34d-162">See Also</span></span>  
 [<span data-ttu-id="ee34d-163">建立結構描述時的考量</span><span class="sxs-lookup"><span data-stu-id="ee34d-163">Considerations When Creating Schemas</span></span>](../core/considerations-when-creating-schemas.md)