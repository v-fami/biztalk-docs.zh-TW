---
title: 組件安裝在 GAC 中的 |Microsoft 文件
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 3b12d00c-8750-4c6d-8244-e613f955a478
caps.latest.revision: 17
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 25af22c85602c323b87340cce8b740fe5b68accb
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/28/2017
ms.locfileid: "25966404"
---
# <a name="assembly-installation-in-the-gac"></a><span data-ttu-id="589b2-102">GAC 中的組件安裝</span><span class="sxs-lookup"><span data-stu-id="589b2-102">Assembly Installation in the GAC</span></span>
<span data-ttu-id="589b2-103">每部電腦都含有全域組件快取 (GAC)，其中包含該部電腦上一個或多個應用程式所使用的組件。</span><span class="sxs-lookup"><span data-stu-id="589b2-103">Each computer contains a global assembly cache (GAC) that contains the assemblies that are used by one or more applications on that computer.</span></span> <span data-ttu-id="589b2-104">為了讓 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 在執行階段期間處理訊息，BizTalk 應用程式所包含的組件必須存在於執行應用程式之電腦的 GAC 中。</span><span class="sxs-lookup"><span data-stu-id="589b2-104">For [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] to process messages during run time, the assemblies included in a BizTalk application must be present in the GACs of the computers that run the application.</span></span>  
  
 <span data-ttu-id="589b2-105">如果您的應用程式隔離在一個伺服器上，組件就只需要存在於該伺服器的 GAC 中。</span><span class="sxs-lookup"><span data-stu-id="589b2-105">If your application is isolated to one server, then assemblies need only be present in the GAC of that server.</span></span> <span data-ttu-id="589b2-106">但是，如果有多部伺服器在主控應用程式，該應用程式中的組件就必須存在於需要存取組件所包含之成品的每部電腦的 GAC 中。</span><span class="sxs-lookup"><span data-stu-id="589b2-106">However if multiple servers host the application, then the assemblies in that application must exist in the GAC of each computer that requires access to the artifacts contained in the assembly.</span></span> <span data-ttu-id="589b2-107">例如，如果您將 Assembly_A 部署至 Server_1，然後在 Server_2 上的主機中登錄 Assembly_A，assembly_a 就必須安裝在 Server_2 上的 GAC 中。</span><span class="sxs-lookup"><span data-stu-id="589b2-107">For example, if you deploy Assembly_A to Server_1, and then enlist Assembly_A in a host on Server_2, Assembly_A must be installed in the GAC on Server_2.</span></span> <span data-ttu-id="589b2-108">如果不是，Server_2 將無法在執行階段期間存取 Assembly_A。</span><span class="sxs-lookup"><span data-stu-id="589b2-108">If it is not, Server_2 will not be able to access Assembly_A during run time.</span></span>  
  
 <span data-ttu-id="589b2-109">尤其，包含協調流程及其所依靠之任合組件的組件，都一定得安裝在伺服器上的 GAC 中，且這些伺服器必須執行協調流程所繫結之目標主控件的執行個體。</span><span class="sxs-lookup"><span data-stu-id="589b2-109">In particular, assemblies containing orchestrations and any assemblies that they depend on must always be installed in the GAC on servers that run instances of the host to which the orchestration is bound.</span></span> <span data-ttu-id="589b2-110">此外，包含由連接埠使用之對應和管線的組件，也必須安裝在執行主控件 (提供連接埠之配接器處理常式服務) 之執行個體的伺服器上。</span><span class="sxs-lookup"><span data-stu-id="589b2-110">In addition, assemblies containing the maps and pipelines used by a port must be installed on servers that run instances of the host serving as the adapter handler for the port.</span></span>  
  
 <span data-ttu-id="589b2-111">您可以指定每個組件的部署選項，以便在從 [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)] 部署組件時將其安裝到 GAC 中。</span><span class="sxs-lookup"><span data-stu-id="589b2-111">You can specify a deployment option for each assembly to install it in the GAC when you deploy the assembly from [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)].</span></span> <span data-ttu-id="589b2-112">或者，您可以用手動方式將組件安裝到 GAC 中。</span><span class="sxs-lookup"><span data-stu-id="589b2-112">Alternatively, you can install an assembly in the GAC manually.</span></span> <span data-ttu-id="589b2-113">此外，您可以指定將組件部署到 BizTalk 應用程式後，在 GAC 中安裝組件的部署選項。</span><span class="sxs-lookup"><span data-stu-id="589b2-113">In addition, you can specify deployment options to install the assembly in the GAC after it is deployed into a BizTalk application.</span></span>  
  
 <span data-ttu-id="589b2-114">下列摘要可在 GAC 中安裝組件的工具和方法：</span><span class="sxs-lookup"><span data-stu-id="589b2-114">The following summarizes the tools and methods available to install an assembly in the GAC:</span></span>  
  
-   <span data-ttu-id="589b2-115">**Microsoft Visual Studio。**</span><span class="sxs-lookup"><span data-stu-id="589b2-115">**Microsoft Visual Studio.**</span></span> <span data-ttu-id="589b2-116">如先前所述，您可以設定專案屬性的組件在 GAC 中自動安裝時，您將部署中所述[如何在 Visual Studio 中設定部署屬性](../core/how-to-set-deployment-properties-in-visual-studio.md)。</span><span class="sxs-lookup"><span data-stu-id="589b2-116">As previously mentioned, you can set project properties to install assemblies in the GAC automatically when you deploy them, as described in [How to Set Deployment Properties in Visual Studio](../core/how-to-set-deployment-properties-in-visual-studio.md).</span></span> <span data-ttu-id="589b2-117">您也可以手動安裝的組件在 GAC 中所隨附的 Gacutil 命令列工具[!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]中所述，[如何在 GAC 中安裝組件](../core/how-to-install-an-assembly-in-the-gac.md)。</span><span class="sxs-lookup"><span data-stu-id="589b2-117">You can also manually install assemblies in the GAC by using the Gacutil command-line tool included with [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)], as described in [How to Install an Assembly in the GAC](../core/how-to-install-an-assembly-in-the-gac.md).</span></span>  
  
-   <span data-ttu-id="589b2-118">**BTSTask 命令列工具。**</span><span class="sxs-lookup"><span data-stu-id="589b2-118">**BTSTask command-line tool.**</span></span> <span data-ttu-id="589b2-119">當您使用 BTSTask 將組件新增至 BizTalk 應用程式時，即可指定在匯入或安裝包含該組件的應用程式時，將組件安裝到 GAC 中的選項。</span><span class="sxs-lookup"><span data-stu-id="589b2-119">When you add an assembly to a BizTalk application by using BTSTask, you can specify options to install the assembly in the GAC when the application that contains it is imported or installed.</span></span> <span data-ttu-id="589b2-120">如需詳細資訊，請參閱[AddResource 命令： BizTalk 組件](../core/addresource-command-biztalk-assembly.md)。</span><span class="sxs-lookup"><span data-stu-id="589b2-120">For more information, see [AddResource Command: BizTalk Assembly](../core/addresource-command-biztalk-assembly.md).</span></span> <span data-ttu-id="589b2-121">另請參閱[AddResource 命令：.NET 組件](../core/addresource-command-net-assembly.md)。</span><span class="sxs-lookup"><span data-stu-id="589b2-121">Also see [AddResource Command: .NET Assembly](../core/addresource-command-net-assembly.md).</span></span>  
  
-   <span data-ttu-id="589b2-122">**BizTalk Server 管理主控台。**</span><span class="sxs-lookup"><span data-stu-id="589b2-122">**BizTalk Server Administration console.**</span></span> <span data-ttu-id="589b2-123">使用與 BTSTask 相同的方式，當您使用 [管理主控台] 將組件新增至應用程式時，即可指定在匯入或安裝包含該組件的應用程式時，將組件安裝到 GAC 中的選項。</span><span class="sxs-lookup"><span data-stu-id="589b2-123">In the same manner as BTSTask, when you add an assembly to an application by using the Administration console, you can specify options to install an assembly in the GAC when the application that contains it is imported or installed.</span></span> <span data-ttu-id="589b2-124">如需詳細資訊，請參閱[如何將 BizTalk 組件新增至應用程式](../core/how-to-add-a-biztalk-assembly-to-an-application.md)。</span><span class="sxs-lookup"><span data-stu-id="589b2-124">For more information, see [How to Add a BizTalk Assembly to an Application](../core/how-to-add-a-biztalk-assembly-to-an-application.md).</span></span> <span data-ttu-id="589b2-125">另請參閱[如何將.NET 組件新增至應用程式](../core/how-to-add-a-net-assembly-to-an-application.md)。</span><span class="sxs-lookup"><span data-stu-id="589b2-125">Also see [How to Add a .NET Assembly to an Application](../core/how-to-add-a-net-assembly-to-an-application.md).</span></span>  
  
     <span data-ttu-id="589b2-126">此外，您可以設定部署選項在任何時間之後已部署至或加入至應用程式，組件中所述[如何修改 BizTalk 組件的部署選項](../core/how-to-modify-the-deployment-options-of-a-biztalk-assembly.md)。</span><span class="sxs-lookup"><span data-stu-id="589b2-126">In addition, you can configure deployment options at any time after an assembly has been deployed into or added to an application, as described in [How to Modify the Deployment Options of a BizTalk Assembly](../core/how-to-modify-the-deployment-options-of-a-biztalk-assembly.md).</span></span> <span data-ttu-id="589b2-127">組件會部署到[!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]從[!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]第一次，在管理主控台中的部署選項設定如下： GAC 安裝上的已啟用和停用 GAC，匯入。</span><span class="sxs-lookup"><span data-stu-id="589b2-127">When assemblies are deployed into [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)] from [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)] for the first time, the deployment options in the Administration console are set as follows: GAC on installation is enabled and GAC on import is disabled.</span></span> <span data-ttu-id="589b2-128">如果您變更了這些設定，即使組件已經從 [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)] 重新部署，您的變更依然會具有效果。</span><span class="sxs-lookup"><span data-stu-id="589b2-128">If you make changes to these settings, your changes will still be in effect if the assembly is redeployed from [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)].</span></span>  
  
-   <span data-ttu-id="589b2-129">**拖放。**</span><span class="sxs-lookup"><span data-stu-id="589b2-129">**Drag and drop.**</span></span> <span data-ttu-id="589b2-130">使用 Windows 檔案總管中，您可以拖放組件檔\< *Windows 資料夾*\>\assembly。</span><span class="sxs-lookup"><span data-stu-id="589b2-130">Using Windows Explorer, you can drag and drop the assembly file into the \<*Windows folder*\>\assembly.</span></span>  
  
-   <span data-ttu-id="589b2-131">**其他方法。**</span><span class="sxs-lookup"><span data-stu-id="589b2-131">**Other methods.**</span></span> <span data-ttu-id="589b2-132">還有其他工具和方法，包括使用 Windows Installer 或協力廠商所建立的工具，都能將組件安裝到 GAC 中。</span><span class="sxs-lookup"><span data-stu-id="589b2-132">There are other tools and methods, including using Windows installer or tools created by third-party vendors, to install an assembly in the GAC.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="589b2-133">為了讓您的應用程式能夠適當運作，請確定在 GAC 中具有與 BizTalk 管理資料庫中版本相同的組件。</span><span class="sxs-lookup"><span data-stu-id="589b2-133">So that your application functions properly, ensure that the same versions of assemblies are in the BizTalk Management database as in the GAC.</span></span> <span data-ttu-id="589b2-134">如果您沒有總是在部署組件時將其安裝到 GAC 中，就可能會在 GAC 和 BizTalk 管理資料庫中擁有不同的版本，這樣將會造成執行階段期間的處理錯誤。</span><span class="sxs-lookup"><span data-stu-id="589b2-134">If you do not always install an assembly in the GAC when you deploy it, you might have different versions in the GAC and the BizTalk Management database, which will cause processing errors during run time.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="589b2-135">如需版本編號的詳細資訊，請參閱 Microsoft [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)] 所提供「.NET Framework 說明」中的＜組件版本編號＞。</span><span class="sxs-lookup"><span data-stu-id="589b2-135">For information about version numbering, see "Assembly Versioning" in the .NET Framework help available from Microsoft [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)].</span></span> <span data-ttu-id="589b2-136">請注意，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 不支援使用 .NET 原則檔。</span><span class="sxs-lookup"><span data-stu-id="589b2-136">Note that the use of .NET policy files is not supported by [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="589b2-137">請參閱</span><span class="sxs-lookup"><span data-stu-id="589b2-137">See Also</span></span>  
 <span data-ttu-id="589b2-138">[部署 BizTalk 組件從 Visual Studio 到 BizTalk 應用程式](../core/deploying-biztalk-assemblies-from-visual-studio-into-a-biztalk-application.md) </span><span class="sxs-lookup"><span data-stu-id="589b2-138">[Deploying BizTalk Assemblies from Visual Studio into a BizTalk Application](../core/deploying-biztalk-assemblies-from-visual-studio-into-a-biztalk-application.md) </span></span>  
 [<span data-ttu-id="589b2-139">了解 BizTalk 應用程式部署和管理</span><span class="sxs-lookup"><span data-stu-id="589b2-139">Understanding BizTalk Application Deployment and Management</span></span>](../core/understanding-biztalk-application-deployment-and-management.md)