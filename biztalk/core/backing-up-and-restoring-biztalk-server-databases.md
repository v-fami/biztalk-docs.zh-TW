---
title: 備份和還原 BizTalk Server 資料庫 |Microsoft 文件
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- backing up [BAM]
- databases, backing up
- databases, restoring
- backing up, restoring
- backing up, databases
- restoring, BAM
- backing up, BAM
- backing up, backup jobs
- BAM, restoring
- restoring, databases
- restoring [BAM]
- BAM, backing up
ms.assetid: 82fc1af2-1389-4c79-80dc-f2df5656d201
caps.latest.revision: 30
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: dba0e9e7cb5d01bf845eaa4adf3557dc3b6ea34a
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
ms.locfileid: "22232926"
---
# <a name="backing-up-and-restoring-biztalk-server-databases"></a><span data-ttu-id="e4853-102">備份和還原 BizTalk Server 資料庫</span><span class="sxs-lookup"><span data-stu-id="e4853-102">Backing Up and Restoring BizTalk Server Databases</span></span>
<span data-ttu-id="e4853-103">除了商務活動監控 (BAM) 使用的部分資料庫是例外之外，您要使用「備份 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]」工作來備份 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 來源系統中的所有資料庫。</span><span class="sxs-lookup"><span data-stu-id="e4853-103">You use the Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job to back up all of the databases in your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] source system, except for some databases used by Business Activity Monitoring (BAM).</span></span> <span data-ttu-id="e4853-104">來源系統是包含即時資料的伺服器或伺服器群組。</span><span class="sxs-lookup"><span data-stu-id="e4853-104">The source system is the server or group of servers that contain live data.</span></span> <span data-ttu-id="e4853-105">BAM 資料庫由於有不同的備份和還原需求，因此要使用其他方法來備份和還原。</span><span class="sxs-lookup"><span data-stu-id="e4853-105">Because BAM databases have different backup and restore requirements, these databases are backed up and restored using other methods.</span></span>  
  
 <span data-ttu-id="e4853-106">備份和還原 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 資料庫包含下列步驟：</span><span class="sxs-lookup"><span data-stu-id="e4853-106">Backing up the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases and restoring them involves the following steps:</span></span>  
  
1.  <span data-ttu-id="e4853-107">**設定 「 備份 BizTalk Server 」 工作**</span><span class="sxs-lookup"><span data-stu-id="e4853-107">**Configuring the Backup BizTalk Server job**</span></span>  
  
     <span data-ttu-id="e4853-108">在備份 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 資料庫之前，您必須先在來源系統上設定「備份 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]」工作，這會自動引導系統將備份寫入資料夾，往後便可在此資料夾中使用這些備份在目的系統上還原資料庫。</span><span class="sxs-lookup"><span data-stu-id="e4853-108">Before you can back up the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases, you must first configure the Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job on the source system, which directs backups to be automatically written to a folder where they can then be used to restore the databases on the destination system.</span></span> <span data-ttu-id="e4853-109">目的系統是將用來還原來源系統所產生的資料庫備份之伺服器或伺服器群組。</span><span class="sxs-lookup"><span data-stu-id="e4853-109">The destination system is the server or group of servers that will be used to restore the database backups produced by the source system.</span></span> <span data-ttu-id="e4853-110">如需有關此步驟的詳細資訊，請參閱[如何設定 「 備份 BizTalk Server 」 工作](../core/how-to-configure-the-backup-biztalk-server-job.md)。</span><span class="sxs-lookup"><span data-stu-id="e4853-110">For more information about this step, see [How to Configure the Backup BizTalk Server Job](../core/how-to-configure-the-backup-biztalk-server-job.md).</span></span>  
  
2.  <span data-ttu-id="e4853-111">**設定目的系統以進行記錄傳送**</span><span class="sxs-lookup"><span data-stu-id="e4853-111">**Configuring the destination system for log shipping**</span></span>  
  
     <span data-ttu-id="e4853-112">您也必須設定目的系統以進行記錄傳送，當發生系統失敗時，便能提供待命伺服器功能並減少停機時間。</span><span class="sxs-lookup"><span data-stu-id="e4853-112">You must also configure the destination system for log shipping, which provides standby server capabilities and reduces downtime in the event of a system failure.</span></span> <span data-ttu-id="e4853-113">如需有關此步驟的詳細資訊，請參閱[如何設定記錄傳送目的地系統](../core/how-to-configure-the-destination-system-for-log-shipping.md)。</span><span class="sxs-lookup"><span data-stu-id="e4853-113">For more information about this step, see [How to Configure the Destination System for Log Shipping](../core/how-to-configure-the-destination-system-for-log-shipping.md).</span></span>  
  
3.  <span data-ttu-id="e4853-114">**還原資料庫**</span><span class="sxs-lookup"><span data-stu-id="e4853-114">**Restoring the databases**</span></span>  
  
     <span data-ttu-id="e4853-115">發生硬體失敗時，您可以使用傳送到目的系統的備份和記錄來還原您的資料庫。</span><span class="sxs-lookup"><span data-stu-id="e4853-115">When a hardware failure occurs, you can restore your databases by using the backups and logs sent to your destination system.</span></span> <span data-ttu-id="e4853-116">如需有關此步驟的詳細資訊，請參閱[如何還原您的資料庫](../core/how-to-restore-your-databases.md)。</span><span class="sxs-lookup"><span data-stu-id="e4853-116">For more information about this step, see [How to Restore Your Databases](../core/how-to-restore-your-databases.md).</span></span>  
  
## <a name="biztalk-server-databases"></a><span data-ttu-id="e4853-117">BizTalk Server 資料庫</span><span class="sxs-lookup"><span data-stu-id="e4853-117">BizTalk Server Databases</span></span>  
 <span data-ttu-id="e4853-118">下表描述 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 使用的資料庫，並指示用來備份資料庫的方法。</span><span class="sxs-lookup"><span data-stu-id="e4853-118">The following tables describe the databases used by [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] and identify which methods are used to back up the databases.</span></span>  
  
### <a name="databases-backed-up-by-the-backup-biztalk-server-job"></a><span data-ttu-id="e4853-119">由備份 BizTalk Server 工作備份的資料庫</span><span class="sxs-lookup"><span data-stu-id="e4853-119">Databases Backed Up by the Backup BizTalk Server Job</span></span>  
 <span data-ttu-id="e4853-120">下表列出「備份 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]」工作會備份和還原的資料庫。</span><span class="sxs-lookup"><span data-stu-id="e4853-120">The following table lists the databases that are backed up and restored as a part of the Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job.</span></span> <span data-ttu-id="e4853-121">您可以修改「備份 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]」工作，藉由將自訂資料庫新增到 adm_OtherBackupDatabases 資料表來備份它們。</span><span class="sxs-lookup"><span data-stu-id="e4853-121">You can modify the Backup [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] job to back up custom databases by adding them to the adm_OtherBackupDatabases table.</span></span> <span data-ttu-id="e4853-122">如需詳細資訊，請參閱[如何備份自訂資料庫](../core/how-to-back-up-custom-databases.md)。</span><span class="sxs-lookup"><span data-stu-id="e4853-122">For more information, see [How to Back Up Custom Databases](../core/how-to-back-up-custom-databases.md).</span></span>  
  
|<span data-ttu-id="e4853-123">資料庫</span><span class="sxs-lookup"><span data-stu-id="e4853-123">Database</span></span>|<span data-ttu-id="e4853-124">預設資料庫名稱</span><span class="sxs-lookup"><span data-stu-id="e4853-124">Default database name</span></span>|<span data-ttu-id="e4853-125">Description</span><span class="sxs-lookup"><span data-stu-id="e4853-125">Description</span></span>|  
|--------------|---------------------------|-----------------|  
|<span data-ttu-id="e4853-126">BAM 主要匯入資料庫</span><span class="sxs-lookup"><span data-stu-id="e4853-126">BAM Primary Import database</span></span>|<span data-ttu-id="e4853-127">BAMPrimaryImport</span><span class="sxs-lookup"><span data-stu-id="e4853-127">BAMPrimaryImport</span></span>|<span data-ttu-id="e4853-128">這是商務活動監控 (BAM) 收集原始追蹤資料的資料庫。</span><span class="sxs-lookup"><span data-stu-id="e4853-128">This is the database where the Business Activity Monitoring (BAM) collects raw tracking data.</span></span>|  
|<span data-ttu-id="e4853-129">BAM Notification Services 應用程式資料庫</span><span class="sxs-lookup"><span data-stu-id="e4853-129">BAM Notification Services Application database</span></span>|<span data-ttu-id="e4853-130">BAMAlertsApplication</span><span class="sxs-lookup"><span data-stu-id="e4853-130">BAMAlertsApplication</span></span>|<span data-ttu-id="e4853-131">這個資料庫包含 BAM 通知的警示資訊。</span><span class="sxs-lookup"><span data-stu-id="e4853-131">This database contains alert information for BAM notifications.</span></span> <span data-ttu-id="e4853-132">例如，當您使用 BAM 入口網站建立警示時，就會在資料庫中插入項目以指定與警示相關的條件和事件，以及警示的其他支援資料項目。</span><span class="sxs-lookup"><span data-stu-id="e4853-132">For example, when you create an alert using the BAM portal, entries are inserted in the database specifying the conditions and events to which the alert pertains, as well as other supporting data items for the alert.</span></span>|  
|<span data-ttu-id="e4853-133">BAM Notification Services 執行個體資料庫</span><span class="sxs-lookup"><span data-stu-id="e4853-133">BAM Notification Services Instance database</span></span>|<span data-ttu-id="e4853-134">BAMAlertsNSMain</span><span class="sxs-lookup"><span data-stu-id="e4853-134">BAMAlertsNSMain</span></span>|<span data-ttu-id="e4853-135">這個資料庫包含執行個體資訊，指定通知服務連接到 BAM 正在監控之系統的方法。</span><span class="sxs-lookup"><span data-stu-id="e4853-135">This database contains instance information specifying how the notification services connect to the system that BAM is monitoring.</span></span>|  
|<span data-ttu-id="e4853-136">BizTalk 追蹤資料庫</span><span class="sxs-lookup"><span data-stu-id="e4853-136">BizTalk Tracking database</span></span>|<span data-ttu-id="e4853-137">BizTalkDTADb</span><span class="sxs-lookup"><span data-stu-id="e4853-137">BizTalkDTADb</span></span>|<span data-ttu-id="e4853-138">這個資料庫儲存了 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 追蹤引擎所追蹤的狀況監控資料。</span><span class="sxs-lookup"><span data-stu-id="e4853-138">This database stores health monitoring data tracked by the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] tracking engine.</span></span>|  
|<span data-ttu-id="e4853-139">BizTalk 管理資料庫</span><span class="sxs-lookup"><span data-stu-id="e4853-139">BizTalk Management database</span></span>|<span data-ttu-id="e4853-140">BizTalkMgmtDb</span><span class="sxs-lookup"><span data-stu-id="e4853-140">BizTalkMgmtDb</span></span>|<span data-ttu-id="e4853-141">這個資料庫是所有 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 執行個體的中央中繼資訊存放區。</span><span class="sxs-lookup"><span data-stu-id="e4853-141">This database is the central meta-information store for all instances of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>|  
|<span data-ttu-id="e4853-142">BizTalk MessageBox 資料庫</span><span class="sxs-lookup"><span data-stu-id="e4853-142">BizTalk MessageBox database</span></span>|<span data-ttu-id="e4853-143">BizTalkMsgBoxDb</span><span class="sxs-lookup"><span data-stu-id="e4853-143">BizTalkMsgBoxDb</span></span>|<span data-ttu-id="e4853-144">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 引擎使用這個資料庫進行路由、排入佇列、執行個體管理及其他不同的工作。</span><span class="sxs-lookup"><span data-stu-id="e4853-144">This database is used by the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] engine for routing, queuing, instance management, and a variety of other tasks.</span></span>|  
|<span data-ttu-id="e4853-145">規則引擎資料庫</span><span class="sxs-lookup"><span data-stu-id="e4853-145">Rule Engine database</span></span>|<span data-ttu-id="e4853-146">BizTalkRuleEngineDb</span><span class="sxs-lookup"><span data-stu-id="e4853-146">BizTalkRuleEngineDb</span></span>|<span data-ttu-id="e4853-147">這個資料庫是下列項目的儲存機制：</span><span class="sxs-lookup"><span data-stu-id="e4853-147">This database is a repository for:</span></span><br /><br /> <span data-ttu-id="e4853-148">-原則，也就是相關規則的集合。</span><span class="sxs-lookup"><span data-stu-id="e4853-148">-   Policies, which are sets of related rules.</span></span><br /><span data-ttu-id="e4853-149">-詞彙，規則中關於資料參考的使用者易記、 網域特定名稱的集合。</span><span class="sxs-lookup"><span data-stu-id="e4853-149">-   Vocabularies, which are collections of user-friendly, domain-specific names for data references in rules.</span></span>|  
|<span data-ttu-id="e4853-150">SSO 資料庫</span><span class="sxs-lookup"><span data-stu-id="e4853-150">SSO database</span></span>|<span data-ttu-id="e4853-151">SSODB</span><span class="sxs-lookup"><span data-stu-id="e4853-151">SSODB</span></span>|<span data-ttu-id="e4853-152">這個「企業單一登入」資料庫會安全地儲存接收位置的組態資訊。</span><span class="sxs-lookup"><span data-stu-id="e4853-152">This Enterprise Single Sign-On database securely stores the configuration information for receive locations.</span></span>|  
  
### <a name="databases-backed-up-by-the-bam-backup-process"></a><span data-ttu-id="e4853-153">由 BAM 備份程序備份的資料庫</span><span class="sxs-lookup"><span data-stu-id="e4853-153">Databases Backed Up by the BAM Backup Process</span></span>  
 <span data-ttu-id="e4853-154">下表列出的資料庫備份及還原使用中的程序的[備份和還原 BAM](../core/backing-up-and-restoring-bam.md):</span><span class="sxs-lookup"><span data-stu-id="e4853-154">The following table lists the databases that are backed up and restored using the procedures in [Backing Up and Restoring BAM](../core/backing-up-and-restoring-bam.md):</span></span>  
  
|<span data-ttu-id="e4853-155">資料庫</span><span class="sxs-lookup"><span data-stu-id="e4853-155">Database</span></span>|<span data-ttu-id="e4853-156">預設資料庫名稱</span><span class="sxs-lookup"><span data-stu-id="e4853-156">Default database name</span></span>|<span data-ttu-id="e4853-157">Description</span><span class="sxs-lookup"><span data-stu-id="e4853-157">Description</span></span>|  
|--------------|---------------------------|-----------------|  
|<span data-ttu-id="e4853-158">BAM 星狀結構描述</span><span class="sxs-lookup"><span data-stu-id="e4853-158">BAM Star Schema</span></span>|<span data-ttu-id="e4853-159">BAMStarSchema</span><span class="sxs-lookup"><span data-stu-id="e4853-159">BAMStarSchema</span></span>|<span data-ttu-id="e4853-160">這個資料庫含有臨時資料表以及量值和維度資料表。</span><span class="sxs-lookup"><span data-stu-id="e4853-160">This database contains the staging table, and the measure and dimension tables.</span></span>|  
|<span data-ttu-id="e4853-161">BAM 分析</span><span class="sxs-lookup"><span data-stu-id="e4853-161">BAM Analysis</span></span>|<span data-ttu-id="e4853-162">BAMAnalysis</span><span class="sxs-lookup"><span data-stu-id="e4853-162">BAMAnalysis</span></span>|<span data-ttu-id="e4853-163">這個資料庫含有可供線上及離線分析使用的 BAM OLAP Cube。</span><span class="sxs-lookup"><span data-stu-id="e4853-163">This database contains BAM OLAP cubes for both online and offline analysis.</span></span>|  
|<span data-ttu-id="e4853-164">BAM 封存</span><span class="sxs-lookup"><span data-stu-id="e4853-164">BAM Archive</span></span>|<span data-ttu-id="e4853-165">BAMArchive</span><span class="sxs-lookup"><span data-stu-id="e4853-165">BAMArchive</span></span>|<span data-ttu-id="e4853-166">這個資料庫會封存舊的商務活動資料。</span><span class="sxs-lookup"><span data-stu-id="e4853-166">This database archives old business activity data.</span></span> <span data-ttu-id="e4853-167">建立 BAM 封存資料庫可將 BAM 主要匯入資料庫中的商務活動資料累積降到最低。</span><span class="sxs-lookup"><span data-stu-id="e4853-167">Create a BAM Archive database to minimize the accumulation of business activity data in the BAM Primary Import database.</span></span>|  
|<span data-ttu-id="e4853-168">追蹤 Analysis Server</span><span class="sxs-lookup"><span data-stu-id="e4853-168">Tracking Analysis Server</span></span>|<span data-ttu-id="e4853-169">BizTalkAnalysisDb</span><span class="sxs-lookup"><span data-stu-id="e4853-169">BizTalkAnalysisDb</span></span>|<span data-ttu-id="e4853-170">這個資料庫會儲存狀況監控線上分析處理 (OLAP) Cube。</span><span class="sxs-lookup"><span data-stu-id="e4853-170">This database stores health monitoring online analytical processing (OLAP) cubes.</span></span>|  
  
## <a name="in-this-section"></a><span data-ttu-id="e4853-171">本節內容</span><span class="sxs-lookup"><span data-stu-id="e4853-171">In This Section</span></span>  
  
-   [<span data-ttu-id="e4853-172">如何設定備份 BizTalk Server 作業</span><span class="sxs-lookup"><span data-stu-id="e4853-172">How to Configure the Backup BizTalk Server Job</span></span>](../core/how-to-configure-the-backup-biztalk-server-job.md)  
  
-   [<span data-ttu-id="e4853-173">如何設定記錄傳送目的地系統</span><span class="sxs-lookup"><span data-stu-id="e4853-173">How to Configure the Destination System for Log Shipping</span></span>](../core/how-to-configure-the-destination-system-for-log-shipping.md)  
  
-   [<span data-ttu-id="e4853-174">如何還原資料庫</span><span class="sxs-lookup"><span data-stu-id="e4853-174">How to Restore Your Databases</span></span>](../core/how-to-restore-your-databases.md)  
  
-   [<span data-ttu-id="e4853-175">如何備份和還原 SQL 代理程式作業</span><span class="sxs-lookup"><span data-stu-id="e4853-175">How to Back Up and Restore SQL Agent Jobs</span></span>](../core/how-to-back-up-and-restore-sql-agent-jobs.md)  
  
-   [<span data-ttu-id="e4853-176">如何備份和還原 SQL Server 登入</span><span class="sxs-lookup"><span data-stu-id="e4853-176">How to Back Up and Restore SQL Server Logins</span></span>](../core/how-to-back-up-and-restore-sql-server-logins.md)