---
title: 服務匯流排傳訊配接器 |Microsoft Docs
description: 傳送和接收 BizTalk Server 中使用 Azure SB Messaging 配接器的訊息
ms.custom: ''
ms.date: 11/21/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: c06c4934-45b2-4f6f-9d19-3ebd937c32ae
caps.latest.revision: 5
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 3ce37fbf72f07bc3610a88096098722e8be55d6b
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "37015711"
---
# <a name="sb-messaging-adapter"></a><span data-ttu-id="97cff-103">SB Messaging 配接器</span><span class="sxs-lookup"><span data-stu-id="97cff-103">SB-Messaging Adapter</span></span>
<span data-ttu-id="97cff-104">服務匯流排 (**SB Messaging**) 配接器用來接收和傳送來自服務匯流排實體，例如佇列、 主題和轉送。</span><span class="sxs-lookup"><span data-stu-id="97cff-104">The Service Bus (**SB-Messaging**) adapter is used to receive and send from Service Bus entities like Queues, Topics, and Relays.</span></span> <span data-ttu-id="97cff-105">您可以使用**SB Messaging**配接器連接將內部[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]至 Azure。</span><span class="sxs-lookup"><span data-stu-id="97cff-105">You can use the **SB-Messaging** adapter to connect your on-premises [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] to Azure.</span></span>

<span data-ttu-id="97cff-106">**開頭[!INCLUDE[bts2016_md](../includes/bts2016-md.md)]Feature Pack 2**，服務匯流排進階版支援。</span><span class="sxs-lookup"><span data-stu-id="97cff-106">**Starting with [!INCLUDE[bts2016_md](../includes/bts2016-md.md)] Feature Pack 2**, Service Bus Premium is supported.</span></span> <span data-ttu-id="97cff-107">設定使用此配接器傳送埠時，您可以傳送訊息至分割的佇列和主題。</span><span class="sxs-lookup"><span data-stu-id="97cff-107">When configuring a send port using this adapter, you can send messages to partitioned queues and topics.</span></span> 

## <a name="authenticating-with-service-bus"></a><span data-ttu-id="97cff-108">使用服務匯流排進行驗證</span><span class="sxs-lookup"><span data-stu-id="97cff-108">Authenticating with Service Bus</span></span>
<span data-ttu-id="97cff-109">服務匯流排提供兩種方法來驗證：</span><span class="sxs-lookup"><span data-stu-id="97cff-109">Service Bus provides two methods to authenticate:</span></span> 

- <span data-ttu-id="97cff-110">存取控制服務 (ACS)</span><span class="sxs-lookup"><span data-stu-id="97cff-110">Access Control Service (ACS)</span></span> 
- <span data-ttu-id="97cff-111">共用存取簽章 (SAS)</span><span class="sxs-lookup"><span data-stu-id="97cff-111">Shared Access Signature (SAS)</span></span>

<span data-ttu-id="97cff-112">我們建議使用共用存取簽章 (SAS) 來使用服務匯流排進行驗證。</span><span class="sxs-lookup"><span data-stu-id="97cff-112">We recommend using Shared Access Signature (SAS) to authenticate with Service Bus.</span></span> <span data-ttu-id="97cff-113">共用存取金鑰值都會列在[Azure 入口網站](https://portal.azure.com)。</span><span class="sxs-lookup"><span data-stu-id="97cff-113">The Shared Access Key value is listed in the [Azure portal](https://portal.azure.com).</span></span>

<span data-ttu-id="97cff-114">當您建立服務匯流排命名空間時，存取控制 (ACS) 命名空間不會自動建立。</span><span class="sxs-lookup"><span data-stu-id="97cff-114">When you create a Service Bus namespace, the Access Control (ACS) namespace is not automatically created.</span></span> <span data-ttu-id="97cff-115">若要使用存取控制，您會需要此命名空間的簽發者名稱和簽發者金鑰值。</span><span class="sxs-lookup"><span data-stu-id="97cff-115">To use Access Control, you need the Issuer Name and Issuer Key values of this namespace.</span></span> <span data-ttu-id="97cff-116">當您建立新的 ACS 命名空間，使用 Windows PowerShell 時，可使用這些值。</span><span class="sxs-lookup"><span data-stu-id="97cff-116">These values are available when you create a new ACS namespace using Windows PowerShell.</span></span> <span data-ttu-id="97cff-117">在 Azure 入口網站中，不會列出這些值。</span><span class="sxs-lookup"><span data-stu-id="97cff-117">These values are not listed in the Azure portal.</span></span>

<span data-ttu-id="97cff-118">若要使用 ACS 進行驗證，並取得簽發者名稱和簽發者金鑰值，則整體步驟包括：</span><span class="sxs-lookup"><span data-stu-id="97cff-118">To use ACS for authentication, and get the Issuer Name and Issuer Key values, the overall steps include:</span></span>

1. <span data-ttu-id="97cff-119">安裝[Azure Powershell cmdlet](https://azure.microsoft.com/documentation/articles/powershell-install-configure/)。</span><span class="sxs-lookup"><span data-stu-id="97cff-119">Install the [Azure Powershell cmdlets](https://azure.microsoft.com/documentation/articles/powershell-install-configure/).</span></span>
2. <span data-ttu-id="97cff-120">新增您的 Azure 帳戶： `Add-AzureAccount`</span><span class="sxs-lookup"><span data-stu-id="97cff-120">Add your Azure account: `Add-AzureAccount`</span></span>
3. <span data-ttu-id="97cff-121">傳回您的訂用帳戶名稱： `get-azuresubscription`</span><span class="sxs-lookup"><span data-stu-id="97cff-121">Return your subscription name: `get-azuresubscription`</span></span>
4. <span data-ttu-id="97cff-122">選取您的訂用帳戶： `select-azuresubscription <name of your subscription>`</span><span class="sxs-lookup"><span data-stu-id="97cff-122">Select your subscription: `select-azuresubscription <name of your subscription>`</span></span> 
5. <span data-ttu-id="97cff-123">建立新的命名空間： `new-azuresbnamespace <name for the service bus> "Location" -CreateACSNamespace $true -NamespaceType Messaging`</span><span class="sxs-lookup"><span data-stu-id="97cff-123">Create a new namespace: `new-azuresbnamespace <name for the service bus> "Location" -CreateACSNamespace $true -NamespaceType Messaging`</span></span>

    <span data-ttu-id="97cff-124">範例：    `new-azuresbnamespace biztalksbnamespace "South Central US" -CreateACSNamespace $true -NamespaceType Messaging`</span><span class="sxs-lookup"><span data-stu-id="97cff-124">Example:    `new-azuresbnamespace biztalksbnamespace "South Central US" -CreateACSNamespace $true -NamespaceType Messaging`</span></span>

5. <span data-ttu-id="97cff-125">（這可能需要幾分鐘的時間） 建立新的 ACS 命名空間時，連接字串中列出的 IssuerName 和 IssuerKey 值：</span><span class="sxs-lookup"><span data-stu-id="97cff-125">When the new ACS namespace is created (which can take several minutes), the IssuerName and IssuerKey values are listed in the connection string:</span></span> 

    ```
    Name                  : biztalksbnamespace
    Region                : South Central US
    DefaultKey            : abcdefghijklmnopqrstuvwxyz
    Status                : Active
    CreatedAt             : 10/18/2016 9:36:30 PM
    AcsManagementEndpoint : https://biztalksbnamespace-sb.accesscontrol.windows.net/
    ServiceBusEndpoint    : https://biztalksbnamespace.servicebus.windows.net/
    ConnectionString      : Endpoint=sb://biztalksbnamespace.servicebus.windows.net/;SharedSecretIssuer=owner;SharedSecretValue=abcdefghijklmnopqrstuvwxyz
    NamespaceType         : Messaging
    ```

<span data-ttu-id="97cff-126">請參閱[New-azuresbnamespace](https://docs.microsoft.com/powershell/module/Azure/New-AzureSBNamespace)指導方針。</span><span class="sxs-lookup"><span data-stu-id="97cff-126">See [New-AzureSBNamespace](https://docs.microsoft.com/powershell/module/Azure/New-AzureSBNamespace) for guidance.</span></span>

## <a name="receive-messages-from-service-bus"></a><span data-ttu-id="97cff-127">接收來自服務匯流排的訊息</span><span class="sxs-lookup"><span data-stu-id="97cff-127">Receive messages from Service Bus</span></span>

1. <span data-ttu-id="97cff-128">在 BizTalk Server 管理主控台中，依序展開**BizTalk 群組**，展開**應用程式**，然後展開您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="97cff-128">In the BizTalk Server Administration console, expand **BizTalk Group**, expand **Applications**, and then expand your application.</span></span> 

2. <span data-ttu-id="97cff-129">以滑鼠右鍵按一下**接收連接埠**，選取**新增**，然後選取**單向接收埠**。</span><span class="sxs-lookup"><span data-stu-id="97cff-129">Right-click **Receive Ports**, select **New**, and select **One-Way receive port**.</span></span> 

3. <span data-ttu-id="97cff-130">為它命名，然後選取**接收位置**。</span><span class="sxs-lookup"><span data-stu-id="97cff-130">Give it a name, and select **Receive Locations**.</span></span> 

4. <span data-ttu-id="97cff-131">選取 **的新**，不妨**名稱**。</span><span class="sxs-lookup"><span data-stu-id="97cff-131">Select **New**, give it a **Name**.</span></span> <span data-ttu-id="97cff-132">在 **傳輸**區段中，選取**SB Messaging**從**型別**下拉式清單，然後選取**設定**。</span><span class="sxs-lookup"><span data-stu-id="97cff-132">In the **Transport** section, select **SB-Messaging** from the **Type** drop-down list, and then select **Configure**.</span></span>  

5. <span data-ttu-id="97cff-133">設定**一般**屬性：</span><span class="sxs-lookup"><span data-stu-id="97cff-133">Configure the **General** properties:</span></span>  


   |           <span data-ttu-id="97cff-134">使用</span><span class="sxs-lookup"><span data-stu-id="97cff-134">Use this</span></span>            |                                                                                                                                                                                                                                                                                                                                              <span data-ttu-id="97cff-135">以進行此動作</span><span class="sxs-lookup"><span data-stu-id="97cff-135">To do this</span></span>                                                                                                                                                                                                                                                                                                                                               |
   |-------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   | <span data-ttu-id="97cff-136">**佇列或訂用帳戶的 URL**</span><span class="sxs-lookup"><span data-stu-id="97cff-136">**Queue or Subscription URL**</span></span> |                                                                                                                                                                                                                                                               <span data-ttu-id="97cff-137">指定已部署服務匯流排佇列的 URL。</span><span class="sxs-lookup"><span data-stu-id="97cff-137">Specify the URL where the Service Bus queue is deployed.</span></span> <span data-ttu-id="97cff-138">URL 通常會使用下列格式：</span><span class="sxs-lookup"><span data-stu-id="97cff-138">Typically the URL is in the following format:</span></span><br /><br /> `sb://<namespace>.servicebus.windows.net/<queue_name>`                                                                                                                                                                                                                                                               |
   |       <span data-ttu-id="97cff-139">**開啟逾時**</span><span class="sxs-lookup"><span data-stu-id="97cff-139">**Open Timeout**</span></span>        |                                                                                                                                                                                                                                                                                 <span data-ttu-id="97cff-140">指定時間值，表示可供完成通道開啟作業的時間。</span><span class="sxs-lookup"><span data-stu-id="97cff-140">Specifies a time span value that indicates the time for a channel open operation to complete.</span></span><br /><br /> <span data-ttu-id="97cff-141">**預設值：** 1 分鐘</span><span class="sxs-lookup"><span data-stu-id="97cff-141">**Default value:** 1 minute</span></span>                                                                                                                                                                                                                                                                                 |
   |       <span data-ttu-id="97cff-142">**關閉逾時**</span><span class="sxs-lookup"><span data-stu-id="97cff-142">**Close Timeout**</span></span>       |                                                                                                                                                                                                                                                                                <span data-ttu-id="97cff-143">指定時間值，表示可供完成通道關閉作業的時間。</span><span class="sxs-lookup"><span data-stu-id="97cff-143">Specifies a time span value that indicates the time for a channel close operation to complete.</span></span><br /><br /> <span data-ttu-id="97cff-144">**預設值：** 1 分鐘</span><span class="sxs-lookup"><span data-stu-id="97cff-144">**Default value:** 1 minute</span></span>                                                                                                                                                                                                                                                                                 |
   |      <span data-ttu-id="97cff-145">**接收逾時**</span><span class="sxs-lookup"><span data-stu-id="97cff-145">**Receive timeout**</span></span>      |                                                                                                                                                                                                                                                                                  <span data-ttu-id="97cff-146">指定時間值，表示可供完成接收作業的時間。</span><span class="sxs-lookup"><span data-stu-id="97cff-146">Specifies a time span value that indicates the time for a receive operation to complete.</span></span><br /><br /> <span data-ttu-id="97cff-147">**預設值：** 10 分鐘</span><span class="sxs-lookup"><span data-stu-id="97cff-147">**Default value:** 10 minutes</span></span>                                                                                                                                                                                                                                                                                   |
   |      <span data-ttu-id="97cff-148">**預先擷取計數**</span><span class="sxs-lookup"><span data-stu-id="97cff-148">**Prefetch count**</span></span>       | <span data-ttu-id="97cff-149">指定同時從服務匯流排佇列或主題接收的訊息數目。</span><span class="sxs-lookup"><span data-stu-id="97cff-149">Specifies the number of messages that are received simultaneously from the Service Bus Queue or a topic.</span></span> <span data-ttu-id="97cff-150">預先擷取可讓佇列或訂閱用戶端在執行接收作業時從服務載入其他訊息。</span><span class="sxs-lookup"><span data-stu-id="97cff-150">Prefetching enables the queue or subscription client to load additional messages from the service when it performs a receive operation.</span></span> <span data-ttu-id="97cff-151">用戶端會將這些訊息存放在本機快取中。</span><span class="sxs-lookup"><span data-stu-id="97cff-151">The client stores these messages in a local cache.</span></span> <span data-ttu-id="97cff-152">快取大小是由您在此指定的 [預先擷取計數] 屬性值所決定。</span><span class="sxs-lookup"><span data-stu-id="97cff-152">The size of the cache is determined by the value for the Prefetch Count property you specify here.</span></span><br /><br /> <span data-ttu-id="97cff-153">如需詳細資訊，請參閱一節 「 預先擷取 」 在 [https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements/](https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements/)</span><span class="sxs-lookup"><span data-stu-id="97cff-153">For more information, refer to the section “Prefetching” at [https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements/](https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements/)</span></span><br /><br /> <span data-ttu-id="97cff-154">**預設值：** -1</span><span class="sxs-lookup"><span data-stu-id="97cff-154">**Default value:** -1</span></span> |
   |        <span data-ttu-id="97cff-155">**使用工作階段**</span><span class="sxs-lookup"><span data-stu-id="97cff-155">**Use Session**</span></span>        |                                                                                                                                                                                                                                                                                                <span data-ttu-id="97cff-156">選取此核取方塊以使用服務匯流排工作階段從佇列或訂閱接收訊息。</span><span class="sxs-lookup"><span data-stu-id="97cff-156">Select this check box to use a Service Bus session to receive messages from a queue or a subscription.</span></span>                                                                                                                                                                                                                                                                                                 |


6. <span data-ttu-id="97cff-157">設定**驗證**屬性：</span><span class="sxs-lookup"><span data-stu-id="97cff-157">Configure the **Authentication** properties:</span></span>  


   |                                               <span data-ttu-id="97cff-158">使用</span><span class="sxs-lookup"><span data-stu-id="97cff-158">Use this</span></span>                                                |                                                                                                                                                                                             <span data-ttu-id="97cff-159">以進行此動作</span><span class="sxs-lookup"><span data-stu-id="97cff-159">To do this</span></span>                                                                                                                                                                                             |
   |-------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |                                      <span data-ttu-id="97cff-160">**存取控制服務**</span><span class="sxs-lookup"><span data-stu-id="97cff-160">**Access Control Service**</span></span>                                       | <span data-ttu-id="97cff-161">選取此項目以使用 ACS 進行驗證並提供下列值：</span><span class="sxs-lookup"><span data-stu-id="97cff-161">Select this to use ACS for authentication and provide the following values:</span></span><br /><br /> <span data-ttu-id="97cff-162">輸入服務匯流排存取控制服務 STS URI。</span><span class="sxs-lookup"><span data-stu-id="97cff-162">- Enter the Service Bus Access Control Service STS URI.</span></span> <span data-ttu-id="97cff-163">URI 通常會使用下列格式：</span><span class="sxs-lookup"><span data-stu-id="97cff-163">Typically the URI is in the following format:</span></span><br /><br /> `https://<namespace>-sb.accesscontrol.windows.net/`<br /><br /> <span data-ttu-id="97cff-164">輸入服務匯流排命名空間的簽發者名稱。</span><span class="sxs-lookup"><span data-stu-id="97cff-164">- Enter the issuer name for the Service Bus namespace.</span></span><br /><br /> <span data-ttu-id="97cff-165">輸入服務匯流排命名空間的簽發者金鑰。</span><span class="sxs-lookup"><span data-stu-id="97cff-165">- Enter the issuer key for the Service Bus namespace.</span></span> |
   | <span data-ttu-id="97cff-166">**共用存取簽章**(開始新[!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)])</span><span class="sxs-lookup"><span data-stu-id="97cff-166">**Shared Access Signature** (new starting with [!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)])</span></span> |                                                                                                                                          <span data-ttu-id="97cff-167">選取此項目以使用共用存取簽章 (SAS) 以進行驗證，並提供 SAS 金鑰和金鑰值。</span><span class="sxs-lookup"><span data-stu-id="97cff-167">Select this to use Shared Access Signature (SAS) for authentication, and provide the SAS key name and key value.</span></span>                                                                                                                                          |


7. <span data-ttu-id="97cff-168">在 **屬性**索引標籤中，於**仲介訊息屬性的命名空間**，輸入配接器用來撰寫代理的訊息屬性做為訊息內容屬性的命名空間所收到訊息[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="97cff-168">In the **Properties** tab, in the **Namespace for Brokered Message Properties**, enter the namespace that the adapter uses to write the brokered message properties as message context properties on the message received by [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="97cff-169">如果您想要升級仲介的訊息屬性，請選取**升級仲介訊息屬性**核取方塊。</span><span class="sxs-lookup"><span data-stu-id="97cff-169">If you want to promote the brokered message properties, select the **Promote Brokered Message Properties** check box.</span></span>  

8. <span data-ttu-id="97cff-170">選取 [確定]。</span><span class="sxs-lookup"><span data-stu-id="97cff-170">Select **OK**.</span></span>  

9. <span data-ttu-id="97cff-171">選取您**接收處理常式**，而**接收管線**。</span><span class="sxs-lookup"><span data-stu-id="97cff-171">Select your **Receive handler**, and the **Receive pipeline**.</span></span> <span data-ttu-id="97cff-172">選取 [確定] 儲存您的變更。</span><span class="sxs-lookup"><span data-stu-id="97cff-172">Select **OK** to save your changes.</span></span> <span data-ttu-id="97cff-173">[建立接收位置](../core/how-to-create-a-receive-location.md)提供一些指引。</span><span class="sxs-lookup"><span data-stu-id="97cff-173">[Create a Receive Location](../core/how-to-create-a-receive-location.md) provides some guidance.</span></span>  

## <a name="send-messages-to-service-bus"></a><span data-ttu-id="97cff-174">將訊息傳送至服務匯流排</span><span class="sxs-lookup"><span data-stu-id="97cff-174">Send messages to Service Bus</span></span>

1. <span data-ttu-id="97cff-175">在 BizTalk Server 管理主控台中，以滑鼠右鍵按一下**傳送埠**，選取**新增**，然後選取**靜態單向傳送埠**。</span><span class="sxs-lookup"><span data-stu-id="97cff-175">In the BizTalk Server Administration console, right-click **Send Ports**, select **New**, and select **Static One-way send port**.</span></span>

   <span data-ttu-id="97cff-176">[建立傳送埠](../core/how-to-create-a-send-port2.md)提供一些指引。</span><span class="sxs-lookup"><span data-stu-id="97cff-176">[Create a Send Port](../core/how-to-create-a-send-port2.md) provides some guidance.</span></span>

2. <span data-ttu-id="97cff-177">請輸入**名稱**。</span><span class="sxs-lookup"><span data-stu-id="97cff-177">Enter a **Name**.</span></span> <span data-ttu-id="97cff-178">在**傳輸**，將**型別**來**SB Messaging**，然後選取**設定**。</span><span class="sxs-lookup"><span data-stu-id="97cff-178">In **Transport**, set the **Type** to **SB-Messaging**, and select **Configure**.</span></span> 

3. <span data-ttu-id="97cff-179">設定**一般**屬性：</span><span class="sxs-lookup"><span data-stu-id="97cff-179">Configure the **General** properties:</span></span>  


   |         <span data-ttu-id="97cff-180">使用</span><span class="sxs-lookup"><span data-stu-id="97cff-180">Use this</span></span>         |                                                                                                                                                                                                                                             <span data-ttu-id="97cff-181">以進行此動作</span><span class="sxs-lookup"><span data-stu-id="97cff-181">To do this</span></span>                                                                                                                                                                                                                                              |
   |--------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |   <span data-ttu-id="97cff-182">**目的地 URL**</span><span class="sxs-lookup"><span data-stu-id="97cff-182">**Destination URL**</span></span>    |                                                                                                                                                               <span data-ttu-id="97cff-183">輸入部署的服務匯流排佇列所在的 URL。</span><span class="sxs-lookup"><span data-stu-id="97cff-183">Enter the URL where the Service Bus queue is deployed.</span></span> <span data-ttu-id="97cff-184">URL 通常會使用下列格式：</span><span class="sxs-lookup"><span data-stu-id="97cff-184">Typically the URL is in the following format:</span></span><br /><br /> `sb://<namespace>.servicebus.windows.net/<queue_name>`                                                                                                                                                               |
   | <span data-ttu-id="97cff-185">**批次排清間隔**</span><span class="sxs-lookup"><span data-stu-id="97cff-185">**Batch Flush Interval**</span></span> | <span data-ttu-id="97cff-186">指定時間值，表示將傳送至佇列或主題的訊息批次排清的間隔。</span><span class="sxs-lookup"><span data-stu-id="97cff-186">Specifies a time span value that indicates the interval when the message batches being sent to a Queue or a Topic are flushed.</span></span> <span data-ttu-id="97cff-187">預設值是 20 毫秒。</span><span class="sxs-lookup"><span data-stu-id="97cff-187">The default value is 20 milliseconds.</span></span><br /><br /> <span data-ttu-id="97cff-188">如需有關批次處理相對於服務匯流排佇列和主題的詳細資訊，請參閱**用戶端批次處理**一節[ https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements ](https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements)。</span><span class="sxs-lookup"><span data-stu-id="97cff-188">For more information about batching with respect to Service Bus Queues and Topics, see the **Client-side batching** section at [https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements](https://azure.microsoft.com/documentation/articles/service-bus-performance-improvements).</span></span> |
   |     <span data-ttu-id="97cff-189">**開啟逾時**</span><span class="sxs-lookup"><span data-stu-id="97cff-189">**Open Timeout**</span></span>     |                                                                                                                                                                                <span data-ttu-id="97cff-190">指定時間值，表示可供完成通道開啟作業的時間。</span><span class="sxs-lookup"><span data-stu-id="97cff-190">Specifies a time span value that indicates the time for a channel open operation to complete.</span></span><br /><br /> <span data-ttu-id="97cff-191">**預設值：** 1 分鐘</span><span class="sxs-lookup"><span data-stu-id="97cff-191">**Default value:** 1 minute</span></span>                                                                                                                                                                                |
   |     <span data-ttu-id="97cff-192">**傳送等候逾時**</span><span class="sxs-lookup"><span data-stu-id="97cff-192">**Send Timeout**</span></span>     |                                                                                                                                                                                    <span data-ttu-id="97cff-193">指定時間值，表示可供完成傳送作業的時間。</span><span class="sxs-lookup"><span data-stu-id="97cff-193">Specifies a time span value that indicates the time for a send operation to complete.</span></span><br /><br /> <span data-ttu-id="97cff-194">**預設值：** 1 分鐘</span><span class="sxs-lookup"><span data-stu-id="97cff-194">**Default value:** 1 minute</span></span>                                                                                                                                                                                    |
   |    <span data-ttu-id="97cff-195">**關閉逾時**</span><span class="sxs-lookup"><span data-stu-id="97cff-195">**Close Timeout**</span></span>     |                                                                                                                                                                               <span data-ttu-id="97cff-196">指定時間值，表示可供完成通道關閉作業的時間。</span><span class="sxs-lookup"><span data-stu-id="97cff-196">Specifies a time span value that indicates the time for a channel close operation to complete.</span></span><br /><br /> <span data-ttu-id="97cff-197">**預設值：** 1 分鐘</span><span class="sxs-lookup"><span data-stu-id="97cff-197">**Default value:** 1 minute</span></span>                                                                                                                                                                                |


4. <span data-ttu-id="97cff-198">設定**驗證**屬性：</span><span class="sxs-lookup"><span data-stu-id="97cff-198">Configure the **Authentication** properties:</span></span> 


   |                                               <span data-ttu-id="97cff-199">使用</span><span class="sxs-lookup"><span data-stu-id="97cff-199">Use this</span></span>                                                |                                                                                                                                                                                             <span data-ttu-id="97cff-200">以進行此動作</span><span class="sxs-lookup"><span data-stu-id="97cff-200">To do this</span></span>                                                                                                                                                                                             |
   |-------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
   |                                      <span data-ttu-id="97cff-201">**存取控制服務**</span><span class="sxs-lookup"><span data-stu-id="97cff-201">**Access Control Service**</span></span>                                       | <span data-ttu-id="97cff-202">選取此項目以使用 ACS 進行驗證並提供下列值：</span><span class="sxs-lookup"><span data-stu-id="97cff-202">Select this to use ACS for authentication and provide the following values:</span></span><br /><br /> <span data-ttu-id="97cff-203">輸入服務匯流排存取控制服務 STS URI。</span><span class="sxs-lookup"><span data-stu-id="97cff-203">- Enter the Service Bus Access Control Service STS URI.</span></span> <span data-ttu-id="97cff-204">URI 通常會使用下列格式：</span><span class="sxs-lookup"><span data-stu-id="97cff-204">Typically the URI is in the following format:</span></span><br /><br /> `https://<namespace>-sb.accesscontrol.windows.net/`<br /><br /> <span data-ttu-id="97cff-205">輸入服務匯流排命名空間的簽發者名稱。</span><span class="sxs-lookup"><span data-stu-id="97cff-205">- Enter the issuer name for the Service Bus namespace.</span></span><br /><br /> <span data-ttu-id="97cff-206">輸入服務匯流排命名空間的簽發者金鑰。</span><span class="sxs-lookup"><span data-stu-id="97cff-206">- Enter the issuer key for the Service Bus namespace.</span></span> |
   | <span data-ttu-id="97cff-207">**共用存取簽章**(開始新[!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)])</span><span class="sxs-lookup"><span data-stu-id="97cff-207">**Shared Access Signature** (new starting with [!INCLUDE[bts2013r2_md](../includes/bts2013r2-md.md)])</span></span> |                                                                                                                                          <span data-ttu-id="97cff-208">選取此項目以使用共用存取簽章 (SAS) 以進行驗證，並提供 SAS 金鑰和金鑰值。</span><span class="sxs-lookup"><span data-stu-id="97cff-208">Select this to use Shared Access Signature (SAS) for authentication, and provide the SAS key name and key value.</span></span>                                                                                                                                          |


5. <span data-ttu-id="97cff-209">在 **屬性**索引標籤上，輸入**命名空間，使用者定義的仲介訊息屬性**，其中包含您想要寫入至外寄訊息的 BizTalk 訊息內容屬性服務匯流排。</span><span class="sxs-lookup"><span data-stu-id="97cff-209">In the **Properties** tab, enter the **Namespace for the user defined Brokered Message Properties** that contains the BizTalk message context properties that you want to write on the outgoing message to Service Bus.</span></span> <span data-ttu-id="97cff-210">命名空間的所有屬性會做為使用者定義的仲介訊息屬性都寫入訊息。</span><span class="sxs-lookup"><span data-stu-id="97cff-210">All the namespace properties are written to the message as user-defined Brokered Message properties.</span></span> <span data-ttu-id="97cff-211">配接器將屬性寫入為仲介訊息屬性時，會忽略此命名空間。</span><span class="sxs-lookup"><span data-stu-id="97cff-211">The adapter ignores the namespace while writing the properties as Brokered Message properties.</span></span> <span data-ttu-id="97cff-212">它僅使用命名空間來確定要寫入的屬性。</span><span class="sxs-lookup"><span data-stu-id="97cff-212">It uses the namespace only to ascertain what properties to write.</span></span>  

    <span data-ttu-id="97cff-213">您也可以輸入 BrokeredMessage 屬性的值。</span><span class="sxs-lookup"><span data-stu-id="97cff-213">You can also enter the values for the BrokeredMessage properties.</span></span> <span data-ttu-id="97cff-214">這些屬性會在所述[BrokeredMessage 屬性](https://docs.microsoft.com/dotnet/api/microsoft.servicebus.messaging.brokeredmessage)，包括**分割區索引鍵**。</span><span class="sxs-lookup"><span data-stu-id="97cff-214">These properties are described at [BrokeredMessage Properties](https://docs.microsoft.com/dotnet/api/microsoft.servicebus.messaging.brokeredmessage), including the **Partition Key**.</span></span>

6. <span data-ttu-id="97cff-215">選取 [確定] 儲存您的變更。</span><span class="sxs-lookup"><span data-stu-id="97cff-215">Select **OK** to save your changes.</span></span>  

## <a name="see-also"></a><span data-ttu-id="97cff-216">另請參閱</span><span class="sxs-lookup"><span data-stu-id="97cff-216">See also</span></span>
[<span data-ttu-id="97cff-217">使用配接器</span><span class="sxs-lookup"><span data-stu-id="97cff-217">Using adapters</span></span>](../core/using-adapters.md)