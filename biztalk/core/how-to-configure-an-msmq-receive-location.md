---
title: "如何設定 MSMQ 接收位置 |Microsoft 文件"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- MSMQ adapters, receive locations
- receive locations, MSMQ adapters
- configuring [MSMQ adapters], receive locations
ms.assetid: ba25cf43-18f1-4c19-84fb-74c7b82b95a9
caps.latest.revision: "43"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 795b72318054525485a64c9dd704b81ddf6cb6b9
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/01/2017
---
# <a name="how-to-configure-an-msmq-receive-location"></a><span data-ttu-id="c1890-102">如何設定 MSMQ 接收位置</span><span class="sxs-lookup"><span data-stu-id="c1890-102">How to Configure an MSMQ Receive Location</span></span>
<span data-ttu-id="c1890-103">您可以在 [BizTalk Server 管理] 主控台中設定 MSMQ 接收位置配接器變數。</span><span class="sxs-lookup"><span data-stu-id="c1890-103">You can set MSMQ receive location adapter variables in the BizTalk Server Administration console.</span></span> <span data-ttu-id="c1890-104">若未在接收位置設定屬性，則會使用在 [BizTalk Server 管理] 主控台中設定的預設接收處理常式值。</span><span class="sxs-lookup"><span data-stu-id="c1890-104">If properties are not set in the receive location, the default receive handler values set in the BizTalk Server Administration console are used.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c1890-105">完成下列程序之前，您必須已經新增接收埠。</span><span class="sxs-lookup"><span data-stu-id="c1890-105">Before completing the following procedure you must have already added a receive port.</span></span> <span data-ttu-id="c1890-106">如需詳細資訊，請參閱[如何建立接收埠](../core/how-to-create-a-receive-port.md)。</span><span class="sxs-lookup"><span data-stu-id="c1890-106">For more information see [How to Create a Receive Port](../core/how-to-create-a-receive-port.md).</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="c1890-107">如果主控件執行個體與 MSMQ 傳送埠或接收位置有關聯，請確認 MSMQ 服務是否正在該電腦上執行。</span><span class="sxs-lookup"><span data-stu-id="c1890-107">If a host instance is associated with an MSMQ send port or receive location, verify the MSMQ service is running on that machine.</span></span> <span data-ttu-id="c1890-108">如果服務不在執行中，MSMQ 接收埠會在啟動後不久即關閉，並且傳送至 MSMQ 傳送埠的訊息也將被擱置。</span><span class="sxs-lookup"><span data-stu-id="c1890-108">If the service is not running, the MSMQ receive ports will shut down shortly after they are started, and messages sent to the MSMQ send ports will be suspended.</span></span>  
>   
>  <span data-ttu-id="c1890-109">在叢集化實例中，不但叢集化 MSMQ 執行個體必須正在執行，而且叢集電腦上的本機 MSMQ 服務也應該是在執行。</span><span class="sxs-lookup"><span data-stu-id="c1890-109">In a clustered scenario, not only does the clustered MSMQ instance need to be running, but the local MSMQ service on each cluster machine should be running, as well.</span></span>  
  
## <a name="to-configure-variables-for-an-msmq-receive-location"></a><span data-ttu-id="c1890-110">設定 MSMQ 接收位置的變數</span><span class="sxs-lookup"><span data-stu-id="c1890-110">To configure variables for an MSMQ receive location</span></span>  
 <span data-ttu-id="c1890-111">請依照下列步驟，設定 MSMQ 接收位置的變數：</span><span class="sxs-lookup"><span data-stu-id="c1890-111">Follow these steps to configure variables for an MSMQ receive location:</span></span>  
  
1.  <span data-ttu-id="c1890-112">在 BizTalk Server 管理主控台中，展開  **BizTalk Server 管理**，依序展開**BizTalk 群組**，依序展開**應用程式**，然後展開您想要在其中建立接收位置的應用程式。</span><span class="sxs-lookup"><span data-stu-id="c1890-112">In the BizTalk Server Administration console, expand **BizTalk Server Administration**, expand **BizTalk Group**, expand **Applications**, and then expand the application you want to create a receive location in.</span></span>  
  
2.  <span data-ttu-id="c1890-113">在 BizTalk Server 管理主控台中，在左窗格中，按一下 **接收埠**節點。</span><span class="sxs-lookup"><span data-stu-id="c1890-113">In the BizTalk Server Administration console, in the left pane, click the **Receive Port** node.</span></span> <span data-ttu-id="c1890-114">然後在右窗格中，使用滑鼠右鍵按一下與現有接收位置關聯的接收埠，或是您要與新接收位置關聯的接收埠，然後按一下 **[屬性]**。</span><span class="sxs-lookup"><span data-stu-id="c1890-114">Then in the right pane, right-click the receive port that is associated with an existing receive location or that you want to associate with a new receive location, and then click **Properties**.</span></span>  
  
3.  <span data-ttu-id="c1890-115">在**接收埠屬性**對話方塊的左窗格中，選取**接收位置**，然後在右窗格中，按兩下現有接收位置或按一下**新增**以建立新接收位置。</span><span class="sxs-lookup"><span data-stu-id="c1890-115">In the **Receive Port Properties** dialog box, in the left pane, select **Receive Locations**, and then in the right pane, double-click an existing receive location or click **New**to create a new receive location.</span></span>  
  
4.  <span data-ttu-id="c1890-116">在**接收位置屬性**對話方塊中，於**傳輸**區段旁邊**類型**，選取**MSMQ**從下拉式清單中，然後按一下 **設定**。</span><span class="sxs-lookup"><span data-stu-id="c1890-116">In the **Receive Location Properties** dialog box, in the **Transport** section next to **Type**, select **MSMQ** from the drop-down list, and then click **Configure**.</span></span>  
  
5.  <span data-ttu-id="c1890-117">在**MSMQ 傳輸屬性**對話方塊方塊中，執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="c1890-117">In the **MSMQ Transport Properties** dialog box, do the following:</span></span>  
  
    |<span data-ttu-id="c1890-118">使用</span><span class="sxs-lookup"><span data-stu-id="c1890-118">Use this</span></span>|<span data-ttu-id="c1890-119">動作</span><span class="sxs-lookup"><span data-stu-id="c1890-119">To do this</span></span>|<span data-ttu-id="c1890-120">資料型別</span><span class="sxs-lookup"><span data-stu-id="c1890-120">Date type</span></span>|<span data-ttu-id="c1890-121">預設值</span><span class="sxs-lookup"><span data-stu-id="c1890-121">Default value</span></span>|  
    |--------------|----------------|---------------|-------------------|  
    |<span data-ttu-id="c1890-122">**密碼**</span><span class="sxs-lookup"><span data-stu-id="c1890-122">**Password**</span></span>|<span data-ttu-id="c1890-123">設定要用於遠端佇列的密碼。</span><span class="sxs-lookup"><span data-stu-id="c1890-123">Set a password to use for a remote queue.</span></span>|<span data-ttu-id="c1890-124">字串</span><span class="sxs-lookup"><span data-stu-id="c1890-124">String</span></span>|<span data-ttu-id="c1890-125">空白</span><span class="sxs-lookup"><span data-stu-id="c1890-125">Blank</span></span>|  
    |<span data-ttu-id="c1890-126">**使用者名稱**</span><span class="sxs-lookup"><span data-stu-id="c1890-126">**User Name**</span></span>|<span data-ttu-id="c1890-127">決定要用於存取遠端佇列的使用者名稱與密碼。</span><span class="sxs-lookup"><span data-stu-id="c1890-127">Determine the user name to use, in combination with the password, for access to a remote queue.</span></span> <span data-ttu-id="c1890-128">您不能使用遠端電腦的本機使用者做為使用者名稱。</span><span class="sxs-lookup"><span data-stu-id="c1890-128">You cannot use the local user of the remote computer for the user name.</span></span>|<span data-ttu-id="c1890-129">字串</span><span class="sxs-lookup"><span data-stu-id="c1890-129">String</span></span>|<span data-ttu-id="c1890-130">空白</span><span class="sxs-lookup"><span data-stu-id="c1890-130">Blank</span></span>|  
    |<span data-ttu-id="c1890-131">**批次大小**</span><span class="sxs-lookup"><span data-stu-id="c1890-131">**Batch Size**</span></span>|<span data-ttu-id="c1890-132">設定批次大小。</span><span class="sxs-lookup"><span data-stu-id="c1890-132">Configure the batch size.</span></span> <span data-ttu-id="c1890-133">MSMQ 配接器以批次方式提交訊息到 MessageBox 資料庫。</span><span class="sxs-lookup"><span data-stu-id="c1890-133">The MSMQ adapter submits messages to the MessageBox database in batches.</span></span> <span data-ttu-id="c1890-134">預設批次大小為 20，批次大小下限為 1。</span><span class="sxs-lookup"><span data-stu-id="c1890-134">The default batch size is 20, and the minimum batch size is 1.</span></span> <span data-ttu-id="c1890-135">**注意：**如果**交易式**接收位置的屬性設定為**True**; 每個訊息批次提交至 MessageBox 資料庫的 Microsoft Distributed 身分交易協調器 (MSDTC) 交易。</span><span class="sxs-lookup"><span data-stu-id="c1890-135">**Note:**  If the **Transactional** property for the receive location is set to **True**; each message batch is submitted to the MessageBox database under the context of a Microsoft Distributed Transaction Coordinator (MSDTC) transaction.</span></span> <span data-ttu-id="c1890-136">在批次中的每個訊息都保存至 MessageBox 中，並置於適當的訂閱者佇列之前，為訊息批次建立的 MSDTC 交易仍會處於開啟狀態。</span><span class="sxs-lookup"><span data-stu-id="c1890-136">The MSDTC transaction that is created for a message batch remains open until every message in the batch has been persisted to the MessageBox and placed in the appropriate subscriber queue.</span></span> <span data-ttu-id="c1890-137">因此，此 MSDTC 交易的持續時間會增加為**批次大小**參數會增加。</span><span class="sxs-lookup"><span data-stu-id="c1890-137">Therefore the duration of this MSDTC transaction is increased as the **Batch Size** parameter is increased.</span></span> <span data-ttu-id="c1890-138">同時有大量的 MSDTC 交易開啟對造成負面影響整體效能，因為**批次大小**啟用交易支援時，參數應該設定為非常大的值。</span><span class="sxs-lookup"><span data-stu-id="c1890-138">Since having a large number of MSDTC transactions open simultaneously can negatively impact overall performance, the **Batch Size** parameter should not be set to a very large value when transaction support is enabled.</span></span>|<span data-ttu-id="c1890-139">int</span><span class="sxs-lookup"><span data-stu-id="c1890-139">Int</span></span>|<span data-ttu-id="c1890-140">20</span><span class="sxs-lookup"><span data-stu-id="c1890-140">20</span></span>|  
    |<span data-ttu-id="c1890-141">**失敗**</span><span class="sxs-lookup"><span data-stu-id="c1890-141">**On Failure**</span></span>|<span data-ttu-id="c1890-142">指定配接器如何回應錯誤。</span><span class="sxs-lookup"><span data-stu-id="c1890-142">Specify how the adapter should respond to an error.</span></span> <span data-ttu-id="c1890-143">將這個屬性設為下列其中一個值：</span><span class="sxs-lookup"><span data-stu-id="c1890-143">Set this property to one of the following values:</span></span><br /><br /> <span data-ttu-id="c1890-144">-   **停止。**</span><span class="sxs-lookup"><span data-stu-id="c1890-144">-   **Stop.**</span></span> <span data-ttu-id="c1890-145">若發生錯誤狀況，則透過這個接收位置停止接收訊息。</span><span class="sxs-lookup"><span data-stu-id="c1890-145">Stop receiving messages through this receive location if an error condition occurs.</span></span><br /><span data-ttu-id="c1890-146">-   **Suspend(non-resumable)。**</span><span class="sxs-lookup"><span data-stu-id="c1890-146">-   **Suspend(non-resumable).**</span></span> <span data-ttu-id="c1890-147">擱置訊息並標示為不可繼續。</span><span class="sxs-lookup"><span data-stu-id="c1890-147">Suspend messages and mark as non-resumable.</span></span><br /><span data-ttu-id="c1890-148">-   **Suspend(resumable)。**</span><span class="sxs-lookup"><span data-stu-id="c1890-148">-   **Suspend(resumable).**</span></span> <span data-ttu-id="c1890-149">擱置訊息並標示為可繼續。</span><span class="sxs-lookup"><span data-stu-id="c1890-149">Suspend messages and mark as resumable.</span></span> <span data-ttu-id="c1890-150">**重要事項：**如果**True**選項**排序的處理**屬性，**停止**選項**失敗**屬性，而**False**選項**交易式**屬性會套用在相同的時間，則不會暫止或留在來源佇列無法傳送任何訊息。</span><span class="sxs-lookup"><span data-stu-id="c1890-150">**Important:**  If the **True** option for **Ordered Processing** property, the **Stop** option for the **On Failure** property, and the **False** option for the **Transactional** property are applied at the same time, then any messages that fail delivery will not be suspended or left in the source queue.</span></span> <span data-ttu-id="c1890-151">在此實例中，可能會發生訊息遺失。</span><span class="sxs-lookup"><span data-stu-id="c1890-151">In this scenario, message loss can occur.</span></span> <span data-ttu-id="c1890-152">若要使用時防止資料遺失，**排序的處理**功能，**停止**選項**失敗**屬性應該只會套用，如果**，則為 True**選項**交易式**屬性會套用。</span><span class="sxs-lookup"><span data-stu-id="c1890-152">To prevent data loss, when using the **Ordered Processing** feature, the **Stop** option for the **On Failure** property should only be applied if the **True** option for the **Transactional** property is applied.</span></span> <span data-ttu-id="c1890-153">接著，若發生訊息傳送失敗，原始訊息將會保留在來源 MSMQ 佇列中。</span><span class="sxs-lookup"><span data-stu-id="c1890-153">Then, if a message delivery failure occurs, the original message will be left in the source MSMQ queue.</span></span> <span data-ttu-id="c1890-154">如果**排序的處理**屬性設定的值為**False**則**失敗**屬性將不會生效，且訊息傳遞失敗發生訊息將擱置狀態為**已擱置 （可繼續）**。</span><span class="sxs-lookup"><span data-stu-id="c1890-154">If the **Ordered Processing** property is set to a value of **False** then the **On Failure** property will not take effect and if a message delivery failure occurs the message will be suspended with a status of **Suspended (resumable)**.</span></span>|<span data-ttu-id="c1890-155">字串</span><span class="sxs-lookup"><span data-stu-id="c1890-155">String</span></span>|<span data-ttu-id="c1890-156">擱置 (可繼續)</span><span class="sxs-lookup"><span data-stu-id="c1890-156">Suspend(resumable)</span></span>|  
    |<span data-ttu-id="c1890-157">**排序的處理**</span><span class="sxs-lookup"><span data-stu-id="c1890-157">**Ordered Processing**</span></span>|<span data-ttu-id="c1890-158">將此屬性設定為**True**或**False**。</span><span class="sxs-lookup"><span data-stu-id="c1890-158">Set this property to **True** or **False**.</span></span> <span data-ttu-id="c1890-159">指示是否連續處理訊息。</span><span class="sxs-lookup"><span data-stu-id="c1890-159">This indicates whether to process messages serially.</span></span> <span data-ttu-id="c1890-160">將屬性設定為**True**會容納已排序的訊息傳遞的 BizTalk 傳訊 」 或 「 協調流程傳送埠搭配使用時**排序的傳遞**選項設為**True**。</span><span class="sxs-lookup"><span data-stu-id="c1890-160">Setting the property to **True** will accommodate ordered message delivery when used in conjunction with a BizTalk messaging or orchestration send port that has the **Ordered Delivery** option set to **True**.</span></span> <span data-ttu-id="c1890-161">如需詳細資訊，請參閱[排序訊息傳遞](../core/ordered-delivery-of-messages.md)。</span><span class="sxs-lookup"><span data-stu-id="c1890-161">For more information see [Ordered Delivery of Messages](../core/ordered-delivery-of-messages.md).</span></span><br /><br /> <span data-ttu-id="c1890-162">此屬性設定為**True**藉由將配接器單一執行緒處理大型訊息時，也會最佳化資源使用狀況。</span><span class="sxs-lookup"><span data-stu-id="c1890-162">Setting this property to **True** also optimizes resource usage when handling large messages by making the adapter single-threaded.</span></span> <span data-ttu-id="c1890-163">如需詳細資訊，請參閱[傳送和接收大型訊息使用 MSMQ 配接器](../core/sending-and-receiving-large-messages-using-the-msmq-adapter.md)。</span><span class="sxs-lookup"><span data-stu-id="c1890-163">For more information, see [Sending and Receiving Large Messages Using the MSMQ Adapter](../core/sending-and-receiving-large-messages-using-the-msmq-adapter.md).</span></span>|<span data-ttu-id="c1890-164">布林</span><span class="sxs-lookup"><span data-stu-id="c1890-164">Boolean</span></span>|<span data-ttu-id="c1890-165">False</span><span class="sxs-lookup"><span data-stu-id="c1890-165">False</span></span>|  
    |<span data-ttu-id="c1890-166">**佇列**</span><span class="sxs-lookup"><span data-stu-id="c1890-166">**Queue**</span></span>|<span data-ttu-id="c1890-167">輸入有效的佇列路徑。</span><span class="sxs-lookup"><span data-stu-id="c1890-167">Type a valid queue path.</span></span> <span data-ttu-id="c1890-168">系統將根據您指定的佇列路徑執行適當的驗證。</span><span class="sxs-lookup"><span data-stu-id="c1890-168">Depending on the queue path you specify, the system performs the appropriate validations.</span></span> <span data-ttu-id="c1890-169">**注意：** URI 傳送埠或接收位置不能超過 256 個字元。</span><span class="sxs-lookup"><span data-stu-id="c1890-169">**Note:**  The URI for a send port or receive location cannot exceed 256 characters.</span></span> <span data-ttu-id="c1890-170">**注意：** MSMQ 接收配接器來監視新訊息的指定的 MSMQ 佇列每 0.5 秒鐘使用輪詢機制。</span><span class="sxs-lookup"><span data-stu-id="c1890-170">**Note:**  MSMQ Receive adapter uses a polling mechanism to monitor the specified MSMQ queue for new messages every 0.5 seconds.</span></span> <span data-ttu-id="c1890-171">這個 0.5 秒間隔是固定的間隔。</span><span class="sxs-lookup"><span data-stu-id="c1890-171">This 0.5 second interval is a fixed interval.</span></span>|<span data-ttu-id="c1890-172">字串</span><span class="sxs-lookup"><span data-stu-id="c1890-172">String</span></span>|<span data-ttu-id="c1890-173">空白</span><span class="sxs-lookup"><span data-stu-id="c1890-173">Blank</span></span>|  
    |<span data-ttu-id="c1890-174">**異動**</span><span class="sxs-lookup"><span data-stu-id="c1890-174">**Transactional**</span></span>|<span data-ttu-id="c1890-175">將此屬性設定為**True**或**False**。</span><span class="sxs-lookup"><span data-stu-id="c1890-175">Set this property to **True** or **False**.</span></span> <span data-ttu-id="c1890-176">**注意：**配接器支援與訊息佇列 4.0 或更新版本的遠端佇列的交易式讀取。</span><span class="sxs-lookup"><span data-stu-id="c1890-176">**Note:**  The adapter supports transactional reads of remote queues with Message Queuing 4.0 or later only.</span></span> <span data-ttu-id="c1890-177">在此案例中 BizTalk Server 和遠端的訊息佇列伺服器必須執行訊息佇列 4.0 或更新版本。</span><span class="sxs-lookup"><span data-stu-id="c1890-177">In this scenario both the BizTalk Server and the remote Message Queuing server must be running Message Queuing 4.0 or later.</span></span> <br /><br /> <span data-ttu-id="c1890-178">如需詳細資訊，請參閱[設定 MSMQ 配接器](../core/configuring-the-msmq-adapter.md)和[叢集主控件中執行配接器處理常式的考量](../core/considerations-for-running-adapter-handlers-within-a-clustered-host1.md)。</span><span class="sxs-lookup"><span data-stu-id="c1890-178">For more information, see [Configuring the MSMQ Adapter](../core/configuring-the-msmq-adapter.md) and [Considerations for Running Adapter Handlers within a Clustered Host](../core/considerations-for-running-adapter-handlers-within-a-clustered-host1.md).</span></span>|<span data-ttu-id="c1890-179">布林</span><span class="sxs-lookup"><span data-stu-id="c1890-179">Boolean</span></span>|<span data-ttu-id="c1890-180">False</span><span class="sxs-lookup"><span data-stu-id="c1890-180">False</span></span>|  
  
    > [!NOTE]
    >  <span data-ttu-id="c1890-181">**使用者名**和**密碼**只會套用到用來存取遠端佇列的 Windows 帳戶。</span><span class="sxs-lookup"><span data-stu-id="c1890-181">The **User Name** and **Password** apply only to Windows accounts used to access remote queues.</span></span>  
  
6.  <span data-ttu-id="c1890-182">按一下 **[確定]**。</span><span class="sxs-lookup"><span data-stu-id="c1890-182">Click **OK**.</span></span>  
  
7.  <span data-ttu-id="c1890-183">在**接收位置屬性**對話方塊方塊中，輸入適當的值，以完成接收位置組態，然後按一下**確定**儲存設定。</span><span class="sxs-lookup"><span data-stu-id="c1890-183">In the **Receive Location Properties** dialog box, enter the appropriate values to complete the configuration of the receive location, and click **OK** to save settings.</span></span> <span data-ttu-id="c1890-184">如需有關資訊**接收位置屬性**對話方塊中，請參閱[如何建立接收位置](../core/how-to-create-a-receive-location.md)。</span><span class="sxs-lookup"><span data-stu-id="c1890-184">For information about the **Receive Locations Properties** dialog box, see [How to Create a Receive Location](../core/how-to-create-a-receive-location.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c1890-185">請參閱</span><span class="sxs-lookup"><span data-stu-id="c1890-185">See Also</span></span>  
 [<span data-ttu-id="c1890-186">設定 MSMQ 配接器</span><span class="sxs-lookup"><span data-stu-id="c1890-186">Configuring the MSMQ Adapter</span></span>](../core/configuring-the-msmq-adapter.md)