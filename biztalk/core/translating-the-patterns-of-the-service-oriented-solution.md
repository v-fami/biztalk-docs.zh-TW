---
title: 轉譯模式的服務導向解決方案 |Microsoft 文件
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- patterns [service solutions], translating patterns to orchestration shapes
- artifacts, patterns
- orchestrations, patterns
- patterns [process management solutions], connections
- patterns [service solutions], orchestration boundaries
- patterns [process management solutions], translating patterns to orchestrations
- orchestrations, boundaries
- patterns [service solutions], translating patterns to artifacts
ms.assetid: ff17cc41-2a7b-4304-b5bd-96b1174cea7f
caps.latest.revision: 19
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 95285c93bdb290adbee988305dbcd365e4e729a6
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
ms.locfileid: "22279998"
---
# <a name="translating-the-patterns-of-the-service-oriented-solution"></a><span data-ttu-id="50402-102">轉譯模式的服務導向解決方案</span><span class="sxs-lookup"><span data-stu-id="50402-102">Translating the Patterns of the Service Oriented Solution</span></span>
<span data-ttu-id="50402-103">本節描述解決方案如何將模式圖轉譯為 BizTalk Server 成品。</span><span class="sxs-lookup"><span data-stu-id="50402-103">This section describes how the solution translates the pattern diagram into BizTalk Server artifacts.</span></span>  
  
 <span data-ttu-id="50402-104">![服務 &#45; 導向的解決方案模式](../core/media/service-oriented-solution-patterns.gif "Service_Oriented_Solution_Patterns")</span><span class="sxs-lookup"><span data-stu-id="50402-104">![Service&#45;Oriented Solution Patterns](../core/media/service-oriented-solution-patterns.gif "Service_Oriented_Solution_Patterns")</span></span>  
  
## <a name="connections-and-completeness-conditions"></a><span data-ttu-id="50402-105">連線與完整性條件</span><span class="sxs-lookup"><span data-stu-id="50402-105">Connections and Completeness Conditions</span></span>  
 <span data-ttu-id="50402-106">我們可以在任何地方開始將模式轉譯為 BizTalk Server 元件。</span><span class="sxs-lookup"><span data-stu-id="50402-106">We can pretty much start anywhere with translating the patterns into BizTalk Server components.</span></span> <span data-ttu-id="50402-107">不過實際上，元件之間的連線是元件的基礎結構，如此一來，這似乎是開始的好地方。</span><span class="sxs-lookup"><span data-stu-id="50402-107">However, the connections among the components are, in effect, the infrastructure for the components so that it seems a good place to start.</span></span> <span data-ttu-id="50402-108">此外，在整合者模式的狀況下，我們必須考量要如何分辨它具有所有需要的資訊。</span><span class="sxs-lookup"><span data-stu-id="50402-108">Also, in the case of the aggregator pattern, we need to think about what will tell it that it has all of the information it needs.</span></span> <span data-ttu-id="50402-109">這會影響到它對其他元件的連線，以及它的設計。</span><span class="sxs-lookup"><span data-stu-id="50402-109">This affects both its connections to other components as well as its design.</span></span>  
  
 <span data-ttu-id="50402-110">解決方案必須提供一個方便使用且一致的方法。</span><span class="sxs-lookup"><span data-stu-id="50402-110">The solution needs to provide a convenient and consistent way of being used.</span></span> <span data-ttu-id="50402-111">服務介面會指定其他應用程式如何使用它。</span><span class="sxs-lookup"><span data-stu-id="50402-111">The service interface specifies how other applications can use it.</span></span> <span data-ttu-id="50402-112">因為解決方案必須與使用 IBM WebSphere MQ 的傳統應用程式進行通訊，所以 IBM WebSphere MQ 必須是服務介面的一部分。</span><span class="sxs-lookup"><span data-stu-id="50402-112">Because the solution needs to communicate with a legacy application using IBM WebSphere MQ, IBM WebSphere MQ needs to be part of the service interface.</span></span> <span data-ttu-id="50402-113">不過，對於新的應用程式而言，Web 服務介面似乎是很明確的選擇。</span><span class="sxs-lookup"><span data-stu-id="50402-113">However, for newer applications, a Web service interface seems an obvious choice.</span></span> <span data-ttu-id="50402-114">Web 服務介面會對其他使用服務的應用程式提供最大的彈性。</span><span class="sxs-lookup"><span data-stu-id="50402-114">A Web service interface provides maximum flexibility for other applications using the service.</span></span> <span data-ttu-id="50402-115">在此，我們可以使用 BizTalk Server 的彈性來享有雙重服務介面。</span><span class="sxs-lookup"><span data-stu-id="50402-115">Here, we can use the flexibility of BizTalk Server to have a dual service interface.</span></span> <span data-ttu-id="50402-116">公開為 Web 服務的協調流程的相關資訊，請參閱[如何對應至 Web 服務的協調流程](../core/how-to-map-orchestrations-to-web-services.md)。</span><span class="sxs-lookup"><span data-stu-id="50402-116">For information about exposing orchestrations as Web services, see [How to Map Orchestrations to Web Services](../core/how-to-map-orchestrations-to-web-services.md).</span></span>  
  
 <span data-ttu-id="50402-117">其他連線是服務介面與收件者清單之間的連線、收件者清單與後端應用程式之間的連線，以及在後端應用程式、整合者和服務介面之間的連線。</span><span class="sxs-lookup"><span data-stu-id="50402-117">The other connections are those between the service interface and the recipient list, between the recipient list and the back-end applications, and among the back-end applications, aggregator, and the service interface.</span></span>  
  
 <span data-ttu-id="50402-118">若連接到收件者清單的連線是同步的，解決方案不需要使用相互關聯，以確保已傳送和接收所有傳送到收件者清單的訊息。</span><span class="sxs-lookup"><span data-stu-id="50402-118">If the connection to the recipient list is synchronous, the solution does not need to use correlations to ensure all messages to the recipient list are sent and received.</span></span> <span data-ttu-id="50402-119">基於相同理由，所以後端應用程式和整合者之間的連線可以同步。</span><span class="sxs-lookup"><span data-stu-id="50402-119">The connections between the back-end applications and the aggregator can be synchronous for the same reasons.</span></span> <span data-ttu-id="50402-120">整合者需要來自全部三個後端應用程式的回應，以完成查詢回應。</span><span class="sxs-lookup"><span data-stu-id="50402-120">The aggregator needs the responses from all three of the back-end applications to complete the query response.</span></span> <span data-ttu-id="50402-121">回應時間應該要短一點，這樣同步連線才適用，並可簡化解決方案。</span><span class="sxs-lookup"><span data-stu-id="50402-121">Response times should be short so that synchronous connections are appropriate and simplify the solution.</span></span>  
  
 <span data-ttu-id="50402-122">在整合者模式中，通常會有完整性條件。</span><span class="sxs-lookup"><span data-stu-id="50402-122">In the aggregator pattern, there is usually a completeness condition.</span></span> <span data-ttu-id="50402-123">在有多部後端伺服器且回應時間很慢的狀況下，例如，完整性條件可能在指定的時期內接收至少一個回應。</span><span class="sxs-lookup"><span data-stu-id="50402-123">In cases where there are multiple back-end servers and response times are slow, the completeness condition might be, for example, receiving at least one response in a given time period.</span></span> <span data-ttu-id="50402-124">這個服務導向解決方案需要全部三個回應，才能建構最後的訊息。</span><span class="sxs-lookup"><span data-stu-id="50402-124">This service-oriented solution requires all three responses in order to construct the final message.</span></span> <span data-ttu-id="50402-125">因此，此處的完整性條件就是接收全部三個回應。</span><span class="sxs-lookup"><span data-stu-id="50402-125">Thus, here, the completeness condition is receiving all three responses.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="50402-126">時接收透過 IBM WebSphere MQ 的要求，方案會將相互關聯識別項複製**MQMD_MsgId**值設定為**MQMD_CorrelId**回應訊息。</span><span class="sxs-lookup"><span data-stu-id="50402-126">When receiving requests through IBM WebSphere MQ, the solution adds a correlation identifier by copying the **MQMD_MsgId** value to the **MQMD_CorrelId** of the response message.</span></span> <span data-ttu-id="50402-127">這是在要求-回應中使用 MQSeries 配接器，以避免可能的競爭條件之標準方法的一部分。</span><span class="sxs-lookup"><span data-stu-id="50402-127">This is part of the standard way of using the MQSeries adapter in request-reply to avoid a possible race condition.</span></span> <span data-ttu-id="50402-128">如需詳細資訊，請參閱[相互關聯訊息使用要求-回覆](../core/correlating-messages-using-request-reply.md)。</span><span class="sxs-lookup"><span data-stu-id="50402-128">For more information, see [Correlating Messages Using Request-Reply](../core/correlating-messages-using-request-reply.md).</span></span>  
  
## <a name="determining-orchestration-boundaries"></a><span data-ttu-id="50402-129">判斷協調流程界限</span><span class="sxs-lookup"><span data-stu-id="50402-129">Determining Orchestration Boundaries</span></span>  
 <span data-ttu-id="50402-130">這個解決方案必須允許來自 IBM WebSphere MQ 佇列以及透過 Web 服務介面的要求。</span><span class="sxs-lookup"><span data-stu-id="50402-130">The solution must allow for requests from an IBM WebSphere MQ queue as well as through the Web service interface.</span></span> <span data-ttu-id="50402-131">將服務介面放入一個協調流程中、將 IBM WebSphere MQ 輸入到另一個協調流程中，並將大量處理放入第三個協調流程中，讓外部通訊與處理保持分開的狀態。</span><span class="sxs-lookup"><span data-stu-id="50402-131">Putting the service interface into one orchestration, the IBM WebSphere MQ input into another, and the bulk of the processing into a third keeps the external communication separated from the processing.</span></span>  
  
## <a name="translating-the-components-into-orchestration-shapes"></a><span data-ttu-id="50402-132">將元件轉譯為協調流程圖形</span><span class="sxs-lookup"><span data-stu-id="50402-132">Translating the Components into Orchestration Shapes</span></span>  
 <span data-ttu-id="50402-133">在最後的解決方案中，轉譯為圖形的模式將會在單一協調流程中。</span><span class="sxs-lookup"><span data-stu-id="50402-133">The patterns to translate into shapes will, in the final solution, be in a single orchestration.</span></span> <span data-ttu-id="50402-134">有很多種方式可以在 BizTalk Server 中建立以內容為基礎的路由器，包括建立 MessageBox 訂閱。</span><span class="sxs-lookup"><span data-stu-id="50402-134">There are numerous ways to create a content-based router in BizTalk Server, including creating MessageBox subscriptions.</span></span> <span data-ttu-id="50402-135">在這個解決方案中，路由會使用 MessageBox 訂閱。</span><span class="sxs-lookup"><span data-stu-id="50402-135">In the solution, the routing uses MessageBox subscriptions.</span></span> <span data-ttu-id="50402-136">運算式圖形會評估訊息是否包括所需欄位的值。</span><span class="sxs-lookup"><span data-stu-id="50402-136">An expression shape evaluates whether or not the message includes values for the required fields.</span></span> <span data-ttu-id="50402-137">決策圖形會評估運算式圖形中的變數集，並透過協調流程來選取路徑。</span><span class="sxs-lookup"><span data-stu-id="50402-137">A decision shape evaluates the variable set in the expression shape and selects the path through the orchestration.</span></span>  
  
 <span data-ttu-id="50402-138">**CustomerService**協調流程會使用平行圖形，將訊息傳送至後端應用程式並同步接收回應。</span><span class="sxs-lookup"><span data-stu-id="50402-138">The **CustomerService** orchestration uses the parallel shape to send messages to the backend applications and receive responses simultaneously.</span></span> <span data-ttu-id="50402-139">在提出下一個要求以前，不需要等待某一個應用程式完成。</span><span class="sxs-lookup"><span data-stu-id="50402-139">It does not have to wait on one application finishing before making the next request.</span></span> <span data-ttu-id="50402-140">若應用程式的數目經常變更，或者連接到應用程式的連線並不可靠，那麼協調流程必須以不同的方式來轉譯模式。</span><span class="sxs-lookup"><span data-stu-id="50402-140">If the number of applications were to change frequently, or if the connections to the applications were unreliable, then the orchestration would need to translate the pattern differently.</span></span>  
  
 <span data-ttu-id="50402-141">在這個解決方案中，整合者必須結合來自三個回應訊息的項目。</span><span class="sxs-lookup"><span data-stu-id="50402-141">In the solution the aggregator must combine elements from three response messages.</span></span> <span data-ttu-id="50402-142">使用平行圖形，以確保與後端系統的通訊是平行的。</span><span class="sxs-lookup"><span data-stu-id="50402-142">Using the parallel shape ensures that the communication with the back-end systems is parallel.</span></span> <span data-ttu-id="50402-143">此外，因為圖形在接收所有回應或逾時以前不會終止，整合者一定會知道它可以繼續執行的時機。</span><span class="sxs-lookup"><span data-stu-id="50402-143">And, because the shape does not terminate until it receives all responses or a timeout, the aggregator will always know when it can proceed.</span></span> <span data-ttu-id="50402-144">協調流程會使用一個轉換圖形，該圖形會將來自三個後端回應訊息和原始要求訊息的項目，對應至回應訊息中的項目。</span><span class="sxs-lookup"><span data-stu-id="50402-144">The orchestration uses a transform shape that maps elements from the three backend response messages and the original request message to elements in the response message.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="50402-145">與後端系統的通訊可能也逾時。您可以設定逾時期限封入**接收**成形**範圍**形狀和設定**逾時**範圍的屬性。</span><span class="sxs-lookup"><span data-stu-id="50402-145">The communications with the back-end systems may also time out. You can set the time-out period by enclosing the **Receive** shape in a **Scope** shape and setting the **Timeout** property of the scope.</span></span>  
  
 <span data-ttu-id="50402-146">如需協調流程圖形的完整清單，請參閱[協調流程圖形](../core/orchestration-shapes.md)。</span><span class="sxs-lookup"><span data-stu-id="50402-146">For a complete list of orchestration shapes, see [Orchestration Shapes](../core/orchestration-shapes.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="50402-147">另請參閱</span><span class="sxs-lookup"><span data-stu-id="50402-147">See Also</span></span>  
 <span data-ttu-id="50402-148">[模式在服務導向解決方案](../core/patterns-in-the-service-oriented-solution.md) </span><span class="sxs-lookup"><span data-stu-id="50402-148">[Patterns in the Service Oriented Solution](../core/patterns-in-the-service-oriented-solution.md) </span></span>  
 [<span data-ttu-id="50402-149">元件的服務導向解決方案</span><span class="sxs-lookup"><span data-stu-id="50402-149">Components of the Service Oriented Solution</span></span>](../core/components-of-the-service-oriented-solution.md)