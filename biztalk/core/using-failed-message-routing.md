---
title: "使用失敗訊息路由 |Microsoft 文件"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords: bts10.ops.tsroutingfailure
ms.assetid: d081934c-600e-44ce-8ba4-fb646d494589
caps.latest.revision: "33"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: af6d006aeebd5e2a5f8625a994c8a6f9b0cb6f6a
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
---
# <a name="using-failed-message-routing"></a><span data-ttu-id="a3086-102">使用失敗訊息路由</span><span class="sxs-lookup"><span data-stu-id="a3086-102">Using Failed Message Routing</span></span>
<span data-ttu-id="a3086-103">錯誤處理機制可讓設計師指定自動化的傳訊失敗處理方式，而不是依照傳統行為，將失敗的訊息放在已擱置佇列中 (現在的預設行為)。</span><span class="sxs-lookup"><span data-stu-id="a3086-103">The error-handling facility allows the designer to designate automated handling of messaging failures as an alternative to the traditional (now default) behavior of placing failed messages in the Suspended queue.</span></span> <span data-ttu-id="a3086-104">此自動化處理將錯誤訊息路由至任何訂閱路由的目的地，像是傳送埠或協調流程。</span><span class="sxs-lookup"><span data-stu-id="a3086-104">This automated handling routes an error message to any subscribing routing destination, such as a send port or orchestration.</span></span> <span data-ttu-id="a3086-105">錯誤訊息是原始訊息的複製，含有現在已降級之所有先前升級的屬性，以及已升級為訊息內容之與特定傳訊失敗相關的已選取屬性。</span><span class="sxs-lookup"><span data-stu-id="a3086-105">The error message is a clone of the original message with all previously promoted properties now demoted and with selected properties related to the specific messaging failure promoted to the message context.</span></span>  
  
> [!WARNING]
>  <span data-ttu-id="a3086-106">失敗的訊息包含原始訊息複本。</span><span class="sxs-lookup"><span data-stu-id="a3086-106">Failed messages contain a copy of the original message.</span></span> <span data-ttu-id="a3086-107">若原始訊息包含敏感性資訊，請設計手動和自動化失敗訊息程序，以避免它們意外洩漏。</span><span class="sxs-lookup"><span data-stu-id="a3086-107">If the original message contains sensitive information, design your manual and automatic failed message processes so that they avoid accidental disclosure.</span></span>  
  
## <a name="what-does-failed-message-routing-consist-of"></a><span data-ttu-id="a3086-108">失敗訊息路由包含哪些內容？</span><span class="sxs-lookup"><span data-stu-id="a3086-108">What Does Failed Message Routing Consist Of?</span></span>  
 <span data-ttu-id="a3086-109">啟用失敗訊息路由時，BizTalk Server 不會擱置訊息，而是以路由訊息取代。</span><span class="sxs-lookup"><span data-stu-id="a3086-109">When failed message routing is enabled, BizTalk Server does not suspend the message—it routes the message instead.</span></span> <span data-ttu-id="a3086-110">在接收埠和傳送埠上皆可啟用失敗訊息路由，結果如下：</span><span class="sxs-lookup"><span data-stu-id="a3086-110">Failed message routing can be enabled on both receive and send ports, with the following results:</span></span>  
  
-   <span data-ttu-id="a3086-111">若在接收埠上啟用失敗訊息路由，且訊息在接收管線中或在路由時發生失敗，則會產生失敗的訊息。</span><span class="sxs-lookup"><span data-stu-id="a3086-111">If failed message routing is enabled on a receive port and a message fails in the receive pipeline or in routing, a failed message is generated.</span></span> <span data-ttu-id="a3086-112">當錯誤發生在解譯階段中或解譯階段前，則錯誤訊息為原始交換的複製。</span><span class="sxs-lookup"><span data-stu-id="a3086-112">In the case where an error occurs in or before the disassembly phase, the error message is a clone of the original interchange.</span></span>  
  
-   <span data-ttu-id="a3086-113">若在傳送埠上啟用失敗訊息路由，且訊息在傳送管線中發生失敗，則會產生失敗的訊息。</span><span class="sxs-lookup"><span data-stu-id="a3086-113">If failed message routing is enabled on a send port and the message fails in the send pipeline, a failed message is generated.</span></span>  
  
 <span data-ttu-id="a3086-114">當失敗的訊息產生時，BizTalk Server 會升級錯誤報告相關的訊息內容屬性，並在發佈失敗的訊息之前降級一般訊息內容屬性。</span><span class="sxs-lookup"><span data-stu-id="a3086-114">When a failed message is generated, BizTalk Server promotes error-report-related message context properties and demotes regular message context properties before publishing the failed message.</span></span> <span data-ttu-id="a3086-115">此行為與未啟用失敗訊息路由時的下列預設行為不同：失敗的訊息會擱置。</span><span class="sxs-lookup"><span data-stu-id="a3086-115">Compare this to the default behavior when failed message routing is not enabled: Messages that fail are suspended.</span></span>  
  
## <a name="what-kinds-of-messaging-failures-trigger-an-error-message"></a><span data-ttu-id="a3086-116">哪些傳訊失敗會觸發錯誤訊息？</span><span class="sxs-lookup"><span data-stu-id="a3086-116">What Kinds of Messaging Failures Trigger an Error Message?</span></span>  
 <span data-ttu-id="a3086-117">若啟用失敗訊息路由，則任何發生在配接器處理、管線處理、對應或訊息路由中的失敗，會導致錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="a3086-117">Any failure that occurs in adapter processing, pipeline processing, mapping, or message routing results in an error message if routing for failed messages is enabled.</span></span> <span data-ttu-id="a3086-118">當傳訊錯誤發生在協調流程從接收埠接收或是傳送至傳送埠時，產生的錯誤訊息會與協調流程繫結的傳訊連接埠關聯。</span><span class="sxs-lookup"><span data-stu-id="a3086-118">When a messaging error occurs while an orchestration is receiving from a receive port or sending to a send port, the resulting error message is associated with the messaging ports to which the orchestration is bound.</span></span>  
  
## <a name="subscribing-to-an-error-message"></a><span data-ttu-id="a3086-119">訂閱錯誤訊息</span><span class="sxs-lookup"><span data-stu-id="a3086-119">Subscribing to an Error Message</span></span>  
 <span data-ttu-id="a3086-120">錯誤訊息會傳遞到已訂閱要接收它們的協調流程或傳送埠。</span><span class="sxs-lookup"><span data-stu-id="a3086-120">Error messages are delivered to orchestrations or send ports that have subscribed to receive them.</span></span> <span data-ttu-id="a3086-121">訂閱一般會根據在其中發生傳訊錯誤的連接埠名稱 (傳送埠或接收埠) 來選取錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="a3086-121">A subscription typically selects an error message based on the name of the port in which the messaging error occurred (either a send or a receive port).</span></span> <span data-ttu-id="a3086-122">訂閱也可能篩選其他升級至錯誤訊息內容的屬性 (例如， **[InboundTransportLocation]** 或 **[FailureCode]**)。</span><span class="sxs-lookup"><span data-stu-id="a3086-122">A subscription might also filter on other properties promoted to the error's message context (for example, **InboundTransportLocation** or **FailureCode**).</span></span>  
  
## <a name="error-message-specification"></a><span data-ttu-id="a3086-123">錯誤訊息規格</span><span class="sxs-lookup"><span data-stu-id="a3086-123">Error Message Specification</span></span>  
 <span data-ttu-id="a3086-124">錯誤訊息是原始失敗訊息的複製，含有已降級之所有先前的升級屬性，以及一組已升級為訊息內容的錯誤特定屬性。</span><span class="sxs-lookup"><span data-stu-id="a3086-124">An error message is a clone of the original failed message, with all previously promoted properties demoted and with a set of error-specific properties promoted to the message context.</span></span> <span data-ttu-id="a3086-125">先前升級的屬性已降級，以避免非預期地傳遞給未被指定接收錯誤訊息的訂閱者。</span><span class="sxs-lookup"><span data-stu-id="a3086-125">Previously promoted properties are demoted to avoid unintended delivery to subscribers not designated to receive the error message.</span></span> <span data-ttu-id="a3086-126">錯誤訊息已發佈以供散佈給訂閱者 (協調流程、傳送埠以及傳送埠群組)。</span><span class="sxs-lookup"><span data-stu-id="a3086-126">The error message is published for distribution to subscribers (orchestrations, send ports, and send port groups).</span></span>  
  
 <span data-ttu-id="a3086-127">升級至所有落在錯誤訊息內容屬性**ErrorReport** BizTalk Server 中的命名空間。</span><span class="sxs-lookup"><span data-stu-id="a3086-127">The properties that are promoted to the context of an error message all fall under the **ErrorReport** namespace in BizTalk Server.</span></span> <span data-ttu-id="a3086-128">這些屬性如下所示：</span><span class="sxs-lookup"><span data-stu-id="a3086-128">They are as follows:</span></span>  
  
|<span data-ttu-id="a3086-129">屬性名稱</span><span class="sxs-lookup"><span data-stu-id="a3086-129">Property name</span></span>|<span data-ttu-id="a3086-130">資料類型</span><span class="sxs-lookup"><span data-stu-id="a3086-130">Data type</span></span>|<span data-ttu-id="a3086-131">已升級</span><span class="sxs-lookup"><span data-stu-id="a3086-131">Promoted</span></span>|<span data-ttu-id="a3086-132">描述</span><span class="sxs-lookup"><span data-stu-id="a3086-132">Description</span></span>|  
|-------------------|---------------|--------------|-----------------|  
|<span data-ttu-id="a3086-133">[FailureCode]</span><span class="sxs-lookup"><span data-stu-id="a3086-133">FailureCode</span></span>|<span data-ttu-id="a3086-134">System.String</span><span class="sxs-lookup"><span data-stu-id="a3086-134">System.String</span></span>|<span data-ttu-id="a3086-135">是</span><span class="sxs-lookup"><span data-stu-id="a3086-135">Yes</span></span>|<span data-ttu-id="a3086-136">錯誤碼。</span><span class="sxs-lookup"><span data-stu-id="a3086-136">Error code.</span></span> <span data-ttu-id="a3086-137">報告在 [BizTalk Server 管理] 主控台中的一個十六進位值。</span><span class="sxs-lookup"><span data-stu-id="a3086-137">A hexadecimal value that is reported in the BizTalk Server Administration console.</span></span>|  
|<span data-ttu-id="a3086-138">FailureCategory</span><span class="sxs-lookup"><span data-stu-id="a3086-138">FailureCategory</span></span>|<span data-ttu-id="a3086-139">System.Int32</span><span class="sxs-lookup"><span data-stu-id="a3086-139">System.Int32</span></span>|<span data-ttu-id="a3086-140">是</span><span class="sxs-lookup"><span data-stu-id="a3086-140">Yes</span></span>|<span data-ttu-id="a3086-141">不會使用此屬性。</span><span class="sxs-lookup"><span data-stu-id="a3086-141">This property is not used.</span></span> <span data-ttu-id="a3086-142">未定義其值。</span><span class="sxs-lookup"><span data-stu-id="a3086-142">Its value is undefined.</span></span>|  
|<span data-ttu-id="a3086-143">描述</span><span class="sxs-lookup"><span data-stu-id="a3086-143">Description</span></span>|<span data-ttu-id="a3086-144">System.String</span><span class="sxs-lookup"><span data-stu-id="a3086-144">System.String</span></span>|<span data-ttu-id="a3086-145">否</span><span class="sxs-lookup"><span data-stu-id="a3086-145">No</span></span>|<span data-ttu-id="a3086-146">錯誤描述。</span><span class="sxs-lookup"><span data-stu-id="a3086-146">Error description.</span></span> <span data-ttu-id="a3086-147">與寫入有關此傳訊失敗的應用程式事件記錄檔中之診斷文字相同的診斷文字。</span><span class="sxs-lookup"><span data-stu-id="a3086-147">Same diagnostic text as is written to the Application Event Log regarding this messaging failure.</span></span>|  
|<span data-ttu-id="a3086-148">MessageType</span><span class="sxs-lookup"><span data-stu-id="a3086-148">MessageType</span></span>|<span data-ttu-id="a3086-149">System.String</span><span class="sxs-lookup"><span data-stu-id="a3086-149">System.String</span></span>|<span data-ttu-id="a3086-150">是</span><span class="sxs-lookup"><span data-stu-id="a3086-150">Yes</span></span>|<span data-ttu-id="a3086-151">若訊息類型未確定，則訊息類型為失敗的訊息或空白。</span><span class="sxs-lookup"><span data-stu-id="a3086-151">Message type of failed message, or empty if message type is indeterminate.</span></span><br /><br /> <span data-ttu-id="a3086-152">BizTalk Server 使用訊息類型為訊息與其 XML 結構描述建立關聯。</span><span class="sxs-lookup"><span data-stu-id="a3086-152">BizTalk Server uses the message type to associate messages with their XML schemas.</span></span> <span data-ttu-id="a3086-153">訊息類型是藉由串連結構描述命名空間與結構描述根節點所構成：http://mynamespace#rootnode。</span><span class="sxs-lookup"><span data-stu-id="a3086-153">Message type is formed by concatenating the schema namespace with the schema root node: http://mynamespace#rootnode.</span></span> <span data-ttu-id="a3086-154">**注意：**其訊息類型決定之前失敗，並沒有這個屬性的訊息設定。</span><span class="sxs-lookup"><span data-stu-id="a3086-154">**Note:**  Messages that fail before their message type is determined do not have this property set.</span></span>|  
|<span data-ttu-id="a3086-155">ReceivePortName</span><span class="sxs-lookup"><span data-stu-id="a3086-155">ReceivePortName</span></span>|<span data-ttu-id="a3086-156">System.String</span><span class="sxs-lookup"><span data-stu-id="a3086-156">System.String</span></span>|<span data-ttu-id="a3086-157">**[已升級]** ：若失敗發生在輸入處理期間 (在接收埠)</span><span class="sxs-lookup"><span data-stu-id="a3086-157">**Promoted** if the failure happened during inbound processing (in a receive port)</span></span><br /><br /> <span data-ttu-id="a3086-158">**[未升級]** ：若失敗發生在傳送埠。</span><span class="sxs-lookup"><span data-stu-id="a3086-158">**Not promoted** if the failure happened in a send port.</span></span>|<span data-ttu-id="a3086-159">失敗發生所在的接收埠名稱。</span><span class="sxs-lookup"><span data-stu-id="a3086-159">Name of the receive port where the failure happened.</span></span>|  
|<span data-ttu-id="a3086-160">[InboundTransportLocation]</span><span class="sxs-lookup"><span data-stu-id="a3086-160">InboundTransportLocation</span></span>|<span data-ttu-id="a3086-161">System.String</span><span class="sxs-lookup"><span data-stu-id="a3086-161">System.String</span></span>|<span data-ttu-id="a3086-162">**[已升級]** ：若失敗發生在輸入處理期間 (在接收埠)</span><span class="sxs-lookup"><span data-stu-id="a3086-162">**Promoted** if the failure happened during inbound processing (in a receive port)</span></span><br /><br /> <span data-ttu-id="a3086-163">**[未升級]** ：若失敗發生在傳送埠。</span><span class="sxs-lookup"><span data-stu-id="a3086-163">**Not promoted** if the failure happened in a send port.</span></span>|<span data-ttu-id="a3086-164">失敗發生所在的接收位置 URI。</span><span class="sxs-lookup"><span data-stu-id="a3086-164">URI of the receive location where the failure happened.</span></span>|  
|<span data-ttu-id="a3086-165">SendPortName</span><span class="sxs-lookup"><span data-stu-id="a3086-165">SendPortName</span></span>|<span data-ttu-id="a3086-166">System.String</span><span class="sxs-lookup"><span data-stu-id="a3086-166">System.String</span></span>|<span data-ttu-id="a3086-167">**[已升級]** ：若失敗發生在輸出處理期間 (在傳送埠)</span><span class="sxs-lookup"><span data-stu-id="a3086-167">**Promoted** if the failure happened during outbound processing (in a send port)</span></span><br /><br /> <span data-ttu-id="a3086-168">**[未升級]** ：若失敗發生在接收埠。</span><span class="sxs-lookup"><span data-stu-id="a3086-168">**Not promoted** if the failure happened in a receive port.</span></span>|<span data-ttu-id="a3086-169">失敗發生所在的傳送埠名稱。</span><span class="sxs-lookup"><span data-stu-id="a3086-169">Name of the send port where the failure happened.</span></span>|  
|<span data-ttu-id="a3086-170">OutboundTransportLocation</span><span class="sxs-lookup"><span data-stu-id="a3086-170">OutboundTransportLocation</span></span>|<span data-ttu-id="a3086-171">System.String</span><span class="sxs-lookup"><span data-stu-id="a3086-171">System.String</span></span>|<span data-ttu-id="a3086-172">**[已升級]** ：若失敗發生在輸出處理期間 (在傳送埠)</span><span class="sxs-lookup"><span data-stu-id="a3086-172">**Promoted** if the failure happened during outbound processing (in a send port)</span></span><br /><br /> <span data-ttu-id="a3086-173">**[未升級]** ：若失敗發生在接收埠。</span><span class="sxs-lookup"><span data-stu-id="a3086-173">**Not promoted** if the failure happened in a receive port.</span></span>|<span data-ttu-id="a3086-174">失敗發生所在的傳送位置 URI。</span><span class="sxs-lookup"><span data-stu-id="a3086-174">URI of the send location where the failure happened.</span></span>|  
|<span data-ttu-id="a3086-175">ErrorType</span><span class="sxs-lookup"><span data-stu-id="a3086-175">ErrorType</span></span>|<span data-ttu-id="a3086-176">System.String</span><span class="sxs-lookup"><span data-stu-id="a3086-176">System.String</span></span>|<span data-ttu-id="a3086-177">是</span><span class="sxs-lookup"><span data-stu-id="a3086-177">Yes</span></span>|<span data-ttu-id="a3086-178">指示錯誤包含的訊息類型。</span><span class="sxs-lookup"><span data-stu-id="a3086-178">Indicates the type of message that the error contains.</span></span> <span data-ttu-id="a3086-179">此屬性永遠包含 **FailedMessage**這個值，表示錯誤包含原始失敗訊息。</span><span class="sxs-lookup"><span data-stu-id="a3086-179">This property always contains the value **FailedMessage**, meaning that the error contains the original failed message.</span></span>|  
|<span data-ttu-id="a3086-180">RoutingFailureReportID</span><span class="sxs-lookup"><span data-stu-id="a3086-180">RoutingFailureReportID</span></span>|<span data-ttu-id="a3086-181">System.String</span><span class="sxs-lookup"><span data-stu-id="a3086-181">System.String</span></span>|<span data-ttu-id="a3086-182">是</span><span class="sxs-lookup"><span data-stu-id="a3086-182">Yes</span></span>|<span data-ttu-id="a3086-183">此屬性提供 BizTalk Server 在發生路由失敗時所產生的路由失敗報告識別碼。</span><span class="sxs-lookup"><span data-stu-id="a3086-183">This property provides the ID of the routing failure report that BizTalk Server generates when there is a routing failure.</span></span> <span data-ttu-id="a3086-184">路由失敗報告是 BizTalk Server 產生並擱置的特殊訊息。</span><span class="sxs-lookup"><span data-stu-id="a3086-184">A routing failure report is a special message that BizTalk Server generates and suspends.</span></span> <span data-ttu-id="a3086-185">此訊息沒有內文，但是有失敗訊息的內容。</span><span class="sxs-lookup"><span data-stu-id="a3086-185">This message does not have a body, but it has the context of the failed message.</span></span> <span data-ttu-id="a3086-186">錯誤處理協調流程或傳送埠可以使用此識別碼查詢 MessageBox 資料庫並處理路由失敗報告。</span><span class="sxs-lookup"><span data-stu-id="a3086-186">Using this ID, an error-handling orchestration or a send port can query the MessageBox database and process the routing failure report.</span></span> <span data-ttu-id="a3086-187">例如，協調流程可能需要在取得失敗訊息之後終止路由失敗報告。</span><span class="sxs-lookup"><span data-stu-id="a3086-187">For example, an orchestration may want to terminate the routing failure report after it gets the failed message.</span></span>|  
  
## <a name="handling-error-messages"></a><span data-ttu-id="a3086-188">處理錯誤訊息</span><span class="sxs-lookup"><span data-stu-id="a3086-188">Handling Error Messages</span></span>  
 <span data-ttu-id="a3086-189">錯誤處理是由協調流程或傳送埠訂閱所指定，它們的篩選條件符合已經升級為錯誤訊息之訊息內容的屬性。</span><span class="sxs-lookup"><span data-stu-id="a3086-189">Error handling is specified by an orchestration or send-port subscription whose filter matches the properties that have been promoted to the message context of the error message.</span></span>  
  
## <a name="security-implications"></a><span data-ttu-id="a3086-190">安全性影響</span><span class="sxs-lookup"><span data-stu-id="a3086-190">Security Implications</span></span>  
 <span data-ttu-id="a3086-191">與原始訊息關聯的身分 (由接收管線的解析合作對象階段決定的初始身分或最終身分) 會指派給錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="a3086-191">The identity associated with the original message—either its initial identity or its final identity determined by the Resolve Party stage of the receive pipeline—is assigned to the error message.</span></span>  
  
 <span data-ttu-id="a3086-192">限制訊息傳遞給授權的訂閱連接埠與協調流程之安全性機制，也適用於錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="a3086-192">The security mechanisms that restrict delivery of messages to authorized subscribing ports and orchestrations also apply to error messages.</span></span>  
  
 <span data-ttu-id="a3086-193">訂閱錯誤訊息但未以適當解密憑證設定的傳送埠，不會收到因下列原因而產生的錯誤訊息：在原始訊息進入 BizTalk Server 所透過的接收管線之解密階段或該階段之前發生傳訊失敗。</span><span class="sxs-lookup"><span data-stu-id="a3086-193">A send port that subscribes to an error message, but is not configured with an appropriate decryption certificate, does not receive error messages that result from messaging failures at or before the decrypt stage of the receive pipeline through which the original message entered BizTalk Server.</span></span> <span data-ttu-id="a3086-194">相反的，失敗訊息會放置在已擱置佇列中。</span><span class="sxs-lookup"><span data-stu-id="a3086-194">Instead, the failed messages are placed in the Suspended queue.</span></span>  
  
## <a name="adapter-messaging-failure"></a><span data-ttu-id="a3086-195">配接器傳訊失敗</span><span class="sxs-lookup"><span data-stu-id="a3086-195">Adapter Messaging Failure</span></span>  
 <span data-ttu-id="a3086-196">若配接器擱置訊息，則會發佈錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="a3086-196">If an adapter suspends a message, an error message is published.</span></span> <span data-ttu-id="a3086-197">若訊息未擱置，則不會產生錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="a3086-197">No error message is generated if the message is not suspended.</span></span>  
  
## <a name="transactional-receive-pipelines"></a><span data-ttu-id="a3086-198">交易式接收管線</span><span class="sxs-lookup"><span data-stu-id="a3086-198">Transactional Receive Pipelines</span></span>  
 <span data-ttu-id="a3086-199">若交易式接收管線擲回例外狀況 (指定應中止該交易)，則會中止交易，並發佈錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="a3086-199">If a transactional receive pipeline throws an exception (specifies that the transaction should be aborted), then the transaction is aborted and an error message is published.</span></span>  
  
 <span data-ttu-id="a3086-200">若交易式接收管線明確地擱置訊息 (指定 MessageDestination = SuspendQueue)，則允許目前的交易繼續進行 (且可以將它認可，除非後續階段指定將它中止)，並發佈結果錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="a3086-200">If a transactional receive pipeline explicitly suspends a message (specifies that MessageDestination = SuspendQueue), then the current transaction is allowed to proceed (and may be committed unless subsequent stages specify to abort it) and the resulting error message is published.</span></span>  
  
## <a name="solicit-response-send-ports"></a><span data-ttu-id="a3086-201">請求-回應傳送埠</span><span class="sxs-lookup"><span data-stu-id="a3086-201">Solicit-Response Send Ports</span></span>  
 <span data-ttu-id="a3086-202">當協調流程傳送的要求訊息傳輸失敗或是此要求訊息的回應輸入處理失敗時，不論失敗訊息是否已路由，協調流程都會收到例外狀況。</span><span class="sxs-lookup"><span data-stu-id="a3086-202">When a request message is sent from an orchestration and it fails transmission or its response fails inbound processing, the orchestration gets an exception, regardless of whether the failed message has been routed.</span></span>  
  
 <span data-ttu-id="a3086-203">在請求-回應傳送埠已連接至要求-回應接收埠的情況下，不論失敗訊息是否已路由，接收埠都會收到回應訊息 (若傳送成功) 或是收到 NACK (若傳輸失敗)。</span><span class="sxs-lookup"><span data-stu-id="a3086-203">In the case where a solicit-response send port is connected to a request-response receive port, the receive port gets either a response message (if the transmission succeeds) or a NACK (if the transmission fails), regardless of whether the failed message has been routed.</span></span>  
  
## <a name="one-way-send-ports"></a><span data-ttu-id="a3086-204">單向傳送埠</span><span class="sxs-lookup"><span data-stu-id="a3086-204">One-Way Send Ports</span></span>  
 <span data-ttu-id="a3086-205">當協調流程透過為傳遞通知設定的傳送埠傳送訊息時，不論錯誤訊息是否已路由，協調流程都會收到傳遞通知。</span><span class="sxs-lookup"><span data-stu-id="a3086-205">When a message is sent from an orchestration through a send port configured for delivery notification, then the orchestration receives a delivery notification regardless of whether the error message has been routed.</span></span> <span data-ttu-id="a3086-206">換句話說，即使連接埠在處理期間發生傳訊失敗，傳送埠還是會為協調流程產生傳遞通知。</span><span class="sxs-lookup"><span data-stu-id="a3086-206">In other words, the send port generates a delivery notification for the orchestration even if the port encounters a messaging failure during processing.</span></span> <span data-ttu-id="a3086-207">通知會確認已傳遞至連接埠，但不會指出是否已透過連接埠成功處理。</span><span class="sxs-lookup"><span data-stu-id="a3086-207">The notification confirms delivery to the port, but does not address successful processing through the port.</span></span>  
  
## <a name="resuming-suspended-messages"></a><span data-ttu-id="a3086-208">繼續擱置的訊息</span><span class="sxs-lookup"><span data-stu-id="a3086-208">Resuming Suspended Messages</span></span>  
 <span data-ttu-id="a3086-209">若輸入處理失敗 (也就是說，從接收配接器 (包含) 開始處理直到發佈 (但不包含發佈) 至 MessageBox) 且未處理其失敗的大部分訊息，會擱置為可繼續。</span><span class="sxs-lookup"><span data-stu-id="a3086-209">Most messages that fail inbound processing (that is, processing from and including the receive adapter and up to but not including publication to the message box), and whose failures are not handled, are suspended as resumable.</span></span> <span data-ttu-id="a3086-210">此例外狀況是來自雙向接收埠的要求訊息已擱置為不可繼續。</span><span class="sxs-lookup"><span data-stu-id="a3086-210">The exception is that request messages from two-way receive ports are suspended as nonresumable.</span></span>  
  
 <span data-ttu-id="a3086-211">訊息通常以原始形式 (如同在管線處理之前的形式) 擱置，但有兩個例外狀況：</span><span class="sxs-lookup"><span data-stu-id="a3086-211">Messages are typically suspended in their original form (as they were before pipeline processing), with two exceptions:</span></span>  
  
-   <span data-ttu-id="a3086-212">**由管線元件擱置的訊息。**</span><span class="sxs-lookup"><span data-stu-id="a3086-212">**Messages suspended by pipeline components.**</span></span> <span data-ttu-id="a3086-213">BizTalk Server 會以提供訊息給失敗管線元件時的相同形式來擱置這種類型的訊息。</span><span class="sxs-lookup"><span data-stu-id="a3086-213">BizTalk Server suspends this type of message in the same form as it was provided to the failing pipeline component.</span></span> <span data-ttu-id="a3086-214">繼續訊息時，它會從相同管線的開頭進行管線處理。</span><span class="sxs-lookup"><span data-stu-id="a3086-214">When the message is resumed, it undergoes pipeline processing from the beginning of the same pipeline.</span></span> <span data-ttu-id="a3086-215">這表示在原始失敗發生階段之前的管線階段中之管線元件，必須準備以不同於它在先前處理該訊息之原始形式的形式來處理「相同」訊息。</span><span class="sxs-lookup"><span data-stu-id="a3086-215">This implies that a pipeline component in a pipeline stage that precedes the stage where the original failure occurred must be prepared to handle the "same" message in a form that is different from the original form in which it processed that message.</span></span>  
  
-   <span data-ttu-id="a3086-216">**從 可復原的訊息交換反組譯碼中之後路由失敗。**</span><span class="sxs-lookup"><span data-stu-id="a3086-216">**Messages from recoverable interchange disassembly that subsequently fail routing.**</span></span> <span data-ttu-id="a3086-217">BizTalk Server 會以發佈訊息的相同形式來擱置這種類型的訊息。</span><span class="sxs-lookup"><span data-stu-id="a3086-217">BizTalk Server suspends this type of message in the same form as it was published.</span></span> <span data-ttu-id="a3086-218">這是訊息在管線執行 **之後** 的形式。</span><span class="sxs-lookup"><span data-stu-id="a3086-218">This is the form the message had **after** pipeline execution.</span></span> <span data-ttu-id="a3086-219">繼續訊息時，它會略過管線處理並直接發佈到 MessageBox 資料庫。</span><span class="sxs-lookup"><span data-stu-id="a3086-219">When the message is resumed, it skips pipeline processing and is published directly to the MessageBox database.</span></span>  
  
## <a name="scenarios-leading-to-suspended-non-resumable-messages"></a><span data-ttu-id="a3086-220">產生已擱置 (不可繼續) 訊息的案例</span><span class="sxs-lookup"><span data-stu-id="a3086-220">Scenarios Leading to Suspended (Non-Resumable) Messages</span></span>  
 <span data-ttu-id="a3086-221">雖然訊息比較常擱置為可繼續，但仍有一些會造成不可繼續訊息的案例：</span><span class="sxs-lookup"><span data-stu-id="a3086-221">While it is more common for messages to be suspended as resumable, there are some scenarios that lead to non-resumable messages:</span></span>  
  
-   <span data-ttu-id="a3086-222">在「排序的傳遞」傳送埠已啟用在失敗時繼續的情況下，如果管線、對應或傳輸中有失敗。</span><span class="sxs-lookup"><span data-stu-id="a3086-222">In an Ordered Delivery send port with continue on failure enabled, if there is a failure in the pipeline, mapping or transmission.</span></span>  
  
-   <span data-ttu-id="a3086-223">在「排序的傳遞」接收埠中，如果配接器設為在失敗時不可繼續且擱置訊息。</span><span class="sxs-lookup"><span data-stu-id="a3086-223">In an Ordered Delivery receive port, if the adapter is configured to suspend messages on non-resumable on failure.</span></span> <span data-ttu-id="a3086-224">例如，設定「失敗時」的 MSMQ 配接器設為「擱置 (不可繼續)」或 MQSeries 配接器已啟用「以不可繼續擱置」，失敗的訊息就會擱置為不可繼續。</span><span class="sxs-lookup"><span data-stu-id="a3086-224">For example, if the MSMQ adapter setting "On Failure" is set to "Suspend (non-resumable)" or the MQSeries adapter has "Suspend as Non Resumable" enabled, failed messages will be suspended as non-resumable.</span></span>  
  
-   <span data-ttu-id="a3086-225">在雙向接收埠中，如果回應訊息在管線、對應或傳輸中失敗。</span><span class="sxs-lookup"><span data-stu-id="a3086-225">In a two-way receive port, if the response message fails in the pipeline, mapping, or transmission.</span></span>  
  
-   <span data-ttu-id="a3086-226">在雙向接收埠中，如果接收訊息在管線、對應或傳輸中失敗。</span><span class="sxs-lookup"><span data-stu-id="a3086-226">In a two-way receive port, if the receive message fails in the pipeline, mapping or transmission.</span></span> <span data-ttu-id="a3086-227">個別的配接器行為可能有所不同。</span><span class="sxs-lookup"><span data-stu-id="a3086-227">Individual adapter behavior may be different.</span></span> <span data-ttu-id="a3086-228">例如，依預設值，HTTP 配接器不會擱置訊息，但可經由設定這樣做。</span><span class="sxs-lookup"><span data-stu-id="a3086-228">For example, the HTTP adapter does not suspend messages by default but can be configured to do so.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a3086-229">另請參閱</span><span class="sxs-lookup"><span data-stu-id="a3086-229">See Also</span></span>  
 <span data-ttu-id="a3086-230">[錯誤處理](../core/error-handling.md) </span><span class="sxs-lookup"><span data-stu-id="a3086-230">[Error Handling](../core/error-handling.md) </span></span>  
 <span data-ttu-id="a3086-231">[使用通知](../core/using-acknowledgments.md) </span><span class="sxs-lookup"><span data-stu-id="a3086-231">[Using Acknowledgments](../core/using-acknowledgments.md) </span></span>  
 [<span data-ttu-id="a3086-232">訊息的排序傳遞</span><span class="sxs-lookup"><span data-stu-id="a3086-232">Ordered Delivery of Messages</span></span>](../core/ordered-delivery-of-messages.md)