---
title: 避免瓶頸的指導方針 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 640ab399-b22d-4f71-b41d-ea8d778e064a
caps.latest.revision: 9
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 45071b7990d8fd4a926efa56b9e98cbd633553ac
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "37017806"
---
# <a name="guidelines-for-avoiding-bottlenecks"></a><span data-ttu-id="acf2e-102">避免瓶頸的指導方針</span><span class="sxs-lookup"><span data-stu-id="acf2e-102">Guidelines for Avoiding Bottlenecks</span></span>
<span data-ttu-id="acf2e-103">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 的預設設定會針對許多軟硬體組態提供最佳效能，但有時候修改此設定或部署組態會有助益。</span><span class="sxs-lookup"><span data-stu-id="acf2e-103">While the default settings in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] provide optimal performance for many hardware and software configurations, in some scenarios it may be beneficial to modify the settings or deployment configuration.</span></span> <span data-ttu-id="acf2e-104">在設定 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 時，請考慮下列效能指導方針：</span><span class="sxs-lookup"><span data-stu-id="acf2e-104">When configuring [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)], consider the following performance guidelines:</span></span>  

-   <span data-ttu-id="acf2e-105">為避免資源爭用，請將接收、協調流程和傳送分離至不同的主控件。</span><span class="sxs-lookup"><span data-stu-id="acf2e-105">To prevent resource contention, isolate receiving, orchestration, and sending onto separate hosts.</span></span> <span data-ttu-id="acf2e-106">若要進一步將爭用情形降至最低，請將追蹤服務與其他主控件分離。</span><span class="sxs-lookup"><span data-stu-id="acf2e-106">To further minimize contention, isolate the tracking service from other hosts.</span></span>  

-   <span data-ttu-id="acf2e-107">如果 BizTalk Server 上的 CPU 處理是瓶頸，請加入其他 CPU 或升級為更快速的 CPU，向上擴充 BizTalk Server。</span><span class="sxs-lookup"><span data-stu-id="acf2e-107">If CPU processing on the BizTalk Server is the bottleneck, scale up BizTalk Server by including additional CPUs or upgrading to faster CPUs.</span></span>  

## <a name="sql-server-guidelines"></a><span data-ttu-id="acf2e-108">SQL Server 指導方針</span><span class="sxs-lookup"><span data-stu-id="acf2e-108">SQL Server Guidelines</span></span>  
 <span data-ttu-id="acf2e-109">搭配 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 設定 Microsoft SQL Server 時，請考慮下列效能指導方針：</span><span class="sxs-lookup"><span data-stu-id="acf2e-109">Consider the following performance guidelines when configuring Microsoft SQL Server with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]:</span></span>  

- [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="acf2e-110"> 資料庫應該設定為專用 SQL Server 執行個體上執行的話。</span><span class="sxs-lookup"><span data-stu-id="acf2e-110"> databases should be configured to run on a dedicated SQL Server instance whenever possible.</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="acf2e-111"> 資料庫大量應用程式，因此，明確劃分[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]電腦與裝載的 SQL Server 電腦[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]資料庫將會改善效能，並應視為生產環境中的最佳做法[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]環境。</span><span class="sxs-lookup"><span data-stu-id="acf2e-111"> is a databases intensive application, so separation of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer(s) and the SQL Server computer(s) that house the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases will improve performance and should be considered a best practice in a production [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment.</span></span>  

- <span data-ttu-id="acf2e-112">盡可能搭配 SQL Server 使用快速磁碟子系統。</span><span class="sxs-lookup"><span data-stu-id="acf2e-112">Whenever possible, use a fast disk subsystem with SQL Server.</span></span> <span data-ttu-id="acf2e-113">使用類型 5 的磁碟陣列 (RAID5/10) 或具有備份電源供應的儲存區域網路 (SAN)。</span><span class="sxs-lookup"><span data-stu-id="acf2e-113">Use a redundant array of independent disks type 5 (RAID5/10) or a storage area network (SAN) with backup power supply.</span></span>  

- <span data-ttu-id="acf2e-114">使用 SQL Server 損毀修復程序，定期備份資料庫。</span><span class="sxs-lookup"><span data-stu-id="acf2e-114">Use the SQL Server disaster recovery process to back up your databases regularly.</span></span> <span data-ttu-id="acf2e-115">BizTalk Server 服務會自動從 SQL Server 連線失敗復原。</span><span class="sxs-lookup"><span data-stu-id="acf2e-115">The BizTalk Server service automatically recovers from SQL Server connection malfunctions.</span></span>  

- <span data-ttu-id="acf2e-116">將每個 MessageBox 分離至與 BizTalk 追蹤資料庫 (BizTalkDTADb) 不同的伺服器。</span><span class="sxs-lookup"><span data-stu-id="acf2e-116">Isolate each message box onto a separate server from the BizTalk Tracking database (BizTalkDTADb).</span></span> <span data-ttu-id="acf2e-117">針對較小的部署，如果有可用的 CPU 資源，將 MessageBox 分離至與 BizTalkDTADb 資料庫不同的實體磁碟可能就已足夠。</span><span class="sxs-lookup"><span data-stu-id="acf2e-117">For smaller deployments if CPU resources are available, isolating the message box onto a separate physical disk from the BizTalkDTADb database might be sufficient.</span></span>  

- <span data-ttu-id="acf2e-118">由於 CPU 處理器飽和或因磁碟作業所造成的延遲 (平均磁碟佇列長度)，主要 MessageBox 可能成為瓶頸。</span><span class="sxs-lookup"><span data-stu-id="acf2e-118">The primary MessageBox could be the bottleneck due to CPU processor saturation or latency from disk operations (average disk queue length).</span></span> <span data-ttu-id="acf2e-119">如果 CPU 處理是瓶頸，請將 CPU 處理器加入主要 MessageBox。</span><span class="sxs-lookup"><span data-stu-id="acf2e-119">If CPU processing is the bottleneck, add CPU processors to the primary message box.</span></span> <span data-ttu-id="acf2e-120">否則，請嘗試停用主要 MessageBox 的發佈功能，如此一來，主要 MessageBox 會更有效率地處理傳遞至其他 MessageBox 資料庫的訊息。</span><span class="sxs-lookup"><span data-stu-id="acf2e-120">If not try disabling publishing on the Master MessageBox, this way the Master MessageBox can more efficiently handle routing of messages to the other MessageBox databases.</span></span>  

- <span data-ttu-id="acf2e-121">如果磁碟作業是瓶頸，請將 BizTalkDTADb 資料庫移至專用的 SQL Server 電腦和 (或) 專用磁碟。</span><span class="sxs-lookup"><span data-stu-id="acf2e-121">If disk operations are the bottleneck, move the BizTalkDTADb database to a dedicated SQL Server computer and/or dedicated disk.</span></span> <span data-ttu-id="acf2e-122">如果主要 MessageBox 上的 CPU 處理和磁碟作業都不是瓶頸，您可以在相同的 SQL Server 電腦上建立新的 MessageBox 資料庫，善用現有硬體。</span><span class="sxs-lookup"><span data-stu-id="acf2e-122">If CPU processing and disk operations on the primary message box are not the bottleneck, you can create new MessageBox databases on the same SQL Server computer to leverage your existing hardware.</span></span>  

- <span data-ttu-id="acf2e-123">SQL Server 最佳作法來隔離到個別的實體磁碟上的最大資料庫 MessageBox 和 BizTalkDTADb 資料庫的交易和資料記錄檔。</span><span class="sxs-lookup"><span data-stu-id="acf2e-123">Follow SQL Server best practices to isolate the transaction and data log files for the MessageBox and BizTalkDTADb databases onto separate physical disks.</span></span>  

- <span data-ttu-id="acf2e-124">針對資料和記錄檔案配置足夠的儲存空間，否則 SQL Server 會自動取用保存記錄檔所在磁碟上的所有可用空間。</span><span class="sxs-lookup"><span data-stu-id="acf2e-124">Allocate sufficient storage space for the data and log files; otherwise SQL Server will automatically consume all of the available space on the disks that the log files are kept.</span></span> <span data-ttu-id="acf2e-125">記錄檔的初始大小取決於特定實例的特殊需求。</span><span class="sxs-lookup"><span data-stu-id="acf2e-125">Initial size of the log files will depend on the specific requirements in your particular scenario.</span></span> <span data-ttu-id="acf2e-126">根據測試結果評估部署時的平均檔案大小，在實作解決方案之前擴充儲存空間。</span><span class="sxs-lookup"><span data-stu-id="acf2e-126">Estimate the average file size in your deployment based on testing results, and expand the storage space before implementing your solution.</span></span>  

- <span data-ttu-id="acf2e-127">針對高磁碟使用量的資料庫 (例如 MessageBox、追蹤和「商務活動監控」(BAM) 資料庫) 配置足夠的儲存空間。</span><span class="sxs-lookup"><span data-stu-id="acf2e-127">Allocate sufficient storage space for high-disk-usage databases, such as the MessageBox, Tracking, and Business Activity Monitoring (BAM) databases.</span></span> <span data-ttu-id="acf2e-128">如果您的解決方案使用 BizTalk Framework 傳訊通訊協定，請針對 BizTalk 組態資料庫 (BizTalkMgmtDb) 配置足夠的儲存空間。</span><span class="sxs-lookup"><span data-stu-id="acf2e-128">If your solution uses the BizTalk Framework messaging protocol, allocate sufficient storage space for the BizTalk Configuration database (BizTalkMgmtDb).</span></span>  

- <span data-ttu-id="acf2e-129">根據商務需求 [資料保留期限] 和特定實例中處理的資料量，設定追蹤資料庫的封存/清除工作，以確保 BizTalkDTADb 資料庫不會變得太大。</span><span class="sxs-lookup"><span data-stu-id="acf2e-129">Depending on business needs [data retention periods] and the volume of data processed in your particular scenario, configure the Archive/Purge jobs on the Tracking database such that the BizTalkDTADb database does not grow too large.</span></span> <span data-ttu-id="acf2e-130">此資料庫太大會降低效能 (尤其是在 BizTalkDTADb 資料庫支援多個 MessageBox 時)，因為達到資料庫全部容量時會限制資料插入的速率。</span><span class="sxs-lookup"><span data-stu-id="acf2e-130">The growth of this database can degrade performance (especially when one BizTalkDTADb database supports multiple message boxes) because reaching the full capacity of the database imposes a limit on the rate of data insertion.</span></span>  

- <span data-ttu-id="acf2e-131">如果 MessageBox 和 BizTalkDTADb 資料庫是瓶頸，請向上擴充裝載這些資料庫的伺服器。</span><span class="sxs-lookup"><span data-stu-id="acf2e-131">Scale up the servers hosting the MessageBox and BizTalkDTADb databases if they are the bottleneck.</span></span> <span data-ttu-id="acf2e-132">您可以增加 CPU、增加記憶體、升級為更快速的 CPU，以及使用高速專用磁碟，向上擴充硬體。</span><span class="sxs-lookup"><span data-stu-id="acf2e-132">You can scale up the hardware by adding CPUs, adding memory, upgrading to faster CPUs and using high-speed dedicated disks.</span></span>
