---
title: "EDIFACT CONTRL 訊息做為功能通知 |Microsoft 文件"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 7d3c2be0-0993-4b2d-b6c3-286020117078
caps.latest.revision: "14"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 6e95e61fa4152cdd7485175240b6481f3d28cfc7
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/01/2017
---
# <a name="edifact-contrl-message-as-functional-acknowledgment"></a>EDIFACT CONTRL 訊息做為功能通知
如果您選取要產生功能通知，在商務設定檔的設定或交易夥伴協議 （或後援協議，如果未定義協議是兩個商務設定檔之間），或如果設定為"1"，CONTRL 訊息中的 UNB9 欄位訊息將會產生做為功能通知 (ACK)。 這個通知會報告對交換進行語法檢查的結果。  
  
 CONTRL 功能通知包括下列區段：  
  
-   UNH 訊息標頭 (必要項)  
  
-   UCI 區段，可識別主旨交換並指出狀態交換接收，並包含已接收交換之 UNA、UNB 和 UNZ 區段的參考 (必要項)。 UCI 區段的最多出現次數為 1；因此，它會針對其中控制區段中所遇到的第一個錯誤進行報告。  
  
-   UCF 區段，可識別群組區段 （由 UNG 標頭和 UNE 結尾封裝） 並指出錯誤 （如果存在 UNG 區段必要項） 的本質  
  
-   UCM 區段，可識別訊息區段 (由 UNH 標頭和 UNT 結尾封裝) 並指出錯誤的本質 (必要項)。  
  
-   UCS 區段，可識別交易集並指出錯誤的本質 (必要項)。  
  
-   UCD 區段，可識別錯誤複合或元件資料元素，並指出錯誤的本質 (條件式)。  
  
-   UNT 訊息結尾 (必要項)。  
  
 如果已接收的 CONTRL 功能通知只包含 UNH、UCI 和 UNT 區段，EDIReceive 管線會將通知處理為 CONTRL 回條 (技術) 通知。  
  
 區段在報告層級的每個執行個體 (也就是 UCI、UCF、UCM、UCS 和 UCD 區段) 只能報告一個錯誤。  
  
> [!NOTE]
>  CONTRL 訊息包含數個將從已接收交換複製過來的必要資料元素。 如果交換中的資料元素遺失或語法錯誤，將無法產生語法正確的 CONTRL 訊息。 如此則必須以 CONTRL 訊息以外的其他方式報告錯誤。  
  
> [!NOTE]
>  在 BizTalk Server 中，包含一個或多個 CONTRL 訊息的已接收交換的回應以傳送 CONTRL 訊息 （接收通知、 接受或拒絕）。 在 [!INCLUDE[bts2010R2](../includes/bts2010r2-md.md)] 中，則不會傳送 CONTRL 訊息 (接收通知、接收或拒絕) 回應包含一個或多個 CONTRL 訊息的已接收交換。 所收到 CONTRL 訊息中的錯誤，必須以 CONTRL 訊息以外的其他方式報告。 如果含有資料訊息的交換中包含一或多個 CONTRL 訊息，則為回應該交換而產生 CONTRL 訊息時，會如同已接收交換中不包含任何 CONTRL 訊息般地產生 CONTRL 訊息。  
  
 **SG 迴圈**  
  
 根據已接收交換是否包含一或多個群組而定，CONTRL 功能通知的結構會有所不同。 如果交換包含群組，則通知中每個群組都會包含一個 UCF 區段。 針對每個訊息，每個 UCF 區段都會包含一個 UCM 區段，而每個 UCM 區段又會以串聯方式包含一系列 UCS 和 UCD 區段。  
  
 通知訊息的 XML 格式將包含封裝每個 UCF 區段 SG3Loop 項目、 封裝每個 UCM 元素的 SG4Loop 項目和 SG5Loop 項目會封裝每對 UCS 和 UCD 元素。 訊息的原生 EDI 格式中並不包含 SG 迴圈標記。  
  
 如果交換不含群組，通知就不會包含 UCF 區段， 而是針對每個訊息各包含一個 UCM 區段，而每個 UCM 區段又會以串聯方式包含一系列 UCS 和 UCD 區段。  
  
 通知訊息的 XML 格式包含用於封裝每個 UCM 元素的 SG1Loop 元素，以及用於封裝每對 UCS 和 UCD 元素的 SG2Loop 元素。 與包含群組的交換相同，通知的原生格式中並不包含 SG 標記。  
  
> [!NOTE]
>  依照預設和業界用法，已接受的交易集不應有 SG1/SG4 迴圈。 不過，若要支援符合標準，您可以強制產生 SG1/SG4 選取**接受的交易集產生 SG1/SG4 迴圈**中的核取方塊**通知**頁面協議兩個商務設定檔之間的協議的 [內容] 對話方塊 (或**通知**為商務設定檔之 EDI 設定索引標籤頁面)。 如果選取此核取方塊，則接收管線會在是否已在接受或拒絕交易集產生 SG1/SG4 迴圈。 如果不勾選，則只會針對錯誤交易集產生這些迴圈 (UCM5 != 7)。  
  
 **資料元素**  
  
 CONTRL 功能通知 (ACK) 包括下列資料元素：  
  
|Data 元素|名稱|使用方式|  
|------------------|----------|-----------|  
|UNH1|訊息參考編號|-|  
|UNH2|訊息識別碼子元件|這些子元件包括：<br /><br /> -1 = CONTRL<br /><br /> - 2 = 4<br /><br /> - 3 = 1<br /><br /> -4 = 取消|  
|UCI1|交換控制編號|自所接收訊息的 UNB5 欄位進行對應。|  
|UCI2|交換傳送者|自所接收訊息的 UNB2 欄位進行對應。 第一個子元件 (識別) 為必要項。 第二個子元件 (辨識符號) 和第三個元件 (反向路由位址) 為選擇性項目。|  
|UCI3|交換收件者|自所接收訊息的 UNB3 欄位進行對應。 第一個子元件 (識別) 為必要項。 第二個子元件 (辨識符號) 為選擇性項目。|  
|UCI4|動作代碼|這些動作代碼包括：<br /><br /> -8 如果交換已接受<br /><br /> -7，當交換已接受，但某些交易集將會拒絕<br /><br /> -4，當交換因 UNA 或 UNB 區段錯誤而拒絕<br /><br /> 這是必要的資料元素。|  
|UCI5|語法錯誤代碼|識別接收交換時的錯誤狀況 (如果有的話)。 如需詳細資訊，請參閱[EDIFACT CONTRL 通知錯誤碼](../core/edifact-contrl-acknowledgment-error-codes.md)。<br /><br /> 這個資料元素具有條件式選用性。|  
|UCI6|服務區段標記|識別具有 UCI5 資料元素中已指出之錯誤狀況的區段。<br /><br /> 這個資料元素具有條件式選用性。|  
|UCI7|資料元素識別碼|識別具有 UCI5 資料元素中已指出之錯誤狀況的資料元素。 UCI7 的子元件包括：<br /><br /> -錯誤資料元素區段中的位置 （必要項）<br /><br /> -錯誤元件資料元素區段中的位置 （條件式選用性）<br /><br /> -錯誤資料元素區段 （條件式選用性） 中的項目|  
|UCI8|-|-|  
|UCF1|群組參考編號|自所接收訊息的 UNG5 欄位進行對應。<br /><br /> 這是必要的資料元素。|  
|UCF2|應用程式傳送者識別碼|自所接收訊息的 UNG2 欄位進行對應，包含子元件。<br /><br /> 這是條件式資料元素。|  
|UCF3|應用程式收件者識別碼|自所接收訊息的 UNG3 欄位進行對應，包含子元件。<br /><br /> 這是條件式資料元素。|  
|UCF4|動作代碼|這些動作代碼包括：<br /><br /> -7，當交換已接受<br /><br /> -4，當交換因 UNA 或 UNB 區段錯誤而拒絕<br /><br /> 此代碼適用於此層級與所有更低層級。<br /><br /> 這是必要的資料元素。|  
|UCF5|語法錯誤代碼|識別群組中的錯誤狀況 (如果有的話)。 如需詳細資訊，請參閱[EDIFACT CONTRL 通知錯誤碼](../core/edifact-contrl-acknowledgment-error-codes.md)。<br /><br /> 這個資料元素具有條件式選用性。|  
|UCF6|服務區段標記|識別群組中的錯誤區段。<br /><br /> 這個資料元素具有條件式選用性。|  
|UCF7|資料元素識別碼|識別具有 UCF5 資料元素中指出之錯誤狀況的資料元素。 UCF7 的子元件包括：<br /><br /> -錯誤資料元素區段中的位置 （必要項）<br /><br /> -錯誤元件資料元素區段中的位置 （條件式選用性）<br /><br /> -錯誤資料元素區段 （必要項） 中的項目|  
|UCM1|訊息參考編號|自所接收訊息的 UNH1 欄位進行對應。<br /><br /> 這是必要的資料元素。|  
|UCM2|訊息識別碼|自所接收訊息的 UNH2 欄位進行對應，包含子元素。<br /><br /> 這是條件式資料元素。|  
|UCM3|動作代碼|這些動作代碼包括：<br /><br /> -7，當交換已接受<br /><br /> -4，當交換因 UNA 或 UNB 區段錯誤而拒絕<br /><br /> 此代碼適用於此層級與所有更低層級。<br /><br /> 這是必要的資料元素。|  
|UCM4|語法錯誤代碼|識別群組中的錯誤狀況 (如果有的話)。 如需詳細資訊，請參閱[EDIFACT CONTRL 通知錯誤碼](../core/edifact-contrl-acknowledgment-error-codes.md)。<br /><br /> 這個資料元素具有條件式選用性。|  
|UCM5|服務區段標記|識別錯誤中的 UNH 或 UNT 區段。<br /><br /> 這個資料元素具有條件式選用性。|  
|UCM7|資料元素識別碼|識別具有 UCM5 資料元素中指出之錯誤狀況的資料元素。 UCM7 的子元件包括：<br /><br /> -錯誤資料元素區段中的位置 （必要項）<br /><br /> -錯誤元件資料元素區段中的位置 （條件式選用性）<br /><br /> -錯誤資料元素區段 （必要項） 中的項目|  
|UCS1|訊息內文中的區段位置|錯誤區段中，位置計數為 1 的 UNH 開始。 若要報告區段遺漏，這是為遺失區段應為其中的位置之前所處理的最後一個區段的數值計數位置。 遺失區段群組則表示為遺失群組中的第一個區段。<br /><br /> 這是必要的資料元素。|  
|UCS2|語法錯誤代碼|識別群組中的錯誤狀況 (如果有的話)。 如需詳細資訊，請參閱[EDIFACT CONTRL 通知錯誤碼](../core/edifact-contrl-acknowledgment-error-codes.md)。<br /><br /> 這個資料元素具有條件式選用性。|  
|UCD1|語法錯誤代碼|識別群組中的錯誤狀況 (如果有的話)。 如需詳細資訊，請參閱[EDIFACT CONTRL 通知錯誤碼](../core/edifact-contrl-acknowledgment-error-codes.md)。<br /><br /> 這個資料元素具有條件式選用性。<br /><br /> **注意：**如果 XSD 驗證失敗，就會發生，則 UCD1 資料元素就會報告 code 值為 12，無效的值。|  
|UCD2|資料元素識別碼|識別具有 UCD1 資料元素中指出之錯誤狀況的資料元素。 UCD2 的子元件包括：<br /><br /> -錯誤資料元素區段中的位置 （必要項）<br /><br /> -錯誤元件資料元素區段中的位置 （條件式選用性）<br /><br /> -錯誤資料元素區段 （必要項） 中的項目|  
|UNT1|區段計數|-|  
|UNT2|訊息參考編號|-|