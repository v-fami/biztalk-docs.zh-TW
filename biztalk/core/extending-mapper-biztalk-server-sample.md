---
title: "擴充對應工具 （BizTalk Server 範例） |Microsoft 文件"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- BizTalk Mapper, examples
- XML tools
- BizTalk Mapper, extending
- examples, BizTalk Mapper
- examples, XML tools
ms.assetid: 6010a13f-b715-4766-ad91-5aa9b98589e3
caps.latest.revision: "17"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: f24f7f55e752e25ed06ec68c8eca40d2e7509683
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
---
# <a name="extending-mapper-biztalk-server-sample"></a><span data-ttu-id="66bc6-102">擴充對應工具 （BizTalk Server 範例）</span><span class="sxs-lookup"><span data-stu-id="66bc6-102">Extending Mapper (BizTalk Server Sample)</span></span>
<span data-ttu-id="66bc6-103">「擴充對應工具」範例會示範如何使用和擴充「BizTalk 對應工具」。</span><span class="sxs-lookup"><span data-stu-id="66bc6-103">The Extending Mapper sample demonstrates how to use and extend BizTalk Mapper.</span></span> <span data-ttu-id="66bc6-104">此範例包含數個 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 對應檔案 (.btm)，每個檔案都代表「BizTalk 對應工具」的不同功能。</span><span class="sxs-lookup"><span data-stu-id="66bc6-104">The sample includes several [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] map files (.btm), each of which illustrates different features of BizTalk Mapper.</span></span>  
  
## <a name="what-this-sample-does"></a><span data-ttu-id="66bc6-105">此範例的用途</span><span class="sxs-lookup"><span data-stu-id="66bc6-105">What This Sample Does</span></span>  
 <span data-ttu-id="66bc6-106">「擴充對應工具」範例會使用根據訊息內容決定路由 (CBR)，而且不會使用協調流程。</span><span class="sxs-lookup"><span data-stu-id="66bc6-106">The Extending Mapper sample uses content-based routing (CBR) and does not use an orchestration.</span></span> <span data-ttu-id="66bc6-107">藉由對範例傳送埠指定篩選條件，它會直接連接至範例接收埠。</span><span class="sxs-lookup"><span data-stu-id="66bc6-107">By specifying a filter on the sample send port, it is connected directly to the sample receive port.</span></span> <span data-ttu-id="66bc6-108">此外，還會對傳送埠指定對應，以套用到處理過的文件。</span><span class="sxs-lookup"><span data-stu-id="66bc6-108">A map is specified on the send port to be applied to the processed document.</span></span>  
  
## <a name="where-to-find-this-sample"></a><span data-ttu-id="66bc6-109">可在何處找到此範例</span><span class="sxs-lookup"><span data-stu-id="66bc6-109">Where to Find This Sample</span></span>  
 <span data-ttu-id="66bc6-110">*\<範例路徑 >*\XmlTools\ExtendingMapper</span><span class="sxs-lookup"><span data-stu-id="66bc6-110">*\<Samples Path>*\XmlTools\ExtendingMapper</span></span>  
  
 <span data-ttu-id="66bc6-111">下表顯示此範例中的檔案，並描述其用途。</span><span class="sxs-lookup"><span data-stu-id="66bc6-111">The following table shows the files in this sample and describes their purpose.</span></span>  
  
|<span data-ttu-id="66bc6-112">檔案</span><span class="sxs-lookup"><span data-stu-id="66bc6-112">File(s)</span></span>|<span data-ttu-id="66bc6-113">Description</span><span class="sxs-lookup"><span data-stu-id="66bc6-113">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="66bc6-114">MapperClassLibrary\AssemblyInfo.cs、MapperClassLibrary\MapperClassLibrary.csproj、MapperClassLibrary\MapperHelper.cs、MapperClassLibrary\MapperClassLibrary.sln</span><span class="sxs-lookup"><span data-stu-id="66bc6-114">MapperClassLibrary\AssemblyInfo.cs, MapperClassLibrary\MapperClassLibrary.csproj, MapperClassLibrary\MapperHelper.cs, MapperClassLibrary\MapperClassLibrary.sln</span></span>|<span data-ttu-id="66bc6-115">Microsoft?[!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]® 專案檔和 Visual C#® 原始程式檔。</span><span class="sxs-lookup"><span data-stu-id="66bc6-115">Microsoft® [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]® project file and Visual C#® source files.</span></span>|  
|<span data-ttu-id="66bc6-116">Cleanup.bat</span><span class="sxs-lookup"><span data-stu-id="66bc6-116">Cleanup.bat</span></span>|<span data-ttu-id="66bc6-117">用來解除部署組件，並將這些組件從全域組件快取 (GAC) 移除。</span><span class="sxs-lookup"><span data-stu-id="66bc6-117">Used to undeploy assemblies and remove them from the global assembly cache (GAC).</span></span>|  
|<span data-ttu-id="66bc6-118">Destination.xsd</span><span class="sxs-lookup"><span data-stu-id="66bc6-118">Destination.xsd</span></span>|<span data-ttu-id="66bc6-119">結構描述檔案。</span><span class="sxs-lookup"><span data-stu-id="66bc6-119">Schema file.</span></span>|  
|<span data-ttu-id="66bc6-120">ExtendingMapper.btproj、ExtendingMapper.sln</span><span class="sxs-lookup"><span data-stu-id="66bc6-120">ExtendingMapper.btproj, ExtendingMapper.sln</span></span>|<span data-ttu-id="66bc6-121">此範例的 BizTalk 專案和方案檔。</span><span class="sxs-lookup"><span data-stu-id="66bc6-121">BizTalk project and solution files for this sample.</span></span>|  
|<span data-ttu-id="66bc6-122">ExtendingMapper.xml</span><span class="sxs-lookup"><span data-stu-id="66bc6-122">ExtendingMapper.xml</span></span>|<span data-ttu-id="66bc6-123">來源 XML。</span><span class="sxs-lookup"><span data-stu-id="66bc6-123">Source XML.</span></span>|  
|<span data-ttu-id="66bc6-124">ExtendingMapperBinding.xml</span><span class="sxs-lookup"><span data-stu-id="66bc6-124">ExtendingMapperBinding.xml</span></span>|<span data-ttu-id="66bc6-125">繫結 XML。</span><span class="sxs-lookup"><span data-stu-id="66bc6-125">Binding XML.</span></span>|  
|<span data-ttu-id="66bc6-126">ExternalAssembly.xml</span><span class="sxs-lookup"><span data-stu-id="66bc6-126">ExternalAssembly.xml</span></span>|<span data-ttu-id="66bc6-127">外部組件 XML。</span><span class="sxs-lookup"><span data-stu-id="66bc6-127">External assembly XML.</span></span>|  
|<span data-ttu-id="66bc6-128">OverridingMapXslt.btm</span><span class="sxs-lookup"><span data-stu-id="66bc6-128">OverridingMapXslt.btm</span></span>|<span data-ttu-id="66bc6-129">對應檔案。</span><span class="sxs-lookup"><span data-stu-id="66bc6-129">Map file.</span></span>|  
|<span data-ttu-id="66bc6-130">OverridingMapXslt.xml</span><span class="sxs-lookup"><span data-stu-id="66bc6-130">OverridingMapXslt.xml</span></span>|<span data-ttu-id="66bc6-131">覆寫對應 XML。</span><span class="sxs-lookup"><span data-stu-id="66bc6-131">Overriding Map XML.</span></span>|  
|<span data-ttu-id="66bc6-132">OverridingMapXslt.xslt</span><span class="sxs-lookup"><span data-stu-id="66bc6-132">OverridingMapXslt.xslt</span></span>|<span data-ttu-id="66bc6-133">覆寫對應樣式表。</span><span class="sxs-lookup"><span data-stu-id="66bc6-133">Overriding Map style sheet.</span></span>|  
|<span data-ttu-id="66bc6-134">Scriptor_CallExternalAssembly.btm</span><span class="sxs-lookup"><span data-stu-id="66bc6-134">Scriptor_CallExternalAssembly.btm</span></span>|<span data-ttu-id="66bc6-135">範例對應檔案。</span><span class="sxs-lookup"><span data-stu-id="66bc6-135">Sample map file.</span></span>|  
|<span data-ttu-id="66bc6-136">Scriptor_GlobalVariableInInlineScript.btm</span><span class="sxs-lookup"><span data-stu-id="66bc6-136">Scriptor_GlobalVariableInInlineScript.btm</span></span>|<span data-ttu-id="66bc6-137">範例對應檔案。</span><span class="sxs-lookup"><span data-stu-id="66bc6-137">Sample map file.</span></span>|  
|<span data-ttu-id="66bc6-138">Scriptor_InlineScripts.btm</span><span class="sxs-lookup"><span data-stu-id="66bc6-138">Scriptor_InlineScripts.btm</span></span>|<span data-ttu-id="66bc6-139">範例對應檔案。</span><span class="sxs-lookup"><span data-stu-id="66bc6-139">Sample map file.</span></span>|  
|<span data-ttu-id="66bc6-140">Scriptor_InlineXslt.btm</span><span class="sxs-lookup"><span data-stu-id="66bc6-140">Scriptor_InlineXslt.btm</span></span>|<span data-ttu-id="66bc6-141">範例對應檔案。</span><span class="sxs-lookup"><span data-stu-id="66bc6-141">Sample map file.</span></span>|  
|<span data-ttu-id="66bc6-142">Scriptor_InlineXsltCallingExternalAssembly.btm</span><span class="sxs-lookup"><span data-stu-id="66bc6-142">Scriptor_InlineXsltCallingExternalAssembly.btm</span></span>|<span data-ttu-id="66bc6-143">範例對應檔案。</span><span class="sxs-lookup"><span data-stu-id="66bc6-143">Sample map file.</span></span>|  
|<span data-ttu-id="66bc6-144">Scriptor_XsltCalltemplate.btm</span><span class="sxs-lookup"><span data-stu-id="66bc6-144">Scriptor_XsltCalltemplate.btm</span></span>|<span data-ttu-id="66bc6-145">範例對應檔案。</span><span class="sxs-lookup"><span data-stu-id="66bc6-145">Sample map file.</span></span>|  
|<span data-ttu-id="66bc6-146">Setup.bat</span><span class="sxs-lookup"><span data-stu-id="66bc6-146">Setup.bat</span></span>|<span data-ttu-id="66bc6-147">用來建置和初始化範例。</span><span class="sxs-lookup"><span data-stu-id="66bc6-147">Used to build and initialize the sample.</span></span>|  
|<span data-ttu-id="66bc6-148">Source.xsd</span><span class="sxs-lookup"><span data-stu-id="66bc6-148">Source.xsd</span></span>|<span data-ttu-id="66bc6-149">結構描述檔案。</span><span class="sxs-lookup"><span data-stu-id="66bc6-149">Schema file.</span></span>|  
  
## <a name="building-and-initializing-this-sample"></a><span data-ttu-id="66bc6-150">建置和初始化此範例</span><span class="sxs-lookup"><span data-stu-id="66bc6-150">Building and Initializing This Sample</span></span>  
 <span data-ttu-id="66bc6-151">請使用下列程序，建置和初始化「擴充對應工具」範例。</span><span class="sxs-lookup"><span data-stu-id="66bc6-151">Use the following procedure to build and initialize the Extending Mapper sample.</span></span>  
  
#### <a name="to-build-and-initialize-this-sample"></a><span data-ttu-id="66bc6-152">若要建置並初始化這個範例</span><span class="sxs-lookup"><span data-stu-id="66bc6-152">To build and initialize this sample</span></span>  
  
1.  <span data-ttu-id="66bc6-153">在命令視窗中，將目錄變更 (**cd**) 至下列資料夾：</span><span class="sxs-lookup"><span data-stu-id="66bc6-153">In a command window, change directory (**cd**) to the following folder:</span></span>  
  
     <span data-ttu-id="66bc6-154">*\<範例路徑 >*\XmlTools\ExtendingMapper</span><span class="sxs-lookup"><span data-stu-id="66bc6-154">*\<Samples Path>*\XmlTools\ExtendingMapper</span></span>  
  
2.  <span data-ttu-id="66bc6-155">執行檔案 Setup.bat，這會執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="66bc6-155">Run the file Setup.bat, which performs the following actions:</span></span>  
  
    -   <span data-ttu-id="66bc6-156">建立此範例的輸入 (\In) 和輸出 (\Out) 資料夾。</span><span class="sxs-lookup"><span data-stu-id="66bc6-156">Creates the input (\In) and output (\Out) folders for this sample.</span></span>  
  
    -   <span data-ttu-id="66bc6-157">為這個範例編譯和部署 [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)] 專案。</span><span class="sxs-lookup"><span data-stu-id="66bc6-157">Compiles and deploys the [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)] project for this sample.</span></span>  
  
    -   <span data-ttu-id="66bc6-158">建立並繫結 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 接收位置，以及傳送埠和接收埠。</span><span class="sxs-lookup"><span data-stu-id="66bc6-158">Creates and binds the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] receive location, and the send and receive ports.</span></span>  
  
     <span data-ttu-id="66bc6-159">如果您要使用 Scriptor_CallExternalAssembly.btm 或 Scriptor_InlineXsltCallingExternalAssembly.btm 對應，請在 Visual Studio 中開啟 ExtendingMapper.sln，然後進行下列修改 (否則請移至步驟 3)：</span><span class="sxs-lookup"><span data-stu-id="66bc6-159">If you want to use the Scriptor_CallExternalAssembly.btm or Scriptor_InlineXsltCallingExternalAssembly.btm maps, open ExtendingMapper.sln in Visual Studio and make the following modifications (otherwise go to step 3):</span></span>  
  
    1.  <span data-ttu-id="66bc6-160">在 [方案總管] 中，開啟 Scriptor_CallExternalAssembly.btm。</span><span class="sxs-lookup"><span data-stu-id="66bc6-160">In Solution Explorer, open Scriptor_CallExternalAssembly.btm.</span></span>  
  
    2.  <span data-ttu-id="66bc6-161">在對應工具方格中，選取 [指令碼處理] 運算質。</span><span class="sxs-lookup"><span data-stu-id="66bc6-161">On the mapper grid, select the Scripting functoid.</span></span>  
  
    3.  <span data-ttu-id="66bc6-162">在屬性方格中，選取**指令碼**屬性，然後按一下省略符號 （...） 按鈕來設定運算質指令碼。</span><span class="sxs-lookup"><span data-stu-id="66bc6-162">In the property grid, select the **Script** property, and click the ellipsis (...) button to configure the functoid script.</span></span>  
  
    4.  <span data-ttu-id="66bc6-163">在**設定指令碼處理運算質**對話方塊中，選取**指令碼運算質組態**，並指定下列項目：</span><span class="sxs-lookup"><span data-stu-id="66bc6-163">In the **Configure Scripting Functoid** dialog box, select the **Script Functoid Configuration**, and specify the following:</span></span>  
  
        |<span data-ttu-id="66bc6-164">設定此項</span><span class="sxs-lookup"><span data-stu-id="66bc6-164">Set this</span></span>|<span data-ttu-id="66bc6-165">為此值</span><span class="sxs-lookup"><span data-stu-id="66bc6-165">To this</span></span>|  
        |--------------|-------------|  
        |<span data-ttu-id="66bc6-166">**指令碼類型**</span><span class="sxs-lookup"><span data-stu-id="66bc6-166">**Script Type**</span></span>|<span data-ttu-id="66bc6-167">外部組件</span><span class="sxs-lookup"><span data-stu-id="66bc6-167">External assembly</span></span>|  
        |<span data-ttu-id="66bc6-168">**指令碼組件**</span><span class="sxs-lookup"><span data-stu-id="66bc6-168">**Script Assembly**</span></span>|<span data-ttu-id="66bc6-169">Microsoft.Samples.BizTalk.ExtendingMapper.MapperClassLibrary</span><span class="sxs-lookup"><span data-stu-id="66bc6-169">Microsoft.Samples.BizTalk.ExtendingMapper.MapperClassLibrary</span></span>|  
        |<span data-ttu-id="66bc6-170">**指令碼類別**</span><span class="sxs-lookup"><span data-stu-id="66bc6-170">**Script Class**</span></span>|<span data-ttu-id="66bc6-171">Microsoft.Samples.BizTalk.ExtendingMapper.MapperHelper</span><span class="sxs-lookup"><span data-stu-id="66bc6-171">Microsoft.Samples.BizTalk.ExtendingMapper.MapperHelper</span></span>|  
        |<span data-ttu-id="66bc6-172">**指令碼方法**</span><span class="sxs-lookup"><span data-stu-id="66bc6-172">**Script Method**</span></span>|<span data-ttu-id="66bc6-173">MyConcat</span><span class="sxs-lookup"><span data-stu-id="66bc6-173">MyConcat</span></span>|  
  
    5.  <span data-ttu-id="66bc6-174">從[!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]**檔案**功能表上，選擇**儲存**對應檔案，儲存變更並關閉方案。</span><span class="sxs-lookup"><span data-stu-id="66bc6-174">From the [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]**File** menu, choose **Save** to save changes to the map file, and close the solution.</span></span>  
  
3.  <span data-ttu-id="66bc6-175">按任何鍵繼續執行 Setup.bat。</span><span class="sxs-lookup"><span data-stu-id="66bc6-175">Press any key to continue with Setup.bat.</span></span>  
  
    > [!IMPORTANT]
    >  <span data-ttu-id="66bc6-176">如果您要使用 Scriptor_InlineXsltCallingExternalAssembly.btm，則必須編輯 ExternalAssembly.xml 檔案。</span><span class="sxs-lookup"><span data-stu-id="66bc6-176">If you want to use Scriptor_InlineXsltCallingExternalAssembly.btm, you must edit the ExternalAssembly.xml file.</span></span> <span data-ttu-id="66bc6-177">BizTalk 會使用 ExternalAssembly.xml，將對應工具延伸模組物件註冊命名空間對應至 .NET 組件。</span><span class="sxs-lookup"><span data-stu-id="66bc6-177">ExternalAssembly.xml is used by BizTalk to map a mapper extension object registered namespace to a .NET assembly.</span></span> <span data-ttu-id="66bc6-178">由於參考相依組件時是根據其完整格式名稱 (包括自動產生的公開金鑰 Token)，所以您必須更新此值。</span><span class="sxs-lookup"><span data-stu-id="66bc6-178">Because the dependent assembly is referenced by its fully qualified name (including its public key token, which is automatically generated), you must update this value.</span></span> <span data-ttu-id="66bc6-179">如果您不要使用 Scriptor_InlineXsltCallingExternalAssembly.btm，則不需要完成步驟 a 至 e。</span><span class="sxs-lookup"><span data-stu-id="66bc6-179">If you do not want to use Scriptor_InlineXsltCallingExternalAssembly.btm, you do not need to complete steps a through e.</span></span>  
  
4.  <span data-ttu-id="66bc6-180">在 Windows 檔案總管，瀏覽至\<Windows 資料夾 > \assembly\\。</span><span class="sxs-lookup"><span data-stu-id="66bc6-180">In Windows Explorer, navigate to \<Windows folder>\assembly\\.</span></span>  
  
    1.  <span data-ttu-id="66bc6-181">以滑鼠右鍵按一下**[microsoft.samples.biztalk.extendingmapper.mapperclasslibrary]**選取**屬性**。</span><span class="sxs-lookup"><span data-stu-id="66bc6-181">Right-click **Microsoft.Samples.BizTalk.ExtendingMapper.MapperClassLibrary** and select **Properties**.</span></span>  
  
    2.  <span data-ttu-id="66bc6-182">複製公開金鑰 Token 值。</span><span class="sxs-lookup"><span data-stu-id="66bc6-182">Copy the public key token value.</span></span>  
  
    3.  <span data-ttu-id="66bc6-183">在文字編輯器中，開啟*\<範例路徑 >*\XML Tools\ExtendingMapper\ExternalAssembly.xml。</span><span class="sxs-lookup"><span data-stu-id="66bc6-183">In a text editor, open *\<Samples Path>*\XML Tools\ExtendingMapper\ExternalAssembly.xml.</span></span>  
  
    4.  <span data-ttu-id="66bc6-184">選取**Microsoft.samples.biztalk.extendingmapper.mapperclasslibrary，Version = 1.0.0.0，Culture = neutral，PublicKeyToken = 68496d20c737d84b"**屬性，並取代**PublicKeyToken**值與公開金鑰語彙基元值複製在步驟 c。</span><span class="sxs-lookup"><span data-stu-id="66bc6-184">Select the **AssemblyName="Microsoft.Samples.BizTalk.ExtendingMapper.MapperClassLibrary, Version=1.0.0.0, Culture=neutral, PublicKeyToken=68496d20c737d84b"**attribute, and replace the **PublicKeyToken** value with the public key token value you copied in step c.</span></span>  
  
    5.  <span data-ttu-id="66bc6-185">儲存並關閉 ExternalAssembly.xml。</span><span class="sxs-lookup"><span data-stu-id="66bc6-185">Save and close ExternalAssembly.xml.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="66bc6-186">在嘗試執行此範例之前，您應該確認在建置和初始化程序期間沒有報告錯誤。</span><span class="sxs-lookup"><span data-stu-id="66bc6-186">You should confirm that no errors were reported during the build and initialization process before attempting to run this sample.</span></span>  
  
#### <a name="to-configure-enlist-and-start-the-send-port"></a><span data-ttu-id="66bc6-187">若要設定、登錄和啟動傳送埠</span><span class="sxs-lookup"><span data-stu-id="66bc6-187">To configure, enlist, and start the send port</span></span>  
  
1.  <span data-ttu-id="66bc6-188">按一下**啟動**，選取**所有程式**，選取**Microsoft BizTalk Server**，然後選取**BizTalk Server 管理**。</span><span class="sxs-lookup"><span data-stu-id="66bc6-188">Click **Start**, select **All Programs**, select **Microsoft BizTalk Server**, and then select **BizTalk Server Administration**.</span></span>  
  
2.  <span data-ttu-id="66bc6-189">在 BizTalk Server 管理主控台中，按一下以展開**BizTalk Server 管理**，按一下以展開**BizTalk 群組 [\<伺服器名稱 >:\<管理資料庫 >]**，然後按一下以展開**應用程式**。</span><span class="sxs-lookup"><span data-stu-id="66bc6-189">In the BizTalk Server Administration console, click to expand **BizTalk Server Administration**, click to expand **BizTalk Group [\<servername>:\<management database>]**, and click to expand **Applications**.</span></span>  
  
3.  <span data-ttu-id="66bc6-190">按一下以展開**ExtendingMapperApplication**，然後按一下 **傳送埠**。</span><span class="sxs-lookup"><span data-stu-id="66bc6-190">Click to expand **ExtendingMapperApplication**, and then click **Send Ports**.</span></span>  
  
4.  <span data-ttu-id="66bc6-191">在右窗格中，以滑鼠右鍵按一下**傳送埠**，然後按一下 **屬性**。</span><span class="sxs-lookup"><span data-stu-id="66bc6-191">In the right pane, right-click **Send Ports**, and then click **Properties**.</span></span>  
  
5.  <span data-ttu-id="66bc6-192">在**extendingmappersp – 傳送埠屬性**對話方塊中，按一下 **輸出對應**頁面。</span><span class="sxs-lookup"><span data-stu-id="66bc6-192">In the **ExtendingMapperSP – Send Port Properties** dialog box, click the **Outbound Maps** page.</span></span>  
  
     <span data-ttu-id="66bc6-193">在**對應**資料行中，從下拉式清單中，選取所需的對應，然後按一下 **確定**。</span><span class="sxs-lookup"><span data-stu-id="66bc6-193">In the **Map** column, select the required map from the drop-down list, and then click **OK**.</span></span> <span data-ttu-id="66bc6-194">對應是下表中所述。</span><span class="sxs-lookup"><span data-stu-id="66bc6-194">The maps are described in the following table.</span></span>  
  
    |<span data-ttu-id="66bc6-195">要套用的對應屬性</span><span class="sxs-lookup"><span data-stu-id="66bc6-195">Map to apply Property</span></span>|<span data-ttu-id="66bc6-196">Description</span><span class="sxs-lookup"><span data-stu-id="66bc6-196">Description</span></span>|  
    |---------------------------|-----------------|  
    |<span data-ttu-id="66bc6-197">Microsoft.Samples.BizTalk.ExtendingMapper.</span><span class="sxs-lookup"><span data-stu-id="66bc6-197">Microsoft.Samples.BizTalk.ExtendingMapper.</span></span> <span data-ttu-id="66bc6-198">Scriptor_CallExternalAssembly</span><span class="sxs-lookup"><span data-stu-id="66bc6-198">Scriptor_CallExternalAssembly</span></span>|<span data-ttu-id="66bc6-199">示範如何呼叫外部.NET 組件中的函式**指令碼處理**運算質在對應中，根據這個運算質的輸入參數。</span><span class="sxs-lookup"><span data-stu-id="66bc6-199">Demonstrates how to call into a function in an external .NET assembly from a **Scripting** functoid in a map, based on the input parameters to this functoid.</span></span> <span data-ttu-id="66bc6-200">這有助於將任何處理邏輯與對應檔案清楚劃分開來。</span><span class="sxs-lookup"><span data-stu-id="66bc6-200">This helps cleanly separate any processing logic from the map file.</span></span> <span data-ttu-id="66bc6-201">此對應檔案會使用本範例隨附的 MapperClassLibrary.dll 組件。</span><span class="sxs-lookup"><span data-stu-id="66bc6-201">This map file uses the assembly MapperClassLibrary.dll that ships with this sample.</span></span>|  
    |<span data-ttu-id="66bc6-202">Microsoft.Samples.BizTalk.ExtendingMapper.</span><span class="sxs-lookup"><span data-stu-id="66bc6-202">Microsoft.Samples.BizTalk.ExtendingMapper.</span></span> <span data-ttu-id="66bc6-203">Scriptor_InlineScripts</span><span class="sxs-lookup"><span data-stu-id="66bc6-203">Scriptor_InlineScripts</span></span>|<span data-ttu-id="66bc6-204">示範如何撰寫簡單的內嵌指令碼內**指令碼處理**使用.NET 語言，例如 C#、 Visual basic.net 和 JScript.NET 在對應檔中的運算質。</span><span class="sxs-lookup"><span data-stu-id="66bc6-204">Demonstrates how to write simple inline scripts inside **Scripting** functoids in a map file using .NET languages such as C#, Visual Basic.NET, and JScript.NET.</span></span>|  
    |<span data-ttu-id="66bc6-205">Microsoft.Samples.BizTalk.ExtendingMapper.</span><span class="sxs-lookup"><span data-stu-id="66bc6-205">Microsoft.Samples.BizTalk.ExtendingMapper.</span></span> <span data-ttu-id="66bc6-206">Scriptor_GlobalVariableInInlineScript</span><span class="sxs-lookup"><span data-stu-id="66bc6-206">Scriptor_GlobalVariableInInlineScript</span></span>|<span data-ttu-id="66bc6-207">示範如何內嵌指令碼中使用全域變數**指令碼處理**運算質。</span><span class="sxs-lookup"><span data-stu-id="66bc6-207">Demonstrates how to use global variables in the inline scripts of **Scripting** functoids.</span></span> <span data-ttu-id="66bc6-208">全域變數通常用來維護跨不同的對應檔中的狀態資訊**指令碼處理**運算質。</span><span class="sxs-lookup"><span data-stu-id="66bc6-208">Global variables are usually used to maintain state information in a map file across different **Scripting** functoids.</span></span>|  
    |<span data-ttu-id="66bc6-209">Microsoft.Samples.BizTalk.ExtendingMapper.</span><span class="sxs-lookup"><span data-stu-id="66bc6-209">Microsoft.Samples.BizTalk.ExtendingMapper.</span></span> <span data-ttu-id="66bc6-210">Scriptor_InlineXslt</span><span class="sxs-lookup"><span data-stu-id="66bc6-210">Scriptor_InlineXslt</span></span>|<span data-ttu-id="66bc6-211">示範如何建構中使用原始內嵌 XSLT 的目的文件結構內**指令碼處理**對應中的運算質。</span><span class="sxs-lookup"><span data-stu-id="66bc6-211">Demonstrates how to construct structure in the destination document using raw inline XSLT inside a **Scripting** functoid in the map.</span></span> <span data-ttu-id="66bc6-212">您可以建構目的文件使用的某些部分**指令碼處理**包含內嵌 XSLT，當您無法這樣做，在使用其他運算質的 BizTalk 對應工具運算質。</span><span class="sxs-lookup"><span data-stu-id="66bc6-212">You can construct some parts of the destination document using **Scripting** functoids with inline XSLT whenever it is not possible to do that in BizTalk Mapper using other functoids.</span></span>|  
    |<span data-ttu-id="66bc6-213">Microsoft.Samples.BizTalk.ExtendingMapper.</span><span class="sxs-lookup"><span data-stu-id="66bc6-213">Microsoft.Samples.BizTalk.ExtendingMapper.</span></span> <span data-ttu-id="66bc6-214">Scriptor_XsltCalltemplate</span><span class="sxs-lookup"><span data-stu-id="66bc6-214">Scriptor_XsltCalltemplate</span></span>|<span data-ttu-id="66bc6-215">示範如何使用 XSLT 呼叫範本內目的文件中建立結構**指令碼處理**對應中的運算質。</span><span class="sxs-lookup"><span data-stu-id="66bc6-215">Demonstrates how to create structure in the destination document using an XSLT Call template inside a **Scripting** functoid in the map.</span></span> <span data-ttu-id="66bc6-216">「 XSLT 呼叫範本起內嵌 XSLT 是呼叫範本可以接受參數，因此您可以建立結構的優點是根據輸入參數**指令碼處理**運算質。</span><span class="sxs-lookup"><span data-stu-id="66bc6-216">The advantage of an XSLT Call template over inline XSLT is that the call template can accept parameters, so you can create the structure based on input parameters to the **Scripting** functoid.</span></span> <span data-ttu-id="66bc6-217">您可以建構目的文件使用的某些部分**指令碼處理**包含內嵌 XSLT，當您無法這樣做，在使用其他運算質的 BizTalk 對應工具運算質。</span><span class="sxs-lookup"><span data-stu-id="66bc6-217">You can construct some parts of the destination document using **Scripting** functoids with inline XSLT whenever it is not possible to do that in BizTalk Mapper using other functoids.</span></span>|  
    |<span data-ttu-id="66bc6-218">Microsoft.Samples.BizTalk.ExtendingMapper.</span><span class="sxs-lookup"><span data-stu-id="66bc6-218">Microsoft.Samples.BizTalk.ExtendingMapper.</span></span> <span data-ttu-id="66bc6-219">Scriptor_InlineXsltCallingExternalAssembly</span><span class="sxs-lookup"><span data-stu-id="66bc6-219">Scriptor_InlineXsltCallingExternalAssembly</span></span>|<span data-ttu-id="66bc6-220">示範如何呼叫外部.NET 組件從的內嵌 XSLT 的**指令碼處理**運算質在對應中的。</span><span class="sxs-lookup"><span data-stu-id="66bc6-220">Demonstrates how to call into an external .NET assembly from inside The inline XSLT of a **Scripting** functoid in a map.</span></span> <span data-ttu-id="66bc6-221">說明如何您可以覆寫**自訂延伸模組 XML**自訂延伸模組檔案 ExternalAssembly_extxml.xml，其中包含要叫用之外部.NET 組件的詳細資料與 BizTalk 對應工具 」 方格的屬性。</span><span class="sxs-lookup"><span data-stu-id="66bc6-221">Explains how you can override the **Custom Extension XML** property of the BizTalk Mapper grid with the custom extension file ExternalAssembly_extxml.xml that contains the details of the external .NET assembly to invoke.</span></span> <span data-ttu-id="66bc6-222">您可以建構目的文件使用的某些部分**指令碼處理**包含內嵌 XSLT，當您無法這樣做，在使用其他運算質的對應工具 UI 中的運算質。</span><span class="sxs-lookup"><span data-stu-id="66bc6-222">You can construct some parts of the destination document using **Scripting** functoids with inline XSLT whenever it is not possible to do that in the Mapper UI using other functoids.</span></span>|  
    |<span data-ttu-id="66bc6-223">Microsoft.Samples.BizTalk.ExtendingMapper.</span><span class="sxs-lookup"><span data-stu-id="66bc6-223">Microsoft.Samples.BizTalk.ExtendingMapper.</span></span> <span data-ttu-id="66bc6-224">OverridingMapXslt</span><span class="sxs-lookup"><span data-stu-id="66bc6-224">OverridingMapXslt</span></span>|<span data-ttu-id="66bc6-225">示範如何使用自訂 XSLT 檔案完全覆寫「BizTalk 對應工具」檔案的已編譯 XSLT。</span><span class="sxs-lookup"><span data-stu-id="66bc6-225">Demonstrates how to completely override the compiled XSLT of the BizTalk Mapper file with a custom XSLT file.</span></span> <span data-ttu-id="66bc6-226">您可以藉由覆寫**自訂 XSL 路徑**屬性並選擇性地**自訂延伸模組 XML** BizTalk 對應工具 」 方格的屬性。</span><span class="sxs-lookup"><span data-stu-id="66bc6-226">You can do this by overriding the **Custom XSL Path**property and optionally the **Custom Extension XML** property of the BizTalk Mapper grid.</span></span> <span data-ttu-id="66bc6-227">您提供的自訂 XSLT 檔案會包含在執行階段要使用之專案的已編譯 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 組件中。</span><span class="sxs-lookup"><span data-stu-id="66bc6-227">The custom XSLT file that you provide is included in the compiled [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] assembly of the project you want to use at run time.</span></span> <span data-ttu-id="66bc6-228">在這種情況下，對應檔案 (.btm) 的內容會被忽略。</span><span class="sxs-lookup"><span data-stu-id="66bc6-228">In this case, the contents of the map file (.btm) are ignored.</span></span> <span data-ttu-id="66bc6-229">此對應檔案使用 OverridingMapXslt.xslt 和 overridingmapxslt.xml 做為**自訂 XSL 路徑**和**自訂延伸模組 XML**屬性，分別。</span><span class="sxs-lookup"><span data-stu-id="66bc6-229">This map file uses OverridingMapXslt.xslt and OverridingMapXslt.xml for the **Custom XSL Path** and **Custom Extension XML** properties, respectively.</span></span><br /><br /> <span data-ttu-id="66bc6-230">您可以在 [方案總管] 中驗證對應檔案。</span><span class="sxs-lookup"><span data-stu-id="66bc6-230">You can validate a map file in Solution Explorer.</span></span> <span data-ttu-id="66bc6-231">您可以以它做為範本檔案，您可以編輯並為使用**自訂 XSL 路徑**BizTalk 對應工具 」 方格的屬性。</span><span class="sxs-lookup"><span data-stu-id="66bc6-231">You can then use it as a template file that you can edit and use for the **Custom XSL Path** property of the BizTalk Mapper grid.</span></span> <span data-ttu-id="66bc6-232">只要無法使用「BizTalk 對應工具」產生此 XSLT，您便可尋求這種解決方式。</span><span class="sxs-lookup"><span data-stu-id="66bc6-232">You can resort to this option whenever it is not possible to produce this XSLT using BizTalk Mapper.</span></span>|  
  
## <a name="running-this-sample"></a><span data-ttu-id="66bc6-233">執行此範例</span><span class="sxs-lookup"><span data-stu-id="66bc6-233">Running This Sample</span></span>  
 <span data-ttu-id="66bc6-234">請使用下列程序執行「擴充對應工具」範例。</span><span class="sxs-lookup"><span data-stu-id="66bc6-234">Use the following procedure to run the Extending Mapper sample.</span></span>  
  
#### <a name="to-run-this-sample"></a><span data-ttu-id="66bc6-235">執行此範例</span><span class="sxs-lookup"><span data-stu-id="66bc6-235">To run this sample</span></span>  
  
1.  <span data-ttu-id="66bc6-236">輸入檔 extendingmapper.xml 複製到輸入資料夾的複本*\<範例路徑 >*\XmlTools\ExtendingMapper\In。</span><span class="sxs-lookup"><span data-stu-id="66bc6-236">Copy the input file ExtendingMapper.xml into the input folder at *\<Samples Path>*\XmlTools\ExtendingMapper\In.</span></span>  
  
2.  <span data-ttu-id="66bc6-237">請注意檔案轉換和路由傳送至如何*\<範例路徑 >*\XmlTools\ExtendingMapper\Out 資料夾。</span><span class="sxs-lookup"><span data-stu-id="66bc6-237">Notice how the file is transformed and routed to the *\<Samples Path>*\XmlTools\ExtendingMapper\Out folder.</span></span> <span data-ttu-id="66bc6-238">這裡執行的轉換是根據您所套用的對應而來。</span><span class="sxs-lookup"><span data-stu-id="66bc6-238">The transformation that occurs is based on the map you applied.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="66bc6-239">另請參閱</span><span class="sxs-lookup"><span data-stu-id="66bc6-239">See Also</span></span>  
 [<span data-ttu-id="66bc6-240">XML 工具 （BizTalk Server 範例資料夾）</span><span class="sxs-lookup"><span data-stu-id="66bc6-240">XML Tools (BizTalk Server Samples Folder)</span></span>](../core/xml-tools-biztalk-server-samples-folder.md)