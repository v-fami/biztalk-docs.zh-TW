---
title: PartyResolution （BizTalk Server 範例） |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- examples, parties
- orchestrations, examples
- parties, examples
- parties, orchestrations
- examples, routing
- orchestrations, parties
- examples, orchestrations
- examples, messages
- routing, messages
- messages, routing
ms.assetid: 220e6bc5-6f04-4f37-b0d0-f11c2cc14422
caps.latest.revision: 33
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 35334b61199d758a5eafe8623ea576a047799925
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "36984431"
---
# <a name="partyresolution-biztalk-server-sample"></a><span data-ttu-id="80c27-102">PartyResolution （BizTalk Server 範例）</span><span class="sxs-lookup"><span data-stu-id="80c27-102">PartyResolution (BizTalk Server Sample)</span></span>
<span data-ttu-id="80c27-103">PartyResolution 範例示範如何搭配運用 BizTalk 協調流程和合作對象解析，以將訊息路由至兩個可能收件者中的一個。</span><span class="sxs-lookup"><span data-stu-id="80c27-103">The PartyResolution sample demonstrates how to use BizTalk orchestrations with party resolution to route messages to one of two possible recipients.</span></span>  

## <a name="what-this-sample-does"></a><span data-ttu-id="80c27-104">此範例的用途</span><span class="sxs-lookup"><span data-stu-id="80c27-104">What This Sample Does</span></span>  
 <span data-ttu-id="80c27-105">此範例執行多個協調流程，示範下列不同的角色：</span><span class="sxs-lookup"><span data-stu-id="80c27-105">This sample runs multiple orchestrations that demonstrate the following different roles:</span></span>  

-   <span data-ttu-id="80c27-106">買方協調流程，用來初始化訂單 (PO) 訊息處理。</span><span class="sxs-lookup"><span data-stu-id="80c27-106">Buyer orchestration, used to initiate the purchase order (PO) message processing.</span></span>  

-   <span data-ttu-id="80c27-107">供應商協調流程，示範輸入和輸出合作對象解析。</span><span class="sxs-lookup"><span data-stu-id="80c27-107">Supplier orchestration, which demonstrates both inbound and outbound party resolution.</span></span>  

-   <span data-ttu-id="80c27-108">ShipmentAgency1 和 ShipmentAgency2 協調流程，根據 PO 中的出貨目的地回應供應商協調流程。</span><span class="sxs-lookup"><span data-stu-id="80c27-108">ShipmentAgency1 and ShipmentAgency2 orchestrations, which respond to the supplier orchestration based on the shipment destination in the PO.</span></span>  

## <a name="how-this-sample-is-designed-and-why"></a><span data-ttu-id="80c27-109">此範例的設計方式和原因</span><span class="sxs-lookup"><span data-stu-id="80c27-109">How This Sample is Designed and Why</span></span>  
 <span data-ttu-id="80c27-110">合作對象解析是指判斷訊息傳送者 (即傳送訊息之一方) 為何的程序。</span><span class="sxs-lookup"><span data-stu-id="80c27-110">Party resolution refers to the process of determining who (that is, what party) sends a message.</span></span> <span data-ttu-id="80c27-111">例如，您可能只想要讓已知的合作對象傳送訊息。</span><span class="sxs-lookup"><span data-stu-id="80c27-111">For example, you may want to enable only known parties to send a message.</span></span> <span data-ttu-id="80c27-112">輸出合作對象解析就是您在決定要將訊息傳送給哪些合作對象時所依據的程序。</span><span class="sxs-lookup"><span data-stu-id="80c27-112">Outbound party resolution is the process by which you determine which parties should be sent a message.</span></span>  

 <span data-ttu-id="80c27-113">除了合作對象解析之外，此案例還示範如何實作和使用角色。</span><span class="sxs-lookup"><span data-stu-id="80c27-113">In addition to party resolution, this sample demonstrates how to implement and use roles.</span></span> <span data-ttu-id="80c27-114">例如，為了處理產品的出貨，您會建立一個傳送埠，指示託運商運送您產品的文件會傳送到該傳送埠。</span><span class="sxs-lookup"><span data-stu-id="80c27-114">For example, to process the shipment of your product, you create a send port to which you send a document instructing a shipper to ship your product.</span></span> <span data-ttu-id="80c27-115">如果您有多個託運商可供選擇，可在協調流程中建立託運商角色，而不要建立只有託運商 URL 不同的多個傳送埠。</span><span class="sxs-lookup"><span data-stu-id="80c27-115">If you have multiple shippers to choose from, you can create a shipper role in your orchestration rather than create multiple send ports whose only difference is the shipper's URL.</span></span> <span data-ttu-id="80c27-116">然後您可將與產品出貨相關的訊息傳送到該託運商角色。</span><span class="sxs-lookup"><span data-stu-id="80c27-116">You can then send messages relating to product shipment to the shipper role.</span></span> <span data-ttu-id="80c27-117">您會建立合作對象，然後將傳送埠與每個合作對象和合作對象憑證產生關聯。</span><span class="sxs-lookup"><span data-stu-id="80c27-117">You create parties and associate a send port to each party and party certificate.</span></span> <span data-ttu-id="80c27-118">最後您會將每個合作對象登錄到託運商角色以啟用它。</span><span class="sxs-lookup"><span data-stu-id="80c27-118">Finally, you enlist each party to the shipper role to enable it.</span></span> <span data-ttu-id="80c27-119">接著您就可以在協調流程中動態指定您要將訊息傳送到哪個託運商。</span><span class="sxs-lookup"><span data-stu-id="80c27-119">In the orchestration, you can then dynamically specify which shipper you are sending the message to.</span></span>  

 <span data-ttu-id="80c27-120">此範例也示範如何使用相互關聯，將內送訊息對應到正確的協調流程執行個體。</span><span class="sxs-lookup"><span data-stu-id="80c27-120">This sample also demonstrates how to use correlation to match the incoming message to the right orchestration instance.</span></span>  

- <span data-ttu-id="80c27-121">買方、供應商和託運商的商務程序流程如下：</span><span class="sxs-lookup"><span data-stu-id="80c27-121">The business process flows for the buyer, supplier, and shipping agencies are as follows:</span></span>  

- <span data-ttu-id="80c27-122">買方的商務程序流程：</span><span class="sxs-lookup"><span data-stu-id="80c27-122">Buyer business process flow:</span></span>  

  1.  <span data-ttu-id="80c27-123">從內部部門以 .xml 檔案的形式接收 PO 訊息。</span><span class="sxs-lookup"><span data-stu-id="80c27-123">Receive PO message from internal department as an .xml file.</span></span>  

  2.  <span data-ttu-id="80c27-124">將 PO 訊息傳送到供應商。</span><span class="sxs-lookup"><span data-stu-id="80c27-124">Send PO message to supplier.</span></span>  

- <span data-ttu-id="80c27-125">供應商的商務程序流程：</span><span class="sxs-lookup"><span data-stu-id="80c27-125">Supplier business process flow:</span></span>  

  1.  <span data-ttu-id="80c27-126">解析合作對象 (輸入合作對象解析)，根據簽章憑證更新來源合作對象。</span><span class="sxs-lookup"><span data-stu-id="80c27-126">Resolve the party (inbound party resolution) to update the source party based on signature certificate.</span></span>  

  2.  <span data-ttu-id="80c27-127">接收來自買方的啟動訊息 (PO)。</span><span class="sxs-lookup"><span data-stu-id="80c27-127">Receive an activation message (PO) from buyer.</span></span>  

  3.  <span data-ttu-id="80c27-128">將 PO 確認訊息傳送到買方。</span><span class="sxs-lookup"><span data-stu-id="80c27-128">Send a PO Acknowledgement message to buyer.</span></span>  

  4.  <span data-ttu-id="80c27-129">確認送達國家/地區。</span><span class="sxs-lookup"><span data-stu-id="80c27-129">Verify the delivery country/region.</span></span>  

  5.  <span data-ttu-id="80c27-130">解析輸出合作對象，找出要使用的託運商。</span><span class="sxs-lookup"><span data-stu-id="80c27-130">Resolve the outbound party to find which shipping agency to use.</span></span> <span data-ttu-id="80c27-131">如果該國家/地區為美國，託運商就是 ShipmentAgency2。</span><span class="sxs-lookup"><span data-stu-id="80c27-131">If the country/region is U.S., the shipping agency is ShipmentAgency2.</span></span> <span data-ttu-id="80c27-132">如果該國家/地區為加拿大，託運商就是 ShipmentAgency1。</span><span class="sxs-lookup"><span data-stu-id="80c27-132">If the country/region is Canada, the shipping agency is ShipmentAgency1.</span></span>  

  6.  <span data-ttu-id="80c27-133">將出貨訂單要求訊息傳送到適當的託運商。</span><span class="sxs-lookup"><span data-stu-id="80c27-133">Send a Shipment Order Request message to the appropriate shipping agency.</span></span>  

  7.  <span data-ttu-id="80c27-134">從適當的託運商接收出貨訂單確認訊息。</span><span class="sxs-lookup"><span data-stu-id="80c27-134">Receive the Shipment Order Acknowledgement message from the appropriate shipping agency.</span></span>  

  8.  <span data-ttu-id="80c27-135">將出貨建議訊息傳送到適當的託運商。</span><span class="sxs-lookup"><span data-stu-id="80c27-135">Send a Shipment Advice message to the appropriate shipping agency.</span></span>  

  9. <span data-ttu-id="80c27-136">從適當的託運商接收出貨建議確認訊息。</span><span class="sxs-lookup"><span data-stu-id="80c27-136">Receive a Shipment Advice Acknowledgement message from the appropriate shipping agency.</span></span>  

  10. <span data-ttu-id="80c27-137">將最後的 PO 送達回條訊息傳送給買方。</span><span class="sxs-lookup"><span data-stu-id="80c27-137">Send a final PO Delivery Receipt message to the buyer.</span></span>  

- <span data-ttu-id="80c27-138">託運商的商務程序流程 (兩個託運商都相同)：</span><span class="sxs-lookup"><span data-stu-id="80c27-138">Shipping agency business process flow (same for both shipping agencies):</span></span>  

  1.  <span data-ttu-id="80c27-139">接收來自供應商的出貨訂單要求訊息。</span><span class="sxs-lookup"><span data-stu-id="80c27-139">Receive the Shipment Order Request message from the supplier.</span></span>  

  2.  <span data-ttu-id="80c27-140">產生並傳送出貨訂單要求訊息的確認訊息。</span><span class="sxs-lookup"><span data-stu-id="80c27-140">Generate and send an Acknowledgement message for the Shipment Order Request message.</span></span>  

  3.  <span data-ttu-id="80c27-141">接收來自供應商的出貨建議訊息。</span><span class="sxs-lookup"><span data-stu-id="80c27-141">Receive a Shipment Advice message from the supplier.</span></span>  

  4.  <span data-ttu-id="80c27-142">產生並傳送出貨建議訊息的確認訊息。</span><span class="sxs-lookup"><span data-stu-id="80c27-142">Generate and send an Acknowledgement message for the Shipment Advice message.</span></span>  

  <span data-ttu-id="80c27-143">以下聲明說明此範例設計的方式：</span><span class="sxs-lookup"><span data-stu-id="80c27-143">The following statements explain how this sample is designed:</span></span>  

- <span data-ttu-id="80c27-144">BuyerProcess.odx 協調流程會接收訊息，然後使用自訂的管線 MimePartyResSendPipeline 來編碼訊息並將它傳送到供應商。</span><span class="sxs-lookup"><span data-stu-id="80c27-144">The BuyerProcess.odx orchestration receives a message and uses the custom pipeline MimePartyResSendPipeline to encode the message and send it to the supplier.</span></span> <span data-ttu-id="80c27-145">這可使用管線設計師建置和部署自訂傳送管線來完成。</span><span class="sxs-lookup"><span data-stu-id="80c27-145">This is done by using Pipeline Designer to build and deploy a custom send pipeline.</span></span> <span data-ttu-id="80c27-146">傳送訊息給供應商之前, 的訊息進行數位簽署買方的私密金鑰，在 BizTalk 群組屬性中所指定[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台。</span><span class="sxs-lookup"><span data-stu-id="80c27-146">Before sending the message to the supplier, the message is digitally signed with buyer's private key, which is specified in BizTalk Group Properties in the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console.</span></span>  

- <span data-ttu-id="80c27-147">SupplierProcess.odx 協調流程使用自訂的管線 MimePartyResReceivePipeline (此管線包含 MIME/SMIME 解碼器元件)，使用買方的公開金鑰解析並驗證買方的身份，來解碼訊息及執行輸入合作對象解析。</span><span class="sxs-lookup"><span data-stu-id="80c27-147">The SupplierProcess.odx orchestration uses the custom pipeline MimePartyResReceivePipeline, which includes a MIME/SMIME decoder component, to decode the message and perform inbound party resolution by using the buyer's public key to resolve and validate the buyer's identity.</span></span> <span data-ttu-id="80c27-148">此項工作由建置和部署自訂的接收管線完成。</span><span class="sxs-lookup"><span data-stu-id="80c27-148">This is done by building and deploying a custom receive pipeline.</span></span>  

- <span data-ttu-id="80c27-149">然後供應商協調流程會初始化 POCorrelationSets，此屬性定義為以升級的屬性 PONo 為基礎。</span><span class="sxs-lookup"><span data-stu-id="80c27-149">The supplier orchestration then initiates the POCorrelationSets which is defined to base on a promoted property - PONo.</span></span> <span data-ttu-id="80c27-150">PONo 在稍後階段用來將輸入和輸出訊息對應到此協調流程執行個體，因為整個協調流程中有多個傳送和接收動作。</span><span class="sxs-lookup"><span data-stu-id="80c27-150">The PONo is used to match the inbound and outbound messages to this orchestration instance in the later stage, because there are multiple send and receive actions throughout the entire orchestration.</span></span>  

- <span data-ttu-id="80c27-151">供應商協調流程會實作角色連結，以處理輸入和輸出合作對象解析。</span><span class="sxs-lookup"><span data-stu-id="80c27-151">The supplier orchestration implements role links to deal with inbound and outbound party resolution.</span></span> <span data-ttu-id="80c27-152">供應商協調流程使用兩種角色連結類型：</span><span class="sxs-lookup"><span data-stu-id="80c27-152">The supplier orchestration uses two role link types:</span></span>  

  -   <span data-ttu-id="80c27-153">Buyer_Supplier 角色連結類型</span><span class="sxs-lookup"><span data-stu-id="80c27-153">Buyer_Supplier role link type</span></span>  

  -   <span data-ttu-id="80c27-154">Supplier_Shipment 角色連結類型</span><span class="sxs-lookup"><span data-stu-id="80c27-154">Supplier_Shipment role link type</span></span>  

- <span data-ttu-id="80c27-155">在 Buyer_Supplier**角色連結**圖形，供應商是扮演提供者角色，而且因為供應商從買方接收第一個訊息，取用者角色位於買方。</span><span class="sxs-lookup"><span data-stu-id="80c27-155">In the Buyer_Supplier **Role Link** shape, the supplier is in the Provider role and the buyer is in the Consumer role because the supplier receives the first message from the buyer.</span></span> <span data-ttu-id="80c27-156">當供應商協調流程傳送確認到買方角色時，會有一個與買方關聯的傳送埠，而訊息則會透過此指定傳送埠傳送到買方。</span><span class="sxs-lookup"><span data-stu-id="80c27-156">When the supplier orchestration sends the acknowledgment to the buyer role, there is a send port associated with the buyer, and the message is sent to the buyer through the specified send port.</span></span> <span data-ttu-id="80c27-157">若要尋找此傳送埠，以滑鼠右鍵按一下**BuyerAgency**中[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台，然後按一下**屬性**。</span><span class="sxs-lookup"><span data-stu-id="80c27-157">To find the send port, right-click **BuyerAgency** in the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console and then click **Properties**.</span></span> <span data-ttu-id="80c27-158">傳送埠會顯示下**傳送埠**。</span><span class="sxs-lookup"><span data-stu-id="80c27-158">The send port is displayed under **Send Ports**.</span></span>  

- <span data-ttu-id="80c27-159">然後協調流程會使用下列運算式傳回合作對象資訊，並透過呼叫名為 CheckPartyName 的外部組件將 XML 檔案寫入資料夾中。</span><span class="sxs-lookup"><span data-stu-id="80c27-159">The orchestration then uses the following expression to return the partner information, and writes an XML file to a folder through a call to an external assembly named CheckPartyName.</span></span>  

  ```  
  Buyer_Supplier(Microsoft.XLANGs.BaseTypes.SourceParty)  
  ```  

- <span data-ttu-id="80c27-160">在 Supplier_Shipment**角色連結**圖形，出貨角色包含具有兩項作業用來從供應商的訊息傳送至適當的託運商視目的合作對象的傳送埠。</span><span class="sxs-lookup"><span data-stu-id="80c27-160">In the Supplier_Shipment **Role Link** shape, the Shipment role contains a send port with two operations that are used to send the message from the supplier to the appropriate shipping agency depending on the destination party.</span></span> <span data-ttu-id="80c27-161">供應商角色包含一個接收埠，以及用來接收來自託運商之回應的兩項作業。</span><span class="sxs-lookup"><span data-stu-id="80c27-161">The Supplier role contains a receive port with two operations that are used to receive the response from the shipping agency.</span></span> <span data-ttu-id="80c27-162">在傳送和接收這些訊息時會使用相互關聯，它是根據 PONo 而建立。</span><span class="sxs-lookup"><span data-stu-id="80c27-162">The correlation is used when sending and receiving these messages, and it is based on the PONo.</span></span>  

  > [!NOTE]
  >  <span data-ttu-id="80c27-163">當您繫結供應商協調流程時，會發現只需要繫結一個傳送埠和兩個接收埠。</span><span class="sxs-lookup"><span data-stu-id="80c27-163">When you bind the supplier orchestration, you will find that only one send port and two receive ports need to be bound.</span></span> <span data-ttu-id="80c27-164">這是因為目的合作對象的傳送埠已經和合作對象繫結。</span><span class="sxs-lookup"><span data-stu-id="80c27-164">This is because the send ports to the destination parties are already bound with the parties.</span></span> <span data-ttu-id="80c27-165">此外，其中一個協調流程中的接收埠包含兩個接收作業，因此，即使您會看到三**接收**圖形，只有兩個都必須繫結。</span><span class="sxs-lookup"><span data-stu-id="80c27-165">Moreover, one of the receive ports in the orchestration contains two receive operations, so even if you see three **Receive** shapes, only two of them need to be bound.</span></span>  

- <span data-ttu-id="80c27-166">供應商協調流程使用下列程式碼的第一行，藉由呼叫名為 QueryShipmentCatalogComponent 的外部組件來取得託運商。</span><span class="sxs-lookup"><span data-stu-id="80c27-166">The supplier orchestration uses the first line in the following code to get the shipment agency by calling an external assembly named QueryShipmentCatalogComponent.</span></span> <span data-ttu-id="80c27-167">然後它會使用第二行來設定出貨角色的目的合作對象。</span><span class="sxs-lookup"><span data-stu-id="80c27-167">It then uses the second line to set the destination party for the shipment role.</span></span>  

  ```  
  strShipmentName= objQueryShipmentCatalog.GetShipmentDetails(POMessage.MessagePart_1.POHeader.Address.Country);  
  Supplier_Shipment(Microsoft.XLANGs.BaseTypes.DestinationParty) = new Microsoft.XLANGs.BaseTypes.Party(strShipmentName,"OrganizationName");  
  ```  

- <span data-ttu-id="80c27-168">Shipper1Process.odx 和 Shipper2Process.odx 的建置，是用於接收 SupplierProcess.odx 的送貨單和出貨建議，並用於傳送回應給 SupplierProcess.odx。</span><span class="sxs-lookup"><span data-stu-id="80c27-168">Shipper1Process.odx and Shipper2Process.odx are built to receive the shipping order and the shipping advice from SupplierProcess.odx and to send the response back to SupplierProcess.odx.</span></span> <span data-ttu-id="80c27-169">在這兩個託運商協調流程中都有使用相互關聯，而相互關聯類型則是依據升級屬性 PONo 而定。</span><span class="sxs-lookup"><span data-stu-id="80c27-169">In both of the shipper orchestrations, correlation is used, and the correlation type is based on the promoted property PONo.</span></span>  

## <a name="where-to-find-this-sample"></a><span data-ttu-id="80c27-170">可在何處找到此範例</span><span class="sxs-lookup"><span data-stu-id="80c27-170">Where to Find This Sample</span></span>  
 <span data-ttu-id="80c27-171">*\<範例路徑\>* \Orchestrations\PartyResolution\\</span><span class="sxs-lookup"><span data-stu-id="80c27-171">*\<Samples Path\>* \Orchestrations\PartyResolution\\</span></span>  

 <span data-ttu-id="80c27-172">下表顯示此範例中的檔案，並描述其用途。</span><span class="sxs-lookup"><span data-stu-id="80c27-172">The following table shows the files in this sample and describes their purpose.</span></span>  


|                                                                                                                                 <span data-ttu-id="80c27-173">檔案</span><span class="sxs-lookup"><span data-stu-id="80c27-173">File(s)</span></span>                                                                                                                                 |                                                                                                                                                              <span data-ttu-id="80c27-174">描述</span><span class="sxs-lookup"><span data-stu-id="80c27-174">Description</span></span>                                                                                                                                                              |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                                                                      <span data-ttu-id="80c27-175">BuyerBinding.xml, ShippingAgency1Binding.xml, ShippingAgency2Binding.xml, SupplierBinding.xml</span><span class="sxs-lookup"><span data-stu-id="80c27-175">BuyerBinding.xml, ShippingAgency1Binding.xml, ShippingAgency2Binding.xml, SupplierBinding.xml</span></span>                                                                                      |                                                                                                                                            <span data-ttu-id="80c27-176">用於自動化設定，例如連接埠繫結。</span><span class="sxs-lookup"><span data-stu-id="80c27-176">Used for automated setup such as port binding.</span></span>                                                                                                                                             |
|                                                                                                                               <span data-ttu-id="80c27-177">Cleanup.bat</span><span class="sxs-lookup"><span data-stu-id="80c27-177">Cleanup.bat</span></span>                                                                                                                               |                                                                   <span data-ttu-id="80c27-178">用來解除部署組件，以及將它從全域組件快取中移除。</span><span class="sxs-lookup"><span data-stu-id="80c27-178">Used to undeploy assemblies and remove them from the global assembly cache.</span></span> <span data-ttu-id="80c27-179">移除傳送埠和接收埠。</span><span class="sxs-lookup"><span data-stu-id="80c27-179">Removes send and receive ports.</span></span> <span data-ttu-id="80c27-180">視需要移除 Microsoft Internet Information Services (IIS) 虛擬目錄。</span><span class="sxs-lookup"><span data-stu-id="80c27-180">Removes Microsoft Internet Information Services (IIS) virtual directories as needed.</span></span>                                                                    |
|                                                                                                                           <span data-ttu-id="80c27-181">PartyResolution.sln</span><span class="sxs-lookup"><span data-stu-id="80c27-181">PartyResolution.sln</span></span>                                                                                                                           |                                                                                                                              <span data-ttu-id="80c27-182">包含不同子資料夾中所有專案的方案檔。</span><span class="sxs-lookup"><span data-stu-id="80c27-182">Solution file that contains all of the projects in the various subfolders.</span></span>                                                                                                                               |
|                                                                                                                            <span data-ttu-id="80c27-183">PurchaseOrder.xml</span><span class="sxs-lookup"><span data-stu-id="80c27-183">PurchaseOrder.xml</span></span>                                                                                                                            |                                                                                                                                                           <span data-ttu-id="80c27-184">範例 PO 輸入檔。</span><span class="sxs-lookup"><span data-stu-id="80c27-184">Sample input PO.</span></span>                                                                                                                                                            |
|                                                                                                                                <span data-ttu-id="80c27-185">Setup.bat</span><span class="sxs-lookup"><span data-stu-id="80c27-185">Setup.bat</span></span>                                                                                                                                |                                                                                                                                         <span data-ttu-id="80c27-186">用來建置和初始化此範例的一部分。</span><span class="sxs-lookup"><span data-stu-id="80c27-186">Used to build and initialize portions of this sample.</span></span>                                                                                                                                         |
|                                                                                                    <span data-ttu-id="80c27-187">在 \Buyer 資料夾中：</span><span class="sxs-lookup"><span data-stu-id="80c27-187">In the \Buyer folder:</span></span><br /><br /> <span data-ttu-id="80c27-188">Buyer.btproj, BuyerProcess.odx</span><span class="sxs-lookup"><span data-stu-id="80c27-188">Buyer.btproj, BuyerProcess.odx</span></span>                                                                                                     |                                                                                                                             <span data-ttu-id="80c27-189">用來實作此範例中買方的 BizTalk 專案和協調流程。</span><span class="sxs-lookup"><span data-stu-id="80c27-189">BizTalk project and orchestration used to implement the buyer in this sample.</span></span>                                                                                                                             |
|                                                                                                             <span data-ttu-id="80c27-190">在 \Catalog 資料夾中：</span><span class="sxs-lookup"><span data-stu-id="80c27-190">In the \Catalog folder:</span></span><br /><br /> <span data-ttu-id="80c27-191">Catalog.xml</span><span class="sxs-lookup"><span data-stu-id="80c27-191">Catalog.xml</span></span>                                                                                                             |                                                                                                                         <span data-ttu-id="80c27-192">用來根據 PO 中指定的出貨目的地決定託運商。</span><span class="sxs-lookup"><span data-stu-id="80c27-192">Used to determine shipment agency based on shipping destination specified in the PO.</span></span>                                                                                                                          |
|                                                                                      <span data-ttu-id="80c27-193">在 \CheckPartyName 資料夾中：</span><span class="sxs-lookup"><span data-stu-id="80c27-193">In the \CheckPartyName folder:</span></span><br /><br /> <span data-ttu-id="80c27-194">AssemblyInfo.cs, CheckPartyName.csproj, Class1.cs</span><span class="sxs-lookup"><span data-stu-id="80c27-194">AssemblyInfo.cs, CheckPartyName.csproj, Class1.cs</span></span>                                                                                       |                                                                                                  <span data-ttu-id="80c27-195">CheckPartyName 應用程式的 Microsoft Visual C# 專案和來源檔案，用來存取來源合作對象的屬性。</span><span class="sxs-lookup"><span data-stu-id="80c27-195">Microsoft Visual C# project and source files for the CheckPartyName application used to access the properties of the source party.</span></span>                                                                                                   |
|                                                                <span data-ttu-id="80c27-196">在 \FilePolling 資料夾中：</span><span class="sxs-lookup"><span data-stu-id="80c27-196">In the \FilePolling folder:</span></span><br /><br /> <span data-ttu-id="80c27-197">App.ico, AssemblyInfo.cs, FilePolling.cs, FilePolling.csproj, FilePolling.resx, FilePolling.sln,</span><span class="sxs-lookup"><span data-stu-id="80c27-197">App.ico, AssemblyInfo.cs, FilePolling.cs, FilePolling.csproj, FilePolling.resx, FilePolling.sln,</span></span>                                                                 |                                                                 <span data-ttu-id="80c27-198">FilePolling 應用程式的 Visual C# 方案、專案、來源和相關檔案。</span><span class="sxs-lookup"><span data-stu-id="80c27-198">Visual C# solution, project, source, and associated files for the FilePolling application.</span></span><br /><br /> <span data-ttu-id="80c27-199">請使用此應用程式以瞭解有關此自動化案例的處理狀態。</span><span class="sxs-lookup"><span data-stu-id="80c27-199">Use this application to keep informed about the progressing state of this automated scenario.</span></span>                                                                  |
|                                                                            <span data-ttu-id="80c27-200">在 \Pipeline\projectschema 資料夾中：</span><span class="sxs-lookup"><span data-stu-id="80c27-200">In the \Pipeline\projectschema folder:</span></span><br /><br /> <span data-ttu-id="80c27-201">MimePartyResReceivePipeline.btp, MimePartyResSendPipeline.btp</span><span class="sxs-lookup"><span data-stu-id="80c27-201">MimePartyResReceivePipeline.btp, MimePartyResSendPipeline.btp</span></span>                                                                             |                                                                                             <span data-ttu-id="80c27-202">此範例中不同角色所使用的 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 管線檔案。</span><span class="sxs-lookup"><span data-stu-id="80c27-202">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] pipeline files used by the different roles in this sample.</span></span>                                                                                             |
|                                                                <span data-ttu-id="80c27-203">在 \QueryShipmentCatalogComponent 資料夾中：</span><span class="sxs-lookup"><span data-stu-id="80c27-203">In the \QueryShipmentCatalogComponent folder:</span></span><br /><br /> <span data-ttu-id="80c27-204">AssemblyInfo.cs, QueryShipmentCatalog.cs, QueryShipmentCatalogComponent.csproj</span><span class="sxs-lookup"><span data-stu-id="80c27-204">AssemblyInfo.cs, QueryShipmentCatalog.cs, QueryShipmentCatalogComponent.csproj</span></span>                                                                 | <span data-ttu-id="80c27-205">QueryShipmentCatalog 元件的 Visual C# 專案和來源檔案，用來存取 Catalog.xml 檔案中定義的出貨目錄。</span><span class="sxs-lookup"><span data-stu-id="80c27-205">Visual C# project and source files for the QueryShipmentCatalog component used to access the shipment catalog defined in the file Catalog.xml.</span></span><br /><br /> <span data-ttu-id="80c27-206">QueryShipmentCatalog 元件決定供應商將使用的託運商。</span><span class="sxs-lookup"><span data-stu-id="80c27-206">The QueryShipmentCatalog component determines which shipment agency the supplier will use.</span></span> <span data-ttu-id="80c27-207">它使用 Catalog.xml 中的資料，根據地理位置決定最佳的託運商。</span><span class="sxs-lookup"><span data-stu-id="80c27-207">It uses data from Catalog.xml to determine the best shipper based on geography.</span></span> |
| <span data-ttu-id="80c27-208">在 \Schemas 資料夾中：</span><span class="sxs-lookup"><span data-stu-id="80c27-208">In the \Schemas folder:</span></span><br /><br /> <span data-ttu-id="80c27-209">PODeliveryReceipt.xsd, POPropertySchema.xsd, PurchaseOrder.xsd, PurchaseOrderAcknowledgement.xsd, Schemas.btproj, ShipmentAdvice.xsd, ShipmentAdviceAcknowledgement.xsd, ShipmentOrderAcknowledgement.xsd, ShipmentOrderRequest.xsd</span><span class="sxs-lookup"><span data-stu-id="80c27-209">PODeliveryReceipt.xsd, POPropertySchema.xsd, PurchaseOrder.xsd, PurchaseOrderAcknowledgement.xsd, Schemas.btproj, ShipmentAdvice.xsd, ShipmentAdviceAcknowledgement.xsd, ShipmentOrderAcknowledgement.xsd, ShipmentOrderRequest.xsd</span></span> |                                                                                                                                           <span data-ttu-id="80c27-210">此範例中不同角色所使用的結構描述。</span><span class="sxs-lookup"><span data-stu-id="80c27-210">Schemas used by the various roles in this sample.</span></span>                                                                                                                                           |
|                                                                  <span data-ttu-id="80c27-211">在 \ShipmentAgency1 資料夾：</span><span class="sxs-lookup"><span data-stu-id="80c27-211">In the \ShipmentAgency1 folder:</span></span><br /><br /> <span data-ttu-id="80c27-212">ShipmentAdviceAck.btm, ShipmentAgency1.btproj, ShipmentOrderAck.btm, Shipper1Process.odx</span><span class="sxs-lookup"><span data-stu-id="80c27-212">ShipmentAdviceAck.btm, ShipmentAgency1.btproj, ShipmentOrderAck.btm, Shipper1Process.odx</span></span>                                                                   |                                                                                                                      <span data-ttu-id="80c27-213">用來實作此範例中 ShipmentAgency1 的 BizTalk 專案、協調流程和對應。</span><span class="sxs-lookup"><span data-stu-id="80c27-213">BizTalk project, orchestration, and maps used to implement ShipmentAgency1 in this sample.</span></span>                                                                                                                       |
|                                                                  <span data-ttu-id="80c27-214">在 \ShipmentAgency2 資料夾中：</span><span class="sxs-lookup"><span data-stu-id="80c27-214">In the \ShipmentAgency2 folder:</span></span><br /><br /> <span data-ttu-id="80c27-215">ShipmentAdviceAck.btm, ShipmentAgency2.btproj, ShipmentOrderAck.btm, Shipper2Process.odx</span><span class="sxs-lookup"><span data-stu-id="80c27-215">ShipmentAdviceAck.btm, ShipmentAgency2.btproj, ShipmentOrderAck.btm, Shipper2Process.odx</span></span>                                                                   |                                                                                                                      <span data-ttu-id="80c27-216">用來實作此範例中 ShipmentAgency2 的 BizTalk 專案、協調流程和對應。</span><span class="sxs-lookup"><span data-stu-id="80c27-216">BizTalk project, orchestration, and maps used to implement ShipmentAgency2 in this sample.</span></span>                                                                                                                       |
|                                     <span data-ttu-id="80c27-217">在 \Supplier 資料夾中：</span><span class="sxs-lookup"><span data-stu-id="80c27-217">In the \Supplier folder:</span></span><br /><br /> <span data-ttu-id="80c27-218">PO_POAck.btm, PO_ShipmentOrderRequest.btm, ShipmentAdviceAck_PODeliveryReceipt.btm, ShipmentOrder_ShipmentAdvice.btm, Supplier.btproj, SupplierProcess.odx</span><span class="sxs-lookup"><span data-stu-id="80c27-218">PO_POAck.btm, PO_ShipmentOrderRequest.btm, ShipmentAdviceAck_PODeliveryReceipt.btm, ShipmentOrder_ShipmentAdvice.btm, Supplier.btproj, SupplierProcess.odx</span></span>                                     |                                                                                                                        <span data-ttu-id="80c27-219">用來實作此範例中供應商的 BizTalk 專案、協調流程和對應。</span><span class="sxs-lookup"><span data-stu-id="80c27-219">BizTalk project, orchestration, and maps used to implement the supplier in this sample.</span></span>                                                                                                                        |

## <a name="building-and-initializing-this-sample"></a><span data-ttu-id="80c27-220">建置和初始化此範例</span><span class="sxs-lookup"><span data-stu-id="80c27-220">Building and Initializing This Sample</span></span>  

> [!NOTE]
>  <span data-ttu-id="80c27-221">在建置和初始化此範例之前，您必須確定預設的 BizTalk 內含式主控件設定為「信任的驗證」。</span><span class="sxs-lookup"><span data-stu-id="80c27-221">Before you build and initialize this sample, you need to make sure that the default BizTalk In-Process Host is configured as Authentication Trusted.</span></span> <span data-ttu-id="80c27-222">如需詳細資訊，請參閱 < [BizTalk Server 執行階段安全性建議](../core/biztalk-server-runtime-security-recommendations.md)。</span><span class="sxs-lookup"><span data-stu-id="80c27-222">For more information, see [BizTalk Server Runtime Security Recommendations](../core/biztalk-server-runtime-security-recommendations.md).</span></span>  

 <span data-ttu-id="80c27-223">MIME 管線元件不支援在 64 位元主控件執行個體。</span><span class="sxs-lookup"><span data-stu-id="80c27-223">The MIME pipeline component is not supported in a 64-bit host instance.</span></span> <span data-ttu-id="80c27-224">與檔案配接器之傳送和接收處理常式關聯的主控件必須設定做為僅 32 位元主控件。</span><span class="sxs-lookup"><span data-stu-id="80c27-224">The host associated with the send and receive handler for the file adapter must be configured as a 32-bit only host.</span></span> <span data-ttu-id="80c27-225">如需有關這個，請參閱[如何修改主機內容](../core/how-to-modify-host-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="80c27-225">For more information on this see [How to Modify Host Properties](../core/how-to-modify-host-properties.md).</span></span> <span data-ttu-id="80c27-226">如果您已經有 32 位元的唯一主控件，在系統上，設定，想要使用它，請參閱[設定 File 配接器](../core/configure-the-file-adapter.md)設定 file 配接器相關聯的主機上的指示傳送和接收處理常式。</span><span class="sxs-lookup"><span data-stu-id="80c27-226">If you already have a 32-bit only host configured on the system, and want to use it, see [Configuring the File Adapter](../core/configure-the-file-adapter.md) for instructions on configuring the host(s) associated to the file adapter’s send and receive handler.</span></span>  

 <span data-ttu-id="80c27-227">在本節中所述的憑證必須新增至設定將用於簽署訊息的預設 BizTalk 內含式主控件執行個體的登入帳戶的個人存放區。</span><span class="sxs-lookup"><span data-stu-id="80c27-227">The certificate mentioned in this section must to be added to the Personal store of the Logon account configured for the default BizTalk In-Process host instance which will be signing messages.</span></span>  

 <span data-ttu-id="80c27-228">根據預設 setup.bat 下面所述的檔案會預設成安裝合作對象解析範例[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]應用程式。</span><span class="sxs-lookup"><span data-stu-id="80c27-228">By default the setup.bat file mentioned below will install the Party Resolution sample into the default [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] application.</span></span> <span data-ttu-id="80c27-229">您可以修改 setup.bat 檔案，以便部署至新的範例[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]陳述式加上應用程式開啟 setup.bat 檔案，並取代區段`@ECHO Deploy Assemblies...`取代下列項目：</span><span class="sxs-lookup"><span data-stu-id="80c27-229">You can modify the setup.bat file to deploy the sample into a new [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] application by opening the setup.bat file and replacing the section preceded by the statement `@ECHO Deploy Assemblies...` with the following:</span></span>  

```  
@ECHO Deploy Assemblies...  

btstask AddApp -ApplicationName:PartyResolutionSample -Description:"Party Resolution Orchestration sample from the SDK"  
btstask AddResource -ApplicationName:PartyResolutionSample -Type:System.BizTalk:BizTalkAssembly  -Source:Schemas\bin\Release\Schemas.dll -Options:GacOnAdd  
btstask AddResource -ApplicationName:PartyResolutionSample -Type:System.BizTalk:BizTalkAssembly  -Source:Pipeline\projectschema\bin\Release\ProjectSchema.dll -Options:GacOnAdd   
btstask AddResource -ApplicationName:PartyResolutionSample -Type:System.BizTalk:BizTalkAssembly  -Source:Buyer\bin\Release\Buyer.dll -Options:GacOnAdd  
btstask ImportBindings -ApplicationName:PartyResolutionSample -Source:%BuyerBindingFileName%  
btstask AddResource -ApplicationName:PartyResolutionSample -Type:System.BizTalk:BizTalkAssembly  -Source:ShipmentAgency1\bin\Release\ShipmentAgency1.dll -Options:GacOnAdd  
btstask ImportBindings -ApplicationName:PartyResolutionSample -Source:%ShipmentAgency1BindingFileName%  
btstask AddResource -ApplicationName:PartyResolutionSample -Type:System.BizTalk:BizTalkAssembly  -Source:ShipmentAgency2\bin\Release\ShipmentAgency2.dll -Options:GacOnAdd  
btstask ImportBindings -ApplicationName:PartyResolutionSample -Source:%ShipmentAgency2BindingFileName%  
btstask AddResource -ApplicationName:PartyResolutionSample -Type:System.BizTalk:BizTalkAssembly  -Source:Supplier\bin\Release\Supplier.dll -Options:GacOnAdd  
btstask ImportBindings -ApplicationName:PartyResolutionSample -Source:%SupplierBindingFileName%  
```  

#### <a name="to-build-and-initialize-the-partyresolution-sample"></a><span data-ttu-id="80c27-230">建置和初始化 PartyResolution 範例</span><span class="sxs-lookup"><span data-stu-id="80c27-230">To build and initialize the PartyResolution sample</span></span>  

1. <span data-ttu-id="80c27-231">在命令視窗中，瀏覽至下列資料夾：</span><span class="sxs-lookup"><span data-stu-id="80c27-231">In a command window, navigate to the following folder:</span></span>  

    <span data-ttu-id="80c27-232">\<*範例路徑*> \Orchestrations\PartyResolution</span><span class="sxs-lookup"><span data-stu-id="80c27-232">\<*Samples Path*>\Orchestrations\PartyResolution</span></span>  

2. <span data-ttu-id="80c27-233">執行檔案 Setup.bat，這會執行下列動作：</span><span class="sxs-lookup"><span data-stu-id="80c27-233">Run the file Setup.bat, which performs the following actions:</span></span>  

   - <span data-ttu-id="80c27-234">編譯此範例的 [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)] 專案，並部署產生的組件。</span><span class="sxs-lookup"><span data-stu-id="80c27-234">Compiles the [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)] projects for this sample, and deploys the resulting assemblies.</span></span>  

   - <span data-ttu-id="80c27-235">建立並繫結 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 傳送和接收埠。</span><span class="sxs-lookup"><span data-stu-id="80c27-235">Creates and binds the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] send and receive ports.</span></span>  

      <span data-ttu-id="80c27-236">在安裝過程中，您可能會收到下列或類似的警告。</span><span class="sxs-lookup"><span data-stu-id="80c27-236">You may receive the following or similar warnings during the setup process.</span></span> <span data-ttu-id="80c27-237">您可以安全地忽略這些警告。</span><span class="sxs-lookup"><span data-stu-id="80c27-237">You can safely ignore them.</span></span>  

     ```  
     "C:\Program Files\Microsoft BizTalk Server <version>\SDK\Samples\Orchestrations\PartyResolution\PartyResolution.sln" (Buildtarget) (1) ->  
     "C:\Program Files\Microsoft BizTalk Server <version>\SDK\Samples\Orchestrations\PartyResolution\Supplier\Supplier.btproj" (default target) (5) ->  
     "C:\Program Files\Microsoft BizTalk Server <version>\SDK\Samples\Orchestrations\PartyResolution\Supplier\Supplier.btproj" (default target) (5:2) ->  
     (CompileODX target) ->  
       C:\Program Files\Microsoft BizTalk Server <version>\SDK\Samples\Orchestrations\PartyResolution\Supplier\SupplierProcess.odx(831,13): warning X4014: convoy processing will not occur -- check your protocol if you were expecting it [C:\ProgramFiles\Microsoft BizTalk Server <version>\SDK\Samples\Orchestrations\PartyResolution\Supplier\Supplier.btproj]  
       C:\Program Files\Microsoft BizTalk Server <version>\SDK\Samples\Orchestrations\PartyResolution\Supplier\SupplierProcess.odx(841,13): warning X4014: convoy processing will not occur -- check your protocol if you were expecting it [C:\ProgramFiles\Microsoft BizTalk Server <version>\SDK\Samples\Orchestrations\PartyResolution\Supplier\Supplier.btproj]  

     ```  

3. <span data-ttu-id="80c27-238">開始**Visual Studio 命令提示字元**。</span><span class="sxs-lookup"><span data-stu-id="80c27-238">Start **Visual Studio Command Prompt**.</span></span>  

4. <span data-ttu-id="80c27-239">輸入下列命令將組件安裝到全域組件快取中：</span><span class="sxs-lookup"><span data-stu-id="80c27-239">Type the following commands to install the assemblies to the global assembly cache:</span></span>  

   - <span data-ttu-id="80c27-240">gacutil -i [!INCLUDE[btsBiztalkServerPath](../includes/btsbiztalkserverpath-md.md)]SDK\Samples\Orchestrations\PartyResolution\Schemas\bin\Release\schemas.dll</span><span class="sxs-lookup"><span data-stu-id="80c27-240">gacutil -i [!INCLUDE[btsBiztalkServerPath](../includes/btsbiztalkserverpath-md.md)]SDK\Samples\Orchestrations\PartyResolution\Schemas\bin\Release\schemas.dll</span></span>  

   - <span data-ttu-id="80c27-241">gacutil -i [!INCLUDE[btsBiztalkServerPath](../includes/btsbiztalkserverpath-md.md)]SDK\Samples\Orchestrations\PartyResolution\Pipeline\projectschema\bin\Release\ProjectSchema.dll</span><span class="sxs-lookup"><span data-stu-id="80c27-241">gacutil -i [!INCLUDE[btsBiztalkServerPath](../includes/btsbiztalkserverpath-md.md)]SDK\Samples\Orchestrations\PartyResolution\Pipeline\projectschema\bin\Release\ProjectSchema.dll</span></span>  

   - <span data-ttu-id="80c27-242">gacutil -i [!INCLUDE[btsBiztalkServerPath](../includes/btsbiztalkserverpath-md.md)]SDK\Samples\Orchestrations\PartyResolution\Buyer\bin\Release\Buyer.dll</span><span class="sxs-lookup"><span data-stu-id="80c27-242">gacutil -i [!INCLUDE[btsBiztalkServerPath](../includes/btsbiztalkserverpath-md.md)]SDK\Samples\Orchestrations\PartyResolution\Buyer\bin\Release\Buyer.dll</span></span>  

   - <span data-ttu-id="80c27-243">gacutil -i [!INCLUDE[btsBiztalkServerPath](../includes/btsbiztalkserverpath-md.md)]SDK\Samples\Orchestrations\PartyResolution\ShipmentAgency1\bin\Release\ShipmentAgency1.dll</span><span class="sxs-lookup"><span data-stu-id="80c27-243">gacutil -i [!INCLUDE[btsBiztalkServerPath](../includes/btsbiztalkserverpath-md.md)]SDK\Samples\Orchestrations\PartyResolution\ShipmentAgency1\bin\Release\ShipmentAgency1.dll</span></span>  

   - <span data-ttu-id="80c27-244">gacutil -i [!INCLUDE[btsBiztalkServerPath](../includes/btsbiztalkserverpath-md.md)]SDK\Samples\Orchestrations\PartyResolution\ShipmentAgency2\bin\Release\ShipmentAgency2.dll</span><span class="sxs-lookup"><span data-stu-id="80c27-244">gacutil -i [!INCLUDE[btsBiztalkServerPath](../includes/btsbiztalkserverpath-md.md)]SDK\Samples\Orchestrations\PartyResolution\ShipmentAgency2\bin\Release\ShipmentAgency2.dll</span></span>  

   - <span data-ttu-id="80c27-245">gacutil-i [!INCLUDE[btsBiztalkServerPath](../includes/btsbiztalkserverpath-md.md)]SDK\Samples\Orchestrations\PartyResolution\Supplier\bin\Release\Supplier.dll</span><span class="sxs-lookup"><span data-stu-id="80c27-245">gacutil -i [!INCLUDE[btsBiztalkServerPath](../includes/btsbiztalkserverpath-md.md)]SDK\Samples\Orchestrations\PartyResolution\Supplier\bin\Release\Supplier.dll</span></span>  

5. <span data-ttu-id="80c27-246">從「憑證授權單位」(CA) 取得安全的電子郵件憑證。</span><span class="sxs-lookup"><span data-stu-id="80c27-246">Obtain a secured e-mail certificate from a certificate authority (CA).</span></span> <span data-ttu-id="80c27-247">CA 可以是協力廠商授權單位或您組織中的授權單位。</span><span class="sxs-lookup"><span data-stu-id="80c27-247">The CA could be a third-party authority or the authority within your organization.</span></span> <span data-ttu-id="80c27-248">在您取得憑證後，請匯出公開金鑰和私密金鑰。</span><span class="sxs-lookup"><span data-stu-id="80c27-248">After you obtain the certificate, export the public key and private key.</span></span>  

6. <span data-ttu-id="80c27-249">若要私用的金鑰匯入至主控件執行個體的登入帳戶和公開金鑰至本機電腦其他人存放區的個人存放區中，執行下列作業：</span><span class="sxs-lookup"><span data-stu-id="80c27-249">To import the private key to the Personal store of the Host instance logon account and the public key to the Local Computer Other People store, do the following:</span></span>  

   1. <span data-ttu-id="80c27-250">在 [[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，展開 BizTalk 群組]，然後再展開**平台設定**。</span><span class="sxs-lookup"><span data-stu-id="80c27-250">In [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration Console, expand the BizTalk Group, and then expand **Platform Settings**.</span></span>  

   2. <span data-ttu-id="80c27-251">按一下 **主控件執行個體**並尋找顯示預設的內含式主控件執行個體的登入帳戶。</span><span class="sxs-lookup"><span data-stu-id="80c27-251">Click on **Host Instances** and find the Logon account shown for the default In-Process host instance.</span></span> <span data-ttu-id="80c27-252">在預設安裝中預設內含式主控件應命名為 [biztalkserverapplication]。</span><span class="sxs-lookup"><span data-stu-id="80c27-252">In a default installation the default In-Process host should be named BizTalkServerApplication.</span></span>  

   3. <span data-ttu-id="80c27-253">按一下 **[開始]**，然後按一下 **[執行]**。</span><span class="sxs-lookup"><span data-stu-id="80c27-253">Click **Start**, and then click **Run**.</span></span> <span data-ttu-id="80c27-254">在 **執行**方塊中，輸入**mmc.exe**，然後按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="80c27-254">In the **Run** box, type **mmc.exe**, and then click **OK**.</span></span> <span data-ttu-id="80c27-255">輸入主控件執行個體登入帳戶，若要開啟的 「 Microsoft Management Console (MMC) 」，該帳戶下的正確密碼。</span><span class="sxs-lookup"><span data-stu-id="80c27-255">Enter the correct password for the host instance logon account to open the Microsoft Management Console (MMC) under that account.</span></span>  

   4. <span data-ttu-id="80c27-256">在 [檔案] 功能表上，按一下 [新增/移除嵌入式管理單元]。</span><span class="sxs-lookup"><span data-stu-id="80c27-256">On the **File** menu, click **Add/Remove Snap-in**.</span></span>  

   5. <span data-ttu-id="80c27-257">在 **新增或移除嵌入式管理單元**對話方塊中，選取**憑證**，然後按一下**新增**。</span><span class="sxs-lookup"><span data-stu-id="80c27-257">In the **Add or Remove Snap-ins** dialog box, select **Certificates**, and then click **Add**.</span></span>  

   6. <span data-ttu-id="80c27-258">在 **憑證嵌入式管理單元**對話方塊中，選取**我的使用者帳戶**，然後按一下 **完成**。</span><span class="sxs-lookup"><span data-stu-id="80c27-258">In the **Certificates snap-in** dialog box, select **My user account**, and then click **Finish**.</span></span>  

   7. <span data-ttu-id="80c27-259">在 **新增或移除嵌入式管理單元**對話方塊中，選取**憑證**，然後按一下**新增**。</span><span class="sxs-lookup"><span data-stu-id="80c27-259">In the **Add or Remove Snap-ins** dialog box, select **Certificates**, and then click **Add**.</span></span>  

   8. <span data-ttu-id="80c27-260">在 **憑證嵌入式管理單元**對話方塊中，選取**電腦帳戶**，然後按一下 **下一步**。</span><span class="sxs-lookup"><span data-stu-id="80c27-260">In the **Certificates snap-in** dialog box, select **Computer account**, and then click **Next**.</span></span>  

   9. <span data-ttu-id="80c27-261">在 [**選取電腦**] 對話方塊中，選取**本機電腦**，然後按一下**完成**。</span><span class="sxs-lookup"><span data-stu-id="80c27-261">In the **Select Computer** dialog box, select **Local computer**, and then click **Finish**.</span></span>  

   10. <span data-ttu-id="80c27-262">在 [**新增或移除嵌入式管理單元**] 對話方塊中，按一下**確定**。</span><span class="sxs-lookup"><span data-stu-id="80c27-262">In the **Add or Remove Snap-ins** dialog box, click **OK**.</span></span>  

   11. <span data-ttu-id="80c27-263">依序展開**憑證-目前使用者**節點，然後展開**個人**。</span><span class="sxs-lookup"><span data-stu-id="80c27-263">Expand the **Certificates - Current User** node and then expand **Personal**.</span></span> <span data-ttu-id="80c27-264">以滑鼠右鍵按一下**憑證**，按一下**所有工作**，然後按一下**匯入**。</span><span class="sxs-lookup"><span data-stu-id="80c27-264">Right-click **Certificates**, click **All Tasks**, and then click **Import**.</span></span>  

   12. <span data-ttu-id="80c27-265">匯入的私密金鑰，並提供精靈中的密碼。</span><span class="sxs-lookup"><span data-stu-id="80c27-265">Import the private key and provide a password in the wizard.</span></span>  

   13. <span data-ttu-id="80c27-266">依序展開**Certificates (Local Computer)** 節點，然後展開**其他人**。</span><span class="sxs-lookup"><span data-stu-id="80c27-266">Expand the **Certificates (Local Computer)** node and then expand **Other People**.</span></span> <span data-ttu-id="80c27-267">以滑鼠右鍵按一下**憑證**，按一下**所有工作**，然後按一下**匯入**。</span><span class="sxs-lookup"><span data-stu-id="80c27-267">Right-click **Certificates**, click **All Tasks**, and then click **Import**.</span></span>  

   14. <span data-ttu-id="80c27-268">匯入公開金鑰。</span><span class="sxs-lookup"><span data-stu-id="80c27-268">Import the public key.</span></span>  

7. <span data-ttu-id="80c27-269">在 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，以滑鼠右鍵按一下**BizTalk 群組**節點，然後按一下**屬性**。</span><span class="sxs-lookup"><span data-stu-id="80c27-269">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, right-click the **BizTalk Group** node and then click **Properties**.</span></span> <span data-ttu-id="80c27-270">在  **BizTalk 群組-群組屬性**對話方塊中，選取**憑證**。</span><span class="sxs-lookup"><span data-stu-id="80c27-270">In the **BizTalk Group - Group Properties** dialog box, select **Certificate**.</span></span>  

8. <span data-ttu-id="80c27-271">在 [**憑證**] 對話方塊中，按一下**瀏覽**，然後選取您剛才匯入的私密金鑰。</span><span class="sxs-lookup"><span data-stu-id="80c27-271">In the **Certificate** dialog box, click **Browse** and select the private key you just imported.</span></span> <span data-ttu-id="80c27-272">此處指定的憑證用於簽章訊息。</span><span class="sxs-lookup"><span data-stu-id="80c27-272">The certificate specified here is used to sign the outbound message.</span></span> <span data-ttu-id="80c27-273">按一下 [確定] 。</span><span class="sxs-lookup"><span data-stu-id="80c27-273">Click **OK**.</span></span>  

9. <span data-ttu-id="80c27-274">若要更新 BuyerAgency 合作對象，在此範例中執行下列作業：</span><span class="sxs-lookup"><span data-stu-id="80c27-274">To update the BuyerAgency party in this sample do the following:</span></span>  

   1. <span data-ttu-id="80c27-275">在 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，選取**合作對象**。</span><span class="sxs-lookup"><span data-stu-id="80c27-275">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, select **Parties**.</span></span>  

   2. <span data-ttu-id="80c27-276">以滑鼠右鍵按一下**BuyerAgency** ，然後按一下**屬性**。</span><span class="sxs-lookup"><span data-stu-id="80c27-276">Right-click **BuyerAgency** and then click **Properties**.</span></span> <span data-ttu-id="80c27-277">在  **BuyerAgency-合作對象屬性**對話方塊中，選取**一般**。</span><span class="sxs-lookup"><span data-stu-id="80c27-277">In the **BuyerAgency - Party Properties** dialog box, select **General**.</span></span>  

   3. <span data-ttu-id="80c27-278">底下**別名**一節的對話方塊中，加入新的別名名稱與限定詞設定為**WindowsUser**。</span><span class="sxs-lookup"><span data-stu-id="80c27-278">Under the **Aliases** section of the dialog, add a new alias with the name and qualifier set to **WindowsUser**.</span></span> <span data-ttu-id="80c27-279">將值設定為 使用者名稱格式為\<網域 \ 使用者名稱 > (e.g.SOMEDOMAIN\someuser)。</span><span class="sxs-lookup"><span data-stu-id="80c27-279">Set the Value to a user name in format of \<domain\user name> (e.g. SOMEDOMAIN\someuser).</span></span>  

   4. <span data-ttu-id="80c27-280">選取 **憑證**，然後按一下**瀏覽**並選取您剛才匯入的公用金鑰。</span><span class="sxs-lookup"><span data-stu-id="80c27-280">Select **Certificate** and then click **Browse** and select the public key you just imported.</span></span> <span data-ttu-id="80c27-281">此處指定的憑證用於驗證輸入訊息的傳送者識別。</span><span class="sxs-lookup"><span data-stu-id="80c27-281">The certificate specified here is used to validate the sender identity of the inbound message.</span></span> <span data-ttu-id="80c27-282">按一下 [確定] 。</span><span class="sxs-lookup"><span data-stu-id="80c27-282">Click **OK**.</span></span>  

10. <span data-ttu-id="80c27-283">在 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，展開**平台設定**，然後選取**主機**。</span><span class="sxs-lookup"><span data-stu-id="80c27-283">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, expand **Platform Settings**, and then select **Hosts**.</span></span>  

11. <span data-ttu-id="80c27-284">以滑鼠右鍵按一下**BizTalkServerApplication** ，然後按一下**屬性**。</span><span class="sxs-lookup"><span data-stu-id="80c27-284">Right-click **BizTalkServerApplication** and then click **Properties**.</span></span> <span data-ttu-id="80c27-285">在  **BizTalkServerApplication-主控件屬性**對話方塊中，選取**憑證**。</span><span class="sxs-lookup"><span data-stu-id="80c27-285">In the **BizTalkServerApplication - Host Properties** dialog box, select **Certificates**.</span></span>  

12. <span data-ttu-id="80c27-286">按一下 **瀏覽**，然後選取您剛才匯入的私密金鑰。</span><span class="sxs-lookup"><span data-stu-id="80c27-286">Click **Browse** and select the private key you just imported.</span></span> <span data-ttu-id="80c27-287">此處指定的憑證用於解密輸入訊息。</span><span class="sxs-lookup"><span data-stu-id="80c27-287">The certificate specified here is used to decrypt the inbound messages.</span></span> <span data-ttu-id="80c27-288">按一下 [確定] 。</span><span class="sxs-lookup"><span data-stu-id="80c27-288">Click **OK**.</span></span>  

13. <span data-ttu-id="80c27-289">在 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台中，展開**平台設定**，然後選取**主控件執行個體**。</span><span class="sxs-lookup"><span data-stu-id="80c27-289">In the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console, expand **Platform Settings**, and then select **Host Instances**.</span></span>  

14. <span data-ttu-id="80c27-290">以滑鼠右鍵按一下**BizTalkServerApplication** ，然後按一下**重新啟動**。</span><span class="sxs-lookup"><span data-stu-id="80c27-290">Right-click **BizTalkServerApplication** and then click **Restart**.</span></span>  

## <a name="running-this-sample"></a><span data-ttu-id="80c27-291">執行此範例</span><span class="sxs-lookup"><span data-stu-id="80c27-291">Running This Sample</span></span>  

#### <a name="to-run-the-partyresolution-sample"></a><span data-ttu-id="80c27-292">執行 PartyResolution 範例</span><span class="sxs-lookup"><span data-stu-id="80c27-292">To run the PartyResolution sample</span></span>  

1.  <span data-ttu-id="80c27-293">執行下列資料夾中的 FilePolling.exe：</span><span class="sxs-lookup"><span data-stu-id="80c27-293">Run FilePolling.exe from the following folder:</span></span>  

     <span data-ttu-id="80c27-294">*\<範例路徑 >* \Orchestrations\PartyResolution\FilePolling\bin\Debug</span><span class="sxs-lookup"><span data-stu-id="80c27-294">*\<Samples Path>* \Orchestrations\PartyResolution\FilePolling\bin\Debug</span></span>  

2.  <span data-ttu-id="80c27-295">按一下 **啟動輪詢**。</span><span class="sxs-lookup"><span data-stu-id="80c27-295">Click **Start polling**.</span></span>  

3.  <span data-ttu-id="80c27-296">將提供的 PO 執行個體檔案 PurchaseOrder.xml 貼入下列資料夾中：</span><span class="sxs-lookup"><span data-stu-id="80c27-296">Paste a copy of the provided PO instance file, PurchaseOrder.xml, in the following folder:</span></span>  

     <span data-ttu-id="80c27-297">*\<範例路徑 >* \Orchestrations\PartyResolution\FileDrop\PurchaseOrder</span><span class="sxs-lookup"><span data-stu-id="80c27-297">*\<Samples Path>* \Orchestrations\PartyResolution\FileDrop\PurchaseOrder</span></span>  

4.  <span data-ttu-id="80c27-298">觀察一系列可讓您了解此範例進度的相關訊息 (以訊息方塊的形式提供)：</span><span class="sxs-lookup"><span data-stu-id="80c27-298">Observe the sequence of messages that are provided in the form of message boxes that keep you informed about the progress of the sample:</span></span>  

    1.  <span data-ttu-id="80c27-299">供應商何時接收來自買方的 PO。</span><span class="sxs-lookup"><span data-stu-id="80c27-299">When the supplier receives the PO from the buyer.</span></span>  

    2.  <span data-ttu-id="80c27-300">何時從託運商 1 或 2 收到出貨訂單要求。</span><span class="sxs-lookup"><span data-stu-id="80c27-300">When a shipment order request is received from shipment agency 1 or 2.</span></span>  

    3.  <span data-ttu-id="80c27-301">託運商 1 或 2 何時收到出貨建議。</span><span class="sxs-lookup"><span data-stu-id="80c27-301">When a shipment advice is received by shipment agency 1 or 2.</span></span>  

    4.  <span data-ttu-id="80c27-302">供應商何時將 PO 送達回條傳送到買方。</span><span class="sxs-lookup"><span data-stu-id="80c27-302">When the supplier sends the PO delivery receipt to the buyer.</span></span>  

5.  <span data-ttu-id="80c27-303">按一下 **結束**關閉檔案輪詢程式。</span><span class="sxs-lookup"><span data-stu-id="80c27-303">Click **Exit** to close the File Polling program.</span></span>  

> [!NOTE]
>  <span data-ttu-id="80c27-304">您可以將 PurchaseOrder.xml 中的「國家」標記編輯成「美國」，然後重複步驟 2 和步驟 3。</span><span class="sxs-lookup"><span data-stu-id="80c27-304">You can edit the Country tag in PurchaseOrder.xml to "US" and then repeat step 2 and step 3.</span></span> <span data-ttu-id="80c27-305">觀察出貨訂單現在是否傳送到託運商 2。</span><span class="sxs-lookup"><span data-stu-id="80c27-305">Observe that the shipment order is now sent to shipment agency 2.</span></span>  

## <a name="uninstalling-this-sample"></a><span data-ttu-id="80c27-306">解除安裝這個範例</span><span class="sxs-lookup"><span data-stu-id="80c27-306">Uninstalling This Sample</span></span>  

#### <a name="to-uninstall-the-partyresolution-sample"></a><span data-ttu-id="80c27-307">解除安裝 PartyResolution 範例</span><span class="sxs-lookup"><span data-stu-id="80c27-307">To uninstall the PartyResolution sample</span></span>  

1. <span data-ttu-id="80c27-308">在[!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)]命令提示字元，變更目錄 (**cd**) 來\<*範例路徑*> \Orchestrations\ PartyResolution\\。</span><span class="sxs-lookup"><span data-stu-id="80c27-308">At a [!INCLUDE[btsVStudioNoVersion](../includes/btsvstudionoversion-md.md)] command prompt, change directory (**cd**) to \<*Samples Path*>\Orchestrations\ PartyResolution\\.</span></span>  

2. <span data-ttu-id="80c27-309">執行 Cleanup.bat。</span><span class="sxs-lookup"><span data-stu-id="80c27-309">Run Cleanup.bat.</span></span>  

## <a name="see-also"></a><span data-ttu-id="80c27-310">另請參閱</span><span class="sxs-lookup"><span data-stu-id="80c27-310">See Also</span></span>  
 <span data-ttu-id="80c27-311">[合作對象解析管線元件](../core/party-resolution-pipeline-component.md) </span><span class="sxs-lookup"><span data-stu-id="80c27-311">[Party Resolution Pipeline Component](../core/party-resolution-pipeline-component.md) </span></span>  
 <span data-ttu-id="80c27-312">[如何設定 MIME SMIME 編碼器管線元件](../core/how-to-configure-the-mime-smime-encoder-pipeline-component.md) </span><span class="sxs-lookup"><span data-stu-id="80c27-312">[How to Configure the MIME-SMIME Encoder Pipeline Component](../core/how-to-configure-the-mime-smime-encoder-pipeline-component.md) </span></span>  
 <span data-ttu-id="80c27-313">[如何設定 MIME SMIME 解碼器管線元件](../core/how-to-configure-the-mime-smime-decoder-pipeline-component.md) </span><span class="sxs-lookup"><span data-stu-id="80c27-313">[How to Configure the MIME-SMIME Decoder Pipeline Component](../core/how-to-configure-the-mime-smime-decoder-pipeline-component.md) </span></span>  
 [<span data-ttu-id="80c27-314">協調流程 (BizTalk Server Samples 資料夾)</span><span class="sxs-lookup"><span data-stu-id="80c27-314">Orchestrations (BizTalk Server Samples Folder)</span></span>](../core/orchestrations-biztalk-server-samples-folder.md)