---
title: "考量使用 WCF 服務使用 WCF 傳送配接器 |Microsoft 文件"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- consuming, WCF services
- best practices, WCF services
- WCF services, best practices
- consuming, best practices
- WCF services, consuming
ms.assetid: 8bbcfd99-3495-458d-bd7a-6d170a29dde2
caps.latest.revision: "17"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: b2bb1e512b8a13c3d91b87bbfc410c3d21f334fb
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
---
# <a name="considerations-when-consuming-wcf-services-with-the-wcf-send-adapters"></a><span data-ttu-id="f9834-102">利用 WCF 傳送配接器使用 WCF 服務的考量</span><span class="sxs-lookup"><span data-stu-id="f9834-102">Considerations When Consuming WCF Services with the WCF Send Adapters</span></span>
<span data-ttu-id="f9834-103">本主題提供您利用 WCF 配接器使用 Web 服務時應該納入之考量的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="f9834-103">This topic provides information that you should take into consideration when consuming WCF services with the WCF adapters.</span></span>  
  
## <a name="use-the-template----content-specified-by-template-option-when-sending-non-xml-content-as-solicit-messages"></a><span data-ttu-id="f9834-104">傳送非 XML 內容為請求訊息時，使用範本 -- 由範本指定的內容選項</span><span class="sxs-lookup"><span data-stu-id="f9834-104">Use the "Template -- content specified by template" option when sending non-XML content as solicit messages</span></span>  
 <span data-ttu-id="f9834-105">WCF 配接器與**內文--BizTalk 回應訊息內文**（預設值） 選項不允許傳送非 XML 訊息，例如字元資料和點陣圖影像。</span><span class="sxs-lookup"><span data-stu-id="f9834-105">The WCF adapters with **Body -- BizTalk response message body** (the default value) option do not allow sending non-XML message such as character data and bitmap images.</span></span> <span data-ttu-id="f9834-106">您可以使用**範本--由範本指定內容**WCF 配接器傳送非 XML 訊息的選項。</span><span class="sxs-lookup"><span data-stu-id="f9834-106">You can use the **Template -- content specified by template** option for the WCF adapters to send non-XML messages.</span></span> <span data-ttu-id="f9834-107">如需如何使用範本的詳細資訊，請參閱[考量時發佈 WCF 服務使用 WCF 接收配接器](../core/considerations-when-publishing-wcf-services-with-the-wcf-receive-adapters.md)。</span><span class="sxs-lookup"><span data-stu-id="f9834-107">For more information about how to use the template, see [Considerations When Publishing WCF Services with the WCF Receive Adapters](../core/considerations-when-publishing-wcf-services-with-the-wcf-receive-adapters.md).</span></span>  
  
## <a name="the-wcf-basichttp-and-wcf-wshttp-send-ports-always-ignore-the-proxy-if-the-service-address-begins-with-httplocalhost"></a><span data-ttu-id="f9834-108">若服務位址開頭為 http://localhost，WCF-BasicHttp 和 WCF-WSHttp 傳送埠永遠會略過 Proxy</span><span class="sxs-lookup"><span data-stu-id="f9834-108">The WCF-BasicHttp and WCF-WSHttp send ports always ignore the proxy if the service address begins with http://localhost</span></span>  
 <span data-ttu-id="f9834-109">Wcf-basichttp 和 Wcf-wshttp 傳送埠永遠略過 proxy，如果服務位址是以 http://localhost 開頭，無論 proxy 設定在**Proxy**的傳送埠 索引標籤或**Proxy**  索引標籤傳送處理常式。</span><span class="sxs-lookup"><span data-stu-id="f9834-109">The WCF-BasicHttp and WCF-WSHttp send ports always ignore the proxy if the service address begins with http://localhost whether the proxy is configured on the **Proxy** tab of the send port or the **Proxy** tab of the send handler.</span></span> <span data-ttu-id="f9834-110">若您希望用戶端與同一部電腦的服務進行通訊時是透過 Proxy，就應該使用主控件名稱 (不要使用 localhost)。</span><span class="sxs-lookup"><span data-stu-id="f9834-110">You should use the host name (rather than localhost) if you want clients to go through a proxy when talking to services on the same computer.</span></span>  
  
## <a name="the-wcf-basichttp-and-wcf-wshttp-send-adapters-suspend-the-messages-if-the-proxy-setting-is-not-correctly-configured"></a><span data-ttu-id="f9834-111">若 Proxy 設定不正確，WCF-BasicHttp 和 WCF-WSHttp 傳送配接器會擱置訊息</span><span class="sxs-lookup"><span data-stu-id="f9834-111">The WCF-BasicHttp and WCF-WSHttp send adapters suspend the messages if the proxy setting is not correctly configured</span></span>  
 <span data-ttu-id="f9834-112">您可以指定的 proxy 設定 Wcf-basichttp 和 Wcf-wshttp 傳送配接器**Proxy**的傳送埠 索引標籤或**Proxy**傳送處理常式 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="f9834-112">You can specify the proxy setting for the WCF-BasicHttp and WCF-WSHttp send adapters on the **Proxy** tab of the send port or the **Proxy** tab of the send handler.</span></span> <span data-ttu-id="f9834-113">若 Proxy 設定不正確，WCF 配接器會擱置訊息，而且事件日誌會接收到錯誤訊息「沒有任何接聽的端點可以接受該訊息」。</span><span class="sxs-lookup"><span data-stu-id="f9834-113">If this proxy setting is not correctly configured, the WCF adapters suspend the messages, and you receive the "There was no endpoint listening that could accept the message" error message in the event log.</span></span>  
  
## <a name="setting-up-the-permissions-for-a-wcf-send-port-with-the-wcf-netmsmq-adapter"></a><span data-ttu-id="f9834-114">設定具 WCF-NetMsmq 配接器之 WCF 傳送埠的權限</span><span class="sxs-lookup"><span data-stu-id="f9834-114">Setting up the permissions for a WCF send port with the WCF-NetMsmq adapter</span></span>  
 <span data-ttu-id="f9834-115">當具 WCF-NetMsmq 配接器的 WCF 傳送埠傳送訊息至使用 NetMsmqBinding 所發佈的 WCF 服務時，會將訊息定址至目標佇列 (由服務佇列管理員管理的佇列)。</span><span class="sxs-lookup"><span data-stu-id="f9834-115">When a WCF send port with the WCF-NetMsmq adapter sends a message to a WCF service published with the NetMsmqBinding, it addresses the message to the target queue, which is the queue managed by the service's queue manager.</span></span> <span data-ttu-id="f9834-116">用戶端的佇列管理員會將訊息傳送至傳輸 (或外寄) 佇列。</span><span class="sxs-lookup"><span data-stu-id="f9834-116">The queue manager on the client sends the message to a transmission (or outgoing) queue.</span></span> <span data-ttu-id="f9834-117">傳輸佇列是用戶端的佇列管理員，會儲存傳輸至目標佇列的訊息。</span><span class="sxs-lookup"><span data-stu-id="f9834-117">The transmission queue is a queue on the client-side queue manager that stores messages for transmission to the target queue.</span></span>  
  
 <span data-ttu-id="f9834-118">針對定址至服務之所有目標佇列的訊息，服務的佇列管理員會接受並加以儲存。</span><span class="sxs-lookup"><span data-stu-id="f9834-118">The service's queue manager accepts messages addressed to the target queues it owns and stores the messages.</span></span> <span data-ttu-id="f9834-119">接著，服務會要求讀取目標佇列，佇列管理員再將訊息傳遞至服務。</span><span class="sxs-lookup"><span data-stu-id="f9834-119">Then, the service makes requests to read from the target queue, and the queue manager delivers the messages to the service.</span></span> <span data-ttu-id="f9834-120">因此，裝載傳送埠的 BizTalk 主控件執行個體服務帳戶，應擁有寫入傳輸佇列的權限。</span><span class="sxs-lookup"><span data-stu-id="f9834-120">For this reason, the service account for the BizTalk host instance hosting the send port should have the permissions to write on the transmission queue.</span></span>  
  
## <a name="use-an-empty-xpath-expression-to-receive-a-soap-message-with-character-data-in-the-content-of-the-soap-body-element"></a><span data-ttu-id="f9834-121">使用空 XPath 運算式接收 SOAP 訊息，其 SOAP Body 項目內容中含字元資料</span><span class="sxs-lookup"><span data-stu-id="f9834-121">Use an empty XPath expression to receive a SOAP message with character data in the content of the SOAP Body element</span></span>  
 <span data-ttu-id="f9834-122">請求-回應 WCF 傳送埠可接收 WCF 訊息做為回應訊息。</span><span class="sxs-lookup"><span data-stu-id="f9834-122">The solicit-response WCF send port can receive a WCF message as a response message.</span></span> <span data-ttu-id="f9834-123">若要建立 BizTalk 訊息內送回應訊息的 soap 內容中含字元資料從**主體**如下列範例所示的項目，您應該保留**XPath 運算式**文字方塊空的**訊息**WCF 配接器傳輸屬性對話方塊中的索引標籤。</span><span class="sxs-lookup"><span data-stu-id="f9834-123">To create a BizTalk message from an incoming response message with character data in the content of the SOAP **Body** element as shown in the following example, you should leave the **XPath expression** text box empty on the **Message** tab in the WCF adapter transport properties dialog box.</span></span>  
  
```  
<s:Envelope xmlns:s="http://www.w3.org/2003/05/soap-envelope" xmlns:a="http://www.w3.org/2005/08/addressing">  
    <s:Header>  
      ...  
    </s:Header>  
    <s:Body>Contoso</s:Body>  
</s:Envelope>  
```  
  
 <span data-ttu-id="f9834-124">如果您選取**信封**或**主體**選項，配接器不會建立 BizTalk 訊息的內送訊息。</span><span class="sxs-lookup"><span data-stu-id="f9834-124">If you select the **Envelope** or **Body** option, the adapter does not create the BizTalk message from the incoming message.</span></span> <span data-ttu-id="f9834-125">訊息不會遭擱置，因為輸入 SOAP 封送處理時失敗的訊息不會遭擱置。</span><span class="sxs-lookup"><span data-stu-id="f9834-125">The message is not suspended because messages that fail in the inbound SOAP marshaling processing are not suspended.</span></span> <span data-ttu-id="f9834-126">如需有關如何使用 XPath 運算式，在**訊息**索引標籤上，請參閱[指定 WCF 配接器的訊息本文](../core/specifying-the-message-body-for-the-wcf-adapters.md)。</span><span class="sxs-lookup"><span data-stu-id="f9834-126">For more information about how to use the XPath expression on the **Message** tab, see [Specifying the Message Body for the WCF Adapters](../core/specifying-the-message-body-for-the-wcf-adapters.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f9834-127">設定 BTSNTSvc.exe.config. 檔，即可使用 Windows SDK 內的 TraceViewer 工具 (SvcTraceViewer.exe)。</span><span class="sxs-lookup"><span data-stu-id="f9834-127">You can use the TraceViewer tool (SvcTraceViewer.exe) in the Windows SDK by configuring the BTSNTSvc.exe.config.file.</span></span> <span data-ttu-id="f9834-128">如需 Windows SDK 的詳細資訊，請參閱 < 什麼是 Windows SDK 中的 新增 >，網址[http://go.microsoft.com/fwlink/?LinkId=75219](http://go.microsoft.com/fwlink/?LinkId=75219)。</span><span class="sxs-lookup"><span data-stu-id="f9834-128">For more information about the Windows SDK, see "What's New in the Windows SDK" at [http://go.microsoft.com/fwlink/?LinkId=75219](http://go.microsoft.com/fwlink/?LinkId=75219).</span></span> <span data-ttu-id="f9834-129">TraceViewer 工具的詳細資訊，請參閱 < TraceViewer 工具 (SvcTraceViewer.exe) >，網址[http://go.microsoft.com/fwlink/?LinkId=75218](http://go.microsoft.com/fwlink/?LinkId=75218)。</span><span class="sxs-lookup"><span data-stu-id="f9834-129">For more information about the TraceViewer tool, see "TraceViewer Tool (SvcTraceViewer.exe)" at [http://go.microsoft.com/fwlink/?LinkId=75218](http://go.microsoft.com/fwlink/?LinkId=75218).</span></span>  
  
## <a name="biztalk-server-does-not-use-multi-part-message-types-and-root-elements-describing-custom-soap-headers"></a><span data-ttu-id="f9834-130">BizTalk Server 不使用多部分訊息類型和描述自訂 SOAP 標頭的根項目</span><span class="sxs-lookup"><span data-stu-id="f9834-130">BizTalk Server does not use multi-part message types and root elements describing custom SOAP headers</span></span>  
 <span data-ttu-id="f9834-131">若您對中繼資料執行 [BizTalk WCF 服務使用精靈]，而其中的自訂 SOAP 標頭已定義，精靈會在產生的結構描述中產生根項目，代表自訂 SOAP 標頭。</span><span class="sxs-lookup"><span data-stu-id="f9834-131">If you run the BizTalk WCF service Consuming Wizard against metadata where custom SOAP headers are defined, the wizard generates root elements in the generated schemas to represent the custom SOAP headers.</span></span> <span data-ttu-id="f9834-132">精靈也會為自訂 SOAP 標頭在協調流程中建立多部分訊息類型。</span><span class="sxs-lookup"><span data-stu-id="f9834-132">The wizard also creates multi-part message types in orchestrations for the custom SOAP headers.</span></span> <span data-ttu-id="f9834-133">BizTalk Server。</span><span class="sxs-lookup"><span data-stu-id="f9834-133">BizTalk Server.</span></span> <span data-ttu-id="f9834-134">然而，BizTalk Server 不使用多部分訊息類型和根項目來處理自訂 SOAP 標頭。</span><span class="sxs-lookup"><span data-stu-id="f9834-134">However, BizTalk Server does not use multi-part message types and root elements to handle the custom SOAP headers.</span></span>  
  
 <span data-ttu-id="f9834-135">若要存取自訂 SOAP 標頭，您應該使用**InboundHeaders**屬性。</span><span class="sxs-lookup"><span data-stu-id="f9834-135">To access custom SOAP headers, you should use the **InboundHeaders** property.</span></span> <span data-ttu-id="f9834-136">如需接收自訂 SOAP 標頭的詳細資訊，請參閱[SOAP 標頭與已發佈 WCF 服務](../core/soap-headers-with-published-wcf-services.md)。</span><span class="sxs-lookup"><span data-stu-id="f9834-136">For more information about receiving custom SOAP headers, see [SOAP Headers with Published WCF Services](../core/soap-headers-with-published-wcf-services.md).</span></span> <span data-ttu-id="f9834-137">若要使用自訂 SOAP 標頭，您應該使用**OutboundCustomHeaders**屬性。</span><span class="sxs-lookup"><span data-stu-id="f9834-137">To use custom SOAP headers, you should use the **OutboundCustomHeaders** property.</span></span> <span data-ttu-id="f9834-138">如需傳送自訂 SOAP 標頭的詳細資訊，請參閱[取用 WCF 服務使用的 SOAP 標頭](../core/soap-headers-with-consumed-wcf-services.md)。</span><span class="sxs-lookup"><span data-stu-id="f9834-138">For more information about sending custom SOAP headers, see [SOAP Headers with Consumed WCF Services](../core/soap-headers-with-consumed-wcf-services.md).</span></span>  
  
## <a name="create-separate-host-instances-for-send-ports-that-use-different-proxy-addresses-andor-proxy-credentials"></a><span data-ttu-id="f9834-139">為使用不同 Proxy 位址和/或 Proxy 認證的傳送埠，建立個別的主控件執行個體</span><span class="sxs-lookup"><span data-stu-id="f9834-139">Create separate host instances for send ports that use different proxy addresses and/or proxy credentials</span></span>  
 <span data-ttu-id="f9834-140">若要讓 WCF 傳送配接器達到可能的最佳效能，建議您為使用不同 Proxy 位址和/或 Proxy 認證的傳送埠，建立個別的主控件執行個體。</span><span class="sxs-lookup"><span data-stu-id="f9834-140">To achieve the best possible performance for WCF send adapters, we recommend that you create separate host instances for send ports that use different proxy addresses and/or proxy credentials.</span></span> <span data-ttu-id="f9834-141">如此可避免爭用 Proxy 設定。</span><span class="sxs-lookup"><span data-stu-id="f9834-141">This avoids contention on proxy settings.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f9834-142">另請參閱</span><span class="sxs-lookup"><span data-stu-id="f9834-142">See Also</span></span>  
 [<span data-ttu-id="f9834-143">BTSNTSvc.exe.config 檔案</span><span class="sxs-lookup"><span data-stu-id="f9834-143">BTSNTSvc.exe.config File</span></span>](../core/btsntsvc-exe-config-file.md)