---
title: BizTalk Server 如何實作主控件節流 |Microsoft Docs
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- host throttling, rate based throttling
- host throttling, outbound
- host throttling, algorithm
- host throttling, components
- host throttling, inbound
- host throttling, resource based throttling
- host throttling, user controlled throttling
- host throttling, strategies
ms.assetid: 46d3c3de-66b9-4c8a-8369-e68563fc9c40
caps.latest.revision: 27
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: f29fc1021b28a0a0eacfa9d7140483e1a287f238
ms.sourcegitcommit: 266308ec5c6a9d8d80ff298ee6051b4843c5d626
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/27/2018
ms.locfileid: "36998303"
---
# <a name="how-biztalk-server-implements-host-throttling"></a><span data-ttu-id="59a4a-102">BizTalk Server 如何實作主控件節流</span><span class="sxs-lookup"><span data-stu-id="59a4a-102">How BizTalk Server Implements Host Throttling</span></span>
<span data-ttu-id="59a4a-103">[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 主控件節流機制可持續監控節流狀況、計算節流狀況的嚴重性，然後根據計算的嚴重性逐步套用主控件節流。</span><span class="sxs-lookup"><span data-stu-id="59a4a-103">The [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] host throttling mechanism continually monitors for a throttling condition, calculates the severity of the throttling condition, and applies host throttling progressively depending on the calculated severity.</span></span> <span data-ttu-id="59a4a-104">節流機制會自行調整而且預設的設定選項適用於大部分的[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]處理案例。</span><span class="sxs-lookup"><span data-stu-id="59a4a-104">The throttling mechanism is self tuning and the default configuration options are suitable for the majority of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] processing scenarios.</span></span> [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="59a4a-105"> 主控件節流會公開數個可設定的選項可用來微調特定案例的節流。</span><span class="sxs-lookup"><span data-stu-id="59a4a-105"> host throttling exposes several configurable options that can be used to tune throttling for specific scenarios.</span></span> <span data-ttu-id="59a4a-106">如需變更這些組態選項的詳細資訊，請參閱 <<c0> [ 如何修改主控件設定](../core/how-to-modify-host-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="59a4a-106">For information about changing these configuration options, see [How to Modify Host Settings](../core/how-to-modify-host-settings.md).</span></span>  

## <a name="components-of-the-host-throttling-algorithm"></a><span data-ttu-id="59a4a-107">主控件節流演算法的元件</span><span class="sxs-lookup"><span data-stu-id="59a4a-107">Components of the host throttling algorithm</span></span>  
 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="59a4a-108"> 在套用主控件節流時會使用下列演算法：</span><span class="sxs-lookup"><span data-stu-id="59a4a-108"> uses the following algorithm when applying host throttling:</span></span>  

1.  <span data-ttu-id="59a4a-109">持續監控下列參數，以查看其是否超過特定的閾值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-109">Continuously monitor the following parameters to see if they exceed certain thresholds.</span></span> <span data-ttu-id="59a4a-110">若參數值超過參數的閾值，則節流狀況就會存在。</span><span class="sxs-lookup"><span data-stu-id="59a4a-110">If the values for the parameter exceed the threshold for the parameter then a throttling condition exists.</span></span>  

    -   <span data-ttu-id="59a4a-111">使用中的記憶體數量 (全系統與主控件程序記憶體)。</span><span class="sxs-lookup"><span data-stu-id="59a4a-111">Amount of memory in use (both systemwide and host process memory).</span></span>  

    -   <span data-ttu-id="59a4a-112">已傳遞或已處理之內含式訊息的數目 (輸出節流的閾值)。</span><span class="sxs-lookup"><span data-stu-id="59a4a-112">Number of in-process messages being delivered or processed (threshold for outbound throttling).</span></span>  

    -   <span data-ttu-id="59a4a-113">使用中的執行緒數目。</span><span class="sxs-lookup"><span data-stu-id="59a4a-113">Number of threads in use.</span></span>  

    -   <span data-ttu-id="59a4a-114">資料庫大小，以所有主控件之佇列表格中的項目個數及多工緩衝處理與追蹤表格中的項目個數來計量。</span><span class="sxs-lookup"><span data-stu-id="59a4a-114">Database size, measured by the number of items in the queue tables for all hosts and the number of items in the spool and tracking tables.</span></span>  

    -   <span data-ttu-id="59a4a-115">並行資料庫連線的數目。</span><span class="sxs-lookup"><span data-stu-id="59a4a-115">Number of concurrent database connections.</span></span>  

    -   <span data-ttu-id="59a4a-116">訊息發佈 (輸入) 與傳遞或處理 (輸出) 的速率。</span><span class="sxs-lookup"><span data-stu-id="59a4a-116">Rate of message publishing (inbound) and delivery or processing (outbound).</span></span>  

2.  <span data-ttu-id="59a4a-117">決定節流狀況的嚴重性。</span><span class="sxs-lookup"><span data-stu-id="59a4a-117">Determine the severity of the throttling condition.</span></span> <span data-ttu-id="59a4a-118">節流狀況會以下列方式來區分嚴重性層級 (從最嚴重到最不嚴重)。</span><span class="sxs-lookup"><span data-stu-id="59a4a-118">Throttling conditions are ranked in severity as follows (from most severe to least severe).</span></span>  

    -   <span data-ttu-id="59a4a-119">使用中的主控件程序記憶體超過閾值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-119">Host process memory in use exceeds threshold.</span></span>  

    -   <span data-ttu-id="59a4a-120">內含式訊息數目超過閾值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-120">Number of in-process messages exceeds threshold.</span></span>  

    -   <span data-ttu-id="59a4a-121">使用中的執行緒計數超過閾值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-121">Count of threads in use exceeds threshold.</span></span>  

    -   <span data-ttu-id="59a4a-122">資料庫大小超過閾值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-122">Database size exceeds threshold.</span></span>  

    -   <span data-ttu-id="59a4a-123">所有其他節流狀況。</span><span class="sxs-lookup"><span data-stu-id="59a4a-123">All other throttling conditions.</span></span>  

3.  <span data-ttu-id="59a4a-124">依節流狀況的嚴重性逐步套用節流。</span><span class="sxs-lookup"><span data-stu-id="59a4a-124">Progressively apply throttling based upon the severity of the throttling condition(s).</span></span> <span data-ttu-id="59a4a-125">當嚴重性層級增加時，可以更積極地套用節流。</span><span class="sxs-lookup"><span data-stu-id="59a4a-125">Throttling is applied more aggressively as the severity level increases.</span></span> <span data-ttu-id="59a4a-126">漸進式節流可以下列方式來達成：</span><span class="sxs-lookup"><span data-stu-id="59a4a-126">Progressive throttling is achieved as follows:</span></span>  

    -   <span data-ttu-id="59a4a-127">偵測到一或多個節流狀況並指派其嚴重性。</span><span class="sxs-lookup"><span data-stu-id="59a4a-127">One or more throttling conditions are detected and assigned a severity.</span></span>  

    -   <span data-ttu-id="59a4a-128">根據嚴重性層級最高的狀況發出實作節流的指示。</span><span class="sxs-lookup"><span data-stu-id="59a4a-128">An instruction to implement throttling is issued based on the condition with the highest severity.</span></span> <span data-ttu-id="59a4a-129">根據節流狀況，若此狀況持續存在，則各種執行緒集區的大小可能會減少，並藉由凍結執行中的協調流程來釋放記憶體。</span><span class="sxs-lookup"><span data-stu-id="59a4a-129">Depending on the throttling condition, if the condition persists, the size of various thread pools may be reduced and memory may be freed by dehydrating running orchestrations.</span></span>  

    -   <span data-ttu-id="59a4a-130">根據訊息為輸入或輸出訊息，以決定要在發佈或處理訊息時套用延遲。</span><span class="sxs-lookup"><span data-stu-id="59a4a-130">A delay is applied in the publishing or processing of the message, depending on whether the message is inbound or outbound.</span></span> <span data-ttu-id="59a4a-131">延遲期間會與節流狀況的嚴重性成正比，因此，層級較高的嚴重性節流狀況將比層級較低的嚴重性節流狀況初始化更長的節流期間。</span><span class="sxs-lookup"><span data-stu-id="59a4a-131">The delay period is proportional to the severity of the throttling condition, so higher severity throttling conditions will initiate a longer throttling period than lower severity throttling conditions.</span></span> <span data-ttu-id="59a4a-132">透過狀況變更時的節流機制，這個延遲期間可在特定範圍內上下調整。</span><span class="sxs-lookup"><span data-stu-id="59a4a-132">This delay period is adjusted up and down within certain ranges by the throttling mechanism as conditions change.</span></span> <span data-ttu-id="59a4a-133">目前的延遲期間透過公開**訊息傳遞延遲 (ms)** 並**訊息發佈延遲 （毫秒）** 相關聯的效能計數器**biztalk： 訊息代理程式**效能物件類別。</span><span class="sxs-lookup"><span data-stu-id="59a4a-133">The current delay period is exposed through the **Message delivery delay (ms)** and the **Message publishing delay (ms)** performance counters associated with the **BizTalk:Message Agent** performance object category.</span></span> <span data-ttu-id="59a4a-134">這些效能物件計數器會記錄在主題[主控件節流效能計數器](../core/host-throttling-performance-counters.md)。</span><span class="sxs-lookup"><span data-stu-id="59a4a-134">These performance object counters are documented in the topic [Host Throttling Performance Counters](../core/host-throttling-performance-counters.md).</span></span>  

    -   <span data-ttu-id="59a4a-135">節流機制會繼續檢查節流狀況是否存在。</span><span class="sxs-lookup"><span data-stu-id="59a4a-135">The throttling mechanism continues to check if a throttling condition is present.</span></span> <span data-ttu-id="59a4a-136">若節流狀況已移轉，則會解除封鎖已節流的訊息，並允許執行緒集區與其他資源在不受限制的模式下運作。</span><span class="sxs-lookup"><span data-stu-id="59a4a-136">If the throttling conditions are mitigated then the throttled messages are unblocked and the thread pool and other resources are allowed to operate in an unrestricted mode.</span></span> <span data-ttu-id="59a4a-137">若系統繼續操作且沒有任何節流狀況，則延遲期間會大為降低。</span><span class="sxs-lookup"><span data-stu-id="59a4a-137">If the system continues to operate without any throttling conditions, the delay period is greatly reduced.</span></span> <span data-ttu-id="59a4a-138">若節流狀況持續存在，則延遲數量會漸增且與狀況的嚴重性成正比，而後續訊息會受到更高的延遲。</span><span class="sxs-lookup"><span data-stu-id="59a4a-138">If the throttling condition persists, the delay amount is incremented proportional to the severity of the condition and subsequent messages are subject to the higher delay.</span></span>  

    -   <span data-ttu-id="59a4a-139">當延遲期間過後，就不再實作節流。</span><span class="sxs-lookup"><span data-stu-id="59a4a-139">Throttling is no longer implemented when the delay period has elapsed.</span></span>  

## <a name="type-of-throttling-conditions"></a><span data-ttu-id="59a4a-140">節流狀況的類型</span><span class="sxs-lookup"><span data-stu-id="59a4a-140">Type of throttling conditions</span></span>  
 <span data-ttu-id="59a4a-141">有的節流條件的三種主要類型： 速率型、 資源型和協調流程。</span><span class="sxs-lookup"><span data-stu-id="59a4a-141">There are three primary types of throttling conditions: rate based, resource based, and orchestration.</span></span>  

1. <span data-ttu-id="59a4a-142">**根據速率的節流**分為兩類; （已發佈） 的輸入和輸出 （已傳遞）：</span><span class="sxs-lookup"><span data-stu-id="59a4a-142">**Rate based throttling** is divided into two categories; inbound (published) and outbound (delivered):</span></span>  

   - <span data-ttu-id="59a4a-143">對於輸入 （已發佈） 訊息，BizTalk Server 會調整訊息發佈如果**訊息發佈內送速率**主控件執行個體超過**訊息發佈外寄速率\\**\* 指定**速率增加因數 （百分比）** 值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-143">For inbound (published) messages, BizTalk Server throttles publishing of messages if The **Message publishing incoming rate** for the host instance exceeds the **Message publishing outgoing rate\\**\* the specified **Rate overdrive factor (percent)** value.</span></span> <span data-ttu-id="59a4a-144">**速率增加因數 （百分比）** 參數是可在設定**訊息發佈節流設定** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="59a4a-144">The **Rate overdrive factor (percent)** parameter is configurable on the **Message Publishing Throttling Settings** dialog box.</span></span> <span data-ttu-id="59a4a-145">輸入訊息之根據速率的節流，主要是藉由在將訊息批次發佈至 MessageBox 資料庫之前引發延遲來完成。</span><span class="sxs-lookup"><span data-stu-id="59a4a-145">Rate based throttling for inbound messages is accomplished primarily by inducing a delay before publishing the batch of messages into the MessageBox database.</span></span> <span data-ttu-id="59a4a-146">不必採取其他動作，就能完成輸入訊息之根據速率的節流。</span><span class="sxs-lookup"><span data-stu-id="59a4a-146">No other action is taken to accomplish rate based throttling for inbound messages.</span></span>  

   - <span data-ttu-id="59a4a-147">對於輸出 （已傳遞） 訊息，BizTalk Server 會調整訊息的傳遞如果**訊息傳遞內送速率**主控件執行個體超過**訊息傳遞外寄速率** \*指定**速率增加因數 （百分比）** 值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-147">For outbound (delivered) messages, BizTalk Server throttles delivery of messages if The **Message delivery incoming rate** for the host instance exceeds the **Message delivery outgoing rate** \* the specified **Rate overdrive factor (percent)** value.</span></span> <span data-ttu-id="59a4a-148">**速率增加因數 （百分比）** 參數是可在設定**訊息處理節流設定** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="59a4a-148">The **Rate overdrive factor (percent)** parameter is configurable on the **Message Processing Throttling Settings** dialog box.</span></span> <span data-ttu-id="59a4a-149">輸出訊息之根據速率的節流，主要是藉由在從記憶體中佇列移除訊息並將訊息傳遞至「結束點管理員」(EPM) 或協調流程引擎以進行處理之前，引發延遲來完成。</span><span class="sxs-lookup"><span data-stu-id="59a4a-149">Rate based throttling for outbound messages is accomplished primarily by inducing a delay before removing the messages from the in-memory queue and delivering the messages to the End Point Manager (EPM) or orchestration engine for processing.</span></span> <span data-ttu-id="59a4a-150">不必採取其他動作，就能完成輸出訊息之根據速率的節流。</span><span class="sxs-lookup"><span data-stu-id="59a4a-150">No other action is taken to accomplish rate based throttling for outbound messages.</span></span>  

      <span data-ttu-id="59a4a-151">如需速率增加因數及其他速率型節流值的詳細資訊，請參閱[如何修改速率型節流設定](../core/how-to-modify-rate-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="59a4a-151">For more information about the rate overdrive factor and other rate-based throttling values, see [How to Modify Rate Based Throttling Settings](../core/how-to-modify-rate-based-throttling-settings.md).</span></span>  

2. <span data-ttu-id="59a4a-152">**根據資源的節流**監視系統資源，例如執行緒、 記憶體和資料庫大小，而且可以套用至任何服務類別。</span><span class="sxs-lookup"><span data-stu-id="59a4a-152">**Resource based throttling** monitors system resources such as threads, memory, and database size and can be applied to any service class.</span></span> <span data-ttu-id="59a4a-153">如需資源型節流值的詳細資訊，請參閱[如何修改資源型節流設定](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="59a4a-153">For more information about resource-based throttling values, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>  

3. <span data-ttu-id="59a4a-154">**協調流程節流**可避免凍結以及暫停/繼續訂用帳戶的時機。</span><span class="sxs-lookup"><span data-stu-id="59a4a-154">**Orchestration throttling** can prevent dehydration and when to pause/resume subscriptions.</span></span> <span data-ttu-id="59a4a-155">如需有關協調流程節流值的詳細資訊，請參閱[如何修改協調流程節流設定](../core/how-to-modify-orchestration-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="59a4a-155">For more information about orchestration throttling values, see [How to Modify Orchestration Throttling Settings](../core/how-to-modify-orchestration-throttling-settings.md).</span></span>  

## <a name="throttling-condition-triggers-actions-and-mitigation-strategies"></a><span data-ttu-id="59a4a-156">節流狀況觸發程序、動作，以及移轉策略</span><span class="sxs-lookup"><span data-stu-id="59a4a-156">Throttling condition triggers, actions, and mitigation strategies</span></span>  
 <span data-ttu-id="59a4a-157">本節描述各種節流狀況的觸發程序、節流機制所產生的動作，以及可用來移轉節流狀況的技術。</span><span class="sxs-lookup"><span data-stu-id="59a4a-157">This section describes the triggers for various throttling conditions, the resultant actions by the throttling mechanism, and techniques that may be employed to mitigate the throttling condition.</span></span>  

### <a name="inbound-throttling"></a><span data-ttu-id="59a4a-158">輸入節流</span><span class="sxs-lookup"><span data-stu-id="59a4a-158">Inbound Throttling</span></span>  
 <span data-ttu-id="59a4a-159">BizTalk 節流機制會將輸入節流套用至協調流程引擎 (XLANG) 與輸入配接器。</span><span class="sxs-lookup"><span data-stu-id="59a4a-159">The BizTalk throttling mechanism applies inbound throttling to the orchestration engine (XLANG) and to inbound adapters.</span></span>  

 <span data-ttu-id="59a4a-160">使用**訊息發佈節流狀態**並**訊息發佈節流狀態期間**相關聯的計數器**biztalk: Messageagent**效能物件類別，來計量目前的節流狀態與節流期間。</span><span class="sxs-lookup"><span data-stu-id="59a4a-160">Use the **Message publishing throttling state** and **Message publishing throttling state duration** counters associated with **BizTalk:MessageAgent** performance object category to measure the current throttling state and duration of throttling.</span></span> <span data-ttu-id="59a4a-161">如需有關可用之主控件節流效能計數器的詳細資訊，請參閱 <<c0> [ 主控件節流效能計數器](../core/host-throttling-performance-counters.md)。</span><span class="sxs-lookup"><span data-stu-id="59a4a-161">For more information about the available host throttling performance counters, see [Host Throttling Performance Counters](../core/host-throttling-performance-counters.md).</span></span>  

 <span data-ttu-id="59a4a-162">輸入節流會造成輸入訊息積存於來源中。</span><span class="sxs-lookup"><span data-stu-id="59a4a-162">Inbound throttling can cause inbound messages to backlog at the source.</span></span> <span data-ttu-id="59a4a-163">若輸入節流是套用至接收配接器，則接收配接器可能會停止接收訊息，直到移轉了節流狀況為止。</span><span class="sxs-lookup"><span data-stu-id="59a4a-163">If inbound throttling is applied to a receive adapter then the receive adapter may stop receiving messages until the throttling condition is mitigated.</span></span>  


| <span data-ttu-id="59a4a-164">訊息發佈</span><span class="sxs-lookup"><span data-stu-id="59a4a-164">Message Publishing</span></span><br /><br /> <span data-ttu-id="59a4a-165">節流狀態</span><span class="sxs-lookup"><span data-stu-id="59a4a-165">throttling state</span></span> |                                                                                                                                                                                                                                                  <span data-ttu-id="59a4a-166">節流條件的觸發程序</span><span class="sxs-lookup"><span data-stu-id="59a4a-166">Trigger for throttling condition</span></span>                                                                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                        <span data-ttu-id="59a4a-167">採取的節流動作</span><span class="sxs-lookup"><span data-stu-id="59a4a-167">Throttling actions taken</span></span>                                                                                                                                                                                                                                                                                        |                                                                                                                                                                                                                                                                                                                                                                                                 <span data-ttu-id="59a4a-168">移轉策略</span><span class="sxs-lookup"><span data-stu-id="59a4a-168">Mitigation strategy</span></span>                                                                                                                                                                                                                                                                                                                                                                                                  |                                                 <span data-ttu-id="59a4a-169">效能物件</span><span class="sxs-lookup"><span data-stu-id="59a4a-169">Performance object</span></span>                                                  |                                                                                                                                <span data-ttu-id="59a4a-170">效能計數器</span><span class="sxs-lookup"><span data-stu-id="59a4a-170">Performance counter</span></span>                                                                                                                                 |
|-------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                        <span data-ttu-id="59a4a-171">2</span><span class="sxs-lookup"><span data-stu-id="59a4a-171">2</span></span>                        |                                                                                                                                                   <span data-ttu-id="59a4a-172">**訊息發佈內送速率**主控件執行個體超過**訊息發佈外寄速率\\** \*指定**速率增加因數 （百分比）** 值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-172">**Message publishing incoming rate** for the host instance exceeds the **Message publishing outgoing rate\\**\* the specified **Rate overdrive factor (percent)** value.</span></span> <span data-ttu-id="59a4a-173">資料庫無法趕上發佈速率。</span><span class="sxs-lookup"><span data-stu-id="59a4a-173">The database cannot keep up with the publishing rate.</span></span>                                                                                                                                                   |                                                                                                                                                                                 <span data-ttu-id="59a4a-174">封鎖動態計算的時間週期之前，發佈執行緒**訊息發佈內送速率**相當於**訊息發佈外寄速率**\*指定的**速率增加因數 （百分比）** 值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-174">Block the publishing thread for a dynamically computed time period until the **Message Publishing Incoming Rate** is at par with the **Message Publishing Outgoing Rate** \* the specified **Rate overdrive factor (percent)** value.</span></span>                                                                                                                                                                                  |                                                                                                                                                  <span data-ttu-id="59a4a-175">使用效能計數器，來決定訊息發佈內送與訊息發佈外寄速率。</span><span class="sxs-lookup"><span data-stu-id="59a4a-175">Use performance counters to determine the message publishing incoming and message publishing outgoing rate.</span></span> <span data-ttu-id="59a4a-176">考慮適合您環境的增加因素。</span><span class="sxs-lookup"><span data-stu-id="59a4a-176">Consider an appropriate overdrive factor for your environment.</span></span><br /><br /> <span data-ttu-id="59a4a-177">確認值提供給**取樣視窗持續期間**並**最小取樣數目**參數都是適用於您的案例。</span><span class="sxs-lookup"><span data-stu-id="59a4a-177">Verify that the values supplied for the **Sampling window duration** and **Minimum number of samples** parameters are appropriate for your scenario.</span></span><br /><br /> <span data-ttu-id="59a4a-178">如需有關這些參數的詳細資訊，請參閱 <<c0> [ 如何修改速率型節流設定](../core/how-to-modify-rate-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="59a4a-178">For more information about these parameters, see [How to Modify Rate Based Throttling Settings](../core/how-to-modify-rate-based-throttling-settings.md).</span></span>                                                                                                                                                   |                                                <span data-ttu-id="59a4a-179">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="59a4a-179">BizTalk:MessageAgent</span></span>                                                 |                                                                                                   <span data-ttu-id="59a4a-180">訊息發佈內送速率</span><span class="sxs-lookup"><span data-stu-id="59a4a-180">Message publishing incoming rate</span></span><br /><br /> <span data-ttu-id="59a4a-181">訊息發佈外寄速率</span><span class="sxs-lookup"><span data-stu-id="59a4a-181">Message publishing outgoing rate</span></span>                                                                                                    |
|                        <span data-ttu-id="59a4a-182">4</span><span class="sxs-lookup"><span data-stu-id="59a4a-182">4</span></span>                        |                                                                                                                                                                         <span data-ttu-id="59a4a-183">程序記憶體超過指定的閾值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-183">Process memory exceeds the specified threshold.</span></span><br /><br /> <span data-ttu-id="59a4a-184">若要發佈的批次擁有遽增的記憶體需求或是太多執行緒正在處理訊息，就會發生此狀況</span><span class="sxs-lookup"><span data-stu-id="59a4a-184">This can occur if the batch to be published has steep memory requirements or too many threads are processing messages</span></span>                                                                                                                                                                          | <span data-ttu-id="59a4a-185">縮減 EPM 所使用的執行緒集區大小。</span><span class="sxs-lookup"><span data-stu-id="59a4a-185">Reduce the size of the thread pool used by EPM.</span></span><br /><br /> <span data-ttu-id="59a4a-186">封鎖 EPM 執行緒，以防止處理新訊息批次。</span><span class="sxs-lookup"><span data-stu-id="59a4a-186">Block the EPM threads to prevent processing of new messages batches.</span></span><br /><br /> <span data-ttu-id="59a4a-187">若有遽增的記憶體需求使批次中的訊息持續存在於資料庫中，則在訊息持續存在於資料庫中之前，發佈執行緒也會受到漸進式延遲。</span><span class="sxs-lookup"><span data-stu-id="59a4a-187">If there is a steep memory requirement to persist the messages in a batch to the database, the publishing thread is also subject to a progressive delay before the messages are persisted to the database.</span></span><br /><br /> <span data-ttu-id="59a4a-188">由於程序記憶體壓力而是否要封鎖發佈批次，則取決於幾個因數，包括批次中的訊息數目，或是批次中是否有凍結或訊息刪除命令。</span><span class="sxs-lookup"><span data-stu-id="59a4a-188">Whether the publishing batch will be blocked or not due to process memory pressure depends on several factors including the number of messages in the batch or if there are dehydration or message deletion commands in the batch.</span></span> |                                                                                                                                                                                   <span data-ttu-id="59a4a-189">考慮藉由縮減 EPM 執行緒集區和 (或) 配接器批次的大小，來降低負載的數量。</span><span class="sxs-lookup"><span data-stu-id="59a4a-189">Consider reducing the amount of load by reducing the EPM thread pool, and/or the size of adapter batches.</span></span><br /><br /> <span data-ttu-id="59a4a-190">如果處理程序並未耗用過多的記憶體，可考慮加大**程序虛擬**主機的閾值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-190">If the process is not consuming excessive memory, consider increasing the **Process virtual** threshold for the host.</span></span><br /><br /> <span data-ttu-id="59a4a-191">如需變更的詳細資訊**程序虛擬**值，請參閱[如何修改資源型節流設定](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="59a4a-191">For more information about changing the **Process virtual** value, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>                                                                                                                                                                                    |                                                <span data-ttu-id="59a4a-192">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="59a4a-192">BizTalk:MessageAgent</span></span>                                                 |                                                                                     <span data-ttu-id="59a4a-193">高程序記憶體</span><span class="sxs-lookup"><span data-stu-id="59a4a-193">High process memory</span></span><br /><br /> <span data-ttu-id="59a4a-194">程序記憶體使用量 (MB)</span><span class="sxs-lookup"><span data-stu-id="59a4a-194">Process memory usage (MB)</span></span><br /><br /> <span data-ttu-id="59a4a-195">程序記憶體使用量閾值 (MB)</span><span class="sxs-lookup"><span data-stu-id="59a4a-195">Process memory usage threshold (MB)</span></span>                                                                                      |
|                        <span data-ttu-id="59a4a-196">6</span><span class="sxs-lookup"><span data-stu-id="59a4a-196">6</span></span>                        | <span data-ttu-id="59a4a-197">主控件訊息佇列大小、多工緩衝處理表格大小或追蹤表格大小超過指定的閾值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-197">Host message queue size, the spool table size or the tracking table size exceed the specified threshold.</span></span><br /><br /> <span data-ttu-id="59a4a-198">此狀況的可能原因包括：</span><span class="sxs-lookup"><span data-stu-id="59a4a-198">Possible reasons for this condition include:</span></span><br /><br /> <span data-ttu-id="59a4a-199">-BizTalk Server 用來維持 BizTalk Server 資料庫未執行 SQL Agent 作業，或執行速度很慢。</span><span class="sxs-lookup"><span data-stu-id="59a4a-199">-   The SQL Agent jobs used by BizTalk Server to maintain the BizTalk Server databases not running or are running slowly.</span></span><br /><span data-ttu-id="59a4a-200">-下游元件不會及時處理來自於記憶體中佇列的訊息。</span><span class="sxs-lookup"><span data-stu-id="59a4a-200">-   Down-stream components are not processing messages from the in-memory queue in a timely manner.</span></span><br /><span data-ttu-id="59a4a-201">-擱置的訊息數目很高。</span><span class="sxs-lookup"><span data-stu-id="59a4a-201">-   Number of suspended messages is high.</span></span><br /><span data-ttu-id="59a4a-202">-已達到系統最大持續性負載。</span><span class="sxs-lookup"><span data-stu-id="59a4a-202">-   Maximum sustainable load for the system has been reached.</span></span> |                                                                                                                                                                      <span data-ttu-id="59a4a-203">縮減 EPM 所使用的執行緒集區大小。</span><span class="sxs-lookup"><span data-stu-id="59a4a-203">Reduce the size of the thread pool used by EPM.</span></span><br /><br /> <span data-ttu-id="59a4a-204">封鎖 EPM 執行緒，以防止處理新訊息批次。</span><span class="sxs-lookup"><span data-stu-id="59a4a-204">Block the EPM threads to prevent processing of new messages batches.</span></span><br /><br /> <span data-ttu-id="59a4a-205">在訊息持續存在於資料庫之前，發佈執行緒也會受到漸進式延遲。</span><span class="sxs-lookup"><span data-stu-id="59a4a-205">The publishing thread is also subject to a progressive delay before the messages are persisted to the database.</span></span>                                                                                                                                                                      | <span data-ttu-id="59a4a-206">確定 BizTalk Server 用來維持 BizTalk Server 資料庫執行或不失敗的 SQL 代理程式工作。</span><span class="sxs-lookup"><span data-stu-id="59a4a-206">Ensure that the SQL Agent jobs used by BizTalk Server to maintain the BizTalk Server databases are running and are not failing.</span></span><br /><br /> <span data-ttu-id="59a4a-207">視需要終止和繼續已擱置的執行個體。</span><span class="sxs-lookup"><span data-stu-id="59a4a-207">Terminate and resume suspended instances as needed.</span></span><br /><br /> <span data-ttu-id="59a4a-208">增加的預設值**DB 中的訊息計數**考慮儲存 BizTalk 資料庫的 SQL server 的空間需求的臨界值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-208">Increase the default value for the **Message count in DB** threshold taking into consideration the space requirements of the SQL server that houses the BizTalk databases.</span></span><br /><br /> <span data-ttu-id="59a4a-209">如果您的資料庫大小適用於處理額外的訊息待處理項目，請考慮增加**多工緩衝處理乘數**並**追蹤資料乘數**值，以便讓其他待處理項目中的多工緩衝處理與追蹤資料表。</span><span class="sxs-lookup"><span data-stu-id="59a4a-209">If your database is sized appropriately to handle additional message backlog, consider increasing the **Spool multiplier** and **Tracking data multiplier** values to allow additional backlog in the Spool and Tracking tables.</span></span><br /><br /> <span data-ttu-id="59a4a-210">如需變更這些值的詳細資訊，請參閱[如何修改資源型節流設定](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="59a4a-210">For more information about changing the values, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span> | <span data-ttu-id="59a4a-211">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="59a4a-211">BizTalk:MessageAgent</span></span><br /><br /> <span data-ttu-id="59a4a-212">BizTalk:Message Box：一般計數器</span><span class="sxs-lookup"><span data-stu-id="59a4a-212">BizTalk:Message Box:General Counters</span></span><br /><br /> <span data-ttu-id="59a4a-213">BizTalk:Message Box：主控件計數器</span><span class="sxs-lookup"><span data-stu-id="59a4a-213">BizTalk:Message Box:Host Counters</span></span> | <span data-ttu-id="59a4a-214">MessageAgent /資料庫大小</span><span class="sxs-lookup"><span data-stu-id="59a4a-214">MessageAgent /Database size</span></span><br /><br /> <span data-ttu-id="59a4a-215">Message Box：一般計數器/多緩衝處理大小</span><span class="sxs-lookup"><span data-stu-id="59a4a-215">Message Box:General Counters /Spool size</span></span><br /><br /> <span data-ttu-id="59a4a-216">Message Box：一般計數器/追蹤資料大小</span><span class="sxs-lookup"><span data-stu-id="59a4a-216">Message Box:General Counters /Tracking data size</span></span><br /><br /> <span data-ttu-id="59a4a-217">Message Box：主控件計數器/主控件佇列 – 長度</span><span class="sxs-lookup"><span data-stu-id="59a4a-217">Message Box:Host Counters/Host queue – length</span></span><br /><br /> <span data-ttu-id="59a4a-218">Message Box：主控件計數器/主控件佇列 - 已擱置的訊息 – 長度</span><span class="sxs-lookup"><span data-stu-id="59a4a-218">Message Box:Host Counters/Host queue - suspended msgs – length</span></span> |
|                        <span data-ttu-id="59a4a-219">8</span><span class="sxs-lookup"><span data-stu-id="59a4a-219">8</span></span>                        |                                                                                                                                                                                                                         <span data-ttu-id="59a4a-220">主控件執行個體所使用的資料庫工作階段超過指定的閾值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-220">Database sessions being used by the host instance exceed the specified threshold.</span></span>                                                                                                                                                                                                                          |                                                                                                                                                                      <span data-ttu-id="59a4a-221">縮減 EPM 所使用的執行緒集區大小。</span><span class="sxs-lookup"><span data-stu-id="59a4a-221">Reduce the size of the thread pool used by EPM.</span></span><br /><br /> <span data-ttu-id="59a4a-222">封鎖 EPM 執行緒，以防止處理新訊息批次。</span><span class="sxs-lookup"><span data-stu-id="59a4a-222">Block the EPM threads to prevent processing of new messages batches.</span></span><br /><br /> <span data-ttu-id="59a4a-223">在訊息持續存在於資料庫之前，發佈執行緒也會受到漸進式延遲。</span><span class="sxs-lookup"><span data-stu-id="59a4a-223">The publishing thread is also subject to a progressive delay before the messages are persisted to the database.</span></span>                                                                                                                                                                      |                                                                                                                                                                                                                                                                                <span data-ttu-id="59a4a-224">請考慮增加**資料庫連線**主機的閾值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-224">Consider increasing the **Database connections** threshold for the host.</span></span><br /><br /> <span data-ttu-id="59a4a-225">如需有關如何變更此值的詳細資訊，請參閱 <<c0> [ 如何修改資源型節流設定](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="59a4a-225">For more information on changing this value, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>                                                                                                                                                                                                                                                                                |                                                <span data-ttu-id="59a4a-226">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="59a4a-226">BizTalk:MessageAgent</span></span>                                                 |                                                                                                                                  <span data-ttu-id="59a4a-227">資料庫工作階段</span><span class="sxs-lookup"><span data-stu-id="59a4a-227">Database session</span></span>                                                                                                                                  |
|                        <span data-ttu-id="59a4a-228">9</span><span class="sxs-lookup"><span data-stu-id="59a4a-228">9</span></span>                        |                                                                                                                                                                                                                                       <span data-ttu-id="59a4a-229">處理程序執行緒計數超過指定的閾值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-229">Process thread count exceeds the specified threshold.</span></span>                                                                                                                                                                                                                                        |                                                                                                                                                                      <span data-ttu-id="59a4a-230">縮減 EPM 所使用的執行緒集區大小。</span><span class="sxs-lookup"><span data-stu-id="59a4a-230">Reduce the size of the thread pool used by EPM.</span></span><br /><br /> <span data-ttu-id="59a4a-231">封鎖 EPM 執行緒，以防止處理新訊息批次。</span><span class="sxs-lookup"><span data-stu-id="59a4a-231">Block the EPM threads to prevent processing of new messages batches.</span></span><br /><br /> <span data-ttu-id="59a4a-232">在訊息持續存在於資料庫之前，發佈執行緒也會受到漸進式延遲。</span><span class="sxs-lookup"><span data-stu-id="59a4a-232">The publishing thread is also subject to a progressive delay before the messages are persisted to the database.</span></span>                                                                                                                                                                      |                                                                                                                                                                                                         <span data-ttu-id="59a4a-233">考慮調整不同的執行緒集區大小，以確定系統不會建立大量的執行緒。</span><span class="sxs-lookup"><span data-stu-id="59a4a-233">Consider adjusting the different thread pool sizes to ensure that the system does not create a large number of threads.</span></span><br /><br /> <span data-ttu-id="59a4a-234">如需修改執行緒集區大小的詳細資訊，請參閱 <<c0> [ 如何修改一般設定](../core/how-to-modify-general-settings.md)並[如何修改資源型節流設定](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="59a4a-234">For more information about modifying the thread pool sizes, see [How to Modify General Settings](../core/how-to-modify-general-settings.md) and [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>                                                                                                                                                                                                         |                                                <span data-ttu-id="59a4a-235">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="59a4a-235">BizTalk:MessageAgent</span></span>                                                 |                                                                                                                  <span data-ttu-id="59a4a-236">執行緒計數</span><span class="sxs-lookup"><span data-stu-id="59a4a-236">Thread count</span></span><br /><br /> <span data-ttu-id="59a4a-237">執行緒計數閾值</span><span class="sxs-lookup"><span data-stu-id="59a4a-237">Thread count threshold</span></span>                                                                                                                   |
|                        <span data-ttu-id="59a4a-238">5</span><span class="sxs-lookup"><span data-stu-id="59a4a-238">5</span></span>                        |                                                                                                                                                                                                                                           <span data-ttu-id="59a4a-239">系統記憶體超過指定的閾值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-239">System memory exceeds the specified threshold.</span></span>                                                                                                                                                                                                                                           | <span data-ttu-id="59a4a-240">縮減 EPM 所使用的執行緒集區大小。</span><span class="sxs-lookup"><span data-stu-id="59a4a-240">Reduce the size of the thread pool used by EPM.</span></span><br /><br /> <span data-ttu-id="59a4a-241">封鎖 EPM 執行緒，以防止處理新訊息批次。</span><span class="sxs-lookup"><span data-stu-id="59a4a-241">Block the EPM threads to prevent processing of new messages batches.</span></span><br /><br /> <span data-ttu-id="59a4a-242">若有遽增的記憶體需求使批次中的訊息持續存在於資料庫中，則在訊息持續存在於資料庫中之前，發佈執行緒也會受到漸進式延遲。</span><span class="sxs-lookup"><span data-stu-id="59a4a-242">If there is a steep memory requirement to persist the messages in a batch to the database, the publishing thread is also subject to a progressive delay before the messages are persisted to the database.</span></span><br /><br /> <span data-ttu-id="59a4a-243">由於程序記憶體壓力而是否要封鎖發佈批次，則取決於幾個因數，包括批次中的訊息數目，或是批次中是否有凍結或訊息刪除命令。</span><span class="sxs-lookup"><span data-stu-id="59a4a-243">Whether the publishing batch will be blocked or not due to process memory pressure depends on several factors including the number of messages in the batch or if there are dehydration or message deletion commands in the batch.</span></span> |                                                                                                                                                                                <span data-ttu-id="59a4a-244">考慮藉由縮減 EPM 執行緒集區和/或配接器批次大小，來降低負載。</span><span class="sxs-lookup"><span data-stu-id="59a4a-244">Consider reducing load by reducing the default size of the EPM thread pool, and/or the size of adapter batches.</span></span><br /><br /> <span data-ttu-id="59a4a-245">如果處理程序並未耗用過多的記憶體，可考慮加大**全域實體**主機的閾值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-245">If the process is not consuming excessive memory, consider increasing the **Global Physical** threshold for the host.</span></span><br /><br /> <span data-ttu-id="59a4a-246">如需有關變更**全域實體**臨界值，請參閱[如何修改資源型節流設定](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="59a4a-246">For more information on changing the **Global Physical** threshold, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>                                                                                                                                                                                |                                                <span data-ttu-id="59a4a-247">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="59a4a-247">BizTalk:MessageAgent</span></span>                                                 |                                                                                                    <span data-ttu-id="59a4a-248">實體記憶體使用量 (MB)</span><span class="sxs-lookup"><span data-stu-id="59a4a-248">Physical memory usage (MB)</span></span><br /><br /> <span data-ttu-id="59a4a-249">實體記憶體使用量閾值 (MB)</span><span class="sxs-lookup"><span data-stu-id="59a4a-249">Physical memory usage threshold (MB)</span></span>                                                                                                     |

### <a name="outbound-throttling"></a><span data-ttu-id="59a4a-250">輸出節流</span><span class="sxs-lookup"><span data-stu-id="59a4a-250">Outbound Throttling</span></span>  
 <span data-ttu-id="59a4a-251">BizTalk 節流機制會將輸出節流套用至協調流程引擎 (XLANG) 與輸出配接器。</span><span class="sxs-lookup"><span data-stu-id="59a4a-251">The BizTalk throttling mechanism applies outbound throttling to the orchestration engine (XLANG) and to outbound adapters.</span></span>  

 <span data-ttu-id="59a4a-252">使用**訊息傳遞節流狀態**並**訊息傳遞節流狀態期間**相關聯的計數器**biztalk: Messageagent**效能物件測量目前的節流狀態與節流期間用來分類。</span><span class="sxs-lookup"><span data-stu-id="59a4a-252">Use the **Message delivery throttling state** and **Message delivery throttling state duration** counters associated with **BizTalk:MessageAgent** performance object category to measure the current throttling state and duration of throttling.</span></span> <span data-ttu-id="59a4a-253">如需有關可用之主控件節流效能計數器查看[主控件節流效能計數器](../core/host-throttling-performance-counters.md)。</span><span class="sxs-lookup"><span data-stu-id="59a4a-253">For more information about the available host throttling performance counters see [Host Throttling Performance Counters](../core/host-throttling-performance-counters.md).</span></span>  

 <span data-ttu-id="59a4a-254">輸出節流會造成訊息延遲傳遞，而且訊息可能建立在記憶體中佇列內，並造成清除佇列執行緒遭到封鎖，直到移轉了節流狀況為止。</span><span class="sxs-lookup"><span data-stu-id="59a4a-254">Outbound throttling can cause delayed message delivery and messages may build up in the in-memory queue and cause de-queue threads to be blocked until the throttling condition is mitigated.</span></span> <span data-ttu-id="59a4a-255">在清除佇列執行緒被封鎖時，不會從 MessageBox 將額外的訊息提取至記憶體中佇列內以進行輸出傳遞。</span><span class="sxs-lookup"><span data-stu-id="59a4a-255">When de-queue threads are blocked no additional messages are pulled from the MessageBox into the in-memory queue for outbound delivery.</span></span>  


| <span data-ttu-id="59a4a-256">訊息傳遞</span><span class="sxs-lookup"><span data-stu-id="59a4a-256">Message Delivery</span></span><br /><br /> <span data-ttu-id="59a4a-257">節流狀態</span><span class="sxs-lookup"><span data-stu-id="59a4a-257">throttling state</span></span> |                                                                                                                                    <span data-ttu-id="59a4a-258">節流條件的觸發程序</span><span class="sxs-lookup"><span data-stu-id="59a4a-258">Trigger for throttling condition</span></span>                                                                                                                                     |                                                                                                                                                   <span data-ttu-id="59a4a-259">採取的節流動作</span><span class="sxs-lookup"><span data-stu-id="59a4a-259">Throttling actions taken</span></span>                                                                                                                                                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <span data-ttu-id="59a4a-260">移轉策略</span><span class="sxs-lookup"><span data-stu-id="59a4a-260">Mitigation Strategy</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |  <span data-ttu-id="59a4a-261">效能物件</span><span class="sxs-lookup"><span data-stu-id="59a4a-261">Performance Object</span></span>  |                                                                               <span data-ttu-id="59a4a-262">效能計數器</span><span class="sxs-lookup"><span data-stu-id="59a4a-262">Performance Counter</span></span>                                                                               |
|-----------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                       <span data-ttu-id="59a4a-263">@shouldalert</span><span class="sxs-lookup"><span data-stu-id="59a4a-263">1</span></span>                       | <span data-ttu-id="59a4a-264">**訊息傳遞內送速率**主控件執行個體超過**訊息傳遞外寄速率\\**  \*指定**速率增加因數 （百分比）** 值</span><span class="sxs-lookup"><span data-stu-id="59a4a-264">**Message delivery incoming rate** for the host instance exceeds the **Message delivery outgoing rate \\**\* the specified **Rate overdrive factor (percent)** value</span></span><br /><br /> <span data-ttu-id="59a4a-265">可能的原因包括高處理複雜性、慢速輸出配接器，或暫時性系統資源不足。</span><span class="sxs-lookup"><span data-stu-id="59a4a-265">This can be caused by high processing complexity, slow outbound adapters, or a momentary shortage of system resources.</span></span> |                                                 <span data-ttu-id="59a4a-266">封鎖動態計算的時間週期訊息傳遞內送速率相當於之前的傳遞執行緒**訊息傳遞外寄速率\\**  \*指定**速率增加因數 （百分比）** 值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-266">Block the delivery thread for a dynamically computed time period until the Message delivery incoming rate is at par with the **Message delivery outgoing rate \\**\* the specified **Rate overdrive factor (percent)** value.</span></span>                                                 |                                                                                                                                                                                                                                                  <span data-ttu-id="59a4a-267">使用效能計數器，來決定訊息傳遞內送與訊息傳遞外寄速率。</span><span class="sxs-lookup"><span data-stu-id="59a4a-267">Use performance counters to determine the message delivery incoming and message delivery outgoing rate.</span></span> <span data-ttu-id="59a4a-268">考慮適合您環境的增加因素。</span><span class="sxs-lookup"><span data-stu-id="59a4a-268">Consider an appropriate over drive factor for your environment.</span></span><br /><br /> <span data-ttu-id="59a4a-269">確認值提供給**取樣視窗持續期間**並**最小取樣數目**參數都是適用於您的案例。</span><span class="sxs-lookup"><span data-stu-id="59a4a-269">Verify that the values supplied for the **Sampling window duration** and **Minimum number of samples** parameters are appropriate for your scenario.</span></span><br /><br /> <span data-ttu-id="59a4a-270">如需有關這些參數的詳細資訊，請參閱 <<c0> [ 如何修改速率型節流設定](../core/how-to-modify-rate-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="59a4a-270">For more information about these parameters, see [How to Modify Rate Based Throttling Settings](../core/how-to-modify-rate-based-throttling-settings.md).</span></span>                                                                                                                                                                                                                                                   | <span data-ttu-id="59a4a-271">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="59a4a-271">BizTalk:MessageAgent</span></span> |                                                   <span data-ttu-id="59a4a-272">訊息傳遞內送速率</span><span class="sxs-lookup"><span data-stu-id="59a4a-272">Message delivery incoming rate</span></span><br /><br /> <span data-ttu-id="59a4a-273">訊息發佈外寄速率</span><span class="sxs-lookup"><span data-stu-id="59a4a-273">Message publishing outgoing rate</span></span>                                                   |
|                       <span data-ttu-id="59a4a-274">4</span><span class="sxs-lookup"><span data-stu-id="59a4a-274">4</span></span>                       |                             <span data-ttu-id="59a4a-275">程序記憶體超過指定的閾值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-275">Process memory exceeds the specified threshold.</span></span><br /><br /> <span data-ttu-id="59a4a-276">這可能發生於記憶體耗用處理實例中、處理大型訊息時，或是傳送配接器嘗試同時處理大量訊息時。</span><span class="sxs-lookup"><span data-stu-id="59a4a-276">This can occur in memory intensive processing scenarios, when processing large messages, or when send adapters are attempting to process a high number of messages simultaneously.</span></span>                              | <span data-ttu-id="59a4a-277">降低訊息傳遞至配接器或 XLANG 的速度。</span><span class="sxs-lookup"><span data-stu-id="59a4a-277">Slow down message delivery to adapters or XLANG.</span></span><br /><br /> <span data-ttu-id="59a4a-278">若適用，可藉由凍結服務執行個體與壓縮快取，來縮減處理程序記憶體消耗。</span><span class="sxs-lookup"><span data-stu-id="59a4a-278">Reduce process memory consumption by dehydrating service instances and shrinking cache when applicable.</span></span><br /><br /> <span data-ttu-id="59a4a-279">縮減 EPM 和/或訊息代理程式所使用的執行緒集區大小。</span><span class="sxs-lookup"><span data-stu-id="59a4a-279">Reduce the size of the thread pools used by the EPM and/or the Message Agent.</span></span><br /><br /> <span data-ttu-id="59a4a-280">定期強制 .NET 記憶體回收 (GC)。</span><span class="sxs-lookup"><span data-stu-id="59a4a-280">Periodically force a .NET garbage collection (GC).</span></span> | <span data-ttu-id="59a4a-281">若系統並未因根據以程序記憶體為主的節流而成為閒置，則可能不需要其他動作。</span><span class="sxs-lookup"><span data-stu-id="59a4a-281">If the system is not becoming idle due to process memory based throttling, no action may be required.</span></span><br /><br /> <span data-ttu-id="59a4a-282">如果**內含式訊息計數**計數器很高，而且也不會過量即使沒有處理序記憶體為主的節流，無須執行其他動作可能需要的 CPU 使用率。</span><span class="sxs-lookup"><span data-stu-id="59a4a-282">If the **In-process message count** counter is high and the CPU utilization is not excessive even when there is process memory based throttling, no additional action may be required.</span></span><br /><br /> <span data-ttu-id="59a4a-283">若系統出現過度節流，請考慮增加與相關聯的值**程序虛擬**主機的臨界值，並確認主控件執行個體不會產生 「 記憶體不足 」 錯誤。</span><span class="sxs-lookup"><span data-stu-id="59a4a-283">If the system appears to be over-throttling, consider increasing the value associated with the **Process virtual** threshold for the host and verify that the host instance does not generate an "out of memory" error.</span></span> <span data-ttu-id="59a4a-284">如果藉由增加產生 「 記憶體不足 」 錯誤**程序虛擬**臨界值，則請考慮減少的值**內部訊息佇列大小**和**內含式訊息**臨界值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-284">If an "out of memory" error is raised by increasing the **Process virtual** threshold, then consider reducing the values for the **Internal message queue size** and **In-process messages** thresholds.</span></span> <span data-ttu-id="59a4a-285">此策略特別會與大型訊息處理實例有關。</span><span class="sxs-lookup"><span data-stu-id="59a4a-285">This strategy is particularly relevant in large message processing scenarios.</span></span><br /><br /> <span data-ttu-id="59a4a-286">如需有關這些參數的詳細資訊，請參閱 <<c0> [ 如何修改資源型節流設定](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="59a4a-286">For more information about these parameters, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span> | <span data-ttu-id="59a4a-287">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="59a4a-287">BizTalk:MessageAgent</span></span> | <span data-ttu-id="59a4a-288">高程序記憶體</span><span class="sxs-lookup"><span data-stu-id="59a4a-288">High process memory</span></span><br /><br /> <span data-ttu-id="59a4a-289">處理序記憶體 usage(MB)</span><span class="sxs-lookup"><span data-stu-id="59a4a-289">Process memory usage(MB)</span></span><br /><br /> <span data-ttu-id="59a4a-290">程序記憶體使用量閾值 (MB)</span><span class="sxs-lookup"><span data-stu-id="59a4a-290">Process memory usage threshold (MB)</span></span><br /><br /> <span data-ttu-id="59a4a-291">內含式訊息計數</span><span class="sxs-lookup"><span data-stu-id="59a4a-291">In-process message count</span></span><br /><br /> <span data-ttu-id="59a4a-292">作用中執行個體計數</span><span class="sxs-lookup"><span data-stu-id="59a4a-292">Active instance count</span></span> |
|                       <span data-ttu-id="59a4a-293">3</span><span class="sxs-lookup"><span data-stu-id="59a4a-293">3</span></span>                       |                                     <span data-ttu-id="59a4a-294">已傳遞之內含式訊息的數目超過指定的閾值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-294">Number of in-process messages delivered to a service class exceeds the specified threshold.</span></span><br /><br /> <span data-ttu-id="59a4a-295">可能的原因包括高處理複雜性、慢速輸出配接器，或暫時性系統資源不足。</span><span class="sxs-lookup"><span data-stu-id="59a4a-295">This can be caused by high processing complexity, slow outbound adapters, or a momentary shortage of system resources.</span></span>                                      |                                                                                                  <span data-ttu-id="59a4a-296">降低訊息傳遞至配接器或 XLANG 的速度。</span><span class="sxs-lookup"><span data-stu-id="59a4a-296">Slow down message delivery to adapters or XLANG.</span></span><br /><br /> <span data-ttu-id="59a4a-297">縮減訊息代理程式所使用的執行緒集區大小。</span><span class="sxs-lookup"><span data-stu-id="59a4a-297">Reduce the size of the thread pool used by the Message Agent.</span></span>                                                                                                   |                                                                                                                                                                                                                                                                                            <span data-ttu-id="59a4a-298">若發生過度節流，請考慮增加與相關聯的值**內含式訊息**臨界值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-298">If over-throttling occurs, consider increasing the value associated with the **In-process messages** threshold.</span></span><br /><br /> <span data-ttu-id="59a4a-299">如需有關此參數的詳細資訊，請參閱 <<c0> [ 修改資源型節流設定如何](../core/how-to-modify-resource-based-throttling-settings.md)**附註：** 增加此值可能造成不良影響配接器效能及/或增加記憶體此程序的使用方式。</span><span class="sxs-lookup"><span data-stu-id="59a4a-299">For more information about this parameter, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md) **Note:**  Increasing this value may adversely impact send adapter performance and/or increase the memory usage of the process.</span></span>                                                                                                                                                                                                                                                                                             | <span data-ttu-id="59a4a-300">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="59a4a-300">BizTalk:MessageAgent</span></span> |                                                     <span data-ttu-id="59a4a-301">內含式訊息計數</span><span class="sxs-lookup"><span data-stu-id="59a4a-301">In-process message count</span></span><br /><br /> <span data-ttu-id="59a4a-302">內含式訊息計數閾值</span><span class="sxs-lookup"><span data-stu-id="59a4a-302">In-process message count threshold</span></span>                                                     |
|                       <span data-ttu-id="59a4a-303">9</span><span class="sxs-lookup"><span data-stu-id="59a4a-303">9</span></span>                       |                                                                                                                          <span data-ttu-id="59a4a-304">處理程序執行緒計數超過指定的閾值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-304">Process thread count exceeds the specified threshold.</span></span>                                                                                                                          |                                                                                                                         <span data-ttu-id="59a4a-305">縮減 EPM 和 (或) 訊息代理程式所使用的執行緒集區大小。</span><span class="sxs-lookup"><span data-stu-id="59a4a-305">Reduce the size of the thread pools used by the EPM and/or the Message Agent</span></span>                                                                                                                          |                                                                                                                                                                                                                                                                                                       <span data-ttu-id="59a4a-306">考慮調整不同的執行緒集區大小，以確定系統不會建立大量的執行緒。</span><span class="sxs-lookup"><span data-stu-id="59a4a-306">Consider adjusting the different thread pool sizes to ensure that the system does not create a large number of threads.</span></span><br /><br /> <span data-ttu-id="59a4a-307">如需修改執行緒集區大小的詳細資訊，請參閱 <<c0> [ 如何修改一般設定](../core/how-to-modify-general-settings.md)並[如何修改資源型節流設定](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="59a4a-307">For more information about modifying the thread pool sizes, see [How to Modify General Settings](../core/how-to-modify-general-settings.md) and [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>                                                                                                                                                                                                                                                                                                        | <span data-ttu-id="59a4a-308">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="59a4a-308">BizTalk:MessageAgent</span></span> |                                                                 <span data-ttu-id="59a4a-309">執行緒計數</span><span class="sxs-lookup"><span data-stu-id="59a4a-309">Thread count</span></span><br /><br /> <span data-ttu-id="59a4a-310">執行緒計數閾值</span><span class="sxs-lookup"><span data-stu-id="59a4a-310">Thread count threshold</span></span>                                                                 |
|                       <span data-ttu-id="59a4a-311">5</span><span class="sxs-lookup"><span data-stu-id="59a4a-311">5</span></span>                       |                                                                                                                                   <span data-ttu-id="59a4a-312">系統記憶體超過閾值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-312">System memory exceeds a threshold.</span></span>                                                                                                                                    |                                <span data-ttu-id="59a4a-313">降低訊息傳遞至配接器或 XLANG 的速度。</span><span class="sxs-lookup"><span data-stu-id="59a4a-313">Slow down message delivery to adapters or XLANG.</span></span><br /><br /> <span data-ttu-id="59a4a-314">若適用，可藉由凍結服務執行個體與壓縮快取，來縮減處理程序記憶體消耗。</span><span class="sxs-lookup"><span data-stu-id="59a4a-314">Reduce process memory consumption by dehydrating service instances and shrinking cache when applicable.</span></span><br /><br /> <span data-ttu-id="59a4a-315">縮減 EPM 和/或訊息代理程式所使用的執行緒集區大小。</span><span class="sxs-lookup"><span data-stu-id="59a4a-315">Reduce the size of the thread pools used by the EPM and/or the Message Agent.</span></span>                                 |                                                                                                                                                                                                                                                                             <span data-ttu-id="59a4a-316">考慮藉由縮減 EPM 執行緒集區和/或配接器批次大小，來降低負載。</span><span class="sxs-lookup"><span data-stu-id="59a4a-316">Consider reducing load by reducing the default size of the EPM thread pool, and/or the size of adapter batches.</span></span><br /><br /> <span data-ttu-id="59a4a-317">如果處理程序並未耗用過多的記憶體，可考慮加大**全域實體**主機的閾值。</span><span class="sxs-lookup"><span data-stu-id="59a4a-317">If the process is not consuming excessive memory, consider increasing the **Global Physical** threshold for the host.</span></span><br /><br /> <span data-ttu-id="59a4a-318">如需變更的詳細資訊**全域實體**臨界值，請參閱[如何修改資源型節流設定](../core/how-to-modify-resource-based-throttling-settings.md)。</span><span class="sxs-lookup"><span data-stu-id="59a4a-318">For more information about changing the **Global Physical** threshold, see [How to Modify Resource Based Throttling Settings](../core/how-to-modify-resource-based-throttling-settings.md).</span></span>                                                                                                                                                                                                                                                                             | <span data-ttu-id="59a4a-319">BizTalk:MessageAgent</span><span class="sxs-lookup"><span data-stu-id="59a4a-319">BizTalk:MessageAgent</span></span> |                                                                           <span data-ttu-id="59a4a-320">實體記憶體使用量 (MB)</span><span class="sxs-lookup"><span data-stu-id="59a4a-320">Physical memory usage (MB)</span></span>                                                                            |

