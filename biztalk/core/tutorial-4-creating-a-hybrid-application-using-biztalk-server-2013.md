---
title: "教學課程 4： 建立使用 BizTalk Server 2013 的混合式應用程式 |Microsoft 文件"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 3a9de95f-7d2c-437d-be5b-0062592f32c6
caps.latest.revision: "10"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 5c11b163f34a1320052de585c7ddfc79afb03db4
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
---
# <a name="tutorial-4-creating-a-hybrid-application-using-biztalk-server-2013"></a><span data-ttu-id="bf018-102">教學課程 4： 建立使用 BizTalk Server 2013 的混合式應用程式</span><span class="sxs-lookup"><span data-stu-id="bf018-102">Tutorial 4: Creating a Hybrid Application Using BizTalk Server 2013</span></span>
<span data-ttu-id="bf018-103">本節提供的逐步解說說明如何建立與 [!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)] 及 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 有關的混合式應用程式。</span><span class="sxs-lookup"><span data-stu-id="bf018-103">This section provides a step-by-step walkthrough on how to create a hybrid application involving [!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)] and [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>  
  
## <a name="business-scenario"></a><span data-ttu-id="bf018-104">商務案例</span><span class="sxs-lookup"><span data-stu-id="bf018-104">Business Scenario</span></span>  
 <span data-ttu-id="bf018-105">Northwind 是一家透過合作夥伴 (Contoso 即為其中一個合作夥伴) 以一般檔案 EDI 訊息的形式接收銷售訂單的企業。</span><span class="sxs-lookup"><span data-stu-id="bf018-105">Northwind is an enterprise that receives sales orders from its partners, one of them being Contoso, in the form of a flat-file EDI message.</span></span> <span data-ttu-id="bf018-106">Northwind 想要設定一個可執行下列作業的端對端應用程式：</span><span class="sxs-lookup"><span data-stu-id="bf018-106">Northwind wants to set up an end-to-end application that does the following:</span></span>  
  
-   <span data-ttu-id="bf018-107">**管理 EDI 訊息處理**– 應用程式的這個模組必須驗證從 Contoso 接收的訊息是否符合標準 EDI 訊息格式。</span><span class="sxs-lookup"><span data-stu-id="bf018-107">**Manage the EDI message processing** – This module of the application must verify that the message received from Contoso conforms to the standard EDI message formats.</span></span> <span data-ttu-id="bf018-108">這個模組還必須產生所有必要的通知，以確認訊息處理成功。</span><span class="sxs-lookup"><span data-stu-id="bf018-108">This module must also generate all the required acknowledgements to verify that the message is successfully processed.</span></span>  
  
-   <span data-ttu-id="bf018-109">**使用商務邏輯來處理資料**– 一旦成功驗證並處理 EDI 訊息，Northwind 就必須執行訊息根據商務邏輯，以便進一步處理。</span><span class="sxs-lookup"><span data-stu-id="bf018-109">**Use business logic to process the data** – Once the EDI message is successfully verified and processed, Northwind must run the message against business logic for further processing.</span></span> <span data-ttu-id="bf018-110">例如，若所接收訊息中的訂單數量超過指定的數量，則會將資料存放在 SQL Server 資料庫中。</span><span class="sxs-lookup"><span data-stu-id="bf018-110">For example, if the order quantity in the received message is more than a given amount, the data is stored in a SQL Server database.</span></span> <span data-ttu-id="bf018-111">否則，資料會傳送至共用檔案位置。</span><span class="sxs-lookup"><span data-stu-id="bf018-111">Otherwise, the data is sent to a shared file location.</span></span>  
  
 <span data-ttu-id="bf018-112">為了實現這個狀況，Northwind 決定設定一個混合式應用程式，以便在雲端進行 EDI 訊息處理，並同時在內部部署中進行商務邏輯驅動的資料處理。</span><span class="sxs-lookup"><span data-stu-id="bf018-112">To achieve this scenario, Northwind decides to set up a hybrid application where the EDI message processing is done on the cloud while the business-logic-driven data processing is done within the premises.</span></span> <span data-ttu-id="bf018-113">Northwind 使用下列項目來設定此混合式應用程式：</span><span class="sxs-lookup"><span data-stu-id="bf018-113">To set up this hybrid application Northwind uses the following:</span></span>  
  
-   <span data-ttu-id="bf018-114">**[!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)]**-Azure BizTalk 入口網站提供[!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)]可讓客戶可設定交易夥伴和 EDI 協議[!INCLUDE[winazure](../includes/winazure-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="bf018-114">**[!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)]**  – The Azure BizTalk Portal available with [!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)] enables customers to configure trading partners and EDI agreements on [!INCLUDE[winazure](../includes/winazure-md.md)].</span></span> <span data-ttu-id="bf018-115">Northwind 使用 [!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)] – 2012 年 4 月發行，用於建立及部署協議，以便處理內送 EDI 訊息、根據 X12 840 銷售訂單結構描述進行驗證、將訊息轉換為 Northwind 所需的結構描述，再將訊息傳送至服務匯流排佇列。</span><span class="sxs-lookup"><span data-stu-id="bf018-115">Northwind uses the [!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)] – April 2012 release to create and deploy an agreement that processes the incoming EDI message, validates it against the X12 840 sales order schema, transforms the message to a schema required by Northwind, and then sends the message to a Service Bus Queue.</span></span> <span data-ttu-id="bf018-116">所以，若要開發混合式應用程式，應將資料從服務匯流排佇列傳送至內部部署的應用程式。</span><span class="sxs-lookup"><span data-stu-id="bf018-116">So, to develop a hybrid application, the data should be sent from the Service Bus Queue to an on-premises application.</span></span>  
  
-   <span data-ttu-id="bf018-117">**[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]**– Service Bus 在新的介面卡 (**Sb-messaging**) 適用於[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]可讓應用程式接收來自服務匯流排實體，例如佇列、 主題的訊息，依此類推到[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="bf018-117">**[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]**  – The new adapter for Service Bus (**SB-Messaging**) available with [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] enables applications to receive messages from Service Bus entities like Queues, Topics, and so on into [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span> <span data-ttu-id="bf018-118">做為一部分[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]應用程式中，Northwind 使用協調流程決定接收的銷售訂單中要求的數量是否超過 100。</span><span class="sxs-lookup"><span data-stu-id="bf018-118">As part of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] application, Northwind uses an orchestration to decide whether the quantity requested in the received sales order is more than 100.</span></span> <span data-ttu-id="bf018-119">如果數量大於 100，要將訊息插入至呼叫的 SQL Server 資料庫資料表**SalesOrder**。</span><span class="sxs-lookup"><span data-stu-id="bf018-119">If the quantity is more than 100, the message is inserted into a SQL Server database table called **SalesOrder**.</span></span> <span data-ttu-id="bf018-120">如果數量少於 100，則會將訊息傳送至共用檔案位置。</span><span class="sxs-lookup"><span data-stu-id="bf018-120">If the quantity is less than 100, the message is sent to a shared file location.</span></span>  
  
     <span data-ttu-id="bf018-121">為了將訊息插入 SQL Server 資料庫資料表中，Northwind 使用 [!INCLUDE[adaptersql](../includes/adaptersql-md.md)] 中提供的 [!INCLUDE[adapterpacknoversion](../includes/adapterpacknoversion-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="bf018-121">To insert the message into a SQL Server database table, Northwind uses the [!INCLUDE[adaptersql](../includes/adaptersql-md.md)] available as part of the [!INCLUDE[adapterpacknoversion](../includes/adapterpacknoversion-md.md)].</span></span>  
  
### <a name="end-to-end-message-flow"></a><span data-ttu-id="bf018-122">端點對端點訊息流程</span><span class="sxs-lookup"><span data-stu-id="bf018-122">End-to-end Message Flow</span></span>  
 <span data-ttu-id="bf018-123">這就是訊息通過混合式應用程式的方式：</span><span class="sxs-lookup"><span data-stu-id="bf018-123">This is how the message flows through the hybrid application:</span></span>  
  
1.  <span data-ttu-id="bf018-124">Contoso 會將 X12 銷售訂單訊息傳送至已在雲端部署 EDI 協議的端點。</span><span class="sxs-lookup"><span data-stu-id="bf018-124">Contoso sends an X12 sales order message to the endpoint where the EDI agreement is deployed on the cloud.</span></span>  
  
2.  <span data-ttu-id="bf018-125">訊息透過 EDI 協議處理成功之後，就會傳送至服務匯流排佇列。</span><span class="sxs-lookup"><span data-stu-id="bf018-125">After the message is successfully processed through the EDI agreement, it is sent to the Service Bus Queue.</span></span>  
  
3.  <span data-ttu-id="bf018-126">SB-Messaging 接收配接器會使用服務匯流排佇列中的訊息，並將在 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 中部署的協調流程具現化，以根據訂單數量將訊息傳送至不同的目的地。</span><span class="sxs-lookup"><span data-stu-id="bf018-126">SB-Messaging receive adapter consumes the message from the Service Bus Queue and instantiates the orchestration deployed in [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] to send the message to different destinations based on the order quantity.</span></span>  
  
4.  <span data-ttu-id="bf018-127">如果訂購數量大於 100，協調流程會插入訊息**SalesOrder**資料表。</span><span class="sxs-lookup"><span data-stu-id="bf018-127">If the quantity ordered is greater than 100, the orchestration inserts the message to a **SalesOrder** table.</span></span> <span data-ttu-id="bf018-128">如果訂購數量少於或等於 100，則會將訊息寫入至共用檔案位置。</span><span class="sxs-lookup"><span data-stu-id="bf018-128">If the quantity ordered is less than or equal to 100, the message is written to a shared file location.</span></span>  
  
## <a name="set-up-your-computer"></a><span data-ttu-id="bf018-129">設定電腦</span><span class="sxs-lookup"><span data-stu-id="bf018-129">Set up Your Computer</span></span>  
 <span data-ttu-id="bf018-130">本教學課程要求您執行四項主要活動。</span><span class="sxs-lookup"><span data-stu-id="bf018-130">This tutorial requires you to perform four broad activities.</span></span> <span data-ttu-id="bf018-131">下表列出各項活動與其軟體需求：</span><span class="sxs-lookup"><span data-stu-id="bf018-131">The following table lists the activities and the software requirements for each activity:</span></span>  
  
|<span data-ttu-id="bf018-132">活動</span><span class="sxs-lookup"><span data-stu-id="bf018-132">Activity</span></span>|<span data-ttu-id="bf018-133">必要軟體</span><span class="sxs-lookup"><span data-stu-id="bf018-133">Required software</span></span>|  
|--------------|-----------------------|  
|<span data-ttu-id="bf018-134">建立 EDI 協議所需的 EDI 成品</span><span class="sxs-lookup"><span data-stu-id="bf018-134">Create the EDI artifacts required for the EDI agreement</span></span>|<span data-ttu-id="bf018-135">本教學課程與 [!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)] 一起建立 – 2012 年 4 月發行的版本以及 X12 840 銷售訂單結構描述。</span><span class="sxs-lookup"><span data-stu-id="bf018-135">This tutorial was created with the [!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)] – April 2012 release as well as the X12 840 sales order schema.</span></span> <span data-ttu-id="bf018-136">這些可以從下載[http://go.microsoft.com/fwlink/p/?LinkId=235057](http://go.microsoft.com/fwlink/p/?LinkId=235057)。</span><span class="sxs-lookup"><span data-stu-id="bf018-136">These can be downloaded from [http://go.microsoft.com/fwlink/p/?LinkId=235057](http://go.microsoft.com/fwlink/p/?LinkId=235057).</span></span>|  
|<span data-ttu-id="bf018-137">建立和部署 EDI 協議</span><span class="sxs-lookup"><span data-stu-id="bf018-137">Create and deploy the EDI agreement</span></span>|<span data-ttu-id="bf018-138">因為 EDI 協議是部署在 Azure，您只需要 Web 瀏覽器 (如 Internet Explorer) 就能登入 Azure BizTalk Portal。</span><span class="sxs-lookup"><span data-stu-id="bf018-138">Because the EDI agreement is deployed on Azure, you only need a Web browser (e.g. Internet Explorer) to log in to the Azure BizTalk Portal.</span></span>|  
|<span data-ttu-id="bf018-139">建置、部署及設定 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 應用程式</span><span class="sxs-lookup"><span data-stu-id="bf018-139">Build, deploy, and configure the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] application</span></span>|<span data-ttu-id="bf018-140">如果您想要佈建[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]電腦上的 Azure VM，請遵循指示[http://msdn.microsoft.com/library/azure/jj248689.aspx](http://msdn.microsoft.com/library/azure/jj248689.aspx)。</span><span class="sxs-lookup"><span data-stu-id="bf018-140">If you want to provision a [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] computer on an Azure VM, follow the instructions at [http://msdn.microsoft.com/library/azure/jj248689.aspx](http://msdn.microsoft.com/library/azure/jj248689.aspx).</span></span>|  
|<span data-ttu-id="bf018-141">將測試訊息傳送到 EDI 協議端點</span><span class="sxs-lookup"><span data-stu-id="bf018-141">Send a test message to the EDI agreement endpoint</span></span>|<span data-ttu-id="bf018-142">您可以使用 [!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)] 隨附的範例套件中提供的 MessageSender 工具。</span><span class="sxs-lookup"><span data-stu-id="bf018-142">You can use the MessageSender tool available in the samples package shipped with [!INCLUDE[appfabricintegration](../includes/appfabricintegration-md.md)].</span></span> <span data-ttu-id="bf018-143">您可以下載範例套件的[http://go.microsoft.com/fwlink/p/?LinkId=235057](http://go.microsoft.com/fwlink/p/?LinkId=235057)。</span><span class="sxs-lookup"><span data-stu-id="bf018-143">You can download the samples package from [http://go.microsoft.com/fwlink/p/?LinkId=235057](http://go.microsoft.com/fwlink/p/?LinkId=235057).</span></span>|  
  
 <span data-ttu-id="bf018-144">您可以選擇在相同或不同電腦上安裝這些項目。</span><span class="sxs-lookup"><span data-stu-id="bf018-144">You can opt to install all these on the same computer or on different computers.</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="bf018-145">本節內容</span><span class="sxs-lookup"><span data-stu-id="bf018-145">In This Section</span></span>  
  
-   [<span data-ttu-id="bf018-146">（適用於 Azure) 的步驟 1： 建立 EDI 專案</span><span class="sxs-lookup"><span data-stu-id="bf018-146">Step 1 (For Azure): Create the EDI Project</span></span>](../core/step-1-for-azure-create-the-edi-project.md)  
  
-   [<span data-ttu-id="bf018-147">（適用於 Azure) 的步驟 2： 建立 EDI 協議</span><span class="sxs-lookup"><span data-stu-id="bf018-147">Step 2 (For Azure): Create an EDI Agreement</span></span>](../core/step-2-for-azure-create-an-edi-agreement.md)  
  
-   [<span data-ttu-id="bf018-148">（適用於 Azure) 的步驟 3： 建立服務匯流排佇列</span><span class="sxs-lookup"><span data-stu-id="bf018-148">Step 3 (For Azure): Create a Service Bus Queue</span></span>](../core/step-3-for-azure-create-a-service-bus-queue.md)  
  
-   [<span data-ttu-id="bf018-149">步驟 4 （內部部署）： 建立 SQL Server 資料表</span><span class="sxs-lookup"><span data-stu-id="bf018-149">Step 4 (On Premises): Create the SQL Server Table</span></span>](../core/step-4-on-premises-create-the-sql-server-table.md)  
  
-   [<span data-ttu-id="bf018-150">步驟 5 （內部部署）： 產生插入訊息插入至 SalesOrder 資料表的結構描述</span><span class="sxs-lookup"><span data-stu-id="bf018-150">Step 5 (On Premises): Generate the Schema for Inserting a Message inito SalesOrder Table</span></span>](../core/step-5-generate-the-schema-for-inserting-a-message-into-salesorder-table.md)  
  
-   [<span data-ttu-id="bf018-151">步驟 6 （內部部署）： 建立轉換，將訊息從佇列插入結構描述對應</span><span class="sxs-lookup"><span data-stu-id="bf018-151">Step 6 (On Premises): Create a Transform to Map the Message from the Queue to the Insert Schema</span></span>](../core/step-6-map-the-message-from-the-queue-to-the-insert-schema.md)  
  
-   [<span data-ttu-id="bf018-152">步驟 7 （內部部署）： 建立協調流程</span><span class="sxs-lookup"><span data-stu-id="bf018-152">Step 7 (On Premises): Create an Orchestration</span></span>](../core/step-7-on-premises-create-an-orchestration.md)  
  
-   [<span data-ttu-id="bf018-153">步驟 8 （在內部部署）： 設定 BizTalk Server 應用程式</span><span class="sxs-lookup"><span data-stu-id="bf018-153">Step 8 (On Premises): Configure the BizTalk Server Application</span></span>](../core/step-8-on-premises-configure-the-biztalk-server-application.md)  
  
-   [<span data-ttu-id="bf018-154">步驟 9： 測試方案</span><span class="sxs-lookup"><span data-stu-id="bf018-154">Step 9: Test the Solution</span></span>](../core/step-9-test-the-solution.md)