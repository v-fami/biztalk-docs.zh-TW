---
title: 訊息 |Microsoft 文件
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- messages, headers
- messages, acknowledgements
- messages, persisting
- messages
- examples, message headers
- properties
- message headers
- EMS messages
ms.assetid: 65bb3431-7186-4d4c-b004-932cdf070e73
caps.latest.revision: 11
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 8f7313e93029ca75d345aa4e9603699c50399230
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
ms.locfileid: "22266686"
---
# <a name="messages"></a><span data-ttu-id="00d6d-102">訊息</span><span class="sxs-lookup"><span data-stu-id="00d6d-102">Messages</span></span>
<span data-ttu-id="00d6d-103">類似 JMS 訊息的 Enterprise Message Service (EMS) 訊息，其中包含了三個不同部分：標頭、屬性和內文。</span><span class="sxs-lookup"><span data-stu-id="00d6d-103">An Enterprise Message Service (EMS) message, like a JMS message, contains three separate parts: header, properties, and body.</span></span> <span data-ttu-id="00d6d-104">標頭是 EMS 訊息唯一要求指定的部分。</span><span class="sxs-lookup"><span data-stu-id="00d6d-104">The header is the only required part of an EMS message.</span></span> <span data-ttu-id="00d6d-105">本主題會描述訊息中的處理方式 Microsoft BizTalk Adapter for TIBCO Enterprise Message Service。</span><span class="sxs-lookup"><span data-stu-id="00d6d-105">This topic describes how messages are treated in Microsoft BizTalk Adapter for TIBCO Enterprise Message Service.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="00d6d-106">若要設定或擷取標頭欄位 （例如，設定訊息優先順序 」 或是 「 相互關聯識別碼） 或從協調流程的訊息屬性，您必須加入參考**Microsoft.BizTalk.Adapters.TIBCOEMSProperties.dll**中您使用方案總管 中的專案。</span><span class="sxs-lookup"><span data-stu-id="00d6d-106">To set or retrieve a header field (for example, set the Message Priority or Correlation ID) or a message property from the orchestration, you must add a reference to the **Microsoft.BizTalk.Adapters.TIBCOEMSProperties.dll** in your project using Solution Explorer.</span></span>  
  
## <a name="message-header"></a><span data-ttu-id="00d6d-107">訊息標頭</span><span class="sxs-lookup"><span data-stu-id="00d6d-107">Message Header</span></span>  
 <span data-ttu-id="00d6d-108">訊息標頭包含一連串含值的預先定義欄位。</span><span class="sxs-lookup"><span data-stu-id="00d6d-108">The message header contains a series of predefined fields that contain values.</span></span> <span data-ttu-id="00d6d-109">BizTalk Adapter for TIBCO Enterprise Message Service 知道標題中可設定和不可設定的項目。</span><span class="sxs-lookup"><span data-stu-id="00d6d-109">BizTalk Adapter for TIBCO Enterprise Message Service knows what it can and cannot set in the header.</span></span> <span data-ttu-id="00d6d-110">若您嘗試設定唯讀值，配接器就會將您的設定值重新導向或設定到 Properties{} 區段中。</span><span class="sxs-lookup"><span data-stu-id="00d6d-110">If you try to set a read-only value, the adapter redirects or sets your value in the Properties{} section.</span></span>  
  
### <a name="header-example"></a><span data-ttu-id="00d6d-111">標頭範例</span><span class="sxs-lookup"><span data-stu-id="00d6d-111">Header Example</span></span>  
 <span data-ttu-id="00d6d-112">在下列範例中，注意**屬性 = {目的地 = {String: Queue [Q2]}}**。</span><span class="sxs-lookup"><span data-stu-id="00d6d-112">In the following example, notice that **Properties= { Destination={String:Queue[Q2]} }**.</span></span> <span data-ttu-id="00d6d-113">`Properties`是包含字串屬性，字串內容是**Q2**。</span><span class="sxs-lookup"><span data-stu-id="00d6d-113">`Properties` is a property that contains a string, and the contents of the string is **Q2**.</span></span> <span data-ttu-id="00d6d-114">這個屬性與 Destination 區段完全無關，因為它包含的是哪兒也不去的字串值 (您所設定的值)，所以配接器會將這些字串保存在這個區段內。</span><span class="sxs-lookup"><span data-stu-id="00d6d-114">This has nothing to do with the Destination section; it contains strings of values that you set that could not go anywhere else, so the adapter has held them here in this section.</span></span>  
  
 <span data-ttu-id="00d6d-115">`ReplyTo` 屬性可以設定於協調流程，以便告知最終取用者要將回應送往何處。</span><span class="sxs-lookup"><span data-stu-id="00d6d-115">The `ReplyTo` property can be set in the orchestration to tell an eventual consumer where to send a response.</span></span> <span data-ttu-id="00d6d-116">當訊息接收自 TIBCOEMS 時，EMS 會設定 `Destination` 屬性。</span><span class="sxs-lookup"><span data-stu-id="00d6d-116">EMS sets the `Destination` property when the message is received from TIBCOEMS.</span></span> <span data-ttu-id="00d6d-117">在訊息為接收自 TIBCOEMS 的協調流程中，這個第二個屬性具有唯讀性質，因此無法在協調流程中加以編輯。</span><span class="sxs-lookup"><span data-stu-id="00d6d-117">This second property is read-only in the orchestration receiving the message from TIBCOEMS and cannot be edited in the orchestration.</span></span>  
  
 <span data-ttu-id="00d6d-118">例如，協調流程無法動態地分派協調流程內的訊息和設定訊息目的地。</span><span class="sxs-lookup"><span data-stu-id="00d6d-118">For example, an orchestration cannot dispatch messages and set the destination dynamically inside an orchestration.</span></span> <span data-ttu-id="00d6d-119">Destination 的值會依據將傳送該訊息的連接埠而設定。</span><span class="sxs-lookup"><span data-stu-id="00d6d-119">The value of Destination is set by the port to which the message is being transmitted.</span></span>  
  
 <span data-ttu-id="00d6d-120">若您要將訊息分派到不同的佇列，您就必須針對個別佇列建立傳送埠。</span><span class="sxs-lookup"><span data-stu-id="00d6d-120">If you want to dispatch messages to different queues, you must create send ports for each queue.</span></span> <span data-ttu-id="00d6d-121">這樣一來，協調流程就可以決定將哪個連接埠指派給該訊息。</span><span class="sxs-lookup"><span data-stu-id="00d6d-121">The orchestration can then decide which port to assign the message.</span></span>  
  
 <span data-ttu-id="00d6d-122">在下面這個訊息範例中，Destination= `{Queue[Q1]}` 具唯讀性質。</span><span class="sxs-lookup"><span data-stu-id="00d6d-122">In the following message example, the Destination= `{Queue[Q1]}` is read-only.</span></span> <span data-ttu-id="00d6d-123">這個值是 TIBCOEMS 在伺服器接收訊息時設定的。</span><span class="sxs-lookup"><span data-stu-id="00d6d-123">This value is set by TIBCOEMS when the server receives the message.</span></span> <span data-ttu-id="00d6d-124">Destination 和 Q1 的值來自「傳輸屬性」。</span><span class="sxs-lookup"><span data-stu-id="00d6d-124">The value for Destination, Q1, comes from the Transport Properties.</span></span>  
  
#### <a name="example"></a><span data-ttu-id="00d6d-125">範例</span><span class="sxs-lookup"><span data-stu-id="00d6d-125">Example</span></span>  
  
```  
TextMessage={   
    Header={ MessageID={ID:EMS-SERVER.824437A58B11C75F4:1}   
    Destination={Queue[Q1]}   
  
        ' This is READONLY. It gets set by the server when the  
        ' message is received by the server (EMS). It is set in the  
        ' Transport Properties when you specify that you want to  
        ' listen for messages on Q1.  
    ReplyTo={}   
    DeliveryMode={Persistent}   
    Redelivered={False}   
    CorrelationID={}   
    MsgType={}   
    Timestamp={12/1/2005 11:59:01 PM}   
    Expiration={0}   
    Priority={1} }   
    Properties={ Destination={String:Queue[Q2]} }   
  
        ' This is a property that contains a string, and the   
        ' contents of the string is Q2. This has nothing to do with  
        ' the Destination section above – it is just another   
        ' property that is set.   
        ' This is in the schema. The adapter knows what it can and   
        ' cannot set in an EMS header. The values that the adapter   
        ' cannot set are put in the Properties section.   
    text={<?xml version="1.0" encoding="utf-16"?>  
    <ns0:Employees xmlns:ns0="http://BizTalk_Server_Project1.Employee">  
        <Emp Id="Id_0">  
            Name>Name_0</Name>  
        </Emp>  
    </ns0:Employees>  
    }  
```  
  
 <span data-ttu-id="00d6d-126">標頭內含的一連串預先定義欄位，包含了配接器會升級到 BizTalk Server 訊息以便用於協調流程的值。</span><span class="sxs-lookup"><span data-stu-id="00d6d-126">The header contains a series of predefined fields that contain values, which the adapter promotes to the BizTalk Server message context for use in the orchestration.</span></span> <span data-ttu-id="00d6d-127">所升級屬性在標準標頭屬性中的定義，與 JMS 規格和 TIBCO Enterprise Message Service 延伸所下的定義，完全相同。</span><span class="sxs-lookup"><span data-stu-id="00d6d-127">The promoted properties are identical in definition to the standard header properties as defined by the JMS specification and the TIBCO Enterprise Message Service extensions.</span></span> <span data-ttu-id="00d6d-128">訊息是接收自 EMS 的協調流程可以使用所有屬性，但是 `Destination` 和 `ReplyTo` 除外，這兩個屬性描述的是無法正確對應以作為協調流程中單一屬性使用的目的地。</span><span class="sxs-lookup"><span data-stu-id="00d6d-128">All properties except for two are available to the orchestration as received from EMS: `Destination` and `ReplyTo` describe a destination that cannot be correctly mapped for use in an orchestration as a single property.</span></span>  
  
 <span data-ttu-id="00d6d-129">BizTalk Adapter for TIBCO EMS 會將 TIBCOEMS 屬性對應成字串型別，並且使用 Destination 字串表示法。</span><span class="sxs-lookup"><span data-stu-id="00d6d-129">BizTalk Adapter for TIBCO EMS maps the TIBCOEMS property to a string type and uses the Destination string representation.</span></span> <span data-ttu-id="00d6d-130">這個字串看起來像是 `StaticQueue[queuename]` 或 `StatisTopic[topicname]`。</span><span class="sxs-lookup"><span data-stu-id="00d6d-130">This looks like `StaticQueue[queuename]` or `StatisTopic[topicname]`.</span></span> <span data-ttu-id="00d6d-131">協調流程可以設定 `ReplyTo` 的值，而配接器會用標頭中的有效目的地物件來取代該值。</span><span class="sxs-lookup"><span data-stu-id="00d6d-131">The orchestration can set the value for `ReplyTo`, and the adapter replaces it with a valid destination object in the header.</span></span>  
  
 <span data-ttu-id="00d6d-132">配接器會提供結構描述和參考組件，這兩者會描述可供協調流程使用的任何 TIBCO EMS 標頭屬性。</span><span class="sxs-lookup"><span data-stu-id="00d6d-132">The adapter provides a schema and reference assembly describing all TIBCO EMS header properties that can be used by orchestrations.</span></span> <span data-ttu-id="00d6d-133">這些屬性可用於篩選內送訊息，或是加入到外寄訊息。</span><span class="sxs-lookup"><span data-stu-id="00d6d-133">These properties can be used to either filter incoming messages or to add to the outgoing message.</span></span> <span data-ttu-id="00d6d-134">掌控協調流程篩選條件的規則，不同於 EMS 伺服器訊息選取器所使用的規則。</span><span class="sxs-lookup"><span data-stu-id="00d6d-134">The rules governing the orchestration filter differs from those for the message selector for the EMS server.</span></span> <span data-ttu-id="00d6d-135">例如，協調流程可以就 `TibcoEMS.ReplyTo` 或 `TibcoEMS.Destination` 屬性進行篩選，但是 JMS 規格並未提供任何讓訊息選取器就此相同屬性進行篩選的支援。</span><span class="sxs-lookup"><span data-stu-id="00d6d-135">For example, orchestrations can filter on the `TibcoEMS.ReplyTo` or the `TibcoEMS.Destination` property, but there is no support in the JMS specification to allow message selector on this same property.</span></span>  
  
 <span data-ttu-id="00d6d-136">當協調流程有設定這些屬性時，JMS 訊息的標頭屬性中就會包含這些屬性。</span><span class="sxs-lookup"><span data-stu-id="00d6d-136">When these properties are defined by the orchestration, they are included in the header properties of the JMS message.</span></span> <span data-ttu-id="00d6d-137">否則，當 EMS 訊息獲得接收時，這些標頭屬性就會複製到 BizTalk Server 訊息內容中。</span><span class="sxs-lookup"><span data-stu-id="00d6d-137">Alternatively, when the EMS message is received, these header properties are copied to the BizTalk Server message context.</span></span>  
  
 <span data-ttu-id="00d6d-138">當某個屬性與連接埠組態相符時，在訊息上之該屬性值的優先順序便會高於該連接埠組態。</span><span class="sxs-lookup"><span data-stu-id="00d6d-138">When a property matches the port configuration, the value of the property on the message takes precedence on the port’s configuration.</span></span> <span data-ttu-id="00d6d-139">例如，如果連接埠內所設定的優先順序為 4，而您在協調流程邏輯中是將訊息的優先順序設成 9，則此訊息會依據優先順序 9 來由 TIBCO EMS 接收。</span><span class="sxs-lookup"><span data-stu-id="00d6d-139">For example, if the priority is set to 4 in the port, but you set the priority of the message to 9 in the logic of the orchestration, the message is received by TIBCO EMS as having a priority of 9.</span></span>  
  
### <a name="property-descriptions"></a><span data-ttu-id="00d6d-140">屬性描述</span><span class="sxs-lookup"><span data-stu-id="00d6d-140">Property Descriptions</span></span>  
 <span data-ttu-id="00d6d-141">下表描述 BizTalk Adapter for TIBCO Enterprise Message Service 如何使用各個屬性。</span><span class="sxs-lookup"><span data-stu-id="00d6d-141">The following table describes how each property is used by BizTalk Adapter for TIBCO Enterprise Message Service.</span></span>  
  
|<span data-ttu-id="00d6d-142">名稱</span><span class="sxs-lookup"><span data-stu-id="00d6d-142">Name</span></span>|<span data-ttu-id="00d6d-143">型別</span><span class="sxs-lookup"><span data-stu-id="00d6d-143">Type</span></span>|<span data-ttu-id="00d6d-144">Description</span><span class="sxs-lookup"><span data-stu-id="00d6d-144">Description</span></span>|  
|----------|----------|-----------------|  
|<span data-ttu-id="00d6d-145">TibcoEMS.MessageID</span><span class="sxs-lookup"><span data-stu-id="00d6d-145">TibcoEMS.MessageID</span></span>|<span data-ttu-id="00d6d-146">string</span><span class="sxs-lookup"><span data-stu-id="00d6d-146">string</span></span>|<span data-ttu-id="00d6d-147">傳送呼叫，可為各個訊息指派唯一識別碼，並將此識別碼記錄在標頭中。</span><span class="sxs-lookup"><span data-stu-id="00d6d-147">Sending calls assign a unique ID to each message and record it in the header.</span></span><br /><br /> <span data-ttu-id="00d6d-148">任何訊息識別碼值的開頭都是 3 個字元組成的前置識別碼 (已就這個用途而保留)。</span><span class="sxs-lookup"><span data-stu-id="00d6d-148">All message ID values start with the three-character prefix ID (which is reserved for this purpose).</span></span><br /><br /> <span data-ttu-id="00d6d-149">唯讀。</span><span class="sxs-lookup"><span data-stu-id="00d6d-149">Read-only.</span></span> <span data-ttu-id="00d6d-150">變更這個值並不會影響訊息。</span><span class="sxs-lookup"><span data-stu-id="00d6d-150">Changing the value does not affect the message.</span></span>|  
|<span data-ttu-id="00d6d-151">TibcoEMS.Timestamp</span><span class="sxs-lookup"><span data-stu-id="00d6d-151">TibcoEMS.Timestamp</span></span>|<span data-ttu-id="00d6d-152">long</span><span class="sxs-lookup"><span data-stu-id="00d6d-152">long</span></span>|<span data-ttu-id="00d6d-153">傳送呼叫，可在標頭中記錄 UTC 時間戳記。</span><span class="sxs-lookup"><span data-stu-id="00d6d-153">Sending calls record a UTC timestamp in the header.</span></span> <span data-ttu-id="00d6d-154">這個時間戳記會指出伺服器接受訊息的大致估計時間。</span><span class="sxs-lookup"><span data-stu-id="00d6d-154">This indicates the approximate time that the server accepted the message.</span></span><br /><br /> <span data-ttu-id="00d6d-155">這個值是自 1970 年 1 月 1 日以來所經過的毫秒數。</span><span class="sxs-lookup"><span data-stu-id="00d6d-155">The value is in milliseconds since January 1, 1970</span></span><br /><br /> <span data-ttu-id="00d6d-156">唯讀。</span><span class="sxs-lookup"><span data-stu-id="00d6d-156">Read-only.</span></span> <span data-ttu-id="00d6d-157">變更這個值並不會影響訊息。</span><span class="sxs-lookup"><span data-stu-id="00d6d-157">Changing the value does not affect the message.</span></span>|  
|<span data-ttu-id="00d6d-158">TibcoEMS.Redelivered</span><span class="sxs-lookup"><span data-stu-id="00d6d-158">TibcoEMS.Redelivered</span></span>|<span data-ttu-id="00d6d-159">boolean</span><span class="sxs-lookup"><span data-stu-id="00d6d-159">boolean</span></span>|<span data-ttu-id="00d6d-160">伺服器會將標頭設定成指出某個訊息是否與先前所傳送的訊息重複：</span><span class="sxs-lookup"><span data-stu-id="00d6d-160">The server sets the header to indicate whether a message might duplicate a previously delivered message:</span></span><br /><br /> <span data-ttu-id="00d6d-161">-false-伺服器尚未先前嘗試將這個訊息傳送給取用者。</span><span class="sxs-lookup"><span data-stu-id="00d6d-161">-   false—The server has not previously tried to deliver this message to the consumer.</span></span><br /><span data-ttu-id="00d6d-162">-為 true，它是可能的但不是保證，伺服器先前已嘗試將此訊息傳送給取用者，但取用者未傳回具時效性的應答。</span><span class="sxs-lookup"><span data-stu-id="00d6d-162">-   true—It is likely, but not guaranteed, that the server has previously tried to deliver this message to the consumer, but the consumer did not return timely acknowledgement.</span></span><br /><br /> <span data-ttu-id="00d6d-163">唯讀。</span><span class="sxs-lookup"><span data-stu-id="00d6d-163">Read-only.</span></span> <span data-ttu-id="00d6d-164">變更這個值並不會影響訊息。</span><span class="sxs-lookup"><span data-stu-id="00d6d-164">Changing the value does not affect the message.</span></span>|  
|<span data-ttu-id="00d6d-165">TibcoEMS.Destination</span><span class="sxs-lookup"><span data-stu-id="00d6d-165">TibcoEMS.Destination</span></span>|<span data-ttu-id="00d6d-166">string</span><span class="sxs-lookup"><span data-stu-id="00d6d-166">string</span></span>|<span data-ttu-id="00d6d-167">傳送呼叫，可在這個標頭中記錄此訊息的目的地 (佇列或主題)。</span><span class="sxs-lookup"><span data-stu-id="00d6d-167">Sending calls record the destination (queue or topic) of the message in this header.</span></span> <span data-ttu-id="00d6d-168">格式會從目的地改成字串表示法。</span><span class="sxs-lookup"><span data-stu-id="00d6d-168">The format is adapted from a destination to a string.</span></span> <span data-ttu-id="00d6d-169">格式已於先前內容中介紹過。</span><span class="sxs-lookup"><span data-stu-id="00d6d-169">The format is previously described.</span></span><br /><br /> <span data-ttu-id="00d6d-170">唯讀。</span><span class="sxs-lookup"><span data-stu-id="00d6d-170">Read-only.</span></span> <span data-ttu-id="00d6d-171">變更這個值並不會影響訊息。</span><span class="sxs-lookup"><span data-stu-id="00d6d-171">Changing the value does not affect the message.</span></span>|  
|<span data-ttu-id="00d6d-172">TibcoEMS.DeliveryMode</span><span class="sxs-lookup"><span data-stu-id="00d6d-172">TibcoEMS.DeliveryMode</span></span>|<span data-ttu-id="00d6d-173">string</span><span class="sxs-lookup"><span data-stu-id="00d6d-173">string</span></span>|<span data-ttu-id="00d6d-174">有兩個可能的值： 持續性和非持續性。</span><span class="sxs-lookup"><span data-stu-id="00d6d-174">Has two possible values: PERSISTENT and NON-PERSISTENT.</span></span> <span data-ttu-id="00d6d-175">預設值為 PERSISTENT 模式。</span><span class="sxs-lookup"><span data-stu-id="00d6d-175">Default value is PERSISTENT mode.</span></span><br /><br /> <span data-ttu-id="00d6d-176">配接器會先等候來自 EMS 伺服器的通知，接著才發出訊息已傳送到 BizTalk Server 的通知。</span><span class="sxs-lookup"><span data-stu-id="00d6d-176">The adapter waits for an acknowledgement from the EMS server before acknowledging the message sent to BizTalk Server.</span></span> <span data-ttu-id="00d6d-177">這個標頭屬性和連接埠組態項目會決定 EMS 將這個通知傳送給配接器時所花費的時間，並決定訊息傳輸的穩定性。</span><span class="sxs-lookup"><span data-stu-id="00d6d-177">This header property and port configuration item controls the time EMS takes to send this acknowledgement to the adapter and control the reliability of message transmission.</span></span><br /><br /> <span data-ttu-id="00d6d-178">使用 PERSISTENT 傳遞模式 -- EMS 伺服器會一直等候到訊息成功保存於 EMS 伺服器中。</span><span class="sxs-lookup"><span data-stu-id="00d6d-178">Using PERSISTENT delivery mode—the EMS server waits until the message is successfully persisted in the EMS server.</span></span> <span data-ttu-id="00d6d-179">這個動作可保證該訊息有送達佇列。</span><span class="sxs-lookup"><span data-stu-id="00d6d-179">This action guarantees that the message has arrived in the queue.</span></span> <span data-ttu-id="00d6d-180">使用 PERSISTENT 模式傳遞時，請注意下列幾點：</span><span class="sxs-lookup"><span data-stu-id="00d6d-180">When you use PERSISTENT mode delivery, consider the following:</span></span><br /><br /> <span data-ttu-id="00d6d-181">訊息越大，BizTalk Server 就會花更多時間來判定該訊息為已傳送。</span><span class="sxs-lookup"><span data-stu-id="00d6d-181">The larger the messages, the longer it takes for BizTalk Server to consider the message as sent.</span></span><br /><br /> <span data-ttu-id="00d6d-182">使用 NON-PERSISTENT 模式 -- EMS 伺服器會先傳回通知，再保存該訊息。</span><span class="sxs-lookup"><span data-stu-id="00d6d-182">Using NON-PERSISTENT mode—the EMS server returns the acknowledgement before persisting the message.</span></span> <span data-ttu-id="00d6d-183">如果 EMS 伺服器發生失敗，在系統判定 BizTalk Server 已成功傳送該訊息之際，訊息可能已經遺失了。</span><span class="sxs-lookup"><span data-stu-id="00d6d-183">If a failure were to occur with the EMS server, the message might be lost when it is considered successfully sent by BizTalk Server.</span></span>|  
|<span data-ttu-id="00d6d-184">TibcoEMS.Expiration</span><span class="sxs-lookup"><span data-stu-id="00d6d-184">TibcoEMS.Expiration</span></span>|<span data-ttu-id="00d6d-185">long</span><span class="sxs-lookup"><span data-stu-id="00d6d-185">long</span></span>|<span data-ttu-id="00d6d-186">訊息在過期前維持有效的時間長度。</span><span class="sxs-lookup"><span data-stu-id="00d6d-186">Length of time that the message will live before expiration.</span></span> <span data-ttu-id="00d6d-187">如果設成 0，表示訊息永遠不會過期。</span><span class="sxs-lookup"><span data-stu-id="00d6d-187">If set to 0, message does not expire.</span></span><br /><br /> <span data-ttu-id="00d6d-188">此段有效時間的指定單位是毫秒。</span><span class="sxs-lookup"><span data-stu-id="00d6d-188">The time-to-live is specified in milliseconds.</span></span>|  
|<span data-ttu-id="00d6d-189">TibcoEMS.Priority</span><span class="sxs-lookup"><span data-stu-id="00d6d-189">TibcoEMS.Priority</span></span>|<span data-ttu-id="00d6d-190">int</span><span class="sxs-lookup"><span data-stu-id="00d6d-190">int</span></span>|<span data-ttu-id="00d6d-191">使用從 0 到 9 的數字排名，定義訊息的優先順序為一般或是加速。</span><span class="sxs-lookup"><span data-stu-id="00d6d-191">Uses a numeric ranking, between 0 and 9, to define message priority as normal or expedited.</span></span> <span data-ttu-id="00d6d-192">數字越大表示優先順序越前面。</span><span class="sxs-lookup"><span data-stu-id="00d6d-192">Larger numbers represent higher priority.</span></span>|  
|<span data-ttu-id="00d6d-193">TibcoEMS.CorrolationID</span><span class="sxs-lookup"><span data-stu-id="00d6d-193">TibcoEMS.CorrolationID</span></span>|<span data-ttu-id="00d6d-194">string</span><span class="sxs-lookup"><span data-stu-id="00d6d-194">string</span></span>|<span data-ttu-id="00d6d-195">可以用來連結訊息，例如將回應訊息連結到要求訊息。</span><span class="sxs-lookup"><span data-stu-id="00d6d-195">Can be used to link messages, such as linking a response message to a request message.</span></span><br /><br /> <span data-ttu-id="00d6d-196">這個屬性值通常就是 `EMS.JMSMessageID`。</span><span class="sxs-lookup"><span data-stu-id="00d6d-196">Usually this is the same value as the `EMS.JMSMessageID`.</span></span> <span data-ttu-id="00d6d-197">這個屬性通常與 `EMS.JMSReplyTo` 屬性搭配使用。</span><span class="sxs-lookup"><span data-stu-id="00d6d-197">This is usually used together with the `EMS.JMSReplyTo` property.</span></span>|  
|<span data-ttu-id="00d6d-198">TibcoEMS.ReplyTo</span><span class="sxs-lookup"><span data-stu-id="00d6d-198">TibcoEMS.ReplyTo</span></span>|<span data-ttu-id="00d6d-199">string</span><span class="sxs-lookup"><span data-stu-id="00d6d-199">string</span></span>|<span data-ttu-id="00d6d-200">訊息回覆時應該送至其中的目的地。</span><span class="sxs-lookup"><span data-stu-id="00d6d-200">A destination to which a message reply should be sent.</span></span> <span data-ttu-id="00d6d-201">格式和連接埠組態與 `EMS.JMSDestination` 的設定相同。</span><span class="sxs-lookup"><span data-stu-id="00d6d-201">Format is identical to the `EMS.JMSDestination` and also the port's configuration.</span></span>|  
|<span data-ttu-id="00d6d-202">TibcoEMS.Type</span><span class="sxs-lookup"><span data-stu-id="00d6d-202">TibcoEMS.Type</span></span>|<span data-ttu-id="00d6d-203">string</span><span class="sxs-lookup"><span data-stu-id="00d6d-203">string</span></span>|<span data-ttu-id="00d6d-204">不描述訊息類型 (文字、位元組、字串…)。</span><span class="sxs-lookup"><span data-stu-id="00d6d-204">Does not describe the message type (text, byte, string …).</span></span><br /><br /> <span data-ttu-id="00d6d-205">有些 JMS 提供者會使用訊息儲存機制來存放訊息類型定義。</span><span class="sxs-lookup"><span data-stu-id="00d6d-205">Some JMS providers use a message repository to store message type definitions.</span></span> <span data-ttu-id="00d6d-206">用戶端程式可在這個欄位中，存放可參考至該儲存機制內定義的值。</span><span class="sxs-lookup"><span data-stu-id="00d6d-206">Client programs can store a value in this field to reference a definition in the repository.</span></span> <span data-ttu-id="00d6d-207">EMS 支援這個標頭，但是並不會使用它。</span><span class="sxs-lookup"><span data-stu-id="00d6d-207">EMS supports this header but does not use it.</span></span><br /><br /> <span data-ttu-id="00d6d-208">JMS 規格不會定義標準的訊息定義儲存機制，也不會定義訊息類型定義的命名原則。</span><span class="sxs-lookup"><span data-stu-id="00d6d-208">The JMS specification does not define a standard message definition repository, nor does it define a naming policy for message type definitions.</span></span><br /><br /> <span data-ttu-id="00d6d-209">有些提供者需要使用各個應用程式訊息的訊息類型定義。</span><span class="sxs-lookup"><span data-stu-id="00d6d-209">Some providers require message type definitions for each application message.</span></span> <span data-ttu-id="00d6d-210">為了保證與這類提供者維持相容性，用戶端程式可以設定這個標頭，即使該用戶端應用程式並不會使用該標頭。</span><span class="sxs-lookup"><span data-stu-id="00d6d-210">To guarantee compatibility with such providers, client programs can set this header, even if the client application does not use it.</span></span><br /><br /> <span data-ttu-id="00d6d-211">為了保證可攜性，用戶端可以用符號值 (而不要用常值) 來設定這個標頭，並將標頭設定成與提供者的儲存機制相符。</span><span class="sxs-lookup"><span data-stu-id="00d6d-211">To guarantee portability, clients can set this header with symbolic values (instead of literals), and configure them to match the provider's repository.</span></span>|  
  
## <a name="properties"></a><span data-ttu-id="00d6d-212">屬性</span><span class="sxs-lookup"><span data-stu-id="00d6d-212">Properties</span></span>  
 <span data-ttu-id="00d6d-213">整合者可以定義要升級到 BizTalk Server 訊息內容的一組屬性，等到升級過後，這些屬性就會加入到 JMS 訊息的屬性部分。</span><span class="sxs-lookup"><span data-stu-id="00d6d-213">The integrator can define a set of properties to promote to the BizTalk Server message context, after which the properties are added to the properties part of the JMS message.</span></span> <span data-ttu-id="00d6d-214">整合者會在建立結構描述的同時，注意何時要定義該屬性的類型。</span><span class="sxs-lookup"><span data-stu-id="00d6d-214">The integrator takes care when defining the type of the property while it is creating the schema.</span></span> <span data-ttu-id="00d6d-215">如果這個屬性值將用於訊息選取器，這個屬性的型別將會決定特定作業是否可有效執行。</span><span class="sxs-lookup"><span data-stu-id="00d6d-215">If this property value is used in a message selector, certain operations are valid depending on the type of the property.</span></span> <span data-ttu-id="00d6d-216">例如，如果訊息選取器**myMessageProperty > 5**是使用，必須將屬性定義為整數值，而且配接器會將該值放成為整數值的訊息中。</span><span class="sxs-lookup"><span data-stu-id="00d6d-216">For example, if a message selector **myMessageProperty > 5** is used, the property must be defined as an integer value, and the adapter puts the value in the message as an integer value.</span></span> <span data-ttu-id="00d6d-217">對於要升級的屬性，屬性名稱的開頭必須是 EMSX，</span><span class="sxs-lookup"><span data-stu-id="00d6d-217">For the properties to be promoted, the property names must start with EMSX.</span></span> <span data-ttu-id="00d6d-218">而且屬性名稱不能和預先定義的屬性相同。</span><span class="sxs-lookup"><span data-stu-id="00d6d-218">They must also not have the same name as the predefined properties.</span></span>  
  
 <span data-ttu-id="00d6d-219">BizTalk Adapter for TIBCO Enterprise Message Service 會提供結構描述和組件，這兩者會宣告可能出現在這個區段中的 EMS 專屬和 JMS 專屬屬性。</span><span class="sxs-lookup"><span data-stu-id="00d6d-219">BizTalk Adapter for TIBCO Enterprise Message Service provides a schema and assembly, which declare the EMS- and JMS-specific properties that can appear in this section.</span></span> <span data-ttu-id="00d6d-220">這些屬性可予以增加以包含任何遺漏。</span><span class="sxs-lookup"><span data-stu-id="00d6d-220">These can be augmented to include any omissions.</span></span> <span data-ttu-id="00d6d-221">在此訊息內容中加以參考的任何 EMSX 屬性，都會放入該 EMS 訊息的訊息屬性區段。</span><span class="sxs-lookup"><span data-stu-id="00d6d-221">All EMSX properties referenced in the message context are put in the message property section of the EMS message.</span></span> <span data-ttu-id="00d6d-222">如需詳細資訊，請參閱《TIBCO EMS 使用者指南》。</span><span class="sxs-lookup"><span data-stu-id="00d6d-222">For more information, see the TIBCO EMS Users Guide.</span></span>  
  
## <a name="body"></a><span data-ttu-id="00d6d-223">本文</span><span class="sxs-lookup"><span data-stu-id="00d6d-223">Body</span></span>  
 <span data-ttu-id="00d6d-224">EMS 支援列舉於 JMS 規格中的所有訊息： 文字、 位元組、 資料流、 對應和物件。</span><span class="sxs-lookup"><span data-stu-id="00d6d-224">EMS supports all messages enumerated in the JMS specification: text, byte, stream, map, and object.</span></span> <span data-ttu-id="00d6d-225">BizTalk Adapter for TIBCO EMS 支援文字訊息類型。</span><span class="sxs-lookup"><span data-stu-id="00d6d-225">The BizTalk Adapter for TIBCO EMS supports only the text message type.</span></span>  
  
 <span data-ttu-id="00d6d-226">JMS 不要求文字訊息類型一定要包含 XML 格式的內文。</span><span class="sxs-lookup"><span data-stu-id="00d6d-226">JMS does not require that messages of type text contain XML-formatted bodies.</span></span> <span data-ttu-id="00d6d-227">配接器不會處理訊息; 本文提供給[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]接收。</span><span class="sxs-lookup"><span data-stu-id="00d6d-227">The adapter does not process the body of the message; it is provided to [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] as received.</span></span>  <span data-ttu-id="00d6d-228">因此，配接器提交至 BizTalk 訊息可能並不一定剖析為 XML 資料。</span><span class="sxs-lookup"><span data-stu-id="00d6d-228">Therefore, messages submitted to BizTalk by the adapter may not always parse as XML data.</span></span>  
  
## <a name="persistent-messages"></a><span data-ttu-id="00d6d-229">保存的訊息</span><span class="sxs-lookup"><span data-stu-id="00d6d-229">Persistent Messages</span></span>  
 <span data-ttu-id="00d6d-230">訊息可以保存在 EMS 伺服器上來保證完整一次傳遞給訂閱者，但是，這種作法可能會嚴重影響到配接器的效能。</span><span class="sxs-lookup"><span data-stu-id="00d6d-230">Messages can be persisted on the EMS server to guarantee exactly one-time delivery to a subscriber; however, this can have a significant impact on the adapter's performance.</span></span> <span data-ttu-id="00d6d-231">當您傳送訊息時，EMS 會先將訊息存放在本機儲存區，再向配接器發出已接收訊息的通知。</span><span class="sxs-lookup"><span data-stu-id="00d6d-231">When you send messages, EMS stores the message in local storage before acknowledging reception of the message to the adapter.</span></span> <span data-ttu-id="00d6d-232">您可以在協調流程中針對各個訊息來設定這個屬性，或是針對連接埠所處理的任何訊息設定這個屬性。</span><span class="sxs-lookup"><span data-stu-id="00d6d-232">You can set this property on a per-message basis in the orchestration or for all messages processed by the port.</span></span>  
  
 <span data-ttu-id="00d6d-233">就接收的角度來說，配接器可能會在主題沒有訂閱訊息情況下遺漏掉某些訊息。</span><span class="sxs-lookup"><span data-stu-id="00d6d-233">From the receiving aspect, the adapter can miss messages when it is not subscribed to the topic.</span></span> <span data-ttu-id="00d6d-234">當 EMS 沒有保存任何訂閱時，訊息就會張貼到主題上。</span><span class="sxs-lookup"><span data-stu-id="00d6d-234">Messages posted to topics when there are no subscriptions are not persisted by EMS.</span></span> <span data-ttu-id="00d6d-235">配接器需要某種機制，接收訊息張貼即使目前未訂閱;不過，像使用的持續性的訊息，這會對 EMS 效能，具有顯著的影響，它不一定需要。</span><span class="sxs-lookup"><span data-stu-id="00d6d-235">The adapter needs a mechanism to receive message postings even when not currently subscribed; however, like the use of persistent messages, this has a significant impact on the EMS performance, and it is not always required.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="00d6d-236">還有一種從 EMS 檢視位置進行接收的機制，不過這種機制尚未實作，也沒有實際的需要。</span><span class="sxs-lookup"><span data-stu-id="00d6d-236">There is a mechanism for receive from the point of view of EMS, but it is not implemented, nor is it really desired.</span></span> <span data-ttu-id="00d6d-237">這個問題只和主題有關，而不會影響到佇列。</span><span class="sxs-lookup"><span data-stu-id="00d6d-237">This is only an issue with topic; queues are not affected.</span></span> <span data-ttu-id="00d6d-238">主題通常是用於時間特定資料，例如，股票報價。</span><span class="sxs-lookup"><span data-stu-id="00d6d-238">A topic is generally used for time-specific data -- stock quotes, for example.</span></span> <span data-ttu-id="00d6d-239">當股票價格漏掉時，您知道稍後它就會補貼出來。</span><span class="sxs-lookup"><span data-stu-id="00d6d-239">If the price of a stock is missed, you know that it will be posted again later.</span></span>  
  
 <span data-ttu-id="00d6d-240">基於這些因素，您可以選擇為連接埠組態啟用或停用將訊息保存在 EMS 伺服器上。</span><span class="sxs-lookup"><span data-stu-id="00d6d-240">For these reasons the port configuration lets you enable or disable message persistence on the EMS server.</span></span>  
  
## <a name="message-acknowledgement"></a><span data-ttu-id="00d6d-241">訊息應答</span><span class="sxs-lookup"><span data-stu-id="00d6d-241">Message Acknowledgement</span></span>  
 <span data-ttu-id="00d6d-242">BizTalk Adapter for TIBCO Enterprise Message Service 一定會在訊息已正確分派給 BizTalk Server 時應答已接收訊息。</span><span class="sxs-lookup"><span data-stu-id="00d6d-242">BizTalk Adapter for TIBCO Enterprise Message Service always acknowledges reception of a message when that message was correctly dispatched to BizTalk Server.</span></span> <span data-ttu-id="00d6d-243">這樣表示，沒有應答的訊息會從 EMS 重新傳送給配接器。</span><span class="sxs-lookup"><span data-stu-id="00d6d-243">This means that unacknowledged messages are resent from EMS to the adapter.</span></span> <span data-ttu-id="00d6d-244">配接器無法決定 EMS 重新傳送訊息的次數，因為這是目的地本身的組態設定；但是，配接器可以決定該訊息是否要傳送到 MessageBox。</span><span class="sxs-lookup"><span data-stu-id="00d6d-244">The adapter cannot control the number of times the message is resent by EMS because this is a configuration of the destination itself; however, the adapter can control if the message is sent to the MessageBox or not.</span></span> <span data-ttu-id="00d6d-245">EMS 伺服器會決定失敗訊息傳送到佇列的最多次數。</span><span class="sxs-lookup"><span data-stu-id="00d6d-245">The EMS server controls the maximum number of times a failed message is sent to a queue.</span></span>  
  
 <span data-ttu-id="00d6d-246">對於重新傳遞的訊息，EMS 伺服器會將 `JMSRedelivered` 屬性設為 True，而且會遞增 `JMSXDeliveryCount`。</span><span class="sxs-lookup"><span data-stu-id="00d6d-246">For messages that are redelivered, the EMS server sets the `JMSRedelivered` property to True and increments the `JMSXDeliveryCount`.</span></span> <span data-ttu-id="00d6d-247">這兩種屬性值都可用於協調流程。</span><span class="sxs-lookup"><span data-stu-id="00d6d-247">Both property values are available to the orchestration.</span></span> <span data-ttu-id="00d6d-248">您不能在訊息還未傳遞之前就將它移到 EMS 未傳遞佇列。</span><span class="sxs-lookup"><span data-stu-id="00d6d-248">You cannot move a message to the EMS un-delivered queue without delivering it there.</span></span> <span data-ttu-id="00d6d-249">這樣做會改變訊息的屬性。</span><span class="sxs-lookup"><span data-stu-id="00d6d-249">Doing this would change the message properties.</span></span>  
  
 <span data-ttu-id="00d6d-250">當訊息到達其已設定的最大重新傳遞計數時，EMS 伺服器就會判斷該訊息應該要加以刪除，或是放入 $sys.undelivered 佇列。</span><span class="sxs-lookup"><span data-stu-id="00d6d-250">When a message reaches its configured maximum redelivery count, the EMS server determines whether the message should be deleted or put on the $sys.undelivered queue.</span></span> <span data-ttu-id="00d6d-251">EMS 伺服器會根據 `JMS_TIBCO_PRESERVE_UNDELIVERED` 屬性來做出決定；如果是 True，訊息就會前往未傳遞佇列，否則就會加以刪除。</span><span class="sxs-lookup"><span data-stu-id="00d6d-251">The EMS server makes the decision based on the `JMS_TIBCO_PRESERVE_UNDELIVERED` property; if True, the message goes to the undelivered queue, or it is deleted.</span></span> <span data-ttu-id="00d6d-252">這個屬性可以先設定於協調流程中，接著才傳送該訊息。</span><span class="sxs-lookup"><span data-stu-id="00d6d-252">This property can be set in the orchestration before sending the message.</span></span> <span data-ttu-id="00d6d-253">傳遞之後，訊息屬性就不能變更。</span><span class="sxs-lookup"><span data-stu-id="00d6d-253">After delivery, the message property cannot be changed.</span></span> <span data-ttu-id="00d6d-254">系統會在傳送到 EMS 的訊息成功抵達時應答 BizTalk Server。</span><span class="sxs-lookup"><span data-stu-id="00d6d-254">Messages sent to EMS are acknowledged to BizTalk Server when they are successful.</span></span> <span data-ttu-id="00d6d-255">如果對 EMS 的傳送發生失敗，這些訊息會擱置，並標記為可再嘗試。</span><span class="sxs-lookup"><span data-stu-id="00d6d-255">If there is a failure sending theme to EMS, they are suspended and marked as retryable.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="00d6d-256">另請參閱</span><span class="sxs-lookup"><span data-stu-id="00d6d-256">See Also</span></span>  
 [<span data-ttu-id="00d6d-257">快速入門</span><span class="sxs-lookup"><span data-stu-id="00d6d-257">Getting Started</span></span>](../core/getting-started-with-biztalk-adapter-for-tibco-enterprise-message-service.md)