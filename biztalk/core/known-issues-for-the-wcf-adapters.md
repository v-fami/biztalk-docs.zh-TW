---
title: WCF 配接器的已知問題 |Microsoft 文件
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 423c6021-5fb7-48c9-9319-11e7a18c775c
caps.latest.revision: 54
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 26c296dfb2ca1f05a2f403aa31a73b67934fb23a
ms.sourcegitcommit: 3fc338e52d5dbca2c3ea1685a2faafc7582fe23a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/01/2017
ms.locfileid: "26009751"
---
# <a name="known-issues-for-the-wcf-adapters"></a><span data-ttu-id="a7e35-102">WCF 配接器的已知問題</span><span class="sxs-lookup"><span data-stu-id="a7e35-102">Known Issues for the WCF Adapters</span></span>
<span data-ttu-id="a7e35-103">本主題描述 BizTalk Server 隨附的 WCF 配接器的已知的問題。</span><span class="sxs-lookup"><span data-stu-id="a7e35-103">This topic describes the known issues for the WCF adapters included with BizTalk Server.</span></span>  
  
## <a name="a-message-that-fails-in-the-inbound-soap-marshaling-processing-is-not-suspended-in-wcf-receive-adapters"></a><span data-ttu-id="a7e35-104">在輸入 SOAP 封送處理中失敗的訊息未在 WCF 接收配接器中遭擱置</span><span class="sxs-lookup"><span data-stu-id="a7e35-104">A message that fails in the inbound SOAP marshaling processing is not suspended in WCF receive adapters</span></span>  
 <span data-ttu-id="a7e35-105">當訊息抵達 WCF 接收配接器時，WCF 配接器會從內送 SOAP 訊息建立 BizTalk 訊息，然後將 BizTalk 訊息傳遞給結束點管理員管理的傳輸 Proxy。</span><span class="sxs-lookup"><span data-stu-id="a7e35-105">When a message arrives at a WCF receive adapter, the WCF adapter creates a BizTalk message from the incoming SOAP message, and then passes the BizTalk message to the transport proxy, which is managed by the Endpoint Manager.</span></span> <span data-ttu-id="a7e35-106">如果配接器在建立 BizTalk 訊息時無法讀取 SOAP 信封和內文，訊息不會遭擱置，因為配接器使用快速、非快取的順向讀取器來存取 SOAP 訊息。</span><span class="sxs-lookup"><span data-stu-id="a7e35-106">If the adapter fails to read the SOAP envelope and body while creating the BizTalk message, the message is not suspended because the adapter uses the fast, non-cached, and forward-only reader to access the SOAP message.</span></span>  
  
 <span data-ttu-id="a7e35-107">請查看事件日誌中的失敗訊息。</span><span class="sxs-lookup"><span data-stu-id="a7e35-107">You should check the event log for the failed message.</span></span> <span data-ttu-id="a7e35-108">例如，您可以使用內文路徑運算式上**訊息**WCF 配接器傳輸屬性對話方塊來指定如何從 SOAP 訊息內送 WCF 配接器透過建立輸入的 BizTalk 訊息內文中的索引標籤。</span><span class="sxs-lookup"><span data-stu-id="a7e35-108">For example, you can use a body path expression on the **Messages** tab in the WCF adapter transport properties dialog box to specify how to create the inbound BizTalk message body from a SOAP message incoming through the WCF adapter.</span></span> <span data-ttu-id="a7e35-109">當內送 SOAP 訊息無效的內文路徑運算式所提供的**訊息**索引標籤上，配接器就無法建立 BizTalk 訊息的工作，也無法擱置內送訊息。</span><span class="sxs-lookup"><span data-stu-id="a7e35-109">When an invalid body path expression for the incoming SOAP message is supplied on the **Messages** tab, the adapter fails to create the BizTalk message and cannot suspend the incoming message.</span></span> <span data-ttu-id="a7e35-110">如需有關如何使用內文路徑運算式上**訊息**索引標籤上，請參閱[指定 WCF 配接器的訊息本文](../core/specifying-the-message-body-for-the-wcf-adapters.md)。</span><span class="sxs-lookup"><span data-stu-id="a7e35-110">For more information about how to use the body path expression on the **Messages** tab, see [Specifying the Message Body for the WCF Adapters](../core/specifying-the-message-body-for-the-wcf-adapters.md).</span></span>  
  
 <span data-ttu-id="a7e35-111">下圖顯示**訊息** 索引標籤，您可以指定如何從內送 SOAP 訊息建立輸入的 BizTalk 訊息。</span><span class="sxs-lookup"><span data-stu-id="a7e35-111">The following figure shows the **Messages** tab on which you can specify how to create inbound BizTalk messages from the incoming SOAP messages.</span></span>  
  
## <a name="a-message-that-fails-in-the-inbound-soap-marshaling-processing-is-not-suspended-in-wcf-send-adapters"></a><span data-ttu-id="a7e35-112">在輸入 SOAP 封送處理中失敗的訊息未在 WCF 傳送配接器中遭擱置</span><span class="sxs-lookup"><span data-stu-id="a7e35-112">A message that fails in the inbound SOAP marshaling processing is not suspended in WCF send adapters</span></span>  
 <span data-ttu-id="a7e35-113">請求-回應 WCF 傳送埠可接收 WCF 訊息做為回應訊息。</span><span class="sxs-lookup"><span data-stu-id="a7e35-113">The solicit-response WCF send port can receive a WCF message as a response message.</span></span> <span data-ttu-id="a7e35-114">當訊息抵達 WCF 傳送配接器時，WCF 配接器會從內送 SOAP 訊息建立 BizTalk 訊息，然後將 BizTalk 訊息傳遞給結束點管理員管理的傳輸 Proxy。</span><span class="sxs-lookup"><span data-stu-id="a7e35-114">When the message arrives at the WCF send adapter, the WCF adapter creates the BizTalk message from the incoming SOAP message, and then passes the BizTalk message to the transport proxy, which is managed by the Endpoint Manager.</span></span> <span data-ttu-id="a7e35-115">如果配接器在建立 BizTalk 訊息時無法讀取 SOAP 信封和內文，訊息不會遭擱置，因為配接器使用快速、非快取的順向讀取器來存取 SOAP 訊息。</span><span class="sxs-lookup"><span data-stu-id="a7e35-115">If the adapter fails to read the SOAP envelope and body while creating the BizTalk message, the message is not suspended because the adapter uses the fast, non-cached, and forward-only reader to access the SOAP message.</span></span>  
  
 <span data-ttu-id="a7e35-116">請查看事件日誌中的失敗訊息。</span><span class="sxs-lookup"><span data-stu-id="a7e35-116">You should check the event log for the failed message.</span></span> <span data-ttu-id="a7e35-117">例如，您可以使用 XPath 運算式上**訊息**WCF 配接器傳輸屬性對話方塊來指定如何從 SOAP 訊息內送 WCF 配接器透過建立輸入的 BizTalk 訊息內文中的索引標籤。</span><span class="sxs-lookup"><span data-stu-id="a7e35-117">For example, you can use an XPath expression on the **Messages** tab in the WCF adapter transport properties dialog box to specify how to create the inbound BizTalk message body from a SOAP message incoming through the WCF adapter.</span></span> <span data-ttu-id="a7e35-118">當無效的 XPath 運算式內送 SOAP 訊息所提供的**訊息**索引標籤上，配接器就無法建立 BizTalk 訊息的工作，也無法擱置內送訊息。</span><span class="sxs-lookup"><span data-stu-id="a7e35-118">When an invalid XPath expression for the incoming SOAP message is supplied on the **Messages** tab, the adapter fails to create the BizTalk message and cannot suspend the incoming message.</span></span> <span data-ttu-id="a7e35-119">如需有關如何使用 XPath 運算式，在**訊息**索引標籤上，請參閱[指定 WCF 配接器的訊息本文](../core/specifying-the-message-body-for-the-wcf-adapters.md)。</span><span class="sxs-lookup"><span data-stu-id="a7e35-119">For more information about how to use the XPath expression on the **Messages** tab, see [Specifying the Message Body for the WCF Adapters](../core/specifying-the-message-body-for-the-wcf-adapters.md).</span></span>  
  
 <span data-ttu-id="a7e35-120">下圖顯示**訊息**Wcf-netnamedpipe 傳送配接器做為範例 索引標籤。</span><span class="sxs-lookup"><span data-stu-id="a7e35-120">The following figure shows the **Messages** tab of the WCF-NetNamedPipe send adapter as an example.</span></span>  
  
 <span data-ttu-id="a7e35-121">![[訊息] 索引標籤，在 WCF 傳送配接器](../core/media/54623ccf-49a9-4b6a-9487-da0d94bab64d.gif "54623ccf-49a9-4b6a-9487-da0d94bab64d")</span><span class="sxs-lookup"><span data-stu-id="a7e35-121">![The Messages tab in the WCF send adapters](../core/media/54623ccf-49a9-4b6a-9487-da0d94bab64d.gif "54623ccf-49a9-4b6a-9487-da0d94bab64d")</span></span>  
  
## <a name="messages-can-be-lost-when-using-onewaybindingelement-in-a-two-way-transport-with-custom-binding-in-non-transactional-wcf-receive-locations"></a><span data-ttu-id="a7e35-122">在非交易式 WCF 接受位置使用自訂繫結的雙向傳輸中若使用 OneWayBindingElement 時，訊息可能會遺失</span><span class="sxs-lookup"><span data-stu-id="a7e35-122">Messages can be lost when using OneWayBindingElement in a two-way transport with custom binding in non-transactional WCF receive locations</span></span>  
 <span data-ttu-id="a7e35-123">在雙向通訊中，WCF 配接器會傳回回應，直到訊息保存在 MessageBox 資料庫中。</span><span class="sxs-lookup"><span data-stu-id="a7e35-123">In a two-way communication, WCF adapters will send the response back until the messages have been persisted in the MessageBox database.</span></span> <span data-ttu-id="a7e35-124">不過，使用**OneWayBindingElement**分派到 WCF 配接器接收的訊息之前，立即產生虛擬回應。</span><span class="sxs-lookup"><span data-stu-id="a7e35-124">However, using **OneWayBindingElement** generates a dummy response immediately before dispatching the received message to the WCF adapter.</span></span> <span data-ttu-id="a7e35-125">因此，如果您設定的自訂繫結**OneWayBindingElement**通道堆疊中針對雙向傳輸中非交易式接收位置，因為 WCF 配接器處理接收的訊息可能會遺失以單向方式訊息。</span><span class="sxs-lookup"><span data-stu-id="a7e35-125">Therefore, if you configure a custom binding with a **OneWayBindingElement** in the channel stack for two-way transport in non-transactional receive locations, messages can be lost because the WCF adapters process the received messages in the one-way fashion.</span></span>  
  
## <a name="default-values-of-the-readerquotas-attributes-in-the-wcf-custom-and-wcf-customisolated-transport-properties-dialog-boxes-are-used-when-constructing-the-bindings"></a><span data-ttu-id="a7e35-126">建構繫結時，會使用 WCF-Custom 和 WCF-CustomIsolated 傳輸屬性對話方塊中的 ReaderQuotas 屬性預設值</span><span class="sxs-lookup"><span data-stu-id="a7e35-126">Default values of the ReaderQuotas attributes in the WCF-Custom and WCF-CustomIsolated transport properties dialog boxes are used when constructing the bindings</span></span>  
 <span data-ttu-id="a7e35-127">在 Wcf-custom 和 Wcf-customisolated 傳輸屬性 對話方塊中， **ReaderQuotas**屬性值會顯示為零。</span><span class="sxs-lookup"><span data-stu-id="a7e35-127">In the WCF-Custom and WCF-CustomIsolated transport properties dialog boxes, the **ReaderQuotas** attribute values are shown as zero.</span></span> <span data-ttu-id="a7e35-128">不過，當建構繫結時，會使用下列值：</span><span class="sxs-lookup"><span data-stu-id="a7e35-128">However, when constructing the bindings, the following values are used:</span></span>  
  
|<span data-ttu-id="a7e35-129">Attribute</span><span class="sxs-lookup"><span data-stu-id="a7e35-129">Attribute</span></span>|<span data-ttu-id="a7e35-130">Description</span><span class="sxs-lookup"><span data-stu-id="a7e35-130">Description</span></span>|<span data-ttu-id="a7e35-131">值</span><span class="sxs-lookup"><span data-stu-id="a7e35-131">Value</span></span>|  
|---------------|-----------------|-----------|  
|<span data-ttu-id="a7e35-132">maxArrayLength</span><span class="sxs-lookup"><span data-stu-id="a7e35-132">maxArrayLength</span></span>|<span data-ttu-id="a7e35-133">指定陣列長度上限的正整數。</span><span class="sxs-lookup"><span data-stu-id="a7e35-133">A positive integer that specifies the maximum allowed array length.</span></span>|<span data-ttu-id="a7e35-134">16384</span><span class="sxs-lookup"><span data-stu-id="a7e35-134">16384</span></span>|  
|<span data-ttu-id="a7e35-135">maxBytesPerRead</span><span class="sxs-lookup"><span data-stu-id="a7e35-135">maxBytesPerRead</span></span>|<span data-ttu-id="a7e35-136">指定每次讀取作業傳回的位元組上限的正整數。</span><span class="sxs-lookup"><span data-stu-id="a7e35-136">A positive integer that specifies the maximum allowed bytes returned per read.</span></span>|<span data-ttu-id="a7e35-137">4096</span><span class="sxs-lookup"><span data-stu-id="a7e35-137">4096</span></span>|  
|<span data-ttu-id="a7e35-138">maxDepth</span><span class="sxs-lookup"><span data-stu-id="a7e35-138">maxDepth</span></span>|<span data-ttu-id="a7e35-139">指定每次讀取的巢狀節點深度上限的正整數。</span><span class="sxs-lookup"><span data-stu-id="a7e35-139">A positive integer that specifies the maximum nested node depth per read.</span></span>|<span data-ttu-id="a7e35-140">32</span><span class="sxs-lookup"><span data-stu-id="a7e35-140">32</span></span>|  
|<span data-ttu-id="a7e35-141">maxNameTableCharCount</span><span class="sxs-lookup"><span data-stu-id="a7e35-141">maxNameTableCharCount</span></span>|<span data-ttu-id="a7e35-142">指定資料表名稱的字元數上限的正整數。</span><span class="sxs-lookup"><span data-stu-id="a7e35-142">A positive integer that specifies the maximum characters allowed in a table name.</span></span>|<span data-ttu-id="a7e35-143">16384</span><span class="sxs-lookup"><span data-stu-id="a7e35-143">16384</span></span>|  
|<span data-ttu-id="a7e35-144">maxStringContentLength</span><span class="sxs-lookup"><span data-stu-id="a7e35-144">maxStringContentLength</span></span>|<span data-ttu-id="a7e35-145">指定 XML 項目內容的字元數上限的正整數。</span><span class="sxs-lookup"><span data-stu-id="a7e35-145">A positive integer that specifies the maximum characters allowed in XML element content.</span></span>|<span data-ttu-id="a7e35-146">8192</span><span class="sxs-lookup"><span data-stu-id="a7e35-146">8192</span></span>|  
  
## <a name="the-wcf-receive-locations-may-be-disabled-if-you-change-the-wcf-adapter-type-and-keep-the-same-address"></a><span data-ttu-id="a7e35-147">如果變更 WCF 配接器類型但位址保持不變，則 WCF 接收位置可能會停用</span><span class="sxs-lookup"><span data-stu-id="a7e35-147">The WCF receive locations may be disabled if you change the WCF adapter type and keep the same address</span></span>  
 <span data-ttu-id="a7e35-148">如果您變更配接器類型，例如，將 WCF 配接器類型從 WCF-NetTcp 變更為包含 NetTcp 繫結的 WCF-Custom，而位址保持不變，則接收位置可能會停用，因為結束點管理員會發生快取問題。</span><span class="sxs-lookup"><span data-stu-id="a7e35-148">If you change the adapter type—for example, change the WCF adapter type from WCF-NetTcp to WCF-Custom with NetTcp Binding—and keep the same address, the receive location may be disabled because of the caching problem in the Endpoint Manager.</span></span> <span data-ttu-id="a7e35-149">若要解決這個問題，您可以執行下列任一種方法：</span><span class="sxs-lookup"><span data-stu-id="a7e35-149">To work around this, you can do either of the following:</span></span>  
  
-   <span data-ttu-id="a7e35-150">重新啟動 BTSNTSvc 服務。</span><span class="sxs-lookup"><span data-stu-id="a7e35-150">Restart the BTSNTSvc service.</span></span>  
  
-   <span data-ttu-id="a7e35-151">將 URI 變更為不同的位址並儲存，然後將 URI 變更回原來的位址，再儲存一次。</span><span class="sxs-lookup"><span data-stu-id="a7e35-151">Change the URI to a different address and save it, and then change the URI back to the original address and save it again.</span></span>  
  
## <a name="the-wcf-action-set-in-the-orchestration-does-not-override-the-action-setting-in-the-static-send-port"></a><span data-ttu-id="a7e35-152">協調流程中設定的 WCF 動作不會覆寫靜態傳送埠中的動作設定</span><span class="sxs-lookup"><span data-stu-id="a7e35-152">The WCF action set in the orchestration does not override the action setting in the static send port</span></span>  
 <span data-ttu-id="a7e35-153">如果您設定**WCF。動作**協調流程中的內容屬性，您需要讓**動作**WCF 配接器傳輸屬性對話方塊中的空白欄位。</span><span class="sxs-lookup"><span data-stu-id="a7e35-153">If you set the **WCF.Action** context property in the orchestration, you need to leave the **Action** field blank in the WCF adapter transport properties dialog box.</span></span> <span data-ttu-id="a7e35-154">如果您也在靜態傳送埠中，指定動作**WCF。動作**您設定靜態傳送埠中的值將會覆寫您在協調流程中設定的內容屬性。</span><span class="sxs-lookup"><span data-stu-id="a7e35-154">If you also specify an action in the static send port, the **WCF.Action** context property you set in the orchestration will be overridden by the value you set in the static send port.</span></span>  
  
## <a name="propagating-a-fault-message-is-not-supported-in-the-transactional-send"></a><span data-ttu-id="a7e35-155">交易式傳送中不支援傳播錯誤訊息</span><span class="sxs-lookup"><span data-stu-id="a7e35-155">Propagating a fault message is not supported in the transactional send</span></span>  
 <span data-ttu-id="a7e35-156">**傳播錯誤訊息**請求-回應傳送埠中的選項可讓您將路由至訂閱應用程式的輸出處理失敗的訊息。</span><span class="sxs-lookup"><span data-stu-id="a7e35-156">The **Propagate fault message** option in the solicit-response send ports allows you to route the messages that fail the outbound processing to a subscribing application.</span></span> <span data-ttu-id="a7e35-157">不過，如果**啟用交易**傳輸屬性對話方塊中也會選取核取方塊，交易已中止或錯誤回應抵達配接器時，則無法使用，您將無法傳播訂閱的任何應用程式的錯誤訊息</span><span class="sxs-lookup"><span data-stu-id="a7e35-157">However, if the **Enable transactions** check box is also selected in the transport properties dialog box and the transaction is aborted or not usable when the fault response arrives to the adapter, you will not be able to propagate the fault messages to any subscribing applications</span></span>  
  
## <a name="the-msmq-cluster-resource-group-needs-to-be-restarted-before-restarting-the-biztalk-host-cluster-resource-group-during-the-cluster-failover"></a><span data-ttu-id="a7e35-158">叢集容錯移轉期間，需要先重新啟動 MSMQ 叢集資源群組，才能重新啟動 BizTalk 主控件叢集資源群組</span><span class="sxs-lookup"><span data-stu-id="a7e35-158">The MSMQ cluster resource group needs to be restarted before restarting the BizTalk Host cluster resource group during the cluster failover</span></span>  
 <span data-ttu-id="a7e35-159">在容錯移轉叢集的情況中，如果發生容錯移轉，需要先重新啟動 MSMQ 叢集資源群組，才能重新啟動 BizTalk 主控件叢集資源群組。</span><span class="sxs-lookup"><span data-stu-id="a7e35-159">In a failover cluster scenario, when a failover is taking place, the MSMQ cluster resource group needs to be restarted before restarting the BizTalk Host cluster resource group.</span></span> <span data-ttu-id="a7e35-160">如果未能這麼做，MSMQ 接收位置可能會停用。</span><span class="sxs-lookup"><span data-stu-id="a7e35-160">If you fail to do so, the MSMQ receive locations may be disabled.</span></span> <span data-ttu-id="a7e35-161">若要解決這個問題，您可以設定 BizTalk 主控件叢集資源群組相依於 MSMQ 叢集資源群組，以確保 MSMQ 叢集資源群組會在 BizTalk 主控件叢集資源群組之前先行啟動。</span><span class="sxs-lookup"><span data-stu-id="a7e35-161">To work around this issue, you can make the BizTalk Host cluster resource group dependent on the MSMQ cluster resource group to ensure that the MSMQ cluster resource group starts before the BizTalk Host cluster resource group.</span></span> <span data-ttu-id="a7e35-162">或者，您也可以重新啟動 BizTalk 主控件叢集資源群組來解決這個問題。</span><span class="sxs-lookup"><span data-stu-id="a7e35-162">Alternatively, you can restart the BizTalk Host cluster resource group to work around this issue.</span></span>  
  
## <a name="you-receive-an-error-when-sending-messages-to-a-wcf-service-that-uses-wsfederationhttpbinding-in-the-endpoint"></a><span data-ttu-id="a7e35-163">將訊息傳送到在結束點中使用 wsFederationHttpBinding 的 WCF 服務時，收到錯誤</span><span class="sxs-lookup"><span data-stu-id="a7e35-163">You receive an error when sending messages to a WCF service that uses wsFederationHttpBinding in the endpoint</span></span>  
 <span data-ttu-id="a7e35-164">您收到類似下面的錯誤：</span><span class="sxs-lookup"><span data-stu-id="a7e35-164">You receive an error similar to the following:</span></span>  
  
```  
The adapter failed to transmit message going to send port "MySendPort" with URL "http://localohost/MywsFedHttp". It will be retransmitted after the retry interval specified for this Send Port. Details:"The channel is configured to use interactive initializer 'System.ServiceModel.Security.InfocardInteractiveChannelInitializer', but the channel was Opened without calling DisplayInitializationUI.  Call DisplayInitializationUI before calling Open or other methods on this channel.".  
```  
  
 <span data-ttu-id="a7e35-165">這是依據設計的行為。</span><span class="sxs-lookup"><span data-stu-id="a7e35-165">This behavior is by design.</span></span> <span data-ttu-id="a7e35-166">WCF 配接器無法傳送訊息至 WCF 服務使用**wsFederationHttpBinding**在其端點。</span><span class="sxs-lookup"><span data-stu-id="a7e35-166">WCF adapters cannot send messages to the WCF services that are using **wsFederationHttpBinding** in their endpoints.</span></span>  
  
## <a name="the-biztalk-wcf-service-consuming-wizard-does-not-enable-you-to-select-message-types-or-port-types-from-the-wsdl"></a><span data-ttu-id="a7e35-167">BizTalk WCF 服務使用精靈無法讓您從 WSDL 選取訊息類型或連接埠類型</span><span class="sxs-lookup"><span data-stu-id="a7e35-167">The BizTalk WCF Service Consuming Wizard does not enable you to select message types or port types from the WSDL</span></span>  
 <span data-ttu-id="a7e35-168">匯入 WCF 服務時，BizTalk WCF 服務使用精靈無法讓您從 WSDL 選取訊息類型或連接埠類型。</span><span class="sxs-lookup"><span data-stu-id="a7e35-168">The BizTalk WCF Service Consuming Wizard does not enable you to select message types or port types from the WSDL when importing the WCF services.</span></span> <span data-ttu-id="a7e35-169">若要解除此限制，您可以使用下列程式碼取得結構描述，然後將所需的結構描述加入到您的 BizTalk 專案：</span><span class="sxs-lookup"><span data-stu-id="a7e35-169">To work around this limitation, you can use the following code to obtain the schemas and then add the desired schemas to your BizTalk projects:</span></span>  
  
```  
svcutil.exe /t:metadata http://service/metadataendpoint  
```  
  
## <a name="the-biztalk-wcf-service-consuming-wizard-does-not-allow-the-combination-of-one-way-and-request-response-operations"></a><span data-ttu-id="a7e35-170">BizTalk WCF 服務使用精靈不允許單向與要求-回應的組合作業</span><span class="sxs-lookup"><span data-stu-id="a7e35-170">The BizTalk WCF Service Consuming Wizard does not allow the combination of one-way and request-response operations</span></span>  
 <span data-ttu-id="a7e35-171">BizTalk WCF 服務使用精靈不允許您匯入有單向與要求-回應組合作業的連接埠類型。</span><span class="sxs-lookup"><span data-stu-id="a7e35-171">The BizTalk WCF Service Consuming Wizard does not allow you to import the port types that have a combination of one-way and request-response operations.</span></span> <span data-ttu-id="a7e35-172">若要解決這個問題，您可以使用 ServiceModel 中繼資料公用程式工具來產生連接埠類型。</span><span class="sxs-lookup"><span data-stu-id="a7e35-172">To work around this, you can use the ServiceModel Metadata Utility Tool to generate the port types.</span></span>  
  
## <a name="the-biztalk-wcf-service-consuming-wizard-does-not-allow-you-to-set-certificate-credentials-when-retrieving-the-wsdl"></a><span data-ttu-id="a7e35-173">擷取 WSDL 時，BizTalk WCF 服務使用精靈不允許您設定憑證認證</span><span class="sxs-lookup"><span data-stu-id="a7e35-173">The BizTalk WCF Service Consuming Wizard does not allow you to set certificate credentials when retrieving the WSDL</span></span>  
 <span data-ttu-id="a7e35-174">擷取 WSDL 時，BizTalk WCF 服務使用精靈不允許您設定憑證認證。</span><span class="sxs-lookup"><span data-stu-id="a7e35-174">The BizTalk WCF Service Consuming Wizard does not allow you to set certificate credentials when retrieving the WSDL.</span></span> <span data-ttu-id="a7e35-175">若要解決這個問題，您可以使用 ServiceModel 中繼資料公用程式工具產生的 WSDL 與 XSD 檔案，您想要使用的憑證認證的 WCF 服務集合中的其他 svcutil.exe.config 檔，然後再匯入 BizTalk WCF 服務使用精靈選擇**中繼資料檔案 （WSDL 和 XSD）** 選項**中繼資料來源**頁面。</span><span class="sxs-lookup"><span data-stu-id="a7e35-175">To work around this, you can use the ServiceModel Metadata Utility Tool to generate the WSDL and XSD files from the WCF services you wish to consume with the certificate credentials set in the svcutil.exe.config file, and then import them into the BizTalk WCF Service Consuming Wizard by choosing **Metadata Files (WSDL and XSD)** option in the **Metadata source** page.</span></span>  
  
## <a name="wcf-adapters-do-not-support-one-way-operations"></a><span data-ttu-id="a7e35-176">WCF 配接器不支援單向作業</span><span class="sxs-lookup"><span data-stu-id="a7e35-176">WCF adapters do not support one-way operations</span></span>  
 <span data-ttu-id="a7e35-177">您會收到類似下面的錯誤訊息使用 WCF 服務發佈 WCF 配接器 （除了 Wcf-netmsmq 接收配接器） 時如果**IsOneWay**屬性設定為**true**在用戶端。</span><span class="sxs-lookup"><span data-stu-id="a7e35-177">You will receive an error message similar to the following when consuming WCF services published with the WCF adapters (except for the WCF-NetMsmq receive adapter) if the **IsOneWay** property is set to **true** at client side.</span></span> <span data-ttu-id="a7e35-178">這是因為**System.ServiceModel.OperationContractAttribute.IsOneWay** （除非服務發行使用 Wcf-netmsmq 接收配接器） 的 WCF 配接器發佈之 WCF 服務的屬性設定為**false**即使是單向接收位置。</span><span class="sxs-lookup"><span data-stu-id="a7e35-178">This is because the **System.ServiceModel.OperationContractAttribute.IsOneWay** property of WCF services published with the WCF adapters (except for services published with the WCF-NetMsmq receive adapter) is set to **false** even for the one-way receive locations.</span></span>  
  
```  
The channel received an unexpected input message while closing. Your Channel.Close() calls are not synchronized.  
```  
  
 <span data-ttu-id="a7e35-179">使用指定的 WCF 服務時，您會收到類似下面的錯誤訊息**IsOneWay**屬性設定為**true**。</span><span class="sxs-lookup"><span data-stu-id="a7e35-179">You will receive an error message similar to the following when consuming the WCF services specified with the **IsOneWay** property set to **true**.</span></span> <span data-ttu-id="a7e35-180">您從 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 傳送的訊息將會擱置但可繼續。</span><span class="sxs-lookup"><span data-stu-id="a7e35-180">The messages you sent from [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will be suspended and resumable.</span></span>  
  
```  
The request operation at net.tcp://localhost:8088/MyService/tcp did not receive a reply within timeout 00:01:00.  
```  
  
## <a name="a-memory-leak-may-occur-when-sending-messages-to-non-transactional-msmq-queues-using-wcf-netmsmq-binding"></a><span data-ttu-id="a7e35-181">使用 WCF-NetMsmq 繫結傳送訊息到非交易式 MSMQ 佇列時，可能會發生記憶體遺漏</span><span class="sxs-lookup"><span data-stu-id="a7e35-181">A memory leak may occur when sending messages to non-transactional MSMQ queues using WCF-NetMsmq binding</span></span>  
 <span data-ttu-id="a7e35-182">使用 WCF-NetMsmq 繫結傳送訊息到非交易式 MSMQ 佇列時，BizTalk NT 服務可能會發生記憶體遺漏。</span><span class="sxs-lookup"><span data-stu-id="a7e35-182">A memory leak may occur in the BizTalk NT service when sending messages to non-transactional MSMQ queues using WCF-NetMsmq binding.</span></span> <span data-ttu-id="a7e35-183">當您使用 WCF-NetMsmq 傳輸傳送訊息到非交易式 MSMQ 佇列，或使用包含 WCF-Custom 傳輸的 netMsmqBinding 傳送訊息到非交易式 MSMQ 佇列時，就可能會發生這種情況。</span><span class="sxs-lookup"><span data-stu-id="a7e35-183">This may occur when you send messages to a non-transactional MSMQ queue using WCF-NetMsmq transport or when you send messages to a non-transactional MSMQ queue using netMsmqBinding with WCF-Custom transport.</span></span>  
  
 <span data-ttu-id="a7e35-184">若要解決此問題，您必須安裝在知識庫文章 936512 所述的.NET Framework 3.0 hotfix [http://go.microsoft.com/fwlink/?LinkId=92962](http://go.microsoft.com/fwlink/?LinkId=92962)。</span><span class="sxs-lookup"><span data-stu-id="a7e35-184">To resolve the issue, you must install .NET Framework 3.0 hotfix described in the KB article 936512 at [http://go.microsoft.com/fwlink/?LinkId=92962](http://go.microsoft.com/fwlink/?LinkId=92962).</span></span> <span data-ttu-id="a7e35-185">Hotfix 不需要系統重新開機，但需要重新啟動裝載使用 WCF-NetMsmq 繫結之傳送埠的 BizTalk NT 服務。</span><span class="sxs-lookup"><span data-stu-id="a7e35-185">The hotfix does not require a system reboot but it is necessary to restart the BizTalk NT service which hosts the send ports that using WCF-NetMsmq binding.</span></span>  
  
## <a name="you-may-receive-exception-when-communicating-with-apache-web-servers-using-wcf-basichttp-adapter"></a><span data-ttu-id="a7e35-186">使用 WCF-BasicHttp 配接器與 Apache Web 伺服器通訊時，可能會收到例外狀況</span><span class="sxs-lookup"><span data-stu-id="a7e35-186">You may receive exception when communicating with Apache Web servers using WCF-BasicHttp adapter</span></span>  
 <span data-ttu-id="a7e35-187">當您使用包含傳輸安全性的 WCF-BasicHttp 配接器與 Apache Web 伺服器通訊時，可能會收到類似下面的例外狀況：</span><span class="sxs-lookup"><span data-stu-id="a7e35-187">When you use WCF-BasicHttp adapter with transport security to communicate with an Apache Web server, you may receive the exception similar to the followings:</span></span>  
  
```  
System.Net.WebException: The underlying connection was closed: An unexpected error occurred on a send.  
System.IO.IOException: Unable to write data to the transport connection: An established connection was aborted by the software in your host machine. System.Net.Sockets.SocketException: An established connection was aborted by the software in your host machine  
```  
  
 <span data-ttu-id="a7e35-188">若要解決這個問題，您需要使用 WCF-Custom 配接器 (而非 WCF-BasicHttp 配接器) 來與 Apache Web 伺服器通訊，如下所示：</span><span class="sxs-lookup"><span data-stu-id="a7e35-188">To work around this, you need to use WCF-Custom adapter instead of WCF-BasicHttp adapter to communicate with the Apache Web servers as following:</span></span>  
  
1.  <span data-ttu-id="a7e35-189">建立傳送埠和傳輸類型設定為**Wcf-custom**。</span><span class="sxs-lookup"><span data-stu-id="a7e35-189">Create a send port and set the transport type to **WCF-Custom**.</span></span>  
  
2.  <span data-ttu-id="a7e35-190">在**Wcf-custom 傳輸屬性**對話方塊**繫結**索引標籤上，選取**customBinding**從**繫結的型別**下拉式清單。</span><span class="sxs-lookup"><span data-stu-id="a7e35-190">In the **WCF-Custom Transport Properties** dialog box, on the **Binding** tab, select **customBinding** from the **Binding Type** drop-down list.</span></span>  
  
3.  <span data-ttu-id="a7e35-191">在下**customebindingelement**，以滑鼠右鍵按一下**httpTransport**，然後按一下 **移除延伸模組**。</span><span class="sxs-lookup"><span data-stu-id="a7e35-191">Under **CustomeBindingElement**, right-click **httpTransport**, and then click **Remove extension**.</span></span>  
  
4.  <span data-ttu-id="a7e35-192">以滑鼠右鍵按一下**customebindingelement**，然後按一下 **將延伸加入**。</span><span class="sxs-lookup"><span data-stu-id="a7e35-192">Right-click **CustomeBindingElement**, and then click **Add extension**.</span></span>  
  
5.  <span data-ttu-id="a7e35-193">在**選取繫結元素延伸模組**對話方塊中，選取**httpTransport** ，然後按一下 **確定**。</span><span class="sxs-lookup"><span data-stu-id="a7e35-193">In the **Select Binding Element Extension** dialog box, select **httpTransport** and then click **OK**.</span></span>  
  
6.  <span data-ttu-id="a7e35-194">按一下**httpTransport**，然後在**組態** 窗格中，設定的值**keepaliveenabled**至**False**。</span><span class="sxs-lookup"><span data-stu-id="a7e35-194">Click **httpTransport**, and then in the **Configuration** pane, set the value of **keepAliveEnabled** to **False**.</span></span>  
  
7.  <span data-ttu-id="a7e35-195">按一下**textMessageEncoding**，然後在**組態** 窗格中，設定的值**messageVersion**至`Soap11WSAddressing10`。</span><span class="sxs-lookup"><span data-stu-id="a7e35-195">Click **textMessageEncoding**, and then in the **Configuration** pane, set the value of **messageVersion** to `Soap11WSAddressing10`.</span></span>  
  
8.  <span data-ttu-id="a7e35-196">您可能需要視情況設定其他屬性。</span><span class="sxs-lookup"><span data-stu-id="a7e35-196">You may need to configure additional properties as needed.</span></span>  
  
## <a name="biztalk-server-does-not-work-with-wcf-clients-that-using-clientviabehavior-for-multiple-hop-conversations"></a><span data-ttu-id="a7e35-197">BizTalk Server 無法與使用 ClientViaBehavior 進行多躍點交談的 WCF 用戶端搭配運作</span><span class="sxs-lookup"><span data-stu-id="a7e35-197">BizTalk Server does not work with WCF clients that using ClientViaBehavior for multiple-hop conversations</span></span>  
 <span data-ttu-id="a7e35-198">當直接網路目的地不是訊息的預定處理器，WCF 用戶端會使用 ClientViaBehavior 來啟用多躍點交談，在這種情況下，呼叫應用程式不一定知道最終的目的地為何。</span><span class="sxs-lookup"><span data-stu-id="a7e35-198">WCF clients use ClientViaBehavior when the immediate network destination is not the intended processor of the message to enable multiple-hop conversations when the calling application does not necessarily know the ultimate destination.</span></span> <span data-ttu-id="a7e35-199">如果您指定 ClientViaBehavior 並將「收件人位址」設定為遠端服務，其中 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 將做為中介者，那麼就會收到如下錯誤訊息：</span><span class="sxs-lookup"><span data-stu-id="a7e35-199">If you specify the ClientViaBehavior and set the To address to a remote service where [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will be acting as an intermediary, you will receive the error message similar to the following:</span></span>  
  
```  
The message with To 'net.tcp://localhost:5555/test.svc' cannot be processed at the receiver, due to an AddressFilter mismatch at the EndpointDispatcher. Check that the sender and receiver's EndpointAddresses agree  
```