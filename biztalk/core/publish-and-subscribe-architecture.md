---
title: 發佈和訂閱架構 |Microsoft 文件
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- publish/subscribe architecture, publishers
- architecture, publish/subscribe
- publishing, publish/subscribe architecture
- publish/subscribe architecture, about publish/subscribe architecture
- creating, subscriptions
- publish/subscribe architecture, Messaging Engine
- routing, publishing
- Messaging Engine, publishing
- publish/subscribe architecture, subscribers
- publish/subscribe architecture
- subscriptions, publish/subscribe architecture
- publish/subscribe architecture, creating subscriptions
- subscriptions, creating
- Messaging Engine, subscribing
- publishing, routing
- Messaging Engine, publish/subscribe architecture
- publish/subscribe architecture, events
ms.assetid: 5ed36c1f-077d-468f-a99e-60f97377cef6
caps.latest.revision: 11
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: b11ed175fc047eee59761547d8d13ab798ac860c
ms.sourcegitcommit: 5abd0ed3f9e4858ffaaec5481bfa8878595e95f7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/28/2017
ms.locfileid: "25973644"
---
# <a name="publish-and-subscribe-architecture"></a><span data-ttu-id="e4cda-102">發佈和訂閱架構</span><span class="sxs-lookup"><span data-stu-id="e4cda-102">Publish and Subscribe Architecture</span></span>
<span data-ttu-id="e4cda-103">在發佈/訂閱設計中，有三個元件：</span><span class="sxs-lookup"><span data-stu-id="e4cda-103">In a publish/subscribe design, you have three components:</span></span>  
  
-   <span data-ttu-id="e4cda-104">發行者</span><span class="sxs-lookup"><span data-stu-id="e4cda-104">Publishers</span></span>  
  
-   <span data-ttu-id="e4cda-105">訂閱者</span><span class="sxs-lookup"><span data-stu-id="e4cda-105">Subscribers</span></span>  
  
-   <span data-ttu-id="e4cda-106">事件</span><span class="sxs-lookup"><span data-stu-id="e4cda-106">Events</span></span>  
  
 <span data-ttu-id="e4cda-107">發佈者包括發佈可到達其接收位置之訊息的接收埠、在非同步傳送訊息或啟動另一個協調流程時發佈訊息的協調流程，以及從目標應用程式或傳輸收到回應時發佈訊息的請求/回應傳送埠。</span><span class="sxs-lookup"><span data-stu-id="e4cda-107">Publishers include receive ports that publish messages that arrive in their receive locations, orchestrations that publish messages when sending messages or starting another orchestration asynchronously, and solicit/response send ports that publish messages when they receive a response from the target application or transport.</span></span>  
  
 <span data-ttu-id="e4cda-108">在 BizTalk Server 中，兩種主要的訂閱類型：啟動和執行個體。</span><span class="sxs-lookup"><span data-stu-id="e4cda-108">In BizTalk Server, there are two main types of subscriptions: activation and instance.</span></span> <span data-ttu-id="e4cda-109">*啟動訂閱*是指定履行訂閱的訊息應該啟動，或建立時，「 訂閱者 」 時收到的新執行個體。</span><span class="sxs-lookup"><span data-stu-id="e4cda-109">An *activation subscription* is one specifying that a message that fulfills the subscription should activate, or create, a new instance of the subscriber when it is received.</span></span> <span data-ttu-id="e4cda-110">建立啟動訂閱的項目範例包含具有篩選條件的傳送埠，或是與協調流程繫結的傳送埠，以及將其 [啟動] 屬性設定為 [True] 的協調流程接收圖形。</span><span class="sxs-lookup"><span data-stu-id="e4cda-110">Examples of things that create activation subscriptions include send ports with filters or send ports that are bound to orchestrations, and orchestration receive shapes that have their Activate property set to true.</span></span> <span data-ttu-id="e4cda-111">*訂用帳戶的執行個體*指出履行訂閱的訊息，應該路由傳送到 「 訂閱者 」 已在執行執行個體。</span><span class="sxs-lookup"><span data-stu-id="e4cda-111">An *instance subscription* indicates that messages that fulfill the subscription should be routed to an already-running instance of the subscriber.</span></span> <span data-ttu-id="e4cda-112">建立執行個體訂閱的項目範例為具有相互關聯之接收埠與要求/回應樣式接收埠的協調流程，這些連接埠會等待 BizTalk Server 的回應。</span><span class="sxs-lookup"><span data-stu-id="e4cda-112">Examples of things that create instance subscriptions are orchestrations with correlated receives and request/response-style receive ports waiting for a response from BizTalk Server.</span></span>  
  
 <span data-ttu-id="e4cda-113">這兩種類型的訂閱在資訊層次的差異，在於執行個體訂閱會包含唯一的執行個體識別碼，這個識別碼是儲存在主要 MessageBox 資料庫的訂閱資料表中。</span><span class="sxs-lookup"><span data-stu-id="e4cda-113">The difference between the two types of subscription at the information level is that an instance subscription includes the unique instance ID, stored in the subscription table in the master MessageBox database.</span></span> <span data-ttu-id="e4cda-114">當協調流程執行個體或接收埠完成處理時，會從 MessageBox 移除執行個體訂閱，而啟動訂閱只要有登錄協調流程或傳送埠就會維持作用中。</span><span class="sxs-lookup"><span data-stu-id="e4cda-114">When an orchestration instance or receive port completes processing, instance subscriptions are removed from the MessageBox while activation subscriptions remain active as long as the orchestration or send port is enlisted.</span></span>  
  
## <a name="creating-subscriptions"></a><span data-ttu-id="e4cda-115">建立訂閱</span><span class="sxs-lookup"><span data-stu-id="e4cda-115">Creating Subscriptions</span></span>  
 <span data-ttu-id="e4cda-116">訂閱是由 BizTalk Server 中的服務類別所建立，它會列在 BizTalk Server 管理資料庫的 adm_ServiceClass 資料表中。</span><span class="sxs-lookup"><span data-stu-id="e4cda-116">Subscriptions are created by service classes in BizTalk Server, which are listed in the adm_ServiceClass table in the BizTalk Server Management database.</span></span> <span data-ttu-id="e4cda-117">這些服務包含快取服務；由「結束點管理員」所裝載的內含式與外掛式傳訊；XLANG 子服務裝載的協調流程/XLANG。</span><span class="sxs-lookup"><span data-stu-id="e4cda-117">These services include the caching service; in-process and isolated messaging, hosted by the Endpoint Manager; and orchestrations/XLANG hosted by the XLANG subservice.</span></span> <span data-ttu-id="e4cda-118">這些服務類別的每一個都可以建立訂閱，並接收已發佈的訊息。</span><span class="sxs-lookup"><span data-stu-id="e4cda-118">Each of these service classes can create subscriptions and receive published messages.</span></span>  
  
 <span data-ttu-id="e4cda-119">訂閱是比較陳述式的集合，又稱為述詞，它包含訊息內容屬性及訂閱專用的值。</span><span class="sxs-lookup"><span data-stu-id="e4cda-119">A subscription is a collection of comparison statements, known as predicates, involving message context properties and the values specific to the subscription.</span></span> <span data-ttu-id="e4cda-120">例如，「訊息類型」是訊息的內容屬性，而且許多訂閱會在其訂閱中指定訊息類型。</span><span class="sxs-lookup"><span data-stu-id="e4cda-120">For example, Message Type is a context property of messages and many subscriptions specify the message type in their subscription.</span></span> <span data-ttu-id="e4cda-121">「訊息代理程式」會在訂閱資料表中插入訂閱的一般資訊，而特定述詞會根據為訂閱所指定的作業類型而定，插入至下列其中一個述詞資料表中：</span><span class="sxs-lookup"><span data-stu-id="e4cda-121">General information about the subscription is inserted into the subscriptions table by the Message Agent while the specific predicates go into one of the following predicate tables, depending on the type of operation specified for the subscription:</span></span>  
  
-   <span data-ttu-id="e4cda-122">BitwiseANDPredicates</span><span class="sxs-lookup"><span data-stu-id="e4cda-122">BitwiseANDPredicates</span></span>  
  
-   <span data-ttu-id="e4cda-123">EqualsPredicates</span><span class="sxs-lookup"><span data-stu-id="e4cda-123">EqualsPredicates</span></span>  
  
-   <span data-ttu-id="e4cda-124">EqualsPredicates2ndPass</span><span class="sxs-lookup"><span data-stu-id="e4cda-124">EqualsPredicates2ndPass</span></span>  
  
-   <span data-ttu-id="e4cda-125">ExistsPredicates</span><span class="sxs-lookup"><span data-stu-id="e4cda-125">ExistsPredicates</span></span>  
  
-   <span data-ttu-id="e4cda-126">FirstPassPredicates</span><span class="sxs-lookup"><span data-stu-id="e4cda-126">FirstPassPredicates</span></span>  
  
-   <span data-ttu-id="e4cda-127">GreaterThanOrEqualsPredicates</span><span class="sxs-lookup"><span data-stu-id="e4cda-127">GreaterThanOrEqualsPredicates</span></span>  
  
-   <span data-ttu-id="e4cda-128">GreaterThanPredicates</span><span class="sxs-lookup"><span data-stu-id="e4cda-128">GreaterThanPredicates</span></span>  
  
-   <span data-ttu-id="e4cda-129">LessThenOrEqualsPredicates</span><span class="sxs-lookup"><span data-stu-id="e4cda-129">LessThenOrEqualsPredicates</span></span>  
  
-   <span data-ttu-id="e4cda-130">LessThenPredicates</span><span class="sxs-lookup"><span data-stu-id="e4cda-130">LessThenPredicates</span></span>  
  
-   <span data-ttu-id="e4cda-131">NotEqualsPredicates</span><span class="sxs-lookup"><span data-stu-id="e4cda-131">NotEqualsPredicates</span></span>  
  
 <span data-ttu-id="e4cda-132">這些全部都透過呼叫 bts_createsubscription_<\<應用程式名稱\>與 bts_insertpredicate_<\<應用程式名稱\>預存程序，在 MessageBox 資料庫 where \<應用程式名稱\>是建立訂閱之 BizTalk 主控件名稱。</span><span class="sxs-lookup"><span data-stu-id="e4cda-132">All of this is accomplished by calling the Bts_CreateSubscription_\<application name\> and Bts_InsertPredicate_\<application name\> stored procedures in the MessageBox database where \<application name\> is the name of the BizTalk host that is creating the subscription.</span></span>  
  
 <span data-ttu-id="e4cda-133">在登錄傳送埠時，連接埠至少會為任何內容中具有該傳送埠傳輸識別碼的訊息建立訂閱。</span><span class="sxs-lookup"><span data-stu-id="e4cda-133">When a send port is enlisted, the port creates, at a minimum, a subscription for any message with that send port's transport ID in the context.</span></span> <span data-ttu-id="e4cda-134">這允許傳送埠永遠接收專門給它的訊息。</span><span class="sxs-lookup"><span data-stu-id="e4cda-134">This allows the send port to always receive messages intended specifically for it.</span></span> <span data-ttu-id="e4cda-135">當協調流程連接埠與特定傳送埠繫結時，繫結的相關資訊會儲存在 BizTalk 管理資料庫中。</span><span class="sxs-lookup"><span data-stu-id="e4cda-135">When an orchestration port is bound to a particular send port, the information about that binding is stored in the BizTalk Management database.</span></span> <span data-ttu-id="e4cda-136">當訊息從協調流程透過繫結至實體傳送埠的連接埠傳送時，會在內容中包含「傳送識別碼」，讓訊息可路由至該傳送埠。</span><span class="sxs-lookup"><span data-stu-id="e4cda-136">When messages are sent from the orchestration through the port bound to the physical send port, the Transport ID is included in the context so that the message gets routed to that send port.</span></span> <span data-ttu-id="e4cda-137">不過，請務必注意，此傳送埠並不是唯一可接收從協調流程傳送之訊息的傳送埠。</span><span class="sxs-lookup"><span data-stu-id="e4cda-137">However, it is important to note that this send port is not the only send port that can receive messages sent from the orchestration.</span></span> <span data-ttu-id="e4cda-138">當協調流程傳送訊息時，會將該訊息伴隨著所有相關的升級屬性發佈到 MessageBox。</span><span class="sxs-lookup"><span data-stu-id="e4cda-138">When an orchestration sends a message, that message is published to the MessageBox with all of the relevant promoted properties.</span></span> <span data-ttu-id="e4cda-139">繫結的傳送埠保證會接收訊息的複本，因為傳輸識別碼在內容中，不過任何其他傳送埠或協調流程，都可以有同樣符合訊息屬性的訂閱。</span><span class="sxs-lookup"><span data-stu-id="e4cda-139">The bound send port is guaranteed to receive a copy of the message because the transport ID is in the context, but any other send port, or orchestration, can have a subscription that also matches the message properties.</span></span> <span data-ttu-id="e4cda-140">瞭解不論在何時都會將訊息直接發佈到 MessageBox 是非常重要的，所有具有符合訂閱的訂閱者都會收到訊息的複本。</span><span class="sxs-lookup"><span data-stu-id="e4cda-140">It is very important to understand that any time a message is published directly to the MessageBox, all subscribers with matching subscriptions will receive a copy of the message.</span></span>  
  
## <a name="publishing-and-routing"></a><span data-ttu-id="e4cda-141">發佈和路由</span><span class="sxs-lookup"><span data-stu-id="e4cda-141">Publishing and Routing</span></span>  
 <span data-ttu-id="e4cda-142">在建立和啟用訂閱後，必須先發佈訊息才會執行任何處理。</span><span class="sxs-lookup"><span data-stu-id="e4cda-142">After a subscription is created and enabled, a message must be published before any processing takes place.</span></span> <span data-ttu-id="e4cda-143">當 BizTalk Server 從前面所提及的其中一個服務收到訊息時，就會發佈它們。</span><span class="sxs-lookup"><span data-stu-id="e4cda-143">Messages are published when they are received into BizTalk Server from one of the services mentioned previously.</span></span> <span data-ttu-id="e4cda-144">在本路由討論中，我們將著重於 BizTalk Server 透過配接器收到的訊息。</span><span class="sxs-lookup"><span data-stu-id="e4cda-144">For this discussion of routing, we will focus on messages received into BizTalk Server through an adapter.</span></span>  
  
 <span data-ttu-id="e4cda-145">當訊息進入接收管線處理時，會將屬性升級至訊息內容。</span><span class="sxs-lookup"><span data-stu-id="e4cda-145">When messages go through the receive pipeline processing, properties are promoted into the message context.</span></span> <span data-ttu-id="e4cda-146">在接收配接器與管線處理過訊息後並準備將它發佈至 MessageBox 時，第一個執行的動作是「訊息代理程式」會將升級屬性的屬性值與訊息內容的述詞值插入至主要 MessageBox SQL Server 資料庫。</span><span class="sxs-lookup"><span data-stu-id="e4cda-146">After a message is ready to be published into the MessageBox after being processed by the receive adapter and pipeline, the first thing that happens is the Message Agent inserts the property values for the promoted properties and predicate values from the message context into the master MessageBox SQL Server database.</span></span> <span data-ttu-id="e4cda-147">在資料庫中包含這些值可讓「訊息代理程式」進行路由決策。</span><span class="sxs-lookup"><span data-stu-id="e4cda-147">Having these values in the database enables the Message Agent to make routing decisions.</span></span>  
  
 <span data-ttu-id="e4cda-148">「訊息代理程式」的下一步驟是要求主要 MessageBox 資料庫尋找已發佈之目前批次訊息的訂閱。</span><span class="sxs-lookup"><span data-stu-id="e4cda-148">The next step is for the Message Agent to ask the master MessageBox database to find subscriptions for the current batch of messages being published.</span></span> <span data-ttu-id="e4cda-149">請記住，訊息並未寫入至資料庫，而是只寫入內容的屬性。</span><span class="sxs-lookup"><span data-stu-id="e4cda-149">Keep in mind that the messages have not yet been written to the database, only the properties from the context.</span></span> <span data-ttu-id="e4cda-150">MessageBox 查詢中的 bts_FindSubscriptions 預存程序會查詢上述所識別的訂閱與述詞資料表，將它們連結到針對目前的訊息批次所儲存的訊息屬性。</span><span class="sxs-lookup"><span data-stu-id="e4cda-150">The bts_FindSubscriptions stored procedure in the MessageBox queries the subscription and predicate tables identified above, linking them to the message properties stored for the current batch of messages.</span></span>  
  
 <span data-ttu-id="e4cda-151">透過此訊息，「訊息代理程式」會呼叫 bts_InsertMessage 預存程序，將訊息插入至具有訂閱的每個 MessageBox 資料庫一次。</span><span class="sxs-lookup"><span data-stu-id="e4cda-151">With this information, the Message Agent inserts the message once into each MessageBox database that has a subscription by calling the bts_InsertMessage stored procedure.</span></span> <span data-ttu-id="e4cda-152">訂用帳戶 id。 第一次呼叫 bts_InsertMessage 預存程序</span><span class="sxs-lookup"><span data-stu-id="e4cda-152">The bts_InsertMessage stored procedure is first called with a subscription ID.</span></span> <span data-ttu-id="e4cda-153">此第一階段中，預存程序呼叫 int_EvaluateSubscriptions 預存程序會負責查閱訂用帳戶的詳細資訊，確認訊息符合安全性需求的應用程式，藉由檢查，述詞符合應用程式內容主機，以及應用程式特定擱置的佇列根據狀態的應用程式特定佇列中插入訊息的參考訊息。</span><span class="sxs-lookup"><span data-stu-id="e4cda-153">On this first pass, the stored procedure calls the int_EvaluateSubscriptions stored procedure which is responsible for looking up the subscription detail information, verifying that the message meets security requirements for the application by checking that message predicates match application properties for the host, and inserting a reference to the message in the application specific queue or application specific suspended queue depending on the state.</span></span> <span data-ttu-id="e4cda-154">針對為此應用程式所找到的每個訂閱，在應用程式特定的佇列資料表中，插入訊息識別碼、訂閱識別碼、服務識別碼，以及其他訂閱資訊。</span><span class="sxs-lookup"><span data-stu-id="e4cda-154">The message ID, subscription ID, service ID, and other subscription information are inserted into the application specific queue table for each subscription that was found for this application.</span></span> <span data-ttu-id="e4cda-155">插入訊息之後，即會清除訊息屬性與訊息述詞資料表的批次相關值。</span><span class="sxs-lookup"><span data-stu-id="e4cda-155">After the messages are inserted, the message properties and message predicates tables are cleared of the batch related values.</span></span>  
  
 <span data-ttu-id="e4cda-156">接著會為訊息中的每個部分呼叫 bts_InsertMessage 預存程序。</span><span class="sxs-lookup"><span data-stu-id="e4cda-156">The bts_InsertMessage stored procedure is called subsequently for each part in the message.</span></span> <span data-ttu-id="e4cda-157">在第一次呼叫時，訊息內容會傳遞，然後會插入多工緩衝處理資料表，例如組件、 內文部分名稱和識別碼的多訊息相關的中繼資料</span><span class="sxs-lookup"><span data-stu-id="e4cda-157">On the first call, the message context is passed and is then inserted into the SPOOL table along with metadata about the message such as the number of parts, the body part name and ID.</span></span> <span data-ttu-id="e4cda-158">除了訊息內文部分會插入至 PARTS 資料表使用 int_InsertPart 預存程序。</span><span class="sxs-lookup"><span data-stu-id="e4cda-158">In addition the message body part is inserted into the PARTS table using the int_InsertPart stored procedure.</span></span> <span data-ttu-id="e4cda-159">接著為每個其餘的訊息部分呼叫 bts_InsertMessage 預存程序，在此會將這些訊息部分直接傳遞至 int_InsertPart預存程序，以便將它們保存在 PARTS 資料表中。</span><span class="sxs-lookup"><span data-stu-id="e4cda-159">The bts_InsertMessage stored procedure is then called for each of the remaining message parts where they are simply passed to the int_InsertPart stored procedure to be persisted in the PARTS table.</span></span>  
  
 <span data-ttu-id="e4cda-160">路由訊息時，會在下列資料表中插入記錄，以便為每個收到訊息特定執行個體及其部分的每個服務新增參考：</span><span class="sxs-lookup"><span data-stu-id="e4cda-160">When messages are routed, references are added for each service that receives the specific instance of the message and its parts by inserting records into the following tables:</span></span>  
  
-   <span data-ttu-id="e4cda-161">MessageRefCountLog1</span><span class="sxs-lookup"><span data-stu-id="e4cda-161">MessageRefCountLog1</span></span>  
  
-   <span data-ttu-id="e4cda-162">MessageRefCountLog2</span><span class="sxs-lookup"><span data-stu-id="e4cda-162">MessageRefCountLog2</span></span>  
  
-   <span data-ttu-id="e4cda-163">PartRefCountLog1</span><span class="sxs-lookup"><span data-stu-id="e4cda-163">PartRefCountLog1</span></span>  
  
-   <span data-ttu-id="e4cda-164">PartRefCountLog2</span><span class="sxs-lookup"><span data-stu-id="e4cda-164">PartRefCountLog2</span></span>  
  
 <span data-ttu-id="e4cda-165">透過清除定期執行的工作，讓 MessageBox 不會被系統中不再存在的訊息資料所佔滿，這些參考可以避免訊息和部分遭到刪除。</span><span class="sxs-lookup"><span data-stu-id="e4cda-165">These references keep the messages and parts from being deleted by cleanup jobs that run periodically to keep the MessageBox from getting full with message data for messages that are no longer in the system.</span></span> <span data-ttu-id="e4cda-166">有兩個資料表可用來降低爭用和鎖定的問題。</span><span class="sxs-lookup"><span data-stu-id="e4cda-166">Two tables are used to reduce contention and locking issues.</span></span>  
  
 <span data-ttu-id="e4cda-167">既然已將訊息路由至正確的佇列、儲存在 Spool 與 Parts 資料表，以及在應用程式特定佇列中參考它，應用程式執行個體就必須將訊息從佇列提取出來。</span><span class="sxs-lookup"><span data-stu-id="e4cda-167">Now that the message has been routed to the right queue, stored in the Spool and Parts tables, and referenced in the application specific queues, the messages must be pulled off the queues by the application instances.</span></span> <span data-ttu-id="e4cda-168">每個主控件執行個體都有一些取消佇列的執行緒，它們會不斷地每隔一段時間即輪詢資料庫，而此間隔時間是設定在 BizTalk 管理資料庫的 e adm_ServiceClass 資料表中。</span><span class="sxs-lookup"><span data-stu-id="e4cda-168">Each host instance has a number of dequeuing threads that continuously poll the database on an interval that is configured in the adm_ServiceClass table in the BizTalk Management database.</span></span> <span data-ttu-id="e4cda-169">此相同資料表有一個資料行指出要使用之取消佇列執行緒的數目。</span><span class="sxs-lookup"><span data-stu-id="e4cda-169">This same table has a column to indicate the number of dequeuing threads to be used.</span></span> <span data-ttu-id="e4cda-170">每個執行緒呼叫 MessageBox 資料庫，並呼叫 bts_dequeuemessages_<\<應用程式名稱\>預存程序適用於執行中的主應用程式。</span><span class="sxs-lookup"><span data-stu-id="e4cda-170">Each thread calls into the MessageBox database and calls the bts_DequeueMessages_\<application name\> stored procedure appropriate for the host application it is running in.</span></span> <span data-ttu-id="e4cda-171">這個預存程序會使用鎖定語意，以確定只有一個執行個體，一個清除佇列執行緒可以在指定的時間在佇列中的訊息上運作。</span><span class="sxs-lookup"><span data-stu-id="e4cda-171">This stored procedure uses locking semantics to make sure that only one instance and one dequeuing thread are able to operate on a message in the queue at a given time.</span></span> <span data-ttu-id="e4cda-172">取得鎖定的主控件執行個體可取得訊息，且需負責將訊息交給它所需的子服務。</span><span class="sxs-lookup"><span data-stu-id="e4cda-172">The host instance that gets the lock gets the message, and is then responsible for handing the message to the subservice for which it is intended.</span></span>  
  
 <span data-ttu-id="e4cda-173">若接收訊息的服務是「結束點管理員」，會叫用傳送埠 (或是要求/回應接收埠的回應部分)，但若它是 XLANG/s 子服務，則會根據訂閱中是否有執行個體識別碼來決定，要建立協調流程，或定位為服務訂閱。</span><span class="sxs-lookup"><span data-stu-id="e4cda-173">If the service receiving the message is the Endpoint Manager, then the send port is invoked (or the response portion of a request/response receive port) and if it is the XLANG/s subservice, an orchestration is either created, or located to service the subscription depending on whether there is an instance ID in the subscription.</span></span> <span data-ttu-id="e4cda-174">接著服務會釋放對訊息及其部分的參考，以便在其他服務沒有參考時，就可以刪除訊息資料。</span><span class="sxs-lookup"><span data-stu-id="e4cda-174">The service then releases the reference to the message and its part so that if no other services have references, the message data can be deleted.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e4cda-175">請參閱</span><span class="sxs-lookup"><span data-stu-id="e4cda-175">See Also</span></span>  
 [<span data-ttu-id="e4cda-176">傳訊引擎</span><span class="sxs-lookup"><span data-stu-id="e4cda-176">The Messaging Engine </span></span>](../core/the-messaging-engine.md)