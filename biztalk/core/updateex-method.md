---
title: UpdateEx 方法 |Microsoft 文件
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- UpdateEx method
ms.assetid: 2fa9c9cc-fd01-4765-8c31-facac188a19d
caps.latest.revision: 5
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 7a6a64c6709eb9806612518c551372ba45d1a454
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
---
# <a name="updateex-method"></a><span data-ttu-id="13715-102">UpdateEx 方法</span><span class="sxs-lookup"><span data-stu-id="13715-102">UpdateEx Method</span></span>
<span data-ttu-id="13715-103">用來更新屬性，根據輸入金鑰參數 (key1、 key2、...</span><span class="sxs-lookup"><span data-stu-id="13715-103">Used to update properties based on the input key parameters (key1, key2, …</span></span> <span data-ttu-id="13715-104">...keyn)。</span><span class="sxs-lookup"><span data-stu-id="13715-104">keyn).</span></span> <span data-ttu-id="13715-105">使用 `UpdateEx` 時，您無法刪除集合中的項目。</span><span class="sxs-lookup"><span data-stu-id="13715-105">When using `UpdateEx`, you cannot delete items in a collection.</span></span> <span data-ttu-id="13715-106">有一種個別的方法可協助刪除。</span><span class="sxs-lookup"><span data-stu-id="13715-106">A separate method facilitates deletion.</span></span> <span data-ttu-id="13715-107">如需詳細資訊，請參閱[DeleteOnly 方法](../core/deleteonly-method.md)。</span><span class="sxs-lookup"><span data-stu-id="13715-107">For more information, see [DeleteOnly Method](../core/deleteonly-method.md).</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="13715-108">語法</span><span class="sxs-lookup"><span data-stu-id="13715-108">Syntax</span></span>  
  
```  
UpdateEx (key1, key2, ... keyn, correctionMode, interactiveMode,  
    properties)  
```  
  
## <a name="parameters"></a><span data-ttu-id="13715-109">參數</span><span class="sxs-lookup"><span data-stu-id="13715-109">Parameters</span></span>  
  
|<span data-ttu-id="13715-110">參數</span><span class="sxs-lookup"><span data-stu-id="13715-110">Parameter</span></span>|<span data-ttu-id="13715-111">Description</span><span class="sxs-lookup"><span data-stu-id="13715-111">Description</span></span>|  
|---------------|-----------------|  
|`key`|<span data-ttu-id="13715-112">一組參數，其必須存在於伺服器資料庫中，不然會發生錯誤。</span><span class="sxs-lookup"><span data-stu-id="13715-112">A set of parameters that must exist in the server database, or an error occurs.</span></span> <span data-ttu-id="13715-113">這些金鑰對應至 Get Keys 集合，如為特定元件介面所定義：</span><span class="sxs-lookup"><span data-stu-id="13715-113">These keys correspond to the set of Get Keys as defined for the particular component interface.</span></span>|  
|`correctionMode`|<span data-ttu-id="13715-114">一個布林值旗標。</span><span class="sxs-lookup"><span data-stu-id="13715-114">A Boolean flag.</span></span> <span data-ttu-id="13715-115">設定為 true 時，允許透過更新欄位值或透過將新項目插入集合，修改具有生效日期項目的元件介面。</span><span class="sxs-lookup"><span data-stu-id="13715-115">When set to true, allows modifications to component interfaces with effective-dated items either by updating the field values, or by inserting new items into a collection.</span></span> <span data-ttu-id="13715-116">特別是允許修改 EFFDT 在目前生效日期之前的項目。</span><span class="sxs-lookup"><span data-stu-id="13715-116">Specifically, it allows modification to items that have EFFDT prior to the current effective date.</span></span> <span data-ttu-id="13715-117">此旗標若未設定為 TRUE，對這些項目所做的任何修改都會導致 PeopleSoft 伺服器傳回錯誤。</span><span class="sxs-lookup"><span data-stu-id="13715-117">Without this flag set to TRUE, any modification to these items results in an error returned from PeopleSoft server.</span></span><br /><br /> <span data-ttu-id="13715-118">`correctionMode` 引數只會對包含生效日期項目的那些元件介面公開。</span><span class="sxs-lookup"><span data-stu-id="13715-118">The `correctionMode` argument is only exposed for those component interfaces that contain effective-dated items.</span></span> <span data-ttu-id="13715-119">否則，並不會顯示在引數中。</span><span class="sxs-lookup"><span data-stu-id="13715-119">Otherwise, it is not shown as part of the argument.</span></span><br /><br /> <span data-ttu-id="13715-120">您應該避免在生產環境中，將 `correctionMode` 設定為 TRUE。</span><span class="sxs-lookup"><span data-stu-id="13715-120">You should avoid setting `correctionMode` to TRUE in a production environment.</span></span> <span data-ttu-id="13715-121">(這也是 PeopleSoft 提供的建議)。您不應該修改由過去 EFFDT 金鑰判斷為已經發生的事件。</span><span class="sxs-lookup"><span data-stu-id="13715-121">(This is also the recommendation from PeopleSoft.) Events that have already occurred as determined by the past EFFDT key should not be modified.</span></span> <span data-ttu-id="13715-122">這樣可以建立稽核線索。</span><span class="sxs-lookup"><span data-stu-id="13715-122">This allows for the creation of an audit trail.</span></span> <span data-ttu-id="13715-123">`UpdateEx` 中若有 `correctionMode` 旗標，即允許略過此安全機制。</span><span class="sxs-lookup"><span data-stu-id="13715-123">The `correctionMode` flag in `UpdateEx` allows this safety mechanism to be bypassed.</span></span> <span data-ttu-id="13715-124">建議的作法是針對要停用的過去事件，在項目中設定一個欄位，然後新增 (而不是刪除) 更新的項目。</span><span class="sxs-lookup"><span data-stu-id="13715-124">The recommended practice is for past events to be deactivated by setting a field in the item, and adding (instead of deleting) the updated item.</span></span>|  
|`interactiveMode`|<span data-ttu-id="13715-125">用於進行錯誤處理的旗標。</span><span class="sxs-lookup"><span data-stu-id="13715-125">A flag used for error handling.</span></span><br /><br /> <span data-ttu-id="13715-126">存取元件介面中的屬性時，BizTalk Adapter for PeopleSoft Enterprise 會使用 PeopleSoft 提供的 API，來讀取和寫入元件介面中的個別欄位，不過不會每次變更都傳播至 PeopleSoft 伺服器。</span><span class="sxs-lookup"><span data-stu-id="13715-126">When accessing properties in a component interface, BizTalk Adapter for PeopleSoft Enterprise uses PeopleSoft-provided APIs that read and write individual fields in the component interface; however, these changes are not propagated to the PeopleSoft server one at a time.</span></span> <span data-ttu-id="13715-127">而是讓 psjoa.jar (BizTalk Adapter for PeopleSoft Enterprise 會與之互動) 封裝所有變更，然後以一個封裝的形式，將變更傳送至伺服器。</span><span class="sxs-lookup"><span data-stu-id="13715-127">Instead, the psjoa.jar (with which BizTalk Adapter for PeopleSoft Enterprise interacts) packages all the changes and sends the changes to the server in one package.</span></span> <span data-ttu-id="13715-128">如果有任何個別的更新失敗，將會傳回一般錯誤，而不會指出實際錯誤。</span><span class="sxs-lookup"><span data-stu-id="13715-128">If any of the individual updates fail, a generic error is returned, which does not pinpoint the actual error.</span></span> <span data-ttu-id="13715-129">在互動模式設為 TRUE 的情況下，每個欄位更新都會個別傳送至伺服器。</span><span class="sxs-lookup"><span data-stu-id="13715-129">With the interactive mode set to TRUE, every field update is sent to the server individually.</span></span> <span data-ttu-id="13715-130">雖然這對效能會有相當程度的影響，但卻能在更新失敗時 (例如用以設定欄位的值無效時) 提供具體的錯誤資訊。</span><span class="sxs-lookup"><span data-stu-id="13715-130">This has a substantial impact on performance, but it does provide specific error information if the update fails (for example, if an invalid value is used for setting a field).</span></span><br /><br /> <span data-ttu-id="13715-131">`interactiveMode` 可提供最大效能，並提供欄位更新層級的錯誤報告。</span><span class="sxs-lookup"><span data-stu-id="13715-131">The `interactiveMode` provides maximum performance and provides error reporting at the field update level.</span></span> <span data-ttu-id="13715-132">若要適當使用此功能，建議您平常進行呼叫時，將 `interactiveMode` 設為 FALSE。</span><span class="sxs-lookup"><span data-stu-id="13715-132">To use this feature properly, it is recommended that you make normal calls with `interactiveMode` set to FALSE.</span></span> <span data-ttu-id="13715-133">這樣效能應該不會受到影響。</span><span class="sxs-lookup"><span data-stu-id="13715-133">There should be no impact on performance.</span></span> <span data-ttu-id="13715-134">如果傳回錯誤，就會透過將 `interactiveMode` 旗標設定為 TRUE，再次嘗試執行相同的呼叫。</span><span class="sxs-lookup"><span data-stu-id="13715-134">If an error is returned, the same call can be retried with the `interactiveMode` flag set to TRUE.</span></span> <span data-ttu-id="13715-135">當呼叫失敗時，伺服器會傳回更精確的錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="13715-135">When the call fails, the server returns a more precise error message.</span></span>|  
  
### <a name="remarks"></a><span data-ttu-id="13715-136">備註</span><span class="sxs-lookup"><span data-stu-id="13715-136">Remarks</span></span>  
 <span data-ttu-id="13715-137">當您呼叫此函式時，會以輸入參數屬性來取代對應至金鑰的記錄屬性。</span><span class="sxs-lookup"><span data-stu-id="13715-137">When you call this function, the properties of the record corresponding to the keys are replaced by the input parameter properties.</span></span> <span data-ttu-id="13715-138">含有原始記錄的所有集合都會遭到刪除，並以輸入參數來予以取代。</span><span class="sxs-lookup"><span data-stu-id="13715-138">All collections with the original records are deleted and replaced by those in the input parameter.</span></span> <span data-ttu-id="13715-139">這些集合的大小不一定要相符，因為 `UpdateEx` 內的程序是要刪除所有現有集合項目，然後插入指定的項目。</span><span class="sxs-lookup"><span data-stu-id="13715-139">The sizes of these collections do not have to matchbecause the procedure within `UpdateEx` is to delete all existing collection items and then insert the given ones.</span></span>  
  
 <span data-ttu-id="13715-140">如果元件介面的屬性包含生效日期項目，因為原始清單會被取代，所以屬性參數必須包含所有未來的生效日期項目。</span><span class="sxs-lookup"><span data-stu-id="13715-140">If the properties of the component interface contain effective dated items, the properties parameter must contain all future effective-dated items because the original list is replaced.</span></span> <span data-ttu-id="13715-141">這樣可提供新增和刪除未來生效日期項目的機制，不過，如果屬性也包含過去生效日期項目，就會傳回錯誤，因為您無法修改過去生效日期項目。</span><span class="sxs-lookup"><span data-stu-id="13715-141">This provides the mechanism for adding and deleting future effective-dated items; however, if the properties also contain past effective-dated items, an error is returned because past effective-dated items cannot be modified.</span></span> <span data-ttu-id="13715-142">如果目前生效日期項目也包含在內，則會被忽略。</span><span class="sxs-lookup"><span data-stu-id="13715-142">If the current effective-dated item is also included, it is ignored.</span></span> <span data-ttu-id="13715-143">這可讓用戶端來呼叫`Get()`與`getHistoryItems`參數設定為 False，修改任何未來生效日期項目或加入新未來生效日期的項目，和傳遞結構做為參數`UpdateEx()`函式。</span><span class="sxs-lookup"><span data-stu-id="13715-143">This permits the client to call `Get()` with the `getHistoryItems` parameter set to False, and modify any future effective-dated items or add new future effective-dated items, and pass in the structure as parameter for the `UpdateEx()` function.</span></span>  
  
 <span data-ttu-id="13715-144">如果在只能有一個執行個體存在的情況下，元件介面沒有金鑰，`UpdateEx()` 方法的表單如下：</span><span class="sxs-lookup"><span data-stu-id="13715-144">If the component interface does not have a key, as in the case where only one instance can exist, the `UpdateEx()` method has the form:</span></span>  
  
```  
UpdateEx(correctionMode, interactiveMode, properties)  
```  
  
> [!NOTE]
>  <span data-ttu-id="13715-145">如果已啟用元件介面中的 PeopleSoft `UpdateEx()` 與 `Get` 函式，就會提供 BizTalk Adapter for PeopleSoft Enterprise `Save` 方法。</span><span class="sxs-lookup"><span data-stu-id="13715-145">The BizTalk Adapter for PeopleSoft Enterprise `UpdateEx()` method is provided if the PeopleSoft `Get` and `Save` functions in the component interface are enabled.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="13715-146">另請參閱</span><span class="sxs-lookup"><span data-stu-id="13715-146">See Also</span></span>  
 [<span data-ttu-id="13715-147">附錄 a： 元件介面方法</span><span class="sxs-lookup"><span data-stu-id="13715-147">Appendix A: Component Interface Methods</span></span>](../core/appendix-a-component-interface-methods.md)