---
title: "指令碼處理運算質 |Microsoft 文件"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- Scripting functoids, about Scripting functoids
- Scripting functoids
- Scripting functoids, configuring
ms.assetid: ea8353da-049b-4e0c-a700-f51708db22a3
caps.latest.revision: "12"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 822bdbc4482a7e16a7458c7c44d128967203f283
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
---
# <a name="scripting-functoid"></a><span data-ttu-id="9b36b-102">指令碼處理運算質</span><span class="sxs-lookup"><span data-stu-id="9b36b-102">Scripting Functoid</span></span>
<span data-ttu-id="9b36b-103">**指令碼處理**運算質可讓您在執行階段使用自訂指令碼或程式碼來執行無法使用的功能。</span><span class="sxs-lookup"><span data-stu-id="9b36b-103">The **Scripting** functoid enables you to use custom script or code at run time to perform functions otherwise not available.</span></span> <span data-ttu-id="9b36b-104">例如，您可以呼叫執行階段的.NET 組件使用**指令碼處理**運算質和撰寫您自己的自訂函式。</span><span class="sxs-lookup"><span data-stu-id="9b36b-104">For example, you can call a .NET assembly at run time by using the **Scripting** functoid and writing your own custom functions.</span></span>  
  
 <span data-ttu-id="9b36b-105">**指令碼處理**運算質可支援下列語言：</span><span class="sxs-lookup"><span data-stu-id="9b36b-105">The **Scripting** functoid supports the following languages:</span></span>  
  
-   <span data-ttu-id="9b36b-106">C# .NET</span><span class="sxs-lookup"><span data-stu-id="9b36b-106">C# .NET</span></span>  
  
-   <span data-ttu-id="9b36b-107">JScript .NET</span><span class="sxs-lookup"><span data-stu-id="9b36b-107">JScript .NET</span></span>  
  
-   <span data-ttu-id="9b36b-108">Visual Basic.NET</span><span class="sxs-lookup"><span data-stu-id="9b36b-108">Visual Basic .NET</span></span>  
  
-   <span data-ttu-id="9b36b-109">可延伸樣式表語言轉換 (XSLT)</span><span class="sxs-lookup"><span data-stu-id="9b36b-109">Extensible Stylesheet Language Transformations (XSLT)</span></span>  
  
-   <span data-ttu-id="9b36b-110">XSLT 呼叫範本</span><span class="sxs-lookup"><span data-stu-id="9b36b-110">XSLT Call Templates</span></span>  
  
 <span data-ttu-id="9b36b-111">另一個重要差異目前**指令碼處理**運算質和較早版本已不再需要建立並儲存在本身的運算質指令碼。</span><span class="sxs-lookup"><span data-stu-id="9b36b-111">Another significant difference between the current **Scripting** functoid and earlier versions is that the script need no longer be created and stored in the functoid itself.</span></span> <span data-ttu-id="9b36b-112">相反地，您可以建立指令碼在不同的.NET 組件和參考組件透過**指令碼**屬性。</span><span class="sxs-lookup"><span data-stu-id="9b36b-112">Instead, you can create the script in a separate .NET assembly and reference the assembly through the **Script** property.</span></span> <span data-ttu-id="9b36b-113">讓指令碼在個別組件中，可讓您在一個以上的對應中使用相同的指令碼。</span><span class="sxs-lookup"><span data-stu-id="9b36b-113">Having the script in a separate assembly enables you to use the same script in more than one map.</span></span> <span data-ttu-id="9b36b-114">此外，您可以購買**指令碼處理**來自協力廠商所提供的運算質組件。</span><span class="sxs-lookup"><span data-stu-id="9b36b-114">Additionally, you may be able to purchase **Scripting** functoid assemblies from third-party vendors.</span></span>  
  
 <span data-ttu-id="9b36b-115">您可以使用**指令碼處理**建立在目前版本的 BizTalk 對應工具與舊版的 BizTalk 對應工具運算質。</span><span class="sxs-lookup"><span data-stu-id="9b36b-115">You can use **Scripting** functoids created in previous versions of BizTalk Mapper with the current version of BizTalk Mapper.</span></span> <span data-ttu-id="9b36b-116">不過，您必須先移轉運算質。</span><span class="sxs-lookup"><span data-stu-id="9b36b-116">However, you must migrate the functoids first.</span></span> <span data-ttu-id="9b36b-117">如需有關如何移轉**指令碼處理**運算質，請參閱[移轉運算質](../core/migrating-functoids.md)。</span><span class="sxs-lookup"><span data-stu-id="9b36b-117">For more information about how to migrate **Scripting** functoids, see [Migrating Functoids](../core/migrating-functoids.md).</span></span>  
  
 <span data-ttu-id="9b36b-118">當您將加入**指令碼處理**運算質到對應，您必須設定運算質所使用的指令碼。</span><span class="sxs-lookup"><span data-stu-id="9b36b-118">When you add a **Scripting** functoid to a map, you need to configure the script the functoid uses.</span></span> <span data-ttu-id="9b36b-119">如果您選取**指令碼處理**運算質，**指令碼**中屬性已啟用**屬性**視窗。</span><span class="sxs-lookup"><span data-stu-id="9b36b-119">If you select a **Scripting** functoid, the **Script** property is enabled in the **Properties** window.</span></span> <span data-ttu-id="9b36b-120">如果您按一下省略符號 (**...**) 按鈕，為此屬性，**設定指令碼處理運算質**對話方塊隨即開啟。</span><span class="sxs-lookup"><span data-stu-id="9b36b-120">If you click the ellipsis (**...**) button for this property, the **Configure Scripting Functoid** dialog box opens.</span></span> <span data-ttu-id="9b36b-121">或者，您可以按兩下**指令碼處理**運算質。</span><span class="sxs-lookup"><span data-stu-id="9b36b-121">Alternatively, you can double-click the **Scripting** functoid.</span></span>  
  
 <span data-ttu-id="9b36b-122">下表顯示此對話方塊的欄位。</span><span class="sxs-lookup"><span data-stu-id="9b36b-122">The following table shows the fields of this dialog box.</span></span>  
  
|<span data-ttu-id="9b36b-123">設定指令碼處理運算質對話方塊欄位</span><span class="sxs-lookup"><span data-stu-id="9b36b-123">Configure Scripting Functoid dialog box field</span></span>|<span data-ttu-id="9b36b-124">Description</span><span class="sxs-lookup"><span data-stu-id="9b36b-124">Description</span></span>|  
|---------------------------------------------------|-----------------|  
|<span data-ttu-id="9b36b-125">**選取指令碼類型**</span><span class="sxs-lookup"><span data-stu-id="9b36b-125">**Select script type**</span></span>|<span data-ttu-id="9b36b-126">使用此欄位來選取您想要使用此指令碼的類型**指令碼處理**運算質。</span><span class="sxs-lookup"><span data-stu-id="9b36b-126">Use this field to select the type of script you want to use in this **Scripting** functoid.</span></span><br /><br /> <span data-ttu-id="9b36b-127">值：</span><span class="sxs-lookup"><span data-stu-id="9b36b-127">Values:</span></span><br /><br /> <span data-ttu-id="9b36b-128">-   **外部組件**。</span><span class="sxs-lookup"><span data-stu-id="9b36b-128">-   **External Assembly**.</span></span> <span data-ttu-id="9b36b-129">使用此值，如果您想要關聯**指令碼處理**運算質與全域組件快取 (GAC) 中的組件。</span><span class="sxs-lookup"><span data-stu-id="9b36b-129">Use this value if you want to associate the **Scripting** functoid with an assembly in the global assembly cache (GAC).</span></span> <span data-ttu-id="9b36b-130">**警告：**外部組件中的程式碼必須是安全執行緒。</span><span class="sxs-lookup"><span data-stu-id="9b36b-130">**Warning:**      The code in the external assembly must be thread-safe.</span></span> <span data-ttu-id="9b36b-131">在負荷條件下，對應的多個執行個體可能會同時執行。</span><span class="sxs-lookup"><span data-stu-id="9b36b-131">Under stress conditions, multiple instances of a map may be running concurrently.</span></span><br /><span data-ttu-id="9b36b-132">-   **內嵌 C#**。</span><span class="sxs-lookup"><span data-stu-id="9b36b-132">-   **Inline C#**.</span></span>  <span data-ttu-id="9b36b-133">使用此值，如果您想要關聯**指令碼處理**包含 C# 程式碼中的運算質**內嵌指令碼**緩衝區。</span><span class="sxs-lookup"><span data-stu-id="9b36b-133">Use this value if you want to associate the **Scripting** functoid with C# code in the **Inline script** buffer.</span></span><br /><span data-ttu-id="9b36b-134">-   **內嵌 JScript.NET**。</span><span class="sxs-lookup"><span data-stu-id="9b36b-134">-   **Inline JScript .NET**.</span></span> <span data-ttu-id="9b36b-135">使用此值，如果您想要關聯**指令碼處理**運算質中的 JScript.NET 指令碼與**內嵌指令碼**緩衝區。</span><span class="sxs-lookup"><span data-stu-id="9b36b-135">Use this value if you want to associate the **Scripting** functoid with JScript .NET script in the **Inline script** buffer.</span></span><br /><span data-ttu-id="9b36b-136">-   **內嵌 Visual Basic.NET**。</span><span class="sxs-lookup"><span data-stu-id="9b36b-136">-   **Inline Visual Basic .NET**.</span></span> <span data-ttu-id="9b36b-137">使用此值，如果您想要關聯**指令碼處理**與 Visual Basic.NET 程式碼中的運算質**內嵌指令碼**緩衝區。</span><span class="sxs-lookup"><span data-stu-id="9b36b-137">Use this value if you want to associate the **Scripting** functoid with Visual Basic .NET code in the **Inline script** buffer.</span></span><br /><span data-ttu-id="9b36b-138">-   **內嵌 XSLT**。</span><span class="sxs-lookup"><span data-stu-id="9b36b-138">-   **Inline XSLT**.</span></span> <span data-ttu-id="9b36b-139">使用此值，如果您想要關聯**指令碼處理**運算質中的 XSLT 與**內嵌指令碼**緩衝區。</span><span class="sxs-lookup"><span data-stu-id="9b36b-139">Use this value if you want to associate the **Scripting** functoid with XSLT in the **Inline script** buffer.</span></span><br /><span data-ttu-id="9b36b-140">-   **內嵌 XSLT 呼叫範本**。</span><span class="sxs-lookup"><span data-stu-id="9b36b-140">-   **Inline XSLT Call Template**.</span></span> <span data-ttu-id="9b36b-141">使用此值，如果您想要關聯**指令碼處理**運算質與 XSLT 呼叫範本中**內嵌指令碼**緩衝區。</span><span class="sxs-lookup"><span data-stu-id="9b36b-141">Use this value if you want to associate the **Scripting** functoid with XSLT call templates in the **Inline script** buffer.</span></span>|  
|<span data-ttu-id="9b36b-142">**指令碼組件**</span><span class="sxs-lookup"><span data-stu-id="9b36b-142">**Script assembly**</span></span>|<span data-ttu-id="9b36b-143">選取要與建立關聯的組件**指令碼處理**運算質。</span><span class="sxs-lookup"><span data-stu-id="9b36b-143">Select the assembly to associate with the **Scripting** functoid.</span></span> <span data-ttu-id="9b36b-144">只有在 [專案] 視窗中所參考的組件會顯示在此清單中。</span><span class="sxs-lookup"><span data-stu-id="9b36b-144">Only assemblies referenced in the Project window appear in this list.</span></span> <span data-ttu-id="9b36b-145">也請注意，您必須在 GAC 中註冊組件。</span><span class="sxs-lookup"><span data-stu-id="9b36b-145">Note also that you must register assemblies in the GAC.</span></span><br /><br /> <span data-ttu-id="9b36b-146">這個欄位時，才可以使用**選取指令碼類型**設**外部組件**。</span><span class="sxs-lookup"><span data-stu-id="9b36b-146">This field is only available when **Select script type** is set to **External Assembly**.</span></span>|  
|<span data-ttu-id="9b36b-147">**指令碼類別**</span><span class="sxs-lookup"><span data-stu-id="9b36b-147">**Script class**</span></span>|<span data-ttu-id="9b36b-148">選取您要此選擇的組件內類別**指令碼處理**運算質使用。</span><span class="sxs-lookup"><span data-stu-id="9b36b-148">Select the class within the chosen assembly that you want this **Scripting** functoid to use.</span></span><br /><br /> <span data-ttu-id="9b36b-149">這個欄位時，才可以使用**選取指令碼類型**設**外部組件**。</span><span class="sxs-lookup"><span data-stu-id="9b36b-149">This field is only available when **Select script type** is set to **External Assembly**.</span></span>|  
|<span data-ttu-id="9b36b-150">**指令碼方法**</span><span class="sxs-lookup"><span data-stu-id="9b36b-150">**Script method**</span></span>|<span data-ttu-id="9b36b-151">選取您要此選擇類別內的方法**指令碼處理**運算質使用。</span><span class="sxs-lookup"><span data-stu-id="9b36b-151">Select the method within the chosen class that you want this **Scripting** functoid to use.</span></span> <span data-ttu-id="9b36b-152">**注意：**確定此方法預期的輸入參數數目符合中指定的輸入參數數目**設定指令碼處理運算質** 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="9b36b-152">**Note:**  Make sure the number of input parameters expected by the method matches the number of input parameters specified in the **Configure Scripting Functoid** dialog box.</span></span>|  
|<span data-ttu-id="9b36b-153">**內嵌指令碼**</span><span class="sxs-lookup"><span data-stu-id="9b36b-153">**Inline script**</span></span>|<span data-ttu-id="9b36b-154">在此文字方塊中寫入或複製要使用的內嵌指令碼。</span><span class="sxs-lookup"><span data-stu-id="9b36b-154">Write or copy the inline script to be used into this text box.</span></span> <span data-ttu-id="9b36b-155">有效的語言與指令碼包括：C#、JScript .NET、Visual Basic .NET、XSLT 以及 XSLT 呼叫範本。</span><span class="sxs-lookup"><span data-stu-id="9b36b-155">Valid languages and scripts include: C#, JScript .NET, Visual Basic .NET, XSLT, and XSLT call templates.</span></span><br /><br /> <span data-ttu-id="9b36b-156">這個欄位時，才可以使用**選取指令碼類型**設定為其中一個**內嵌**設定。</span><span class="sxs-lookup"><span data-stu-id="9b36b-156">This field is only available when **Select script type** is set to one of the **Inline** settings.</span></span> <span data-ttu-id="9b36b-157">**注意：**避免重複使用相同的方法簽章。</span><span class="sxs-lookup"><span data-stu-id="9b36b-157">**Caution:**  Avoid using the same method signature more than once.</span></span> <span data-ttu-id="9b36b-158">數個指令碼處理運算質具有相同的方法簽章時，BizTalk 會選取第一個實作，並捨棄其他實作。</span><span class="sxs-lookup"><span data-stu-id="9b36b-158">When several Scripting functoids have the same method signature, BizTalk selects the first implementation and disregards the others.</span></span>|  
  
 <span data-ttu-id="9b36b-159">下圖顯示如何**指令碼處理**運算質出現在地圖中使用 C#.Net script 重新格式化電話號碼。</span><span class="sxs-lookup"><span data-stu-id="9b36b-159">The following figure shows how the **Scripting** functoid appears in a map using the C# .Net script to reformat a telephone number.</span></span>  
  
 <span data-ttu-id="9b36b-160">![使用 C# 35; 對應若要格式化電話號碼。] (../core/media/scriptingfunctoid.gif "scriptingfunctoid")</span><span class="sxs-lookup"><span data-stu-id="9b36b-160">![Map using the C&#35; to format a telephone number.](../core/media/scriptingfunctoid.gif "scriptingfunctoid")</span></span>  
<span data-ttu-id="9b36b-161">指令碼處理運算質對應</span><span class="sxs-lookup"><span data-stu-id="9b36b-161">Scripting Functoid Map</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="9b36b-162">本節內容</span><span class="sxs-lookup"><span data-stu-id="9b36b-162">In This Section</span></span>  
  
-   [<span data-ttu-id="9b36b-163">使用外部組件指令碼</span><span class="sxs-lookup"><span data-stu-id="9b36b-163">Scripting Using External Assemblies</span></span>](../core/scripting-using-external-assemblies.md)  
  
-   [<span data-ttu-id="9b36b-164">使用內嵌 C#、 JScript.NET 和 Visual Basic.NET 指令碼</span><span class="sxs-lookup"><span data-stu-id="9b36b-164">Scripting Using Inline C#, JScript .NET, and Visual Basic .NET</span></span>](../core/scripting-using-inline-csharp-jscript-net-and-visual-basic-net.md)  
  
-   [<span data-ttu-id="9b36b-165">使用內嵌 XSLT 與 XSLT 呼叫範本指令碼</span><span class="sxs-lookup"><span data-stu-id="9b36b-165">Scripting Using Inline XSLT and XSLT Call Templates</span></span>](../core/scripting-using-inline-xslt-and-xslt-call-templates.md)