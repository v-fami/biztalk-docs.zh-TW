---
title: "如何建立 BizTalk Server 主控件環境 |Microsoft 文件"
ms.custom: 
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- hosting environments, creating
- managing [hosts], hosting environments
- hosts, environments
- managing [hosts], creating
- creating, hosting environment
ms.assetid: 6f335139-1121-45ff-88da-5c626b8fff97
caps.latest.revision: "20"
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: faa31308db26970d3d8274d42720dfba1cb5f00c
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
---
# <a name="how-to-create-a-biztalk-server-hosting-environment"></a><span data-ttu-id="597d3-102">如何建立 BizTalk Server 主控件環境</span><span class="sxs-lookup"><span data-stu-id="597d3-102">How to Create a BizTalk Server Hosting Environment</span></span>
<span data-ttu-id="597d3-103">建立之前您[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]裝載環境，請考慮下列建議：</span><span class="sxs-lookup"><span data-stu-id="597d3-103">Before you create your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] hosting environment, consider the following recommendations:</span></span>  
  
-   <span data-ttu-id="597d3-104">**使用不同的主控件的信任和非信任的協調流程和接收處理常式**</span><span class="sxs-lookup"><span data-stu-id="597d3-104">**Use different hosts for trusted and non-trusted orchestrations and receive handlers**</span></span>  
  
     <span data-ttu-id="597d3-105">任何在主控件中執行的項目 (例如，協調流程、管線、接收和傳送處理常式) 會以相同的識別來執行，而且可以存取該主控件的工作和擱置佇列。</span><span class="sxs-lookup"><span data-stu-id="597d3-105">Any items running in a host (for example, orchestrations, pipelines, receive and send handlers) run under the same identity, and have access to the work and suspended queues for that host.</span></span>  
  
     <span data-ttu-id="597d3-106">若因為權限錯誤，造成訊息無法傳遞至協調流程，則訊息會放置在主控件的擱置佇列，也就是執行傳送程序 (接收管線或其他協調流程) 的位置。</span><span class="sxs-lookup"><span data-stu-id="597d3-106">If a message cannot be delivered to an orchestration due to permission errors, the message is placed in the suspended queue of the host where the sending process (a receive pipeline or another orchestration) is running.</span></span> <span data-ttu-id="597d3-107">不過，若協調流程和傳送程序 (例如，接收管線) 是在相同主控件執行，則協調流程仍可存取擱置佇列中的訊息。</span><span class="sxs-lookup"><span data-stu-id="597d3-107">However, if the orchestration and the sending process (for example, a receive pipeline) are running in the same host, the orchestration can still access the message in the suspended queue.</span></span> <span data-ttu-id="597d3-108">若不信任的協調流程在信任的主控件上執行，可能會降低系統效能。</span><span class="sxs-lookup"><span data-stu-id="597d3-108">This could potentially compromise your system if a non-trusted orchestration is running in a trusted host.</span></span>  
  
     <span data-ttu-id="597d3-109">建議您在個別的主控件執行不信任的協調流程，並使用與您 BizTalk 群組中信任的主控件不同之服務帳戶。</span><span class="sxs-lookup"><span data-stu-id="597d3-109">We recommend that you run non-trusted orchestrations in a separate host, with a different service account than the trusted hosts in your BizTalk group.</span></span> <span data-ttu-id="597d3-110">如需將主控件指定為受信任，請參閱[如何修改主機內容](../core/how-to-modify-host-properties.md)。</span><span class="sxs-lookup"><span data-stu-id="597d3-110">For information about designating a host as trusted, see [How to Modify Host Properties](../core/how-to-modify-host-properties.md).</span></span>  
  
-   <span data-ttu-id="597d3-111">**限制 BizTalk Server 資料庫的資料庫和記錄檔大小**</span><span class="sxs-lookup"><span data-stu-id="597d3-111">**Limit the database and log size in the BizTalk Server databases**</span></span>  
  
     <span data-ttu-id="597d3-112">BizTalk MessageBox 資料庫和 BizTalk 追蹤資料庫的成長速度比其他[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]資料庫。</span><span class="sxs-lookup"><span data-stu-id="597d3-112">The BizTalk MessageBox databases and the BizTalk Tracking database grow much faster than the other [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases.</span></span> <span data-ttu-id="597d3-113">您應將經常更新這些資料庫，當作是備份和維護計劃的一部分。</span><span class="sxs-lookup"><span data-stu-id="597d3-113">As part of your backup and maintenance program, you should update these databases frequently.</span></span>  
  
     <span data-ttu-id="597d3-114">根據預設，在資料表[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]資料庫沒有記錄大小限制。</span><span class="sxs-lookup"><span data-stu-id="597d3-114">By default, the tables in the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases do not have a log size limit.</span></span> <span data-ttu-id="597d3-115">在備份和維護計劃中，建議您限制記錄大小，以避免日誌過大而可能使用所有的磁碟空間。</span><span class="sxs-lookup"><span data-stu-id="597d3-115">As part of your backup and maintenance program, we recommend that you limit the log size to prevent the logs from becoming too large and potentially using all the disk space.</span></span> <span data-ttu-id="597d3-116">如需管理追蹤資料庫的大小資訊，請參閱[封存和清除 BizTalk 追蹤資料庫](../core/archiving-and-purging-the-biztalk-tracking-database.md)。</span><span class="sxs-lookup"><span data-stu-id="597d3-116">For information about managing the size of tracking database, see [Archiving and Purging the BizTalk Tracking Database](../core/archiving-and-purging-the-biztalk-tracking-database.md).</span></span>  
  
-   <span data-ttu-id="597d3-117">**使用 SQL Server 叢集**</span><span class="sxs-lookup"><span data-stu-id="597d3-117">**Use SQL Server clustering**</span></span>  
  
     <span data-ttu-id="597d3-118">若要提供高可用性的[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]資料庫，建議您叢集的 SQL server 其中[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]儲存資料庫。</span><span class="sxs-lookup"><span data-stu-id="597d3-118">To provide high availability of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases, we recommend that you cluster the SQL servers where the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] databases are stored.</span></span> <span data-ttu-id="597d3-119">若其中一個資料庫或 SQL Server 失敗，這樣便可將停機的可能性降至最低。</span><span class="sxs-lookup"><span data-stu-id="597d3-119">This will help minimize downtime if one of the databases or SQL Server fails.</span></span> <span data-ttu-id="597d3-120">如需有關 SQL Server 叢集的詳細資訊，請參閱 < 容錯移轉叢集架構 > SQL Server 線上叢書 》 中。</span><span class="sxs-lookup"><span data-stu-id="597d3-120">For more information about SQL Server clustering, see "Failover Clustering Architecture" in SQL Server Books Online.</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="597d3-121">必要條件</span><span class="sxs-lookup"><span data-stu-id="597d3-121">Prerequisites</span></span>  
 <span data-ttu-id="597d3-122">以下是執行此主題中之程序的必要條件：</span><span class="sxs-lookup"><span data-stu-id="597d3-122">The following are prerequisites for performing the procedure in this topic:</span></span>  
  
-   <span data-ttu-id="597d3-123">您必須以「[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 系統管理員」群組的成員身分登入。</span><span class="sxs-lookup"><span data-stu-id="597d3-123">You must be logged on as a member of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administrators group.</span></span>  
  
-   <span data-ttu-id="597d3-124">下列程序中的指示假設您已安裝[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]與完整安裝選項。</span><span class="sxs-lookup"><span data-stu-id="597d3-124">The instructions in the following procedure assume that you have installed [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] with the complete installation option.</span></span> <span data-ttu-id="597d3-125">如果您未安裝[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]完整安裝選項時，某些步驟 1 中所列的系統管理物件可能無法在系統上。</span><span class="sxs-lookup"><span data-stu-id="597d3-125">If you did not install [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] with the complete installation option, some of the administration objects listed in step 1 may not be on your system.</span></span>  
  
### <a name="to-create-a-biztalk-server-hosting-environment"></a><span data-ttu-id="597d3-126">建立 BizTalk Server 主控件環境</span><span class="sxs-lookup"><span data-stu-id="597d3-126">To create a BizTalk Server hosting environment</span></span>  
  
1.  <span data-ttu-id="597d3-127">使用[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]設定，以建立新的 BizTalk 群組。</span><span class="sxs-lookup"><span data-stu-id="597d3-127">Use [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Configuration to create a new BizTalk group.</span></span> <span data-ttu-id="597d3-128">如需有關建立新資訊[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]群組，請參閱[使用 BizTalk Server 組態設定群組](http://msdn.microsoft.com/library/16beb7bb-091c-4056-8622-cc79c95186e9)。</span><span class="sxs-lookup"><span data-stu-id="597d3-128">For information about creating a new [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] group, see [Configuring Groups Using the BizTalk Server Configuration](http://msdn.microsoft.com/library/16beb7bb-091c-4056-8622-cc79c95186e9).</span></span>  
  
     [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]<span data-ttu-id="597d3-129">組態會建立下列系統管理物件：</span><span class="sxs-lookup"><span data-stu-id="597d3-129"> Configuration creates the following administration objects:</span></span>  
  
    |<span data-ttu-id="597d3-130">管理物件</span><span class="sxs-lookup"><span data-stu-id="597d3-130">Administration object</span></span>|<span data-ttu-id="597d3-131">Description</span><span class="sxs-lookup"><span data-stu-id="597d3-131">Description</span></span>|  
    |---------------------------|-----------------|  
    |<span data-ttu-id="597d3-132">**BizTalk 管理**資料庫 (BizTalkMgmtDb)</span><span class="sxs-lookup"><span data-stu-id="597d3-132">**BizTalk Management** database (BizTalkMgmtDb)</span></span>|<span data-ttu-id="597d3-133">這個資料庫是所有的中央中繼資訊存放區[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]s。</span><span class="sxs-lookup"><span data-stu-id="597d3-133">This database is the central meta-information store for all [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]s.</span></span>|  
    |<span data-ttu-id="597d3-134">**BizTalk MessageBox**資料庫 (BizTalkMsgBoxDb)</span><span class="sxs-lookup"><span data-stu-id="597d3-134">**BizTalk MessageBox** database (BizTalkMsgBoxDb)</span></span>|<span data-ttu-id="597d3-135">這個資料庫儲存了訂閱述詞。</span><span class="sxs-lookup"><span data-stu-id="597d3-135">This database stores subscriptions predicates.</span></span> <span data-ttu-id="597d3-136">它是主機平台，並針對每個保留的佇列和狀態資料表[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]主機。</span><span class="sxs-lookup"><span data-stu-id="597d3-136">It is a host platform, and keeps the queues and state tables for each [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] host.</span></span> <span data-ttu-id="597d3-137">MessageBox 資料庫也儲存訊息及訊息屬性。</span><span class="sxs-lookup"><span data-stu-id="597d3-137">The MessageBox database also stores the messages and message properties.</span></span> <span data-ttu-id="597d3-138">如需 MessageBox 資料庫的資訊，包括新增其他 MessageBox 資料庫，請參閱[管理 MessageBox 資料庫](../core/managing-messagebox-databases.md)。</span><span class="sxs-lookup"><span data-stu-id="597d3-138">For information about MessageBox databases, including adding additional MessageBox databases, see [Managing MessageBox Databases](../core/managing-messagebox-databases.md).</span></span>|  
    |<span data-ttu-id="597d3-139">**Server**</span><span class="sxs-lookup"><span data-stu-id="597d3-139">**Server**</span></span>|<span data-ttu-id="597d3-140">這是電腦上的[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]安裝和設定，且都在執行主控件執行個體。</span><span class="sxs-lookup"><span data-stu-id="597d3-140">This is the computer on which [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] is installed and configured, and where host instances are running.</span></span> <span data-ttu-id="597d3-141">您是從在伺服器上建立的主控件，而建立主控件執行個體。</span><span class="sxs-lookup"><span data-stu-id="597d3-141">You create host instances from a host created on a server.</span></span> <span data-ttu-id="597d3-142">如需建立主控件的詳細資訊，請參閱[如何建立新的主控件](../core/how-to-create-a-new-host.md)。</span><span class="sxs-lookup"><span data-stu-id="597d3-142">For more information about creating a host, see [How to Create a New Host](../core/how-to-create-a-new-host.md).</span></span> <span data-ttu-id="597d3-143">如需建立主控件執行個體的資訊，請參閱[如何新增主控件執行個體](../core/how-to-add-a-host-instance.md)。</span><span class="sxs-lookup"><span data-stu-id="597d3-143">For information about creating host instances, see [How to Add a Host Instance](../core/how-to-add-a-host-instance.md).</span></span>|  
    |<span data-ttu-id="597d3-144">**BAM 主要匯入**資料庫 (BAMPrimaryImport)</span><span class="sxs-lookup"><span data-stu-id="597d3-144">**BAM Primary Import** database (BAMPrimaryImport)</span></span>|<span data-ttu-id="597d3-145">這是「商務活動監控」工具收集追蹤資料的資料庫。</span><span class="sxs-lookup"><span data-stu-id="597d3-145">This is the database where the Business Activity Monitoring tool collects tracking data.</span></span>|  
    |<span data-ttu-id="597d3-146">**規則引擎**資料庫 (BizTalkRuleEngineDb)</span><span class="sxs-lookup"><span data-stu-id="597d3-146">**Rule Engine** database (BizTalkRuleEngineDb)</span></span>|<span data-ttu-id="597d3-147">這個資料庫是原則、規則和詞彙的儲存機制，可以在商務規則中進行資料參考。</span><span class="sxs-lookup"><span data-stu-id="597d3-147">This database is a repository for policies, rules, and vocabularies for data references in business rules.</span></span>|  
    |<span data-ttu-id="597d3-148">**BizTalk 追蹤**資料庫 (BizTalkDTADb)</span><span class="sxs-lookup"><span data-stu-id="597d3-148">**BizTalk Tracking** database (BizTalkDTADb)</span></span>|<span data-ttu-id="597d3-149">這個資料庫儲存商務和狀況監控資料追蹤[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]追蹤引擎。</span><span class="sxs-lookup"><span data-stu-id="597d3-149">This database stores business and health-monitoring data tracked by the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] tracking engine.</span></span>|  
    |<span data-ttu-id="597d3-150">**SSO**資料庫 (SSODB)</span><span class="sxs-lookup"><span data-stu-id="597d3-150">**SSO** database (SSODB)</span></span>|<span data-ttu-id="597d3-151">此資料庫儲存認證資訊。</span><span class="sxs-lookup"><span data-stu-id="597d3-151">This database stores credential information.</span></span>|  
    |<span data-ttu-id="597d3-152">**內含式主控件**與對應的主控件執行個體</span><span class="sxs-lookup"><span data-stu-id="597d3-152">**In-process host** with corresponding host instances</span></span>|<span data-ttu-id="597d3-153">內含式主控件中的運作[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]處理序空間。</span><span class="sxs-lookup"><span data-stu-id="597d3-153">The in-process host operates within the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] process space.</span></span>|  
    |<span data-ttu-id="597d3-154">**外掛式主控的件**與對應的主控件執行個體</span><span class="sxs-lookup"><span data-stu-id="597d3-154">**Isolated host** with corresponding host instances</span></span>|<span data-ttu-id="597d3-155">外掛式主控的件運作之外[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]安裝。</span><span class="sxs-lookup"><span data-stu-id="597d3-155">The isolated host operates outside of the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] installation.</span></span>|  
    |<span data-ttu-id="597d3-156">HTTP/S、BizTalk 訊息佇列、File、SMTP、SOAP 和 SQL</span><span class="sxs-lookup"><span data-stu-id="597d3-156">HTTP/S, BizTalk Message Queuing, File, SMTP, SOAP, and SQL</span></span>|<span data-ttu-id="597d3-157">組態精靈會建立做為 [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] 一部分的配接器。</span><span class="sxs-lookup"><span data-stu-id="597d3-157">The Configuration Wizard creates the adapters that are part of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)].</span></span>|  
  
2.  <span data-ttu-id="597d3-158">使用[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]管理主控台或 WMI 來新增元件至您[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]所需的環境。</span><span class="sxs-lookup"><span data-stu-id="597d3-158">Use the [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] Administration console or WMI to add components to your [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] environment as needed.</span></span> <span data-ttu-id="597d3-159">若要擴充您的解決方案、新增 MessageBox 資料庫、主控件和服務：</span><span class="sxs-lookup"><span data-stu-id="597d3-159">To scale out your solution, add MessageBox databases, hosts, and servers.</span></span>  
  
3.  <span data-ttu-id="597d3-160">使用「BizTalk 管理主控台」或 WMI，在對應的伺服器建立主控件執行個體。</span><span class="sxs-lookup"><span data-stu-id="597d3-160">Use the BizTalk Administration Console or WMI to create host instances on the mapped servers.</span></span> <span data-ttu-id="597d3-161">這個步驟會決定哪部伺服器上[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]會執行。</span><span class="sxs-lookup"><span data-stu-id="597d3-161">This step determines on which servers [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will run.</span></span> <span data-ttu-id="597d3-162">隨著企業變更的需求，您可以新增伺服器、移除伺服器以及變更伺服器與主控件對應。</span><span class="sxs-lookup"><span data-stu-id="597d3-162">As the needs in your enterprise change, you can add servers, remove servers, and change server-to-host mapping.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="597d3-163">另請參閱</span><span class="sxs-lookup"><span data-stu-id="597d3-163">See Also</span></span>  
 <span data-ttu-id="597d3-164">[管理 BizTalk 主控件和主控件執行個體](../core/managing-biztalk-hosts-and-host-instances.md) </span><span class="sxs-lookup"><span data-stu-id="597d3-164">[Managing BizTalk Hosts and Host Instances](../core/managing-biztalk-hosts-and-host-instances.md) </span></span>  
 <span data-ttu-id="597d3-165">[主機](../core/hosts.md) </span><span class="sxs-lookup"><span data-stu-id="597d3-165">[Hosts](../core/hosts.md) </span></span>  
 [<span data-ttu-id="597d3-166">主控件執行個體</span><span class="sxs-lookup"><span data-stu-id="597d3-166">Host Instances</span></span>](../core/host-instances.md)