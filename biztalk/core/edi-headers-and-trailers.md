---
title: EDI 標頭和結尾 |Microsoft 文件
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 5cf1dae3-9570-413d-a85d-94dcbb561906
caps.latest.revision: 20
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 655a7261da5dc66687fdf0cd623802854c0fa4ef
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
ms.locfileid: "22241926"
---
# <a name="edi-headers-and-trailers"></a><span data-ttu-id="c1639-102">EDI 標頭與結尾</span><span class="sxs-lookup"><span data-stu-id="c1639-102">EDI Headers and Trailers</span></span>
<span data-ttu-id="c1639-103">EDI 交換的部分會以標頭和結尾分隔，這些標頭和結尾必須符合 X12 或 EDIFACT 標準。</span><span class="sxs-lookup"><span data-stu-id="c1639-103">The parts of an EDI interchange are delimited by headers and trailers that must conform to the X12 or EDIFACT standards.</span></span> <span data-ttu-id="c1639-104">交換控制標頭和結尾只會出現一次，而如果交易集和群組在交換內進行批次處理，則功能群組和交易集標頭和結尾會重複出現。</span><span class="sxs-lookup"><span data-stu-id="c1639-104">The interchange control header and trailer occur just once; the functional group and transaction set headers and trailers are repeated if the transaction sets and groups are batched within the interchange.</span></span> <span data-ttu-id="c1639-105">標頭和結尾是由一系列的資料項目組成，其中包括標頭和結尾所包含內容的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="c1639-105">Each of the headers and trailers consists of a series of data elements that contain information about the content that the header and trailer contain.</span></span>  
  
 <span data-ttu-id="c1639-106">X12 和 EDIFACT 的標頭和結尾非常類似。</span><span class="sxs-lookup"><span data-stu-id="c1639-106">The headers and trailers for both X12 and EDIFACT are similar.</span></span> <span data-ttu-id="c1639-107">主要差異在於 EDIFACT 的「UNA 字串服務建議」標頭，它會定義交換中使用的分隔符號。</span><span class="sxs-lookup"><span data-stu-id="c1639-107">The major difference is the UNA Service String Advice header for EDIFACT, which defines the separators used in the interchange.</span></span> <span data-ttu-id="c1639-108">在 X12 編碼中，分隔符號是在「ISA 交換控制標頭」中定義。</span><span class="sxs-lookup"><span data-stu-id="c1639-108">In X12 encoding, the separators are defined in the ISA Interchange Control Header.</span></span>  
  
 <span data-ttu-id="c1639-109">交換控制和功能群組標頭和結尾會表示為信封區段。</span><span class="sxs-lookup"><span data-stu-id="c1639-109">The interchange control and functional group headers and trailers are denoted as envelope segments.</span></span> <span data-ttu-id="c1639-110">當 BizTalk Server 將內送交換分割成交易集時，它會將這些信封區段儲存成內容屬性。</span><span class="sxs-lookup"><span data-stu-id="c1639-110">When BizTalk Server splits an incoming interchange as transaction sets, it saves these envelope segments as context properties.</span></span> <span data-ttu-id="c1639-111">主要用於路由傳送的關鍵信封屬性會以個別屬性提供。</span><span class="sxs-lookup"><span data-stu-id="c1639-111">Key envelope properties that are useful for routing are available as individual properties.</span></span> <span data-ttu-id="c1639-112">保留交換時不會有上述動作，因為在這種情況下，信封資料屬於訊息本身的一部分。</span><span class="sxs-lookup"><span data-stu-id="c1639-112">This does not occur when the interchange is preserved, in which case the envelope data is part of the message itself.</span></span>  
  
 <span data-ttu-id="c1639-113">當[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]產生外寄訊息，則根據交易夥伴協議 （或全域的合約，若無合作對象判定） 上的標頭和結尾。</span><span class="sxs-lookup"><span data-stu-id="c1639-113">When [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] generates an outgoing message, it bases the headers and trailers on trading partner agreements (or global agreements if no party has been determined).</span></span>  
  
 <span data-ttu-id="c1639-114">標頭和結尾欄位和分隔符號字元來分隔它們在交換，兩者中定義的兩個合作對象之間的協議。</span><span class="sxs-lookup"><span data-stu-id="c1639-114">The header and trailer fields, and the separator characters used to separate them in interchanges, are both defined in the agreement between the two parties.</span></span> <span data-ttu-id="c1639-115">為協議所定義的分隔符號字元必須不使用任何交換、 群組或交易集標頭或結尾欄位的定義中。</span><span class="sxs-lookup"><span data-stu-id="c1639-115">A separator character must not be used in the definition of any of the interchange, group, or transaction set header or trailer fields, as defined for the agreement.</span></span> <span data-ttu-id="c1639-116">如有需要，交換將會失敗處理傳送的 EDI 組合器處於[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]或接收的合作對象的解譯器中。</span><span class="sxs-lookup"><span data-stu-id="c1639-116">If they are, the interchange will fail processing either in the EDI Assembler of the sending [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] or in the disassembler of the receiving party.</span></span> <span data-ttu-id="c1639-117">如果交換是輸出批次，它在「EDI 組合器」中即會失敗，因為「組合器」會針對標頭控制 (服務) 結構描述驗證信封。</span><span class="sxs-lookup"><span data-stu-id="c1639-117">The interchange will fail in the EDI Assembler if it is an outbound batch, because the Assembler will validate the envelope against the header control (service) schema.</span></span> <span data-ttu-id="c1639-118">如果未批次交換，EDI 組合器會進行序列化，但它無法解譯器在接收端協議中的處理。</span><span class="sxs-lookup"><span data-stu-id="c1639-118">If the interchange is unbatched, the EDI Assembler will serialize it, but it will fail processing in the disassembler at the receiving agreement.</span></span>  
  
## <a name="x12-headers-and-trailers"></a><span data-ttu-id="c1639-119">X12 標頭與結尾</span><span class="sxs-lookup"><span data-stu-id="c1639-119">X12 Headers and Trailers</span></span>  
 <span data-ttu-id="c1639-120">X12 編碼訊息的標頭和結尾如下：</span><span class="sxs-lookup"><span data-stu-id="c1639-120">The headers and trailers for an X12-encoded message are as follows:</span></span>  
  
```  
ISA Interchange Control Header  
  GS Functional Group Header  
    ST Transaction Set Header  
    SE Transaction Set Trailer  
  GE Functional Group Trailer  
IEA Interchange Control Trailer  
```  
  
 <span data-ttu-id="c1639-121">如果 ISA 標頭後面緊接跟著 IEA 結尾，表示交換是空的。</span><span class="sxs-lookup"><span data-stu-id="c1639-121">If an ISA header is followed immediately by an IEA trailer, the interchange is empty.</span></span> <span data-ttu-id="c1639-122">如果交易集存在，GS 標頭和 GE 結尾一定會存在。否則，它們是條件式。</span><span class="sxs-lookup"><span data-stu-id="c1639-122">If a transaction set exists, the GS header and GE trailer must be present; otherwise, they are conditional.</span></span>  
  
 <span data-ttu-id="c1639-123">X12 訊息中的 ISA 交換控制標頭欄位的長度是固定的。</span><span class="sxs-lookup"><span data-stu-id="c1639-123">The ISA interchange control header fields in an X12-encoded message are of fixed length.</span></span> <span data-ttu-id="c1639-124">針對某些欄位，您可以輸入長度少於欄位固定長度的值。</span><span class="sxs-lookup"><span data-stu-id="c1639-124">For some of the fields, you can enter a value less than the fixed length of the field.</span></span> <span data-ttu-id="c1639-125">若這麼做，交換就必須包含尾端空格 (字串欄位) 或前置零 (數字欄位)，使每個欄位都符合必要長度。</span><span class="sxs-lookup"><span data-stu-id="c1639-125">If you do so, the interchange must contain trailing spaces (for a string field) or leading zeroes (for a numerical field) so that each field is of the required length.</span></span> <span data-ttu-id="c1639-126">當建立輸出交換，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]會輸入尾端空格或前置零，以建立正確長度的交換控制標頭。</span><span class="sxs-lookup"><span data-stu-id="c1639-126">When creating an outbound interchange, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will enter trailing spaces or leading zeroes to create an interchange control header of the right length.</span></span> <span data-ttu-id="c1639-127">GS 群組標頭欄位和 ST 交易集標頭欄位的長度並不固定。</span><span class="sxs-lookup"><span data-stu-id="c1639-127">The GS group header fields and the ST transaction set header fields are not of fixed length.</span></span>  
  
 <span data-ttu-id="c1639-128">在 X12 編碼、 功能安全性標頭、 功能確保標頭、 功能安全性值區段和功能安全性結尾區段已超出範圍[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]EDI 和 AS2。</span><span class="sxs-lookup"><span data-stu-id="c1639-128">In X12 encoding, the functional security header, functional assurance header, functional security value segment, and functional security trailer segments are beyond the scope of [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] EDI and AS2.</span></span> <span data-ttu-id="c1639-129">如果您收到含有這些區段的交換，系統就會擱置此作業並顯示錯誤記錄，表示這些是無法識別的區段。</span><span class="sxs-lookup"><span data-stu-id="c1639-129">If an interchange with these segments is received, it will be suspended with an error log indicating that these are unidentified segments.</span></span>  
  
 <span data-ttu-id="c1639-130">ST01 欄位是交易集識別代碼，而 ST02 欄位是交易集控制編號。</span><span class="sxs-lookup"><span data-stu-id="c1639-130">The ST01 field is the transaction set ID Code; the ST02 field is the transaction set control number.</span></span> <span data-ttu-id="c1639-131">ST03 欄位是結構描述版本識別項。</span><span class="sxs-lookup"><span data-stu-id="c1639-131">The ST03 field is the schema version identifier.</span></span> <span data-ttu-id="c1639-132">SE01 欄位表示交易集中包含的區段數目，而 SE02 欄位與 ST02 欄位相同 (都是交易集控制編號)。</span><span class="sxs-lookup"><span data-stu-id="c1639-132">The SE01 field indicates the number of segments included in the transaction set; the SE02 field is the same as the ST02 field (the transaction set control number).</span></span> <span data-ttu-id="c1639-133">當剖析內送訊息，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]會確認交易集中的區段數目是否與 SE01 欄位的值。</span><span class="sxs-lookup"><span data-stu-id="c1639-133">When parsing an incoming message, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will verify that the number of segments in the transaction set corresponds to the value of the SE01 field.</span></span> <span data-ttu-id="c1639-134">當產生外寄訊息，[!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)]會將 SE01 欄位設定為交易集中的區段的正確數目。</span><span class="sxs-lookup"><span data-stu-id="c1639-134">When generating an outgoing message, [!INCLUDE[btsBizTalkServerNoVersion](../includes/btsbiztalkservernoversion-md.md)] will set the SE01 field to the correct number of segments in the transaction set.</span></span>  
  
 <span data-ttu-id="c1639-135">將序列化為外寄 EDI 交換的 XML 交易集，應該有交易集標頭和結尾。</span><span class="sxs-lookup"><span data-stu-id="c1639-135">An XML transaction set being serialized into an outgoing EDI interchange should have a transaction set header and trailer.</span></span> <span data-ttu-id="c1639-136">不過，如果訊息沒有交易集標頭和結尾，「EDI 組合器」也會處理此訊息。</span><span class="sxs-lookup"><span data-stu-id="c1639-136">However, the EDI Assembler will process the message if it does not have a transaction set header or trailer.</span></span> <span data-ttu-id="c1639-137">對 XML 交易集而言，X12 和 EDIFACT 結構描述中的交易集標頭和結尾都是選擇性項目。</span><span class="sxs-lookup"><span data-stu-id="c1639-137">Transaction set header and trailer segments in X12 and EDIFACT schemas are optional for XML transaction sets.</span></span> <span data-ttu-id="c1639-138">如果交易沒有標頭或結尾，EDISend 或 AS2EDISend 傳送管線中的「EDI 組合器」就會將交易集標頭和結尾值加入至此交易。</span><span class="sxs-lookup"><span data-stu-id="c1639-138">If a transaction does not have a header or trailer, the EDI Assembler in the EDISend or AS2EDISend send pipeline will add transaction set header and trailer values to it.</span></span> <span data-ttu-id="c1639-139">這些值是根據對應或計算而定。</span><span class="sxs-lookup"><span data-stu-id="c1639-139">These values will be based on mappings or calculations.</span></span> <span data-ttu-id="c1639-140">EDI 組合器會針對交換 XML (保留批次)、批次交易集 XML 和交易集 XML 執行這項作業。</span><span class="sxs-lookup"><span data-stu-id="c1639-140">The EDI Assembler will do this for interchange XML (a preserved batch), batched transaction set XML, and transaction set XML.</span></span> <span data-ttu-id="c1639-141">如需詳細資訊，請參閱[X12 交易集標頭和結尾區段](../core/how-the-edi-assembler-works.md#BKMK_X12)或[EDIFACT 交易集標頭和結尾區段](../core/how-the-edi-assembler-works.md#BKMK_EDIFACT)。</span><span class="sxs-lookup"><span data-stu-id="c1639-141">For more information, see [X12 Transaction Set Header and Trailer Segments](../core/how-the-edi-assembler-works.md#BKMK_X12) or [EDIFACT Transaction Set Header and Trailer Segments](../core/how-the-edi-assembler-works.md#BKMK_EDIFACT).</span></span>  
  
## <a name="edifact-headers-and-trailers"></a><span data-ttu-id="c1639-142">EDIFACT 標頭和結尾</span><span class="sxs-lookup"><span data-stu-id="c1639-142">EDIFACT Headers and Trailers</span></span>  
 <span data-ttu-id="c1639-143">EDIFACT 編碼訊息的標頭和結尾如下：</span><span class="sxs-lookup"><span data-stu-id="c1639-143">The headers and trailers for an EDIFACT-encoded message are as follows:</span></span>  
  
```  
UNA Service String Advice  
UNB Interchange Control Header  
  UNG Functional Group Header  
    UNH Message Header  
    UNT Message Trailer  
  UNE Functional Group Trailer  
UNZ Interchange Control Trailer  
```  
  
 <span data-ttu-id="c1639-144">UNA 標頭不是必要項目，</span><span class="sxs-lookup"><span data-stu-id="c1639-144">The UNA header is not required.</span></span> <span data-ttu-id="c1639-145">而 UNB 標頭是必要項目。</span><span class="sxs-lookup"><span data-stu-id="c1639-145">The UNB header is required.</span></span> <span data-ttu-id="c1639-146">如果有 UNA 標頭存在，其中會包含在處理內送訊息時所要使用的分隔符號，否則將會使用為 EfactDelimiters 管線屬性定義的分隔符號。</span><span class="sxs-lookup"><span data-stu-id="c1639-146">If the UNA header is present, it contains the delimiters to use when processing the incoming message; otherwise the separators defined for the EfactDelimiters pipeline property will be used.</span></span>  
  
 <span data-ttu-id="c1639-147">如果 UNB 標頭後面緊接跟著 UNZ 結尾，表示交換是空的。</span><span class="sxs-lookup"><span data-stu-id="c1639-147">If a UNB header is followed immediately by a UNZ trailer, the interchange is empty.</span></span> <span data-ttu-id="c1639-148">如果 UNG 標頭後面緊接跟著 UNE 結尾，表示群組是空的。</span><span class="sxs-lookup"><span data-stu-id="c1639-148">If a UNG header is followed immediately by a UNE trailer, the group is empty.</span></span> <span data-ttu-id="c1639-149">UNG 標頭和 UNE 結尾配對是選擇性項目，不一定要出現在訊息中。</span><span class="sxs-lookup"><span data-stu-id="c1639-149">The UNG header and UNE trailer pair are conditional and do not have to be present in a message.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c1639-150">另請參閱</span><span class="sxs-lookup"><span data-stu-id="c1639-150">See Also</span></span>  
 [<span data-ttu-id="c1639-151">EDI 訊息結構</span><span class="sxs-lookup"><span data-stu-id="c1639-151">EDI Message Structure</span></span>](../core/edi-message-structure.md)