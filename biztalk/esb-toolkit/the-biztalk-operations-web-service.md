---
title: BizTalk 作業 Web 服務 |Microsoft 文件
ms.custom: ''
ms.date: 06/08/2017
ms.prod: biztalk-server
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: af38815f-f643-4598-9148-6499071d12e4
caps.latest.revision: 5
author: MandiOhlinger
ms.author: mandia
manager: anneta
ms.openlocfilehash: 5d09fb2cdcca83e8a9f2e4e7704178d40a915065
ms.sourcegitcommit: cb908c540d8f1a692d01dc8f313e16cb4b4e696d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/20/2017
ms.locfileid: "22296910"
---
# <a name="the-biztalk-operations-web-service"></a><span data-ttu-id="89c14-102">BizTalk 作業 Web 服務</span><span class="sxs-lookup"><span data-stu-id="89c14-102">The BizTalk Operations Web Service</span></span>
<span data-ttu-id="89c14-103">Microsoft BizTalk 作業 Web 服務公開的物件和 BizTalk Server 訊息相關資訊。</span><span class="sxs-lookup"><span data-stu-id="89c14-103">The Microsoft BizTalk Operations Web service exposes information about the objects and messages in BizTalk Server.</span></span> <span data-ttu-id="89c14-104">服務名稱是**ESB.BizTalkOperationsService**，與此服務會公開各種不同的方法會傳回項目，例如清單主機、 協調流程、 應用程式和 BizTalk 應用程式狀態。</span><span class="sxs-lookup"><span data-stu-id="89c14-104">The service name is **ESB.BizTalkOperationsService**, and the service exposes a wide range of methods that return items such as a list of hosts, orchestrations, applications, and the BizTalk application status.</span></span>  
  
 <span data-ttu-id="89c14-105">可用的方法如下：</span><span class="sxs-lookup"><span data-stu-id="89c14-105">The following methods are available:</span></span>  
  
-   <span data-ttu-id="89c14-106">**應用程式**。</span><span class="sxs-lookup"><span data-stu-id="89c14-106">**Applications**.</span></span> <span data-ttu-id="89c14-107">這個方法會採用任何參數，並傳回的名稱和描述的所有已安裝的 BizTalk 應用程式做為集合**BTApplication**物件。</span><span class="sxs-lookup"><span data-stu-id="89c14-107">This method takes no parameters, and it returns the name and description of all installed BizTalk applications as a collection of **BTApplication** objects.</span></span>  
  
-   <span data-ttu-id="89c14-108">**ApplicationStatus**。</span><span class="sxs-lookup"><span data-stu-id="89c14-108">**ApplicationStatus**.</span></span> <span data-ttu-id="89c14-109">這個方法會將參數當成應用程式名稱，並傳回為指定的 BizTalk 應用程式的相關資訊**BTSysStatus**執行個體。</span><span class="sxs-lookup"><span data-stu-id="89c14-109">This method takes as a parameter the application name, and it returns information about the specified BizTalk application as a **BTSysStatus** instance.</span></span> <span data-ttu-id="89c14-110">這項資訊包括協調流程、 傳送埠、 接收位置和主機詳細資料。</span><span class="sxs-lookup"><span data-stu-id="89c14-110">This information includes orchestrations, send ports, receive locations, and host details.</span></span>  
  
-   <span data-ttu-id="89c14-111">**GetLiveMessageBody**。</span><span class="sxs-lookup"><span data-stu-id="89c14-111">**GetLiveMessageBody**.</span></span> <span data-ttu-id="89c14-112">訊息識別碼和執行個體識別碼，這個方法會採用做為參數，並從即時環境做為傳回該訊息的本文**BTMsgBody**執行個體。</span><span class="sxs-lookup"><span data-stu-id="89c14-112">This method takes as parameters a message ID and an instance ID, and it returns the body of that message from the live environment as a **BTMsgBody** instance.</span></span>  
  
-   <span data-ttu-id="89c14-113">**GetMessageInstances**。</span><span class="sxs-lookup"><span data-stu-id="89c14-113">**GetMessageInstances**.</span></span> <span data-ttu-id="89c14-114">這個方法會做為參數的訊息類型，並做為集合傳回所有比對訊息**BTMsgInstance**物件。</span><span class="sxs-lookup"><span data-stu-id="89c14-114">This method takes as a parameter the message type, and it returns all matching messages as a collection of **BTMsgInstance** objects.</span></span>  
  
-   <span data-ttu-id="89c14-115">**GetOrchestrationInstances**。</span><span class="sxs-lookup"><span data-stu-id="89c14-115">**GetOrchestrationInstances**.</span></span> <span data-ttu-id="89c14-116">這個方法會採用做為參數名稱的協調流程，並傳回的集合**BTOrchestrationInstance**包含相符的協調流程的詳細資料的物件。</span><span class="sxs-lookup"><span data-stu-id="89c14-116">This method takes as parameters the name of an orchestration, and it returns a collection of **BTOrchestrationInstance** object that contain details of the matching orchestrations.</span></span>  
  
-   <span data-ttu-id="89c14-117">**GetTrackedMessageBody**。</span><span class="sxs-lookup"><span data-stu-id="89c14-117">**GetTrackedMessageBody**.</span></span> <span data-ttu-id="89c14-118">這個方法會將參數當成訊息的 GUID，並傳回做為該訊息的本文**BTMsgBody** biztalk 處理後的執行個體。</span><span class="sxs-lookup"><span data-stu-id="89c14-118">This method takes as a parameter a message GUID, and it returns the body of that message as a **BTMsgBody** instance after it is processed in BizTalk.</span></span>  
  
-   <span data-ttu-id="89c14-119">**主機**。</span><span class="sxs-lookup"><span data-stu-id="89c14-119">**Hosts**.</span></span> <span data-ttu-id="89c14-120">這個方法會將參數當成主機的名稱，並傳回指定的主機執行個體的相關資訊，做為集合**BTHost**執行個體。</span><span class="sxs-lookup"><span data-stu-id="89c14-120">This method takes as a parameter the name of a host, and it returns information about the specified host instance as a collection of **BTHost** instances.</span></span> <span data-ttu-id="89c14-121">您可以使用主機名稱參數為空字串，傳回所有主控件執行個體的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="89c14-121">Use an empty string for the host name parameter to return information about all host instances.</span></span>  
  
-   <span data-ttu-id="89c14-122">**MessageFlowTree**。</span><span class="sxs-lookup"><span data-stu-id="89c14-122">**MessageFlowTree**.</span></span> <span data-ttu-id="89c14-123">這個方法會採用做為參數執行個體識別碼，並傳回該訊息的訊息流程的詳細資料**RouteTreeNode**執行個體。</span><span class="sxs-lookup"><span data-stu-id="89c14-123">This method takes as a parameter an instance ID, and it returns details of the message flow for that message as a **RouteTreeNode** instance.</span></span>  
  
-   <span data-ttu-id="89c14-124">**協調流程**。</span><span class="sxs-lookup"><span data-stu-id="89c14-124">**Orchestrations**.</span></span> <span data-ttu-id="89c14-125">這個方法會採用做為參數名稱的協調流程，並傳回該協調流程的所有資訊**BTSysStatus**執行個體。</span><span class="sxs-lookup"><span data-stu-id="89c14-125">This method takes as a parameter the name of an orchestration, and it returns all the information for that orchestration as a **BTSysStatus** instance.</span></span> <span data-ttu-id="89c14-126">傳回有關所有協調流程中使用協調流程名稱參數為空字串。</span><span class="sxs-lookup"><span data-stu-id="89c14-126">Use an empty string for the orchestration name parameter to return information about all orchestrations.</span></span>  
  
-   <span data-ttu-id="89c14-127">**ReceiveLocations**。</span><span class="sxs-lookup"><span data-stu-id="89c14-127">**ReceiveLocations**.</span></span> <span data-ttu-id="89c14-128">這個方法會採用做為參數名稱的接收位置，並傳回所有資訊比對的位置中的，如**BTSysStatus**執行個體。</span><span class="sxs-lookup"><span data-stu-id="89c14-128">This method takes as a parameter the name of a receive location, and it returns all the information for matching locations as a **BTSysStatus** instance.</span></span> <span data-ttu-id="89c14-129">您可以使用接收位置名稱參數為空字串，傳回所有位置的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="89c14-129">Use an empty string for the receive locations name parameter to return information about all locations.</span></span>  
  
-   <span data-ttu-id="89c14-130">**ReceiveLocationsByDescription**。</span><span class="sxs-lookup"><span data-stu-id="89c14-130">**ReceiveLocationsByDescription**.</span></span> <span data-ttu-id="89c14-131">這個方法會採用做為參數的描述接收位置，並傳回所有資訊比對的位置中的，如**BTSysStatus**執行個體。</span><span class="sxs-lookup"><span data-stu-id="89c14-131">This method takes as a parameter the description of a receive location, and it returns all the information for matching locations as a **BTSysStatus** instance.</span></span> <span data-ttu-id="89c14-132">您可以使用描述參數為空字串，傳回所有位置的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="89c14-132">Use an empty string for the description parameter to return information about all locations.</span></span>  
  
-   <span data-ttu-id="89c14-133">**SendPorts**。</span><span class="sxs-lookup"><span data-stu-id="89c14-133">**SendPorts**.</span></span> <span data-ttu-id="89c14-134">這個方法會採用做為參數傳送埠的名稱，並傳回符合為連接埠的所有資訊**BTSysStatus**執行個體。</span><span class="sxs-lookup"><span data-stu-id="89c14-134">This method takes as a parameter the name of a send port, and it returns all the information for matching ports as a **BTSysStatus** instance.</span></span> <span data-ttu-id="89c14-135">您可以使用傳送連接埠名稱參數為空字串，傳回所有連接埠的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="89c14-135">Use an empty string for the send port name parameter to return information about all ports.</span></span>  
  
-   <span data-ttu-id="89c14-136">**SendPortsByDescription**。</span><span class="sxs-lookup"><span data-stu-id="89c14-136">**SendPortsByDescription**.</span></span> <span data-ttu-id="89c14-137">這個方法會採用做為參數的描述傳送埠，並傳回符合為連接埠的所有資訊**BTSysStatus**執行個體。</span><span class="sxs-lookup"><span data-stu-id="89c14-137">This method takes as a parameter the description of a send port, and it returns all the information for matching ports as a **BTSysStatus** instance.</span></span> <span data-ttu-id="89c14-138">傳回有關所有連接埠使用 description 參數為空字串。</span><span class="sxs-lookup"><span data-stu-id="89c14-138">Use an empty string for the description parameter to return information about all ports.</span></span>  
  
-   <span data-ttu-id="89c14-139">**StatusChanged**。</span><span class="sxs-lookup"><span data-stu-id="89c14-139">**StatusChanged**.</span></span> <span data-ttu-id="89c14-140">這個方法會將參數當成時間戳記，並傳回詳細資料 （例如連接埠、 主機和協調流程） 的 BizTalk 物件的修改，因為指定的時間戳記，當做**BTSysStatus**執行個體。</span><span class="sxs-lookup"><span data-stu-id="89c14-140">This method takes as a parameter a timestamp, and it returns details of BizTalk objects (such as ports, hosts, and orchestrations) modified since the specified timestamp as a **BTSysStatus** instance.</span></span>  
  
-   <span data-ttu-id="89c14-141">**SystemStatus**。</span><span class="sxs-lookup"><span data-stu-id="89c14-141">**SystemStatus**.</span></span> <span data-ttu-id="89c14-142">這個方法會採用任何參數，並傳回完整詳細資料，做為 BizTalk 系統狀態的**BTSysStatus**執行個體。</span><span class="sxs-lookup"><span data-stu-id="89c14-142">This method takes no parameters, and it returns full details of the BizTalk system status as a **BTSysStatus** instance.</span></span>  
  
-   <span data-ttu-id="89c14-143">**UpdateReceiveLocationDescription**。</span><span class="sxs-lookup"><span data-stu-id="89c14-143">**UpdateReceiveLocationDescription**.</span></span> <span data-ttu-id="89c14-144">這個方法會更新指定的接收位置使用的參數值包含應用程式名稱、 接收埠名稱、 接收位置名稱和接收位置描述的描述。</span><span class="sxs-lookup"><span data-stu-id="89c14-144">This method updates the description of a specified receive location using parameter values that contain the application name, the receive port name, the receive location name, and the receive location description.</span></span> <span data-ttu-id="89c14-145">它會傳回字串，表示作業的結果。</span><span class="sxs-lookup"><span data-stu-id="89c14-145">It returns a String that indicates the result of the operation.</span></span> <span data-ttu-id="89c14-146">請注意測試用戶端應用程式會從其 App.config 檔案讀取這項資訊。</span><span class="sxs-lookup"><span data-stu-id="89c14-146">Note that the test client application reads this information from its App.config file.</span></span>  
  
-   <span data-ttu-id="89c14-147">**UpdateSendPortDescription**。</span><span class="sxs-lookup"><span data-stu-id="89c14-147">**UpdateSendPortDescription**.</span></span> <span data-ttu-id="89c14-148">這個方法會更新指定的傳送埠使用的參數值包含傳送埠名稱和描述傳送連接埠的描述。</span><span class="sxs-lookup"><span data-stu-id="89c14-148">This method updates the description of a specified send port using parameter values that contain the send port name and the send port description.</span></span> <span data-ttu-id="89c14-149">它會傳回字串，表示作業的結果。</span><span class="sxs-lookup"><span data-stu-id="89c14-149">It returns a String that indicates the result of the operation.</span></span> <span data-ttu-id="89c14-150">請注意測試用戶端應用程式會從其 App.config 檔案讀取這項資訊。</span><span class="sxs-lookup"><span data-stu-id="89c14-150">Note that the test client application reads this information from its App.config file.</span></span>  
  
## <a name="configuring-the-biztalk-operations-web-service"></a><span data-ttu-id="89c14-151">設定 BizTalk 作業 Web 服務</span><span class="sxs-lookup"><span data-stu-id="89c14-151">Configuring the BizTalk Operations Web Service</span></span>  
 <span data-ttu-id="89c14-152">BizTalk 作業 Web 服務可能會直接與 BizTalk Server 管理資料庫使用 Windows Management Instrumentation (WMI) 通訊，或使用 BizTalk 作業和戲嚽庢 API 來取得它所需要的資訊。</span><span class="sxs-lookup"><span data-stu-id="89c14-152">The BizTalk Operations Web service either communicates directly with the BizTalk Server management databases using Windows Management Instrumentation (WMI) or it uses the BizTalk Operations and Explorer API to obtain the information it requires.</span></span> <span data-ttu-id="89c14-153">因此，您必須確定您的系統符合下列條件，並將下列安全性權限設定：</span><span class="sxs-lookup"><span data-stu-id="89c14-153">Therefore, you must make sure that your system meets the following conditions and that you configure the following security permission settings:</span></span>  
  
-   <span data-ttu-id="89c14-154">設定**allowOverride**電腦層級 Web.config 檔案中的屬性**false**以確定開發人員無法變更其應用程式的信任層級。</span><span class="sxs-lookup"><span data-stu-id="89c14-154">Set the **allowOverride** attribute in the machine-level Web.config file to **false** to make sure developers cannot change the trust level of their applications.</span></span>  
  
-   <span data-ttu-id="89c14-155">根據預設，BizTalk 作業 Web 服務未設定為需要安全通訊端層 (SSL) 用戶端存取時。</span><span class="sxs-lookup"><span data-stu-id="89c14-155">By default, the BizTalk Operations Web service is not configured to require Secure Sockets Layer (SSL) when accessed by clients.</span></span> <span data-ttu-id="89c14-156">您應該設定服務，讓它需要 SSL 用戶端存取，並保護網際網路資訊服務 (IIS) Web 服務主機電腦與執行裝載 BizTalkMgmtDb 資料庫使用 SQL Server 的電腦之間的連線網路層級 IPSec 與適當的檔案層級存取控制清單 (ACL) 權限。</span><span class="sxs-lookup"><span data-stu-id="89c14-156">You should configure the service so that it requires SSL for client access, and protect the connection between the Internet Information Services (IIS) Web service host computer and the computer running SQL Server that hosts the BizTalkMgmtDb database using network-level IPSec and appropriate file-level access control list (ACL) permissions.</span></span>  
  
-   <span data-ttu-id="89c14-157">存取 BizTalk 作業 Web 服務的使用者必須是一些方法的預設 BizTalk Server 系統管理員群組的成員以及其他方法的預設 BizTalk 應用程式使用者群組的成員。</span><span class="sxs-lookup"><span data-stu-id="89c14-157">Users accessing the BizTalk Operations Web service must be members of the default BizTalk Server Administrators group for some methods and members of the default BizTalk Application Users group for other methods.</span></span>  
  
-   <span data-ttu-id="89c14-158">您必須確定 BizTalk 作業 Web 服務位於名為 已停用匿名存取的 ESB.BizTalkOperationsService 的 IIS 虛擬目錄。</span><span class="sxs-lookup"><span data-stu-id="89c14-158">You must make sure that the BizTalk Operations Web service resides in an IIS virtual directory named ESB.BizTalkOperationsService that has anonymous access disabled.</span></span>  
  
-   <span data-ttu-id="89c14-159">使用者必須擁有**選取**BizTalkMgmtDb 資料庫和 BizTalkMsgBoxDb 資料庫位於 SQL Server 中之數個資料表的權限。</span><span class="sxs-lookup"><span data-stu-id="89c14-159">Users must have **SELECT** permission in SQL Server for several tables located in the BizTalkMgmtDb database and the BizTalkMsgBoxDb database.</span></span> <span data-ttu-id="89c14-160">您可以使用 SQL Server Management Studio 來設定下列權限：</span><span class="sxs-lookup"><span data-stu-id="89c14-160">Use SQL Server Management Studio to set the following permissions:</span></span>  
  
    -   <span data-ttu-id="89c14-161">在 BizTalkMgmtDb 資料庫中，設定 BTS_ADMIN_USERS 資料庫角色與**選取**權限的下列資料表：</span><span class="sxs-lookup"><span data-stu-id="89c14-161">In the BizTalkMgmtDb database, configure the BTS_ADMIN_USERS database role with **SELECT** permission on the following tables:</span></span>  
  
        -   <span data-ttu-id="89c14-162">adm_Server2HostMapping</span><span class="sxs-lookup"><span data-stu-id="89c14-162">adm_Server2HostMapping</span></span>  
  
        -   <span data-ttu-id="89c14-163">adm_Server</span><span class="sxs-lookup"><span data-stu-id="89c14-163">adm_Server</span></span>  
  
        -   <span data-ttu-id="89c14-164">adm_hostInstance</span><span class="sxs-lookup"><span data-stu-id="89c14-164">adm_hostInstance</span></span>  
  
    -   <span data-ttu-id="89c14-165">在 BizTalkMsgBoxDb 資料庫中，設定 BTS_ADMIN_USER 資料庫角色與**選取**ProcessHeartbeats 資料表的權限。</span><span class="sxs-lookup"><span data-stu-id="89c14-165">In the BizTalkMsgBoxDb database, configure the BTS_ADMIN_USER database role with **SELECT** permission on the ProcessHeartbeats table.</span></span>  
  
 <span data-ttu-id="89c14-166">在 SQL Server Management Studio，您可以設定的必要權限。</span><span class="sxs-lookup"><span data-stu-id="89c14-166">In SQL Server Management Studio, you can configure the required permissions.</span></span> <span data-ttu-id="89c14-167">若要這樣做，請展開**安全性**在左的窗格的樹狀檢視的 [物件總管] 中，依序展開**角色**，依序展開**適**選取 BTS_ADMIN_USERS 角色，然後編輯此角色，如圖 1 所示的屬性。</span><span class="sxs-lookup"><span data-stu-id="89c14-167">To do this, expand **Security** in the left pane tree view of Object Explorer, expand **Roles**, expand **DatabaseRoles**, select the BTS_ADMIN_USERS role, and then edit the properties for this role, as shown in Figure 1.</span></span>  
  
 <span data-ttu-id="89c14-168">![SQL Server Mgmt Studio](../esb-toolkit/media/ch4-sqlservermgmtstudio.gif "第 4 章第 SQLServerMgmtStudio")</span><span class="sxs-lookup"><span data-stu-id="89c14-168">![SQL Server Mgmt Studio](../esb-toolkit/media/ch4-sqlservermgmtstudio.gif "Ch4-SQLServerMgmtStudio")</span></span>  
  
 <span data-ttu-id="89c14-169">**圖 1**</span><span class="sxs-lookup"><span data-stu-id="89c14-169">**Figure 1**</span></span>  
  
 <span data-ttu-id="89c14-170">**編輯 Microsoft SQL Server Management Studio 中的 BTS_ADMIN_USERS 資料庫角色的權限**</span><span class="sxs-lookup"><span data-stu-id="89c14-170">**Editing permissions for the BTS_ADMIN_USERS database role in Microsoft SQL Server Management Studio**</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="89c14-171">您必須設定使用 Windows 整合式安全性，並內建網路服務帳戶下執行此服務。</span><span class="sxs-lookup"><span data-stu-id="89c14-171">You must configure this service to use Windows Integrated Security and run under the built-in NETWORK SERVICE account.</span></span> <span data-ttu-id="89c14-172">您也必須啟用 Kerberos 驗證您的 IIS 網頁伺服器上，讓它將此標頭**Negotiate、 NTLM**給用戶端。</span><span class="sxs-lookup"><span data-stu-id="89c14-172">You must also enable Kerberos authentication on your IIS Web server so that it sends the header **Negotiate,NTLM** to the client.</span></span> <span data-ttu-id="89c14-173">如需詳細資訊，請參閱[如何設定 IIS 以支援用於網路驗證的 Kerberos 通訊協定與 NTLM 通訊協定](http://go.microsoft.com/fwlink/?LinkId=186430)([http://go.microsoft.com/fwlink/?LinkId=186430](http://go.microsoft.com/fwlink/?LinkId=186430))。</span><span class="sxs-lookup"><span data-stu-id="89c14-173">For more information, see [How to configure IIS to support both the Kerberos protocol and the NTLM protocol for network authentication](http://go.microsoft.com/fwlink/?LinkId=186430)([http://go.microsoft.com/fwlink/?LinkId=186430](http://go.microsoft.com/fwlink/?LinkId=186430)).</span></span>  
>   
>  <span data-ttu-id="89c14-174">根據預設，BizTalk 作業 Web 服務未設定為需要 SSL 用戶端存取時。</span><span class="sxs-lookup"><span data-stu-id="89c14-174">By default, the BizTalk Operations Web service is not configured to require SSL when accessed by clients.</span></span> <span data-ttu-id="89c14-175">您應該設定服務，讓需要 SSL 用戶端存取和保護 IIS Web 服務主機電腦和伺服器主控 「 UDDI 服務使用網路層級 IPSec 和適當的檔案層級 ACL 權限之間的連線。</span><span class="sxs-lookup"><span data-stu-id="89c14-175">You should configure the service so that it requires SSL for client access and protect the connection between the IIS Web service host computer and the server that hosts the UDDI service using network-level IPSec and appropriate file-level ACL permissions.</span></span>